{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\src\\\\components\\\\Form\\\\Item\\\\View.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport React, { useCallback, useEffect } from \"react\";\nimport { connect, useDispatch, useSelector } from \"react-redux\";\nimport { selectRoot, resetSubmissions, saveSubmission, Form, selectError, Errors, getForm, Formio } from \"react-formio\";\nimport { push } from \"connected-react-router\";\nimport { Link, useParams } from \"react-router-dom\";\nimport Loading from \"../../../containers/Loading\";\nimport { getProcessReq } from \"../../../apiManager/services/bpmServices\";\nimport { setFormFailureErrorData, setFormRequestData, setFormSubmissionError, setFormSubmissionLoading, setFormSuccessData, setMaintainBPMFormPagination } from \"../../../actions/formActions\";\nimport SubmissionError from \"../../../containers/SubmissionError\";\nimport { applicationCreate, publicApplicationCreate, publicApplicationStatus } from \"../../../apiManager/services/applicationServices\";\nimport LoadingOverlay from \"react-loading-overlay\";\nimport { CUSTOM_EVENT_TYPE } from \"../../ServiceFlow/constants/customEventTypes\";\nimport { toast } from \"react-toastify\";\nimport { setFormSubmitted, setPublicFormStatus } from \"../../../actions/formActions\";\nimport { fetchFormByAlias } from \"../../../apiManager/services/bpmFormServices\";\nimport { checkIsObjectId } from \"../../../apiManager/services/formatterService\";\nimport Card from \"react-bootstrap/Card\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar View = /*#__PURE__*/React.memo(_c = _s(function (props) {\n  _s();\n\n  var isFormSubmissionLoading = useSelector(function (state) {\n    return state.formDelete.isFormSubmissionLoading;\n  });\n  var isFormSubmitted = useSelector(function (state) {\n    return state.formDelete.formSubmitted;\n  });\n  var publicFormStatus = useSelector(function (state) {\n    return state.formDelete.publicFormStatus;\n  });\n  var isPublic = window.location.href.includes(\"public\"); //need to remove\n\n  var _useParams = useParams(),\n      formId = _useParams.formId;\n\n  var isAuthenticated = props.isAuthenticated,\n      submission = props.submission,\n      hideComponents = props.hideComponents,\n      _onSubmit = props.onSubmit,\n      onCustomEvent = props.onCustomEvent,\n      errors = props.errors,\n      options = props.options,\n      _props$form = props.form,\n      form = _props$form.form,\n      isActive = _props$form.isActive,\n      url = _props$form.url;\n  var dispatch = useDispatch();\n  var getPublicForm = useCallback(function (form_id, isObjectId, formObj) {\n    dispatch(publicApplicationStatus(form_id, function (err, res) {\n      if (isPublic) {\n        if (isObjectId) {\n          dispatch(getForm(\"form\", form_id));\n        } else {\n          dispatch(setFormRequestData('form', form_id, \"\".concat(Formio.getProjectUrl(), \"/form/\").concat(form_id)));\n          dispatch(setFormSuccessData('form', formObj));\n        }\n\n        if (res && res.is_anonymous && res.status === \"active\") {\n          dispatch(setPublicFormStatus(true));\n        } else {\n          dispatch(setPublicFormStatus(false));\n        }\n      }\n    }));\n  }, [dispatch, isPublic]);\n  var getFormData = useCallback(function () {\n    var isObjectId = checkIsObjectId(formId);\n\n    if (isObjectId) {\n      getPublicForm(formId, isObjectId);\n    } else {\n      dispatch(fetchFormByAlias(formId, /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(err, formObj) {\n          var form_id;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (!err) {\n                    form_id = formObj._id;\n                    getPublicForm(form_id, isObjectId, formObj);\n                  } else {\n                    dispatch(setFormFailureErrorData('form', err));\n                  }\n\n                case 1:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x, _x2) {\n          return _ref.apply(this, arguments);\n        };\n      }()));\n    }\n  }, [formId, dispatch, getPublicForm]);\n  useEffect(function () {\n    if (isPublic) {\n      getFormData();\n    } else {\n      dispatch(setMaintainBPMFormPagination(true));\n    }\n  }, [isPublic, dispatch, getFormData]);\n\n  if (isActive) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      \"data-testid\": \"loading-view-component\",\n      children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, _this);\n  }\n\n  if (isFormSubmitted) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center\",\n      style: {\n        paddingTop: '8rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        style: {\n          width: '60vw',\n          marginLeft: 'auto',\n          marginRight: 'auto',\n          padding: '2rem'\n        },\n        children: /*#__PURE__*/_jsxDEV(Card.Body, {\n          children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-check-circle pb-4\",\n                style: {\n                  color: '#2e8540',\n                  fontSize: '3rem',\n                  caretColor: 'transparent'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 21\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"h4\", {\n              children: /*#__PURE__*/_jsxDEV(\"b\", {\n                children: \"Thank you\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 25\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 21\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(Card.Text, {\n            children: [\"Your form has been submitted. An email acknowledging service of the documents will be sent to the contact email address provided. If you do not receive an email acknowledging service within 1 business day, check your junk folder.  If no confirmation is received, please email \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"mailto:aglsblitigationect@gov.bc.ca\",\n              children: \"aglsblitigationect@gov.bc.ca\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 28\n            }, _this), \". For clarity, service is not effected until an email acknowledgment has been provided.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, _this);\n  }\n\n  if (!publicFormStatus && isPublic) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger mt-4\",\n      role: \"alert\",\n      children: \"Form not available\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, _this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container overflow-y-auto\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-header\",\n      children: [/*#__PURE__*/_jsxDEV(SubmissionError, {\n        modalOpen: props.submissionError.modalOpen,\n        message: props.submissionError.message,\n        onConfirm: props.onConfirm\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, _this), isAuthenticated ? /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/form\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa fa-chevron-left fa-lg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }, _this) : null, form.title ? /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"ml-3 px-3 py-4\",\n        children: form.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 11\n      }, _this) : \"\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Errors, {\n      errors: errors\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(LoadingOverlay, {\n      active: isFormSubmissionLoading,\n      spinner: true,\n      text: \"Loading...\",\n      className: \"col-12\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ml-4 mr-4\",\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          form: form,\n          submission: submission,\n          url: url,\n          options: _objectSpread({}, options),\n          hideComponents: hideComponents,\n          onSubmit: function onSubmit(data) {\n            _onSubmit(data, form._id);\n          },\n          onCustomEvent: onCustomEvent\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 151,\n    columnNumber: 5\n  }, _this);\n}, \"nBz4D42bhC34tanVXG6qvL/hyp4=\", false, function () {\n  return [useSelector, useSelector, useSelector, useParams, useDispatch];\n}));\n_c2 = View;\n\nvar doProcessActions = function doProcessActions(submission, ownProps) {\n  return function (dispatch, getState) {\n    var user = getState().user.userDetail;\n    var form = getState().form.form;\n    var IsAuth = getState().user.isAuthenticated;\n    dispatch(resetSubmissions(\"submission\"));\n    var data = getProcessReq(form, submission._id, \"new\", user);\n    var isPublic = window.location.href.includes(\"public\");\n\n    if (isPublic) {\n      // this is for anonymous\n      dispatch(publicApplicationCreate(data, function (err, res) {\n        if (!err) {\n          dispatch(setFormSubmissionLoading(false));\n          toast.success(\"Submission Saved.\");\n          dispatch(setFormSubmitted(true));\n        } else {\n          //TO DO Update to show error message\n          dispatch(setFormSubmissionLoading(false));\n          toast.error(\"Submission failed\"); // dispatch(setFormSubmitted())\n          // dispatch(push(`/public/submitted`));\n        }\n      }));\n    } else {\n      dispatch(applicationCreate(data, function (err, res) {\n        if (!err) {\n          if (IsAuth) {\n            dispatch(setFormSubmissionLoading(false));\n            dispatch(setMaintainBPMFormPagination(true));\n            /*dispatch(push(`/form/${ownProps.match.params.formId}/submission/${submission._id}/edit`))*/\n\n            toast.success(\"Submission Saved.\");\n            dispatch(push(\"/form\"));\n          } else {\n            dispatch(setFormSubmissionLoading(false));\n          }\n        } else {\n          //TO DO Update to show error message\n          if (IsAuth) {\n            dispatch(setFormSubmissionLoading(false));\n            dispatch(setMaintainBPMFormPagination(true)); //dispatch(push(`/form/${ownProps.match.params.formId}/submission/${submission._id}/edit`))\n\n            toast.success(\"Submission Saved.\");\n            dispatch(push(\"/form\"));\n          } else {\n            dispatch(setFormSubmissionLoading(false));\n          }\n        }\n      }));\n    }\n  };\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user.userDetail,\n    form: selectRoot(\"form\", state),\n    isAuthenticated: state.user.isAuthenticated,\n    errors: [selectError(\"form\", state), selectError(\"submission\", state)],\n    options: {\n      noAlerts: false,\n      i18n: {\n        en: {\n          error: \"Please fix the errors before submitting again.\"\n        }\n      }\n    },\n    submissionError: selectRoot(\"formDelete\", state).formSubmissionError\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch, ownProps) {\n  return {\n    onSubmit: function onSubmit(submission, formId) {\n      dispatch(setFormSubmissionLoading(true));\n      dispatch(saveSubmission(\"submission\", submission, formId, function (err, submission) {\n        if (!err) {\n          dispatch(doProcessActions(submission, ownProps));\n        } else {\n          var ErrorDetails = {\n            modalOpen: true,\n            message: \"Submission cannot be done\"\n          };\n          toast.error(\"Error while Submission.\");\n          dispatch(setFormSubmissionLoading(false));\n          dispatch(setFormSubmissionError(ErrorDetails));\n        }\n      }));\n    },\n    onCustomEvent: function onCustomEvent(customEvent) {\n      switch (customEvent.type) {\n        case CUSTOM_EVENT_TYPE.CUSTOM_SUBMIT_DONE:\n          toast.success(\"Submission Saved.\");\n          dispatch(push(\"/form\"));\n          break;\n\n        case CUSTOM_EVENT_TYPE.CANCEL_SUBMISSION:\n          dispatch(push(\"/form\"));\n          break;\n\n        default:\n          return;\n      }\n    },\n    onConfirm: function onConfirm() {\n      var ErrorDetails = {\n        modalOpen: false,\n        message: \"\"\n      };\n      dispatch(setFormSubmissionError(ErrorDetails));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(View);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"View$React.memo\");\n$RefreshReg$(_c2, \"View\");","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/jag-servebc/forms-flow-ai/forms-flow-web/src/components/Form/Item/View.js"],"names":["React","useCallback","useEffect","connect","useDispatch","useSelector","selectRoot","resetSubmissions","saveSubmission","Form","selectError","Errors","getForm","Formio","push","Link","useParams","Loading","getProcessReq","setFormFailureErrorData","setFormRequestData","setFormSubmissionError","setFormSubmissionLoading","setFormSuccessData","setMaintainBPMFormPagination","SubmissionError","applicationCreate","publicApplicationCreate","publicApplicationStatus","LoadingOverlay","CUSTOM_EVENT_TYPE","toast","setFormSubmitted","setPublicFormStatus","fetchFormByAlias","checkIsObjectId","Card","View","memo","props","isFormSubmissionLoading","state","formDelete","isFormSubmitted","formSubmitted","publicFormStatus","isPublic","window","location","href","includes","formId","isAuthenticated","submission","hideComponents","onSubmit","onCustomEvent","errors","options","form","isActive","url","dispatch","getPublicForm","form_id","isObjectId","formObj","err","res","getProjectUrl","is_anonymous","status","getFormData","_id","paddingTop","width","marginLeft","marginRight","padding","color","fontSize","caretColor","submissionError","modalOpen","message","onConfirm","title","data","doProcessActions","ownProps","getState","user","userDetail","IsAuth","success","error","mapStateToProps","noAlerts","i18n","en","formSubmissionError","mapDispatchToProps","ErrorDetails","customEvent","type","CUSTOM_SUBMIT_DONE","CANCEL_SUBMISSION"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect } from \"react\";\r\nimport { connect, useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  selectRoot,\r\n  resetSubmissions,\r\n  saveSubmission,\r\n  Form,\r\n  selectError,\r\n  Errors,\r\n  getForm, Formio,\r\n} from \"react-formio\";\r\nimport { push } from \"connected-react-router\";\r\nimport { Link, useParams } from \"react-router-dom\";\r\nimport Loading from \"../../../containers/Loading\";\r\nimport { getProcessReq } from \"../../../apiManager/services/bpmServices\";\r\nimport {\r\n  setFormFailureErrorData,\r\n  setFormRequestData,\r\n  setFormSubmissionError,\r\n  setFormSubmissionLoading, setFormSuccessData,\r\n  setMaintainBPMFormPagination,\r\n} from \"../../../actions/formActions\";\r\nimport SubmissionError from \"../../../containers/SubmissionError\";\r\nimport {\r\n  applicationCreate,\r\n  publicApplicationCreate,\r\n  publicApplicationStatus,\r\n} from \"../../../apiManager/services/applicationServices\";\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\nimport { CUSTOM_EVENT_TYPE } from \"../../ServiceFlow/constants/customEventTypes\";\r\nimport { toast } from \"react-toastify\";\r\nimport {\r\n  setFormSubmitted,\r\n  setPublicFormStatus,\r\n} from \"../../../actions/formActions\";\r\nimport { fetchFormByAlias } from \"../../../apiManager/services/bpmFormServices\";\r\nimport {checkIsObjectId} from \"../../../apiManager/services/formatterService\";\r\nimport Card from \"react-bootstrap/Card\";\r\n\r\nconst View = React.memo((props) => {\r\n  const isFormSubmissionLoading = useSelector(\r\n    (state) => state.formDelete.isFormSubmissionLoading\r\n  );\r\n  const isFormSubmitted = useSelector(\r\n    (state) => state.formDelete.formSubmitted\r\n  );\r\n  const publicFormStatus = useSelector(\r\n    (state) => state.formDelete.publicFormStatus\r\n  );\r\n  const isPublic = window.location.href.includes(\"public\"); //need to remove\r\n  const { formId } = useParams();\r\n\r\n  const {\r\n    isAuthenticated,\r\n    submission,\r\n    hideComponents,\r\n    onSubmit,\r\n    onCustomEvent,\r\n    errors,\r\n    options,\r\n    form: { form, isActive, url },\r\n  } = props;\r\n  const dispatch = useDispatch();\r\n\r\n  const getPublicForm = useCallback((form_id, isObjectId, formObj) => {\r\n    dispatch(\r\n      publicApplicationStatus(form_id, (err, res) => {\r\n        if (isPublic) {\r\n          if(isObjectId){\r\n            dispatch(getForm(\"form\", form_id));\r\n          }\r\n          else{\r\n            dispatch(setFormRequestData('form',form_id,`${Formio.getProjectUrl()}/form/${form_id}`));\r\n            dispatch(setFormSuccessData('form',formObj));\r\n          }\r\n          if (res && res.is_anonymous && res.status === \"active\") {\r\n            dispatch(setPublicFormStatus(true));\r\n          } else {\r\n            dispatch(setPublicFormStatus(false));\r\n          }\r\n        }\r\n      })\r\n    );\r\n  },[dispatch,isPublic]);\r\n\r\n  const getFormData = useCallback( () => {\r\n    const isObjectId = checkIsObjectId(formId);\r\n    if (isObjectId) {\r\n      getPublicForm(formId,isObjectId);\r\n    } else {\r\n      dispatch(\r\n        fetchFormByAlias(formId, async (err, formObj) => {\r\n          if (!err) {\r\n            const form_id = formObj._id;\r\n            getPublicForm(form_id,isObjectId,formObj);\r\n          }else{\r\n            dispatch(setFormFailureErrorData('form',err));\r\n          }\r\n        })\r\n      );\r\n    }\r\n  },[formId,dispatch,getPublicForm])\r\n\r\n\r\n  useEffect(() => {\r\n    if (isPublic) {\r\n      getFormData();\r\n    } else {\r\n      dispatch(setMaintainBPMFormPagination(true));\r\n    }\r\n  }, [isPublic, dispatch,getFormData]);\r\n\r\n  if (isActive) {\r\n    return (\r\n      <div data-testid=\"loading-view-component\">\r\n        <Loading />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if(isFormSubmitted){\r\n    return (\r\n      <div className=\"text-center\" style={{ paddingTop: '8rem' }}>\r\n        <Card style={{ width: '60vw', marginLeft: 'auto', marginRight: 'auto', padding: '2rem' }}>\r\n          <Card.Body>\r\n            <Card.Title>\r\n              <span><i className=\"fa fa-check-circle pb-4\" style={{color: '#2e8540', fontSize: '3rem', caretColor: 'transparent' }}/></span>\r\n              <br /><h4><b>Thank you</b></h4>\r\n            </Card.Title>\r\n            <Card.Text>\r\n              Your form has been submitted. An email acknowledging service of the documents will be \r\n              sent to the contact email address provided. If you do not receive an email acknowledging \r\n              service within 1 business day, check your junk folder.  If no confirmation is received, \r\n              please email <a href=\"mailto:aglsblitigationect@gov.bc.ca\">aglsblitigationect@gov.bc.ca</a>. \r\n              For clarity, service is not effected until an email acknowledgment has been provided.\r\n            </Card.Text>\r\n          </Card.Body>\r\n        </Card>\r\n      </div>\r\n  )}\r\n\r\n  if (!publicFormStatus && isPublic) {\r\n    return (\r\n      <div className=\"alert alert-danger mt-4\" role=\"alert\">\r\n        Form not available\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container overflow-y-auto\">\r\n      <div className=\"main-header\">\r\n        <SubmissionError\r\n          modalOpen={props.submissionError.modalOpen}\r\n          message={props.submissionError.message}\r\n          onConfirm={props.onConfirm}\r\n        ></SubmissionError>\r\n        {isAuthenticated ? (\r\n          <Link to=\"/form\">\r\n            <i className=\"fa fa-chevron-left fa-lg\" />\r\n          </Link>\r\n        ) : null}\r\n        {/*   <span className=\"ml-3\">\r\n            <img src=\"/form.svg\" width=\"30\" height=\"30\" alt=\"form\" />\r\n          </span>*/}\r\n        {form.title ? (\r\n          <h3 className=\"ml-3 px-3 py-4\">\r\n            {/* <span className=\"task-head-details\">\r\n              <i className=\"fa fa-wpforms\" aria-hidden=\"true\" /> &nbsp; Forms /\r\n            </span>{\" \"} */}\r\n            {form.title}\r\n          </h3>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n      <Errors errors={errors} />\r\n      <LoadingOverlay\r\n        active={isFormSubmissionLoading}\r\n        spinner\r\n        text=\"Loading...\"\r\n        className=\"col-12\"\r\n      >\r\n        <div className=\"ml-4 mr-4\">\r\n          <Form\r\n            form={form}\r\n            submission={submission}\r\n            url={url}\r\n            options={{ ...options }}\r\n            hideComponents={hideComponents}\r\n            onSubmit={(data) => {\r\n              onSubmit(data, form._id);\r\n            }}\r\n            onCustomEvent={onCustomEvent}\r\n          />\r\n        </div>\r\n      </LoadingOverlay>\r\n    </div>\r\n  );\r\n});\r\n\r\nconst doProcessActions = (submission, ownProps) => {\r\n  return (dispatch, getState) => {\r\n    let user = getState().user.userDetail;\r\n    let form = getState().form.form;\r\n    let IsAuth = getState().user.isAuthenticated;\r\n    dispatch(resetSubmissions(\"submission\"));\r\n    const data = getProcessReq(form, submission._id, \"new\", user);\r\n\r\n    const isPublic = window.location.href.includes(\"public\");\r\n\r\n    if (isPublic) {\r\n      // this is for anonymous\r\n      dispatch(\r\n        publicApplicationCreate(data, (err, res) => {\r\n          if (!err) {\r\n            dispatch(setFormSubmissionLoading(false));\r\n            toast.success(\"Submission Saved.\");\r\n            dispatch(setFormSubmitted(true));\r\n          } else {\r\n            //TO DO Update to show error message\r\n            dispatch(setFormSubmissionLoading(false));\r\n            toast.error(\"Submission failed\");\r\n            // dispatch(setFormSubmitted())\r\n            // dispatch(push(`/public/submitted`));\r\n          }\r\n        })\r\n      );\r\n    } else {\r\n      dispatch(\r\n        applicationCreate(data, (err, res) => {\r\n          if (!err) {\r\n            if (IsAuth) {\r\n              dispatch(setFormSubmissionLoading(false));\r\n              dispatch(setMaintainBPMFormPagination(true));\r\n              /*dispatch(push(`/form/${ownProps.match.params.formId}/submission/${submission._id}/edit`))*/\r\n              toast.success(\"Submission Saved.\");\r\n              dispatch(push(`/form`));\r\n            } else {\r\n              dispatch(setFormSubmissionLoading(false));\r\n            }\r\n          } else {\r\n            //TO DO Update to show error message\r\n            if (IsAuth) {\r\n              dispatch(setFormSubmissionLoading(false));\r\n              dispatch(setMaintainBPMFormPagination(true));\r\n              //dispatch(push(`/form/${ownProps.match.params.formId}/submission/${submission._id}/edit`))\r\n              toast.success(\"Submission Saved.\");\r\n              dispatch(push(`/form`));\r\n            } else {\r\n              dispatch(setFormSubmissionLoading(false));\r\n            }\r\n          }\r\n        })\r\n      );\r\n    }\r\n  };\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    user: state.user.userDetail,\r\n    form: selectRoot(\"form\", state),\r\n    isAuthenticated: state.user.isAuthenticated,\r\n    errors: [selectError(\"form\", state), selectError(\"submission\", state)],\r\n    options: {\r\n      noAlerts: false,\r\n      i18n: {\r\n        en: {\r\n          error: \"Please fix the errors before submitting again.\",\r\n        },\r\n      },\r\n    },\r\n    submissionError: selectRoot(\"formDelete\", state).formSubmissionError,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => {\r\n  return {\r\n    onSubmit: (submission, formId) => {\r\n      dispatch(setFormSubmissionLoading(true));\r\n      dispatch(\r\n        saveSubmission(\"submission\", submission, formId, (err, submission) => {\r\n          if (!err) {\r\n            dispatch(doProcessActions(submission, ownProps));\r\n          } else {\r\n            const ErrorDetails = {\r\n              modalOpen: true,\r\n              message: \"Submission cannot be done\",\r\n            };\r\n            toast.error(\"Error while Submission.\");\r\n            dispatch(setFormSubmissionLoading(false));\r\n            dispatch(setFormSubmissionError(ErrorDetails));\r\n          }\r\n        })\r\n      );\r\n    },\r\n    onCustomEvent: (customEvent) => {\r\n      switch (customEvent.type) {\r\n        case CUSTOM_EVENT_TYPE.CUSTOM_SUBMIT_DONE:\r\n          toast.success(\"Submission Saved.\");\r\n          dispatch(push(`/form`));\r\n          break;\r\n        case CUSTOM_EVENT_TYPE.CANCEL_SUBMISSION:\r\n          dispatch(push(`/form`));\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n    },\r\n    onConfirm: () => {\r\n      const ErrorDetails = { modalOpen: false, message: \"\" };\r\n      dispatch(setFormSubmissionError(ErrorDetails));\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(View);\r\n"]},"metadata":{},"sourceType":"module"}