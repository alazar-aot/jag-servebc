{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\forms-flow-master\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport _objectSpread from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\forms-flow-master\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";\nimport _slicedToArray from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\forms-flow-master\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\forms-flow-master\\\\forms-flow-ai\\\\forms-flow-web\\\\src\\\\components\\\\Form\\\\List.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\forms-flow-master\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { connect, useDispatch, useSelector } from \"react-redux\";\nimport { push } from \"connected-react-router\";\nimport { Link } from \"react-router-dom\";\nimport { Button } from \"react-bootstrap\";\nimport { toast } from 'react-toastify';\nimport { indexForms, selectRoot, selectError, Errors, FormGrid, deleteForm, saveForm } from \"react-formio\";\nimport Loading from \"../../containers/Loading\";\nimport { FORM_ACCESS, STAFF_DESIGNER, SUBMISSION_ACCESS } from \"../../constants/constants\";\nimport \"../Form/List.scss\";\nimport { setBPMFormLimit, setBPMFormListLoading, setBPMFormListPage, setBPMFormListSort, setFormDeleteStatus, setMaintainBPMFormPagination } from \"../../actions/formActions\";\nimport Confirm from \"../../containers/Confirm\";\nimport { fetchBPMFormList, fetchFormByAlias } from \"../../apiManager/services/bpmFormServices\";\nimport { designerColumns, getOperations, userColumns } from \"./constants/formListConstants\";\nimport FileService from \"../../services/FileService\";\nimport { setFormCheckList, setFormUploadList, updateFormUploadCounter } from \"../../actions/checkListActions\";\nimport FileModal from './FileUpload/fileUploadModal';\nimport { addHiddenApplicationComponent } from \"../../constants/applicationComponent\";\nimport LoadingOverlay from \"react-loading-overlay\";\nimport { getFormProcesses, getApplicationCount, resetFormProcessData } from \"../../apiManager/services/processServices\";\nimport { unPublishForm } from \"../../apiManager/services/processServices\";\nimport { setIsApplicationCountLoading } from \"../../actions/processActions\";\nimport { setBpmFormSearch } from \"../../actions/formActions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar List = /*#__PURE__*/React.memo(_c = _s(function (props) {\n  _s();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      showFormUploadModal = _useState2[0],\n      setShowFormUploadModal = _useState2[1];\n\n  var dispatch = useDispatch();\n  var uploadFormNode = useRef();\n  var forms = props.forms,\n      _onAction = props.onAction,\n      getForms = props.getForms,\n      getFormsInit = props.getFormsInit,\n      errors = props.errors,\n      userRoles = props.userRoles,\n      formId = props.formId,\n      _onNo = props.onNo,\n      _onYes = props.onYes;\n  var isBPMFormListLoading = useSelector(function (state) {\n    return state.bpmForms.isActive;\n  });\n  var bpmForms = useSelector(function (state) {\n    return state.bpmForms;\n  });\n  var showViewSubmissions = useSelector(function (state) {\n    return state.user.showViewSubmissions;\n  });\n  var formCheckList = useSelector(function (state) {\n    return state.formCheckList.formList;\n  });\n  var isDesigner = userRoles.includes(STAFF_DESIGNER);\n  var operations = getOperations(userRoles, showViewSubmissions);\n  var columns = isDesigner ? designerColumns : userColumns;\n  var paginatedForms = isDesigner ? forms.forms : bpmForms.forms;\n  var searchFormLoading = useSelector(function (state) {\n    return state.formCheckList.searchFormLoading;\n  });\n  var isApplicationCountLoading = useSelector(function (state) {\n    return state.process.isApplicationCountLoading;\n  });\n  var applicationCountResponse = useSelector(function (state) {\n    return state.process.applicationCountResponse;\n  });\n  var formProcessData = useSelector(function (state) {\n    return state.process.formProcessList;\n  });\n  var applicationCount = useSelector(function (state) {\n    return state.process.applicationCount;\n  });\n  var bpmFormLoading = useSelector(function (state) {\n    return state.bpmForms.bpmFormLoading;\n  });\n\n  var getFormsList = function getFormsList(page, query) {\n    if (page) {\n      dispatch(setBPMFormListPage(page));\n    }\n\n    if (query) {\n      dispatch(setBPMFormListSort(query.sort || ''));\n    }\n  };\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      previousForms = _useState4[0],\n      setPreviousForms = _useState4[1];\n\n  var onPageSizeChanged = function onPageSizeChanged(pageSize) {\n    if (isDesigner) {\n      dispatch(indexForms(\"forms\", 1, {\n        limit: pageSize\n      }));\n    } else {\n      dispatch(setBPMFormLimit(pageSize));\n    }\n  };\n\n  useEffect(function () {\n    if (forms.forms.length > 0) {\n      setPreviousForms(forms);\n    }\n  }, [forms]);\n  useEffect(function () {\n    dispatch(setFormCheckList([]));\n  }, [dispatch]);\n  useEffect(function () {\n    if (isDesigner) {\n      getFormsInit(1);\n    } else {\n      dispatch(setBPMFormListLoading(true));\n      dispatch(fetchBPMFormList());\n    }\n  }, [getFormsInit, dispatch, isDesigner]);\n\n  var downloadForms = function downloadForms() {\n    FileService.downloadFile({\n      forms: formCheckList\n    }, function () {\n      toast.success(\"\".concat(formCheckList.length, \" \").concat(formCheckList.length === 1 ? \"Form\" : \"Forms\", \" Downloaded Successfully\"));\n      dispatch(setFormCheckList([]));\n    });\n  };\n\n  var uploadClick = function uploadClick(e) {\n    var _uploadFormNode$curre;\n\n    dispatch(setFormUploadList([]));\n    e.preventDefault();\n    (_uploadFormNode$curre = uploadFormNode.current) === null || _uploadFormNode$curre === void 0 ? void 0 : _uploadFormNode$curre.click();\n    return false;\n  };\n\n  var resetForms = function resetForms() {\n    isDesigner ? dispatch(indexForms('forms', 1, {\n      query: _objectSpread(_objectSpread({}, forms.query), {}, {\n        title__regex: \"\"\n      })\n    })) : dispatch(setBpmFormSearch(''));\n  };\n\n  var uploadFileContents = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(fileContent) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(fileContent.forms && Array.isArray(fileContent.forms))) {\n                _context4.next = 5;\n                break;\n              }\n\n              _context4.next = 3;\n              return Promise.all(fileContent.forms.map( /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(formData) {\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          return _context3.abrupt(\"return\", new Promise(function (resolve, reject) {\n                            formData = addHiddenApplicationComponent(formData);\n\n                            var newFormData = _objectSpread(_objectSpread({}, formData), {}, {\n                              tags: [\"common\"]\n                            });\n\n                            newFormData.access = FORM_ACCESS;\n                            newFormData.submissionAccess = SUBMISSION_ACCESS;\n                            dispatch(saveForm(\"form\", newFormData, /*#__PURE__*/function () {\n                              var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(err, form) {\n                                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                                  while (1) {\n                                    switch (_context2.prev = _context2.next) {\n                                      case 0:\n                                        // TODO add Default SubmissionAccess to formData\n                                        if (err) {\n                                          // get the form Id of the form if exists already in the server\n                                          dispatch(fetchFormByAlias(newFormData.path, /*#__PURE__*/function () {\n                                            var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(err, formObj) {\n                                              return _regeneratorRuntime.wrap(function _callee$(_context) {\n                                                while (1) {\n                                                  switch (_context.prev = _context.next) {\n                                                    case 0:\n                                                      if (!err) {\n                                                        newFormData._id = formObj._id;\n                                                        newFormData.access = formObj.access;\n                                                        newFormData.submissionAccess = formObj.submissionAccess; // newFormData.tags = formObj.tags;\n\n                                                        // newFormData.tags = formObj.tags;\n                                                        dispatch(saveForm(\"form\", newFormData, function (err, form) {\n                                                          if (!err) {\n                                                            dispatch(updateFormUploadCounter());\n                                                            resolve();\n                                                          } else {\n                                                            toast.error('Error in Json file structure');\n                                                            setShowFormUploadModal(false);\n                                                            reject();\n                                                          }\n                                                        }));\n                                                      } else {\n                                                        toast.error('Error in Json file structure');\n                                                        setShowFormUploadModal(false);\n                                                        reject();\n                                                      }\n\n                                                    case 1:\n                                                    case \"end\":\n                                                      return _context.stop();\n                                                  }\n                                                }\n                                              }, _callee);\n                                            }));\n\n                                            return function (_x5, _x6) {\n                                              return _ref4.apply(this, arguments);\n                                            };\n                                          }()));\n                                        } else {\n                                          dispatch(updateFormUploadCounter());\n                                          resolve();\n                                        }\n\n                                      case 1:\n                                      case \"end\":\n                                        return _context2.stop();\n                                    }\n                                  }\n                                }, _callee2);\n                              }));\n\n                              return function (_x3, _x4) {\n                                return _ref3.apply(this, arguments);\n                              };\n                            }()));\n                          }));\n\n                        case 1:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3);\n                }));\n\n                return function (_x2) {\n                  return _ref2.apply(this, arguments);\n                };\n              }()));\n\n            case 3:\n              _context4.next = 7;\n              break;\n\n            case 5:\n              setShowFormUploadModal(false);\n              return _context4.abrupt(\"return\", toast.error('Error in Json file structure'));\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function uploadFileContents(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var fileUploaded = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(evt) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              FileService.uploadFile(evt, /*#__PURE__*/function () {\n                var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(fileContent) {\n                  return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                    while (1) {\n                      switch (_context5.prev = _context5.next) {\n                        case 0:\n                          dispatch(setFormUploadList((fileContent === null || fileContent === void 0 ? void 0 : fileContent.forms) || []));\n                          setShowFormUploadModal(true);\n                          _context5.next = 4;\n                          return uploadFileContents(fileContent);\n\n                        case 4:\n                          dispatch(indexForms(\"forms\", 1, forms.query));\n\n                        case 5:\n                        case \"end\":\n                          return _context5.stop();\n                      }\n                    }\n                  }, _callee5);\n                }));\n\n                return function (_x8) {\n                  return _ref6.apply(this, arguments);\n                };\n              }());\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function fileUploaded(_x7) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(FileModal, {\n      modalOpen: showFormUploadModal,\n      onClose: function onClose() {\n        return setShowFormUploadModal(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, _this), (forms.isActive || isBPMFormListLoading) && !searchFormLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      \"data-testid\": \"Form-list-component-loader\",\n      children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 55\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(Confirm, {\n        modalOpen: props.modalOpen,\n        message: formProcessData.id && applicationCount !== 0 && applicationCount ? \"\".concat(applicationCountResponse ? applicationCount : \"Are you sure you wish to delete the form \" + props.formName + \"?\") + \"\".concat(applicationCount > 1 ? ' Applications are submitted against' : ' Application is submitted against', \" \") + props.formName + \". Are you sure want to delete ?\" : \"Are you sure you wish to delete the form \" + props.formName + \"?\",\n        onNo: function onNo() {\n          return _onNo();\n        },\n        onYes: function onYes() {\n          _onYes(formId, forms, formProcessData);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 16\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-item-left\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"task-head\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-wpforms\",\n              \"aria-hidden\": \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 19\n            }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"forms-text\",\n              children: \"Forms\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 19\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 17\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 15\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-item-right\",\n          children: [isDesigner && /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/formflow/create\",\n            className: \"btn btn-primary btn-left btn-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-plus fa-lg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 21\n            }, _this), \" Create Form\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 19\n          }, _this), isDesigner && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn btn-primary btn-sm form-btn pull-right btn-left\",\n              onClick: uploadClick,\n              title: \"Upload json form only\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-upload fa-lg\",\n                \"aria-hidden\": \"true\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 23\n              }, _this), \" Upload Form\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 21\n            }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              className: \"d-none\",\n              multiple: false,\n              accept: \".json,application/json\",\n              onChange: fileUploaded,\n              ref: uploadFormNode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 21\n            }, _this)]\n          }, void 0, true), isDesigner && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn btn-primary btn-sm form-btn pull-right btn-left\",\n              onClick: downloadForms,\n              disabled: formCheckList.length === 0,\n              title: \"Select atleast one form\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-download fa-lg\",\n                \"aria-hidden\": \"true\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 23\n              }, _this), \" Download Form\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 21\n            }, _this)\n          }, void 0, false)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 15\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"custom-grid grid-forms\",\n        children: [/*#__PURE__*/_jsxDEV(Errors, {\n          errors: errors\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 15\n        }, _this), /*#__PURE__*/_jsxDEV(LoadingOverlay, {\n          active: searchFormLoading || isApplicationCountLoading || bpmFormLoading,\n          spinner: true,\n          text: \"Loading...\",\n          children: searchFormLoading || paginatedForms.length ? /*#__PURE__*/_jsxDEV(FormGrid, {\n            columns: columns,\n            forms: isDesigner ? forms.forms.length ? forms : previousForms : bpmForms,\n            onAction: function onAction(form, action) {\n              _onAction(form, action);\n            },\n            getForms: isDesigner ? getForms : getFormsList,\n            operations: operations,\n            onPageSizeChanged: onPageSizeChanged\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 16\n          }, _this) : /*#__PURE__*/_jsxDEV(\"span\", {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"container\",\n              style: {\n                maxWidth: \"900px\",\n                margin: \"auto\",\n                height: \"60vh\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"center\",\n                justifyContent: \"center\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"No forms found \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 19\n              }, _this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline-primary\",\n                size: \"sm\",\n                style: {\n                  cursor: \"pointer\"\n                },\n                onClick: resetForms,\n                children: \"Click here to go back\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 18\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 19\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 18\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 15\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 13\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 11\n    }, _this)]\n  }, void 0, true);\n}, \"J400pwYU2KEZhxvbHpzr3jy69hY=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n}));\n_c2 = List;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    forms: selectRoot(\"forms\", state),\n    errors: selectError(\"forms\", state),\n    userRoles: selectRoot(\"user\", state).roles || [],\n    modalOpen: selectRoot(\"formDelete\", state).formDelete.modalOpen,\n    formId: selectRoot(\"formDelete\", state).formDelete.formId,\n    formName: selectRoot(\"formDelete\", state).formDelete.formName,\n    isFormWorkflowSaved: selectRoot(\"formDelete\", state).isFormWorkflowSaved\n  };\n};\n\nvar getInitForms = function getInitForms() {\n  var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n  var query = arguments.length > 1 ? arguments[1] : undefined;\n  return function (dispatch, getState) {\n    var state = getState();\n    var currentPage = state.forms.pagination.page;\n    var maintainPagination = state.bpmForms.maintainPagination;\n    dispatch(indexForms(\"forms\", maintainPagination ? currentPage : page, query));\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch, state, ownProps) {\n  return {\n    getForms: function getForms(page, query) {\n      dispatch(indexForms(\"forms\", page, query));\n    },\n    getFormsInit: function getFormsInit(page, query) {\n      dispatch(getInitForms(page, query));\n    },\n    onAction: function () {\n      var _onAction2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(form, action) {\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.t0 = action;\n                _context7.next = _context7.t0 === \"insert\" ? 3 : _context7.t0 === \"submission\" ? 5 : _context7.t0 === \"delete\" ? 7 : _context7.t0 === \"viewForm\" ? 10 : 14;\n                break;\n\n              case 3:\n                dispatch(push(\"/form/\".concat(form._id)));\n                return _context7.abrupt(\"break\", 14);\n\n              case 5:\n                dispatch(push(\"/form/\".concat(form._id, \"/submission\")));\n                return _context7.abrupt(\"break\", 14);\n\n              case 7:\n                dispatch(setIsApplicationCountLoading(true));\n                dispatch(getFormProcesses(form._id, function (err, data) {\n                  var formDetails = {\n                    modalOpen: true,\n                    formId: form._id,\n                    formName: form.title\n                  };\n\n                  if (data) {\n                    dispatch(getApplicationCount(data.id, function (err, res) {\n                      dispatch(setIsApplicationCountLoading(false));\n                      dispatch(setFormDeleteStatus(formDetails));\n                    }));\n                  } else {\n                    dispatch(setIsApplicationCountLoading(false));\n                    dispatch(setFormDeleteStatus(formDetails));\n                  }\n                }));\n                return _context7.abrupt(\"break\", 14);\n\n              case 10:\n                dispatch(resetFormProcessData());\n                dispatch(setMaintainBPMFormPagination(true));\n                dispatch(push(\"/formflow/\".concat(form._id, \"/view-edit\")));\n                return _context7.abrupt(\"break\", 14);\n\n              case 14:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      function onAction(_x9, _x10) {\n        return _onAction2.apply(this, arguments);\n      }\n\n      return onAction;\n    }(),\n    onYes: function onYes(formId, forms, formData) {\n      if (formData.id) {\n        dispatch(unPublishForm(formData.id));\n        dispatch(deleteForm(\"form\", formId, function (err) {\n          if (!err) {\n            var formDetails = {\n              modalOpen: false,\n              formId: \"\",\n              formName: \"\"\n            };\n            dispatch(setFormDeleteStatus(formDetails));\n            dispatch(indexForms(\"forms\", 1, forms.query));\n          }\n        }));\n      } else {\n        dispatch(deleteForm(\"form\", formId, function (err) {\n          if (!err) {\n            toast.success('Form deleted successfully');\n            var formDetails = {\n              modalOpen: false,\n              formId: \"\",\n              formName: \"\"\n            };\n            dispatch(setFormDeleteStatus(formDetails));\n            dispatch(indexForms(\"forms\", 1, forms.query));\n          }\n        }));\n      }\n    },\n    onNo: function onNo() {\n      var formDetails = {\n        modalOpen: false,\n        formId: \"\",\n        formName: \"\"\n      };\n      dispatch(setFormDeleteStatus(formDetails));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(List);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"List$React.memo\");\n$RefreshReg$(_c2, \"List\");","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/forms-flow-master/forms-flow-ai/forms-flow-web/src/components/Form/List.js"],"names":["React","useEffect","useRef","useState","connect","useDispatch","useSelector","push","Link","Button","toast","indexForms","selectRoot","selectError","Errors","FormGrid","deleteForm","saveForm","Loading","FORM_ACCESS","STAFF_DESIGNER","SUBMISSION_ACCESS","setBPMFormLimit","setBPMFormListLoading","setBPMFormListPage","setBPMFormListSort","setFormDeleteStatus","setMaintainBPMFormPagination","Confirm","fetchBPMFormList","fetchFormByAlias","designerColumns","getOperations","userColumns","FileService","setFormCheckList","setFormUploadList","updateFormUploadCounter","FileModal","addHiddenApplicationComponent","LoadingOverlay","getFormProcesses","getApplicationCount","resetFormProcessData","unPublishForm","setIsApplicationCountLoading","setBpmFormSearch","List","memo","props","showFormUploadModal","setShowFormUploadModal","dispatch","uploadFormNode","forms","onAction","getForms","getFormsInit","errors","userRoles","formId","onNo","onYes","isBPMFormListLoading","state","bpmForms","isActive","showViewSubmissions","user","formCheckList","formList","isDesigner","includes","operations","columns","paginatedForms","searchFormLoading","isApplicationCountLoading","process","applicationCountResponse","formProcessData","formProcessList","applicationCount","bpmFormLoading","getFormsList","page","query","sort","previousForms","setPreviousForms","onPageSizeChanged","pageSize","limit","length","downloadForms","downloadFile","success","uploadClick","e","preventDefault","current","click","resetForms","title__regex","uploadFileContents","fileContent","Array","isArray","Promise","all","map","formData","resolve","reject","newFormData","tags","access","submissionAccess","err","form","path","formObj","_id","error","fileUploaded","evt","uploadFile","modalOpen","id","formName","action","maxWidth","margin","height","display","flexDirection","alignItems","justifyContent","cursor","mapStateToProps","roles","formDelete","isFormWorkflowSaved","getInitForms","getState","currentPage","pagination","maintainPagination","mapDispatchToProps","ownProps","data","formDetails","title","res"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\r\nimport {connect, useDispatch, useSelector} from \"react-redux\";\r\nimport {push} from \"connected-react-router\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {Button} from \"react-bootstrap\";\r\nimport {toast} from 'react-toastify';\r\nimport {\r\n  indexForms,\r\n  selectRoot,\r\n  selectError,\r\n  Errors,\r\n  FormGrid,\r\n  deleteForm,\r\n  saveForm\r\n} from \"react-formio\";\r\nimport Loading from \"../../containers/Loading\";\r\nimport {\r\n  FORM_ACCESS,\r\n  STAFF_DESIGNER, SUBMISSION_ACCESS,\r\n} from \"../../constants/constants\";\r\nimport \"../Form/List.scss\";\r\nimport {\r\n  setBPMFormLimit,\r\n  setBPMFormListLoading,\r\n  setBPMFormListPage, setBPMFormListSort,\r\n  setFormDeleteStatus, setMaintainBPMFormPagination\r\n} from \"../../actions/formActions\";\r\nimport Confirm from \"../../containers/Confirm\";\r\nimport {fetchBPMFormList, fetchFormByAlias} from \"../../apiManager/services/bpmFormServices\";\r\nimport {designerColumns, getOperations, userColumns} from \"./constants/formListConstants\";\r\nimport FileService from \"../../services/FileService\";\r\nimport {setFormCheckList, setFormUploadList, updateFormUploadCounter} from \"../../actions/checkListActions\";\r\nimport FileModal from './FileUpload/fileUploadModal'\r\nimport {addHiddenApplicationComponent} from \"../../constants/applicationComponent\";\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\nimport { getFormProcesses,getApplicationCount, resetFormProcessData } from \"../../apiManager/services/processServices\";\r\nimport { unPublishForm } from \"../../apiManager/services/processServices\";\r\nimport { setIsApplicationCountLoading } from \"../../actions/processActions\";\r\nimport { setBpmFormSearch } from \"../../actions/formActions\";\r\n\r\nconst List = React.memo((props) => {\r\n  const [showFormUploadModal, setShowFormUploadModal] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const uploadFormNode = useRef();\r\n  const {\r\n    forms,\r\n    onAction,\r\n    getForms,\r\n    getFormsInit,\r\n    errors,\r\n    userRoles,\r\n    formId,\r\n    onNo,\r\n    onYes\r\n  } = props;\r\n\r\n  const isBPMFormListLoading = useSelector(state => state.bpmForms.isActive);\r\n  const bpmForms = useSelector(state => state.bpmForms);\r\n  const showViewSubmissions = useSelector((state) => state.user.showViewSubmissions);\r\n  const formCheckList = useSelector(state => state.formCheckList.formList);\r\n  const isDesigner = userRoles.includes(STAFF_DESIGNER);\r\n  const operations = getOperations(userRoles, showViewSubmissions);\r\n  const columns = isDesigner ? designerColumns : userColumns;\r\n  const paginatedForms = isDesigner? forms.forms : bpmForms.forms;\r\n  const searchFormLoading = useSelector(state=> state.formCheckList.searchFormLoading);\r\n  const isApplicationCountLoading = useSelector(state=> state.process.isApplicationCountLoading);\r\n  const applicationCountResponse = useSelector(state=> state.process.applicationCountResponse);\r\n  const formProcessData = useSelector(state=>state.process.formProcessList)\r\n  const applicationCount = useSelector(state => state.process.applicationCount)\r\n  const bpmFormLoading = useSelector(state => state.bpmForms.bpmFormLoading)\r\n\r\n  const getFormsList = (page, query) => {\r\n    if (page) {\r\n      dispatch(setBPMFormListPage(page));\r\n    }\r\n    if (query) {\r\n      dispatch(setBPMFormListSort(query.sort || ''));\r\n    }\r\n  }\r\n  const [previousForms,setPreviousForms] = useState({})\r\n  const onPageSizeChanged = (pageSize) => {\r\n    if (isDesigner) {\r\n      dispatch(indexForms(\"forms\", 1, {limit: pageSize}));\r\n    } else {\r\n      dispatch(setBPMFormLimit(pageSize));\r\n    }\r\n  }\r\n  useEffect(()=>{\r\n    if(forms.forms.length > 0){\r\n      setPreviousForms(forms)\r\n    }\r\n  },[forms])\r\n\r\n  useEffect(() => {\r\n    dispatch(setFormCheckList([]))\r\n  }, [dispatch])\r\n\r\n  useEffect(() => {\r\n    if (isDesigner) {\r\n      getFormsInit(1);\r\n    } else {\r\n      dispatch(setBPMFormListLoading(true))\r\n      dispatch(fetchBPMFormList());\r\n    }\r\n  }, [getFormsInit, dispatch, isDesigner])\r\n\r\n  const downloadForms = () => {\r\n    FileService.downloadFile({forms: formCheckList}, () => {\r\n      toast.success(`${formCheckList.length} ${formCheckList.length === 1 ? \"Form\" : \"Forms\"} Downloaded Successfully`)\r\n      dispatch(setFormCheckList([]));\r\n    })\r\n  }\r\n  \r\n  const uploadClick = e => {\r\n    dispatch(setFormUploadList([]));\r\n    e.preventDefault();\r\n    uploadFormNode.current?.click();\r\n    return false;\r\n  };\r\n   \r\n  const resetForms = ()=>{\r\n  isDesigner ?  dispatch(indexForms('forms', 1, {query:{ ...forms.query, title__regex: \"\" }})) :\r\n  dispatch(setBpmFormSearch(''));\r\n  }\r\n\r\n  const uploadFileContents = async (fileContent) => {\r\n    if (fileContent.forms && Array.isArray(fileContent.forms)) {\r\n      await Promise.all(\r\n        fileContent.forms.map(async (formData) => {\r\n          return new Promise((resolve, reject) => {\r\n            formData = addHiddenApplicationComponent(formData);\r\n            const newFormData = {\r\n              ...formData,\r\n              tags: [\"common\"]\r\n            };\r\n            newFormData.access = FORM_ACCESS;\r\n            newFormData.submissionAccess = SUBMISSION_ACCESS;\r\n            dispatch(saveForm(\"form\", newFormData, async (err, form) => { // TODO add Default SubmissionAccess to formData\r\n              if (err) {\r\n                // get the form Id of the form if exists already in the server\r\n                dispatch(fetchFormByAlias(newFormData.path, async (err, formObj) => {\r\n                  if (!err) {\r\n                    newFormData._id = formObj._id;\r\n                    newFormData.access = formObj.access;\r\n                    newFormData.submissionAccess = formObj.submissionAccess;\r\n                    // newFormData.tags = formObj.tags;\r\n                    dispatch(saveForm(\"form\", newFormData, (err, form) => {\r\n                      if (!err) {\r\n                        dispatch(updateFormUploadCounter())\r\n                        resolve();\r\n                      } else {\r\n                        toast.error('Error in Json file structure');\r\n                        setShowFormUploadModal(false);\r\n                        reject();\r\n                      }\r\n                    }));\r\n                  } else {\r\n                    toast.error('Error in Json file structure');\r\n                    setShowFormUploadModal(false);\r\n                    reject();\r\n                  }\r\n                }));\r\n              } else {\r\n                dispatch(updateFormUploadCounter())\r\n                resolve()\r\n              }\r\n            }))\r\n          });\r\n        }));\r\n    } else {\r\n      setShowFormUploadModal(false);\r\n      return (toast.error('Error in Json file structure'))\r\n    }\r\n  }\r\n\r\n  const fileUploaded = async (evt) => {\r\n    FileService.uploadFile(evt, async (fileContent) => {\r\n      dispatch(setFormUploadList(fileContent?.forms || []));\r\n      setShowFormUploadModal(true);\r\n      await uploadFileContents(fileContent);\r\n      dispatch(indexForms(\"forms\", 1, forms.query))\r\n    })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <FileModal modalOpen={showFormUploadModal} onClose={() => setShowFormUploadModal(false)}/>\r\n      {\r\n        (forms.isActive || isBPMFormListLoading ) && !searchFormLoading  ? \r\n        <div data-testid=\"Form-list-component-loader\"><Loading/></div> :\r\n          <div className=\"container\">\r\n               <Confirm\r\n                 modalOpen={props.modalOpen}\r\n                 message={\r\n                   (formProcessData.id  && applicationCount!==0) && applicationCount  ?  `${applicationCountResponse  ? applicationCount :  \"Are you sure you wish to delete the form \" +\r\n                   props.formName +\r\n                   \"?\"}`\r\n                   + `${applicationCount > 1 ? ' Applications are submitted against' :' Application is submitted against'} ` + props.formName +\". Are you sure want to delete ?\":\r\n                   \"Are you sure you wish to delete the form \" +\r\n                   props.formName +\r\n                   \"?\"\r\n                 }\r\n                 onNo={() => onNo()}\r\n                 onYes={() => {onYes(formId, forms,formProcessData)}}\r\n               />\r\n            <div className=\"flex-container\">\r\n              {/*<img src=\"/form.svg\" width=\"30\" height=\"30\" alt=\"form\" />*/}\r\n              <div className=\"flex-item-left\">\r\n                <h3 className=\"task-head\">\r\n                  <i className=\"fa fa-wpforms\" aria-hidden=\"true\"/>\r\n                  <span className=\"forms-text\">Forms</span></h3>\r\n              </div>\r\n              <div className=\"flex-item-right\">\r\n                {isDesigner && (\r\n                  <Link\r\n                    to=\"/formflow/create\"\r\n                    className=\"btn btn-primary btn-left btn-sm\"\r\n                  >\r\n                    <i className=\"fa fa-plus fa-lg\"/> Create Form\r\n                  </Link>\r\n                )}\r\n                {isDesigner && (\r\n                  <>\r\n                    <Button className=\"btn btn-primary btn-sm form-btn pull-right btn-left\" onClick={uploadClick}\r\n                            title=\"Upload json form only\">\r\n                      <i className=\"fa fa-upload fa-lg\" aria-hidden=\"true\"/> Upload Form</Button>\r\n                    <input type=\"file\" className=\"d-none\"\r\n                           multiple={false}\r\n                           accept=\".json,application/json\"\r\n                           onChange={fileUploaded}\r\n                           ref={uploadFormNode}\r\n                    />\r\n                  </>\r\n                )}\r\n                {isDesigner && (\r\n                  <>\r\n                    <Button className=\"btn btn-primary btn-sm form-btn pull-right btn-left\" onClick={downloadForms}\r\n                            disabled={formCheckList.length === 0} title=\"Select atleast one form\">\r\n                      <i className=\"fa fa-download fa-lg\" aria-hidden=\"true\"/> Download Form</Button>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <section className=\"custom-grid grid-forms\">\r\n              <Errors errors={errors}/>\r\n              {\r\n              <LoadingOverlay\r\n               active={searchFormLoading || isApplicationCountLoading || bpmFormLoading }\r\n               spinner\r\n               text=\"Loading...\"\r\n              >\r\n              {\r\n              (searchFormLoading || paginatedForms.length) ?\r\n               <FormGrid\r\n               columns={columns}\r\n               forms={isDesigner ?(forms.forms.length? forms: previousForms) : bpmForms}\r\n               onAction={(form,action)=>{\r\n                 onAction(form, action)\r\n               }}\r\n               getForms={isDesigner ? getForms : getFormsList}\r\n               operations={operations}\r\n               onPageSizeChanged={onPageSizeChanged}\r\n             />: <span>\r\n                  <div \r\n                    className=\"container\"\r\n                    style={{\r\n                    maxWidth:\"900px\",\r\n                    margin:\"auto\",\r\n                    height:\"60vh\",\r\n                    display:\"flex\",\r\n                    flexDirection:\"column\",\r\n                    alignItems:\"center\",\r\n                    justifyContent:\"center\"}}> \r\n                  <h3 >No forms found </h3> \r\n                 <Button variant=\"outline-primary\" size=\"sm\"\r\n                 style={{\r\n                   cursor:\"pointer\"}}\r\n                   onClick={resetForms}\r\n                 >\r\n                 Click here to go back\r\n                </Button>\r\n                  </div>\r\n                 \r\n                    \r\n                  </span>\r\n              }\r\n              </LoadingOverlay>\r\n              }\r\n            </section>\r\n          </div>\r\n      }\r\n    </>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    forms: selectRoot(\"forms\", state),\r\n    errors: selectError(\"forms\", state),\r\n    userRoles: selectRoot(\"user\", state).roles || [],\r\n    modalOpen: selectRoot(\"formDelete\", state).formDelete.modalOpen,\r\n    formId: selectRoot(\"formDelete\", state).formDelete.formId,\r\n    formName: selectRoot(\"formDelete\", state).formDelete.formName,\r\n    isFormWorkflowSaved: selectRoot(\"formDelete\", state).isFormWorkflowSaved\r\n  };\r\n};\r\n\r\nconst getInitForms = (page = 1, query) => {\r\n  return (dispatch, getState) => {\r\n    const state = getState();\r\n    const currentPage = state.forms.pagination.page;\r\n    const maintainPagination = state.bpmForms.maintainPagination;\r\n    dispatch(indexForms(\"forms\", maintainPagination ? currentPage : page, query));\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch,state, ownProps) => {\r\n  return {\r\n    getForms: (page, query) => {\r\n      dispatch(indexForms(\"forms\", page, query));\r\n    },\r\n    getFormsInit: (page, query) => {\r\n      dispatch(getInitForms(page, query));\r\n    },\r\n    onAction: async (form, action) => {\r\n      switch (action) {\r\n        case \"insert\":\r\n          dispatch(push(`/form/${form._id}`));\r\n          break;\r\n        case \"submission\":\r\n          dispatch(push(`/form/${form._id}/submission`));\r\n          break;\r\n        // case \"edit\":\r\n        //   dispatch(push(`/form/${form._id}/edit`));\r\n        //   break;\r\n        case \"delete\":\r\n          dispatch(setIsApplicationCountLoading(true)) \r\n          dispatch(getFormProcesses(form._id,(err,data)=>{\r\n            const formDetails = {\r\n              modalOpen: true,\r\n              formId: form._id,\r\n              formName: form.title,\r\n            };\r\n            if(data){\r\n              dispatch(getApplicationCount(data.id,(err,res)=>{\r\n                dispatch(setIsApplicationCountLoading(false));\r\n                dispatch(setFormDeleteStatus(formDetails));\r\n              }));\r\n             \r\n            }else{\r\n              dispatch(setIsApplicationCountLoading(false));\r\n                dispatch(setFormDeleteStatus(formDetails));\r\n            }\r\n          }))\r\n          \r\n          break;\r\n        case \"viewForm\":\r\n          dispatch(resetFormProcessData())\r\n          dispatch(setMaintainBPMFormPagination(true));\r\n          dispatch(push(`/formflow/${form._id}/view-edit`));\r\n          break;\r\n        default:\r\n      }\r\n    },\r\n    onYes: (formId, forms,formData) => {\r\n    if(formData.id){\r\n      dispatch(unPublishForm(formData.id)) \r\n      dispatch(\r\n        deleteForm(\"form\", formId, (err) => {\r\n          if (!err) {\r\n            const formDetails = {modalOpen: false, formId: \"\", formName: \"\"};\r\n            dispatch(setFormDeleteStatus(formDetails));\r\n            dispatch(indexForms(\"forms\", 1, forms.query));\r\n          }\r\n        })\r\n      )\r\n    }else{\r\n      dispatch(\r\n        deleteForm(\"form\", formId, (err) => {\r\n          if (!err) {\r\n            toast.success( 'Form deleted successfully')\r\n            const formDetails = {modalOpen: false, formId: \"\", formName: \"\"};\r\n            dispatch(setFormDeleteStatus(formDetails));\r\n            dispatch(indexForms(\"forms\", 1, forms.query));\r\n          }\r\n        })\r\n      );\r\n    }\r\n    },\r\n    onNo: () => {\r\n      const formDetails = {modalOpen: false, formId: \"\", formName: \"\"};\r\n      dispatch(setFormDeleteStatus(formDetails));\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(List);\r\n"]},"metadata":{},"sourceType":"module"}