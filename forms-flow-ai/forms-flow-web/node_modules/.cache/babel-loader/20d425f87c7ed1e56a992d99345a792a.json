{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.reflect.set.js\");\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _NestedArrayComponent2 = _interopRequireDefault(require(\"../_classes/nestedarray/NestedArrayComponent\"));\n\nvar _Component = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _Alert = _interopRequireDefault(require(\"../alert/Alert\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _templates = _interopRequireDefault(require(\"./templates\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction set(target, property, value, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.set) {\n    set = Reflect.set;\n  } else {\n    set = function set(target, property, value, receiver) {\n      var base = _superPropBase(target, property);\n\n      var desc;\n\n      if (base) {\n        desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.set) {\n          desc.set.call(receiver, value);\n          return true;\n        } else if (!desc.writable) {\n          return false;\n        }\n      }\n\n      desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n      if (desc) {\n        if (!desc.writable) {\n          return false;\n        }\n\n        desc.value = value;\n        Object.defineProperty(receiver, property, desc);\n      } else {\n        _defineProperty(receiver, property, value);\n      }\n\n      return true;\n    };\n  }\n\n  return set(target, property, value, receiver);\n}\n\nfunction _set(target, property, value, receiver, isStrict) {\n  var s = set(target, property, value, receiver || target);\n\n  if (!s && isStrict) {\n    throw new Error('failed to set property');\n  }\n\n  return value;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar EditRowState = {\n  New: 'new',\n  Editing: 'editing',\n  Saved: 'saved',\n  Viewing: 'viewing',\n  Removed: 'removed',\n  Draft: 'draft'\n};\n\nvar EditGridComponent = /*#__PURE__*/function (_NestedArrayComponent) {\n  _inherits(EditGridComponent, _NestedArrayComponent);\n\n  var _super = _createSuper(EditGridComponent);\n\n  function EditGridComponent() {\n    var _this;\n\n    _classCallCheck(this, EditGridComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.type = 'editgrid';\n    return _this;\n  }\n\n  _createClass(EditGridComponent, [{\n    key: \"defaultDialogTemplate\",\n    get: function get() {\n      return \"\\n    <h3 ref=\\\"dialogHeader\\\">\".concat(this.t('Do you want to clear data?'), \"</h3>\\n    <div style=\\\"display:flex; justify-content: flex-end;\\\">\\n      <button ref=\\\"dialogCancelButton\\\" class=\\\"btn btn-secondary\\\" aria-label=\\\"\").concat(this.t('Cancel'), \"\\\">\").concat(this.t('Cancel'), \"</button>\\n      <button ref=\\\"dialogYesButton\\\" class=\\\"btn btn-danger\\\" aria-label=\\\"\").concat(this.t('Yes, delete it'), \"\\\">\").concat(this.t('Yes, delete it'), \"</button>\\n    </div>\\n  \");\n    }\n  }, {\n    key: \"defaultRowTemplate\",\n    get: function get() {\n      return this.displayAsTable ? EditGridComponent.defaultTableRowTemplate : EditGridComponent.defaultRowTemplate;\n    }\n  }, {\n    key: \"defaultHeaderTemplate\",\n    get: function get() {\n      return this.displayAsTable ? EditGridComponent.defaultTableHeaderTemplate : EditGridComponent.defaultHeaderTemplate;\n    }\n  }, {\n    key: \"rowTemplate\",\n    get: function get() {\n      var rowTemplate;\n\n      if (_utils.Evaluator.noeval) {\n        rowTemplate = this.displayAsTable ? _templates.default.tableRow : _templates.default.row;\n      } else {\n        rowTemplate = this.displayAsTable ? _lodash.default.get(this.component, 'templates.tableRow', this.defaultRowTemplate) : _lodash.default.get(this.component, 'templates.row', this.defaultRowTemplate);\n      }\n\n      return rowTemplate;\n    }\n  }, {\n    key: \"headerTemplate\",\n    get: function get() {\n      var headerTemplate;\n\n      if (_utils.Evaluator.noeval) {\n        headerTemplate = this.displayAsTable ? _templates.default.tableHeader : _templates.default.header;\n      } else {\n        headerTemplate = this.displayAsTable ? _lodash.default.get(this.component, 'templates.tableHeader', this.defaultHeaderTemplate) : _lodash.default.get(this.component, 'templates.header', this.defaultHeaderTemplate);\n      }\n\n      return headerTemplate;\n    }\n    /**\n     * Returns true if the component has nested components which don't trigger changes on the root level\n     */\n\n  }, {\n    key: \"hasScopedChildren\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return EditGridComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return [];\n    }\n  }, {\n    key: \"editgridKey\",\n    get: function get() {\n      return \"editgrid-\".concat(this.key);\n    }\n  }, {\n    key: \"rowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-row\");\n    }\n  }, {\n    key: \"rowElements\",\n    get: function get() {\n      return this.refs[this.rowRef];\n    }\n  }, {\n    key: \"rowRefs\",\n    get: function get() {\n      return this.refs[\"editgrid-\".concat(this.component.key, \"-row\")];\n    }\n  }, {\n    key: \"addRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-addRow\");\n    }\n  }, {\n    key: \"addRowElements\",\n    get: function get() {\n      return this.refs[this.addRowRef];\n    }\n  }, {\n    key: \"saveRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-saveRow\");\n    }\n  }, {\n    key: \"saveRowElements\",\n    get: function get() {\n      return this.refs[this.saveRowRef];\n    }\n  }, {\n    key: \"cancelRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-cancelRow\");\n    }\n  }, {\n    key: \"cancelRowElements\",\n    get: function get() {\n      return this.refs[this.cancelRowRef];\n    }\n  }, {\n    key: \"inlineEditMode\",\n    get: function get() {\n      return this.component.inlineEdit;\n    }\n  }, {\n    key: \"saveEditMode\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"minLength\",\n    get: function get() {\n      return _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      this._data = value;\n      var data = this.dataValue;\n      (this.editRows || []).forEach(function (row, index) {\n        if (!data[index] && row.state !== EditRowState.New) {\n          data[index] = {};\n        }\n\n        var rowData = data[index] || {};\n        row.data = rowData;\n        row.components.forEach(function (component) {\n          component.data = rowData;\n        });\n      });\n    }\n  }, {\n    key: \"dataValue\",\n    get: function get() {\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"dataValue\", this) || [];\n    },\n    set: function set(value) {\n      _set(_getPrototypeOf(EditGridComponent.prototype), \"dataValue\", value, this, true);\n    }\n  }, {\n    key: \"displayAsTable\",\n    get: function get() {\n      return this.component.displayAsTable;\n    }\n  }, {\n    key: \"iteratableRows\",\n    get: function get() {\n      return this.editRows;\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var value = _get(_getPrototypeOf(EditGridComponent.prototype), \"defaultValue\", this);\n\n      var defaultValue = Array.isArray(value) ? value : [];\n\n      _lodash.default.times(this.minLength - defaultValue.length, function () {\n        return defaultValue.push({});\n      });\n\n      return defaultValue;\n    }\n  }, {\n    key: \"hasRemoveButtons\",\n    value: function hasRemoveButtons() {\n      return !this.component.disableAddingRemovingRows && !this.options.readOnly && !this.disabled && this.fullMode && this.dataValue.length > _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      if (this.builderMode) {\n        this.editRows = [];\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"init\", this).call(this);\n      }\n\n      this.components = this.components || [];\n      var dataValue = this.dataValue;\n      var openWhenEmpty = !dataValue.length && this.component.openWhenEmpty;\n\n      if (openWhenEmpty) {\n        var dataObj = {};\n        this.editRows = [];\n        this.createRow(dataObj, 0);\n      } else {\n        this.editRows = dataValue.map(function (row, rowIndex) {\n          return {\n            components: _this2.lazyLoad ? [] : _this2.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        });\n      }\n\n      this.prevHasAddButton = this.hasAddButton();\n      this.checkData();\n    }\n  }, {\n    key: \"isOpen\",\n    value: function isOpen(editRow) {\n      return [EditRowState.New, EditRowState.Editing, EditRowState.Viewing].includes(editRow.state);\n    }\n  }, {\n    key: \"isComponentVisibleInSomeRow\",\n    value: function isComponentVisibleInSomeRow(component) {\n      var _this3 = this;\n\n      var rows = this.editRows;\n      var savedStates = [EditRowState.Saved, EditRowState.Editing, EditRowState.Draft];\n      var savedRows = rows.filter(function (row) {\n        return _lodash.default.includes(savedStates, row.state);\n      });\n      this.visibleInHeader = this.visibleInHeader || [];\n\n      var changeVisibleInHeader = function changeVisibleInHeader(component, isVisible) {\n        if (!isVisible) {\n          _lodash.default.remove(_this3.visibleInHeader, function (key) {\n            return key === component.key;\n          });\n        }\n\n        if (isVisible && !_lodash.default.includes(_this3.visibleInHeader, component.key)) {\n          _this3.visibleInHeader.push(component.key);\n        }\n      };\n\n      if (_lodash.default.isEmpty(rows)) {\n        var rowComponents = this.createRowComponents({}, 0);\n        var checkComponent;\n        (0, _utils.eachComponent)(rowComponents, function (comp) {\n          if (comp.component.key === component.key) {\n            checkComponent = comp;\n          }\n\n          comp.checkConditions();\n        });\n        var isVisible = checkComponent ? checkComponent.visible : true;\n\n        _toConsumableArray(this.components).forEach(function (comp) {\n          return _this3.removeComponent(comp, _this3.components);\n        });\n\n        changeVisibleInHeader(component, isVisible);\n        return isVisible;\n      }\n\n      var isOpenRowWhenEmpty = _lodash.default.get(this.component, 'openWhenEmpty') && rows.length === 1 && rows[0].state === EditRowState.New;\n\n      if (!_lodash.default.isEmpty(rows) && _lodash.default.isEmpty(savedRows) && !isOpenRowWhenEmpty) {\n        return _lodash.default.includes(this.visibleInHeader, component.key);\n      }\n\n      return _lodash.default.some(isOpenRowWhenEmpty ? rows : savedRows, function (row, index) {\n        var editingRow = row.state === EditRowState.Editing;\n        var isVisible;\n\n        if (!editingRow) {\n          var flattenedComponents = _this3.flattenComponents(index);\n\n          var instance = flattenedComponents[component.key];\n          isVisible = instance ? instance.visible : true;\n          changeVisibleInHeader(component, isVisible);\n        } else {\n          isVisible = _lodash.default.includes(_this3.visibleInHeader, component.key);\n        }\n\n        return isVisible;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      var _this4 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this);\n      }\n\n      var dataValue = this.dataValue;\n      var headerTemplate = this.headerTemplate;\n      var t = this.t.bind(this);\n      var templateName = this.displayAsTable ? 'editgridTable' : 'editgrid';\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this, children || this.renderTemplate(templateName, {\n        ref: {\n          row: this.rowRef,\n          addRow: this.addRowRef,\n          saveRow: this.saveRowRef,\n          cancelRow: this.cancelRowRef\n        },\n        header: this.renderString(headerTemplate, {\n          displayValue: function displayValue(component) {\n            return _this4.displayComponentValue(component, true);\n          },\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        footer: this.renderString(_lodash.default.get(this.component, 'templates.footer'), {\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        rows: this.editRows.map(this.renderRow.bind(this)),\n        openRows: this.editRows.map(function (row) {\n          return _this4.isOpen(row);\n        }),\n        errors: this.editRows.map(function (row) {\n          return row.error;\n        }),\n        hasAddButton: this.hasAddButton(),\n        hasRemoveButtons: this.hasRemoveButtons()\n      }));\n    }\n  }, {\n    key: \"renderComponents\",\n    value: function renderComponents(components) {\n      components = components || this.getComponents();\n      var children = components.map(function (component) {\n        return component.render();\n      });\n      var templateName = this.displayAsTable && this.prevHasAddButton ? 'tableComponents' : 'components';\n      return this.renderTemplate(templateName, {\n        children: children,\n        components: components\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs,\n          _this5 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      this.loadRefs(element, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, this.addRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.saveRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.cancelRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.rowRef, 'multiple'), _this$loadRefs));\n      this.addRowElements.forEach(function (addButton) {\n        _this5.addEventListener(addButton, 'click', function () {\n          return _this5.addRow();\n        });\n      });\n      var openRowCount = 0;\n      this.rowElements.forEach(function (row, rowIndex) {\n        var editRow = _this5.editRows[rowIndex];\n\n        if (editRow !== null && editRow !== void 0 && editRow.isRowSelected) {\n          row.classList.add('selected');\n        }\n\n        if (_this5.isOpen(editRow)) {\n          _this5.attachComponents(row, editRow.components);\n\n          _this5.addEventListener(_this5.saveRowElements[openRowCount], 'click', function () {\n            return _this5.saveRow(rowIndex, true);\n          });\n\n          _this5.addEventListener(_this5.cancelRowElements[openRowCount], 'click', function () {\n            return _this5.cancelRow(rowIndex);\n          });\n\n          openRowCount++;\n        } else {\n          // Attach edit and remove button events.\n          [{\n            className: 'removeRow',\n            event: 'click',\n            action: function action() {\n              return _this5.removeRow(rowIndex, true);\n            }\n          }, {\n            className: 'editRow',\n            event: 'click',\n            action: function action() {\n              _this5.editRow(rowIndex).then(function () {\n                if (_this5.component.rowDrafts) {\n                  var _this5$root;\n\n                  _this5.validateRow(editRow, false);\n\n                  var hasErrors = editRow.errors && !!editRow.errors.length;\n                  var shouldShowRowErrorsAlert = _this5.component.modal && hasErrors && ((_this5$root = _this5.root) === null || _this5$root === void 0 ? void 0 : _this5$root.submitted);\n\n                  if (shouldShowRowErrorsAlert) {\n                    _this5.alert.showErrors(editRow.errors, false);\n\n                    editRow.alerts = true;\n                  }\n                }\n              });\n            }\n          }, {\n            className: 'row',\n            event: 'click',\n            action: function action() {\n              row.classList.toggle('selected');\n              var eventName = 'editGridSelectRow';\n\n              if (Array.from(row.classList).includes('selected')) {\n                editRow.isRowSelected = true;\n              } else {\n                delete editRow.isRowSelected;\n                eventName = 'editGridUnSelectRow';\n              }\n\n              _this5.emit(eventName, {\n                component: _this5.component,\n                data: _this5.dataValue[rowIndex]\n              });\n            }\n          }].forEach(function (_ref) {\n            var className = _ref.className,\n                event = _ref.event,\n                action = _ref.action;\n            var elements = row.getElementsByClassName(className);\n            Array.prototype.forEach.call(elements, function (element) {\n              _this5.addEventListener(element, event, action);\n            });\n          });\n        }\n      }); // Add open class to the element if any edit grid row is open\n\n      if (openRowCount) {\n        this.addClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      } else {\n        this.removeClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      }\n\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n    }\n  }, {\n    key: \"flattenRowDataValue\",\n    value: function flattenRowDataValue(dataValue) {\n      var _this6 = this;\n\n      var flattened = {};\n      Object.keys(dataValue).forEach(function (key) {\n        if (_lodash.default.isObject(dataValue[key]) && !_lodash.default.isNil(dataValue[key])) {\n          Object.assign(flattened, _this6.flattenRowDataValue(dataValue[key]));\n        } else {\n          flattened[key] = dataValue[key];\n        }\n      });\n      return flattened;\n    }\n  }, {\n    key: \"isComponentVisibleInRow\",\n    value: function isComponentVisibleInRow(component, flattenedComponents) {\n      var instance = flattenedComponents[component.key];\n      return instance ? instance.visible : true;\n    }\n  }, {\n    key: \"displayComponentValue\",\n    value: function displayComponentValue(component, header) {\n      return !!((!component.hasOwnProperty('tableView') || component.tableView) && header ? this.isComponentVisibleInSomeRow(component) : _lodash.default.includes(this.visibleInHeader, component.key));\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(row, rowIndex) {\n      var _this7 = this;\n\n      var dataValue = this.dataValue;\n\n      if (this.isOpen(row)) {\n        return this.renderComponents(row.components);\n      } else {\n        var flattenedComponents = this.flattenComponents(rowIndex);\n        var rowTemplate = this.rowTemplate;\n        return this.renderString(rowTemplate, {\n          row: dataValue[rowIndex] || {},\n          data: this.data,\n          rowIndex: rowIndex,\n          components: this.component.components,\n          flattenedComponents: flattenedComponents,\n          displayValue: function displayValue(component) {\n            return _this7.displayComponentValue(component);\n          },\n          isVisibleInRow: function isVisibleInRow(component) {\n            return _this7.isComponentVisibleInRow(component, flattenedComponents);\n          },\n          getView: function getView(component, data) {\n            var _instance$component;\n\n            var instance = flattenedComponents[component.key];\n            var view = instance ? instance.getView(data || instance.dataValue) : ''; // If there is an html tag in view, don't allow it to be injected in template\n\n            var htmlTagRegExp = new RegExp('<(.*?)>');\n            return typeof view === 'string' && view.length && !((_instance$component = instance.component) !== null && _instance$component !== void 0 && _instance$component.template) && htmlTagRegExp.test(view) ? \"<input type=\\\"text\\\" value=\\\"\".concat(view.replace(/\"/g, '&quot;'), \"\\\" readonly/>\") : view;\n          },\n          state: this.editRows[rowIndex].state,\n          t: this.t.bind(this)\n        });\n      }\n    }\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn, rowIndex) {\n      _lodash.default.each(this.getComponents(rowIndex), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this8 = this;\n\n      this.getComponents().forEach(function (component) {\n        var _this8$editRows$compo;\n\n        var rowData = _this8.dataValue[component.rowIndex];\n        var editRowData = (_this8$editRows$compo = _this8.editRows[component.rowIndex]) === null || _this8$editRows$compo === void 0 ? void 0 : _this8$editRows$compo.data;\n        component.data = rowData || editRowData;\n      });\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents(rowIndex) {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      }, rowIndex);\n      return result;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents(rowIndex) {\n      // Ensure editrows is set.\n      this.editRows = this.editRows || [];\n      return this.builderMode ? _get(_getPrototypeOf(EditGridComponent.prototype), \"getComponents\", this).call(this) : _lodash.default.isNumber(rowIndex) ? this.editRows[rowIndex].components || [] : this.editRows.reduce(function (result, row) {\n        return result.concat(row.components || []);\n      }, []);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents(rowIndex) {\n      var _this9 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"destroyComponents\", this).call(this);\n      }\n\n      var components = this.getComponents(rowIndex).slice();\n      components.forEach(function (comp) {\n        return _this9.removeComponent(comp, _this9.components);\n      });\n    }\n  }, {\n    key: \"createRow\",\n    value: function createRow(dataObj, rowIndex) {\n      var editRow = {\n        components: this.createRowComponents(dataObj, rowIndex),\n        data: dataObj,\n        state: EditRowState.New,\n        backup: null,\n        error: null\n      };\n      this.editRows.push(editRow);\n\n      if (this.inlineEditMode) {\n        this.dataValue.push(dataObj);\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRow\",\n    value: function addRow() {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var dataObj = {};\n      var rowIndex = this.editRows.length;\n      var editRow = this.createRow(dataObj, rowIndex);\n\n      if (this.inlineEditMode) {\n        this.triggerChange();\n      }\n\n      this.emit('editGridAddRow', {\n        component: this.component,\n        row: editRow\n      });\n      this.checkRow('checkData', null, {}, editRow.data, editRow.components);\n\n      if (this.component.modal) {\n        this.addRowModal(rowIndex);\n      } else {\n        this.redraw();\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRowModal\",\n    value: function addRowModal(rowIndex) {\n      var _this10 = this;\n\n      var modalContent = this.ce('div');\n      var editRow = this.editRows[rowIndex];\n      editRow.willBeSaved = false;\n      var components = editRow.components;\n      modalContent.innerHTML = this.renderComponents(components);\n      var dialog = this.component.modal ? this.createModal(modalContent, {}, function () {\n        return _this10.showDialog(rowIndex);\n      }) : undefined;\n      dialog.classList.add(\"editgrid-row-modal-\".concat(this.id));\n      editRow.dialog = dialog;\n\n      if (this.alert) {\n        this.alert.clear();\n        this.alert = null;\n      }\n\n      this.alert = new _Alert.default(dialog.refs.dialogContents, this);\n      this.addEventListener(dialog, 'close', function () {\n        if (!editRow.willBeSaved) {\n          if (_this10.editRows[rowIndex] && _this10.editRows[rowIndex].state !== EditRowState.New) {\n            _this10.editRows[rowIndex].components.forEach(function (comp) {\n              comp.setPristine(true);\n            });\n          }\n\n          _this10.cancelRow(rowIndex);\n        }\n\n        if (_this10.alert) {\n          _this10.alert.clear();\n\n          _this10.alert = null;\n        } // Remove references to dialog elements to prevent possible in some cases memory leaks\n\n\n        delete editRow.confirmationDialog;\n        delete editRow.dialog;\n      });\n      dialog.refs.dialogContents.appendChild(this.ce('button', {\n        class: 'btn btn-primary',\n        onClick: function onClick() {\n          // After an attempt to save, all the components inside the row should become not pristine\n          if (!_this10.component.rowDrafts) {\n            editRow.components.forEach(function (comp) {\n              return comp.setPristine(false);\n            });\n          }\n\n          if (_this10.validateRow(editRow, true) || _this10.component.rowDrafts) {\n            editRow.willBeSaved = true;\n            dialog.close();\n\n            _this10.saveRow(rowIndex, true);\n          } else {\n            _this10.alert.showErrors(editRow.errors, false);\n\n            editRow.alerts = true;\n          }\n        }\n      }, this.component.saveRow || 'Save'));\n      return this.attachComponents(modalContent, components);\n    }\n  }, {\n    key: \"showDialog\",\n    value: function showDialog(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (_lodash.default.isEqual(editRow.backup, editRow.data)) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      var wrapper = this.ce('div', {\n        ref: 'confirmationDialog'\n      });\n      var dialogContent = this.component.dialogTemplate || this.defaultDialogTemplate;\n      wrapper.innerHTML = dialogContent;\n      wrapper.refs = {};\n      this.loadRefs.call(wrapper, wrapper, {\n        dialogHeader: 'single',\n        dialogCancelButton: 'single',\n        dialogYesButton: 'single'\n      });\n      var dialog = this.createModal(wrapper);\n      dialog.classList.add(\"editgrid-row-modal-confirmation-\".concat(this.id));\n\n      var close = function close(event) {\n        event.preventDefault();\n        dialog.close();\n      };\n\n      var dialogResult;\n      var promise = new _nativePromiseOnly.default(function (resolve, reject) {\n        dialogResult = {\n          resolve: resolve,\n          reject: reject\n        };\n      });\n      this.addEventListener(wrapper.refs.dialogYesButton, 'click', function (event) {\n        close(event);\n        dialogResult.resolve();\n      });\n      this.addEventListener(wrapper.refs.dialogCancelButton, 'click', function (event) {\n        close(event);\n        dialogResult.reject();\n      });\n      editRow.confirmationDialog = dialog;\n      return promise;\n    }\n  }, {\n    key: \"editRow\",\n    value: function editRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      var isAlreadyEditing = editRow.state === EditRowState.Editing || editRow.state === EditRowState.New;\n\n      if (!editRow || isAlreadyEditing) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      editRow.prevState = editRow.state;\n      editRow.state = this.options.readOnly ? EditRowState.Viewing : EditRowState.Editing;\n\n      if (this.lazyLoad && editRow.components.length === 0) {\n        editRow.components = this.createRowComponents(editRow.data, rowIndex);\n      }\n\n      var dataSnapshot = (0, _utils.fastCloneDeep)(editRow.data);\n\n      if (this.inlineEditMode) {\n        editRow.backup = dataSnapshot;\n      } else {\n        editRow.backup = (0, _utils.fastCloneDeep)(editRow.data);\n        editRow.data = dataSnapshot;\n        this.restoreRowContext(editRow);\n      }\n\n      if (this.component.modal) {\n        return this.addRowModal(rowIndex);\n      }\n\n      return this.redraw();\n    }\n  }, {\n    key: \"clearErrors\",\n    value: function clearErrors(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (editRow && Array.isArray(editRow.components)) {\n        editRow.components.forEach(function (comp) {\n          comp.setPristine(true);\n          comp.setCustomValidity('');\n        });\n      }\n    }\n  }, {\n    key: \"cancelRow\",\n    value: function cancelRow(rowIndex) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var editRow = this.editRows[rowIndex];\n\n      switch (editRow.state) {\n        case EditRowState.New:\n          {\n            editRow.state = EditRowState.Removed;\n            this.clearErrors(rowIndex);\n            this.destroyComponents(rowIndex);\n\n            if (this.inlineEditMode) {\n              this.splice(rowIndex);\n            }\n\n            this.editRows.splice(rowIndex, 1);\n            this.openWhenEmpty();\n            break;\n          }\n\n        case EditRowState.Editing:\n          {\n            editRow.state = editRow.prevState;\n\n            if (this.inlineEditMode) {\n              this.dataValue[rowIndex] = editRow.backup;\n            }\n\n            editRow.data = editRow.backup;\n            editRow.backup = null;\n            this.restoreRowContext(editRow);\n            this.clearErrors(rowIndex);\n            break;\n          }\n      }\n\n      this.emit('editGridCancelRow', {\n        instance: this,\n        component: this.component,\n        editRow: editRow\n      });\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (this.component.rowDrafts) {\n        this.checkValidity(this.data, false);\n      }\n    }\n  }, {\n    key: \"saveRow\",\n    value: function saveRow(rowIndex, modified) {\n      var _this11 = this;\n\n      var editRow = this.editRows[rowIndex];\n\n      if (this.options.readOnly) {\n        return;\n      } // After an attempt to save, all the components inside the row should become not pristine\n\n\n      if (!this.component.rowDrafts) {\n        editRow.components.forEach(function (comp) {\n          return comp.setPristine(false);\n        });\n      }\n\n      var isRowValid = this.validateRow(editRow, true);\n\n      if (!this.component.rowDrafts) {\n        if (!isRowValid) {\n          return false;\n        }\n      }\n\n      if (this.saveEditMode) {\n        var dataValue = this.dataValue;\n\n        switch (editRow.state) {\n          case EditRowState.New:\n            {\n              var newIndex = dataValue.length;\n              dataValue.push(editRow.data);\n              editRow.components.forEach(function (component) {\n                return component.rowIndex = newIndex;\n              });\n\n              if (rowIndex !== newIndex) {\n                this.editRows.splice(rowIndex, 1);\n                this.editRows.splice(newIndex, 0, editRow);\n              }\n\n              break;\n            }\n\n          case EditRowState.Editing:\n            {\n              dataValue[rowIndex] = editRow.data;\n              break;\n            }\n        }\n      }\n\n      editRow.state = this.component.rowDrafts && !isRowValid ? EditRowState.Draft : EditRowState.Saved;\n      editRow.backup = null;\n      this.updateValue();\n      this.emit('editGridSaveRow', {\n        component: this.component,\n        row: editRow.data,\n        instance: this\n      });\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n\n      if (this.component.rowDrafts) {\n        editRow.components.forEach(function (comp) {\n          return comp.setPristine(_this11.pristine);\n        });\n      }\n\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (editRow.alerts) {\n        editRow.alerts = false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus(component) {\n      if ('beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n\n      var relativePath = this.getRelativePath(component.path);\n      var arrayPath = (0, _utils.getArrayFromComponentPath)(relativePath);\n\n      if (_lodash.default.isNumber(arrayPath[0])) {\n        this.editRow(arrayPath[0]);\n      }\n    }\n  }, {\n    key: \"updateComponentsRowIndex\",\n    value: function updateComponentsRowIndex(components, rowIndex) {\n      components.forEach(function (component, colIndex) {\n        component.rowIndex = rowIndex;\n        component.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n      });\n    }\n  }, {\n    key: \"updateRowsComponents\",\n    value: function updateRowsComponents(rowIndex) {\n      var _this12 = this;\n\n      this.editRows.slice(rowIndex).forEach(function (row, index) {\n        _this12.updateComponentsRowIndex(row.components, rowIndex + index);\n      });\n    }\n  }, {\n    key: \"baseRemoveRow\",\n    value: function baseRemoveRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      editRow.state = EditRowState.Removed;\n      this.destroyComponents(rowIndex);\n      return editRow;\n    }\n  }, {\n    key: \"removeRow\",\n    value: function removeRow(rowIndex, modified) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      this.clearErrors(rowIndex);\n      this.baseRemoveRow(rowIndex);\n      this.splice(rowIndex);\n      this.emit('editGridDeleteRow', {\n        index: rowIndex\n      });\n      this.editRows.splice(rowIndex, 1);\n      this.openWhenEmpty();\n      this.updateRowsComponents(rowIndex);\n      this.updateValue();\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n      this.checkValidity(null, true);\n      this.checkData();\n      this.redraw();\n    }\n  }, {\n    key: \"createRowComponents\",\n    value: function createRowComponents(row, rowIndex) {\n      var _this13 = this;\n\n      return this.component.components.map(function (col, colIndex) {\n        var column = _lodash.default.clone(col);\n\n        var options = _lodash.default.clone(_this13.options);\n\n        options.name += \"[\".concat(rowIndex, \"]\");\n        options.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n\n        options.onChange = function () {\n          var _changed$instance$roo, _this13$root;\n\n          var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          var changed = arguments.length > 1 ? arguments[1] : undefined;\n          var modified = arguments.length > 2 ? arguments[2] : undefined;\n\n          if ((_changed$instance$roo = changed.instance.root) !== null && _changed$instance$roo !== void 0 && _changed$instance$roo.id && ((_this13$root = _this13.root) === null || _this13$root === void 0 ? void 0 : _this13$root.id) !== changed.instance.root.id) {\n            changed.instance.root.triggerChange(flags, changed, modified);\n          } else if (!_this13.component.modal) {\n            _this13.triggerRootChange(flags, changed, modified);\n          }\n\n          if (_this13.inlineEditMode) {\n            return;\n          }\n\n          var editRow = _this13.editRows[rowIndex];\n\n          if (editRow !== null && editRow !== void 0 && editRow.alerts) {\n            _this13.checkData(null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              rowIndex: rowIndex\n            }), _this13.data);\n          } else if (editRow) {\n            // If drafts allowed, perform validation silently if there was no attempt to submit a form\n            var silentCheck = _this13.component.rowDrafts && !_this13.shouldValidateDraft(editRow);\n\n            _this13.checkRow('checkData', null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              silentCheck: silentCheck\n            }), editRow.data, editRow.components, silentCheck);\n          }\n        };\n\n        var comp = _this13.createComponent(_lodash.default.assign({}, column, {\n          row: options.row\n        }), options, row);\n\n        comp.rowIndex = rowIndex;\n        comp.inEditGrid = true;\n        return comp;\n      });\n    }\n  }, {\n    key: \"hasOpenRows\",\n    value: function hasOpenRows() {\n      var _this14 = this;\n\n      return this.editRows.some(function (row) {\n        return _this14.isOpen(row);\n      });\n    }\n  }, {\n    key: \"shouldValidateDraft\",\n    value: function shouldValidateDraft(editRow) {\n      var _this$root, _this$root2; // Draft rows should be validated only when there was an attempt to submit a form\n\n\n      return editRow.state === EditRowState.Draft && !this.pristine && !((_this$root = this.root) !== null && _this$root !== void 0 && _this$root.pristine) && !this.hasOpenRows() || ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : _this$root2.submitted);\n    }\n  }, {\n    key: \"shouldValidateRow\",\n    value: function shouldValidateRow(editRow, dirty) {\n      return this.shouldValidateDraft(editRow) || editRow.state === EditRowState.Editing || editRow.alerts || dirty;\n    }\n  }, {\n    key: \"validateRow\",\n    value: function validateRow(editRow, dirty, forceSilentCheck) {\n      var _this15 = this,\n          _this$root3;\n\n      var valid = true;\n\n      var errorsSnapshot = _toConsumableArray(this.errors);\n\n      if (this.shouldValidateRow(editRow, dirty)) {\n        editRow.components.forEach(function (comp) {\n          var silentCheck = _this15.component.rowDrafts && !_this15.shouldValidateDraft(editRow) || forceSilentCheck;\n          valid &= comp.checkValidity(null, dirty, null, silentCheck);\n        });\n      }\n\n      if (this.component.validate && this.component.validate.row) {\n        valid = this.evaluate(this.component.validate.row, {\n          valid: valid,\n          row: editRow.data\n        }, 'valid', true);\n\n        if (valid.toString() !== 'true') {\n          editRow.error = valid;\n          valid = false;\n        } else {\n          editRow.error = null;\n        }\n\n        if (valid === null) {\n          valid = \"Invalid row validation for \".concat(this.key);\n        }\n      }\n\n      editRow.errors = !valid ? this.errors.filter(function (err) {\n        return !errorsSnapshot.includes(err);\n      }) : null;\n\n      if (!this.component.rowDrafts || (_this$root3 = this.root) !== null && _this$root3 !== void 0 && _this$root3.submitted) {\n        this.showRowErrorAlerts(editRow, !!valid);\n      }\n\n      return !!valid;\n    }\n  }, {\n    key: \"showRowErrorAlerts\",\n    value: function showRowErrorAlerts(editRow, valid) {\n      if (editRow.alerts) {\n        if (this.alert) {\n          var _editRow$errors;\n\n          if ((_editRow$errors = editRow.errors) !== null && _editRow$errors !== void 0 && _editRow$errors.length && !valid) {\n            this.alert.showErrors(editRow.errors, false);\n            editRow.alerts = true;\n          } else {\n            this.alert.clear();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      data = data || this.rootValue;\n      row = row || this.data;\n\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      return this.checkComponentValidity(data, dirty, row, {\n        silentCheck: silentCheck\n      });\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row) {\n      var _this16 = this,\n          _this$errors,\n          _this$root5;\n\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var silentCheck = options.silentCheck;\n      var errorsLength = this.errors.length;\n\n      var superValid = _get(_getPrototypeOf(EditGridComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options); // If super tells us that component invalid and there is no need to update alerts, just return false\n\n\n      if (!superValid && !this.alert && !this.hasOpenRows()) {\n        return false;\n      }\n\n      if (this.shouldSkipValidation(data, dirty, row)) {\n        return true;\n      }\n\n      var rowsValid = true;\n      var rowsEditing = false;\n      this.editRows.forEach(function (editRow, index) {\n        // Trigger all errors on the row.\n        var rowValid = _this16.validateRow(editRow, dirty, silentCheck);\n\n        rowsValid &= rowValid;\n\n        if (_this16.rowRefs) {\n          var rowContainer = _this16.rowRefs[index];\n\n          if (rowContainer) {\n            var errorContainer = rowContainer.querySelector('.editgrid-row-error');\n\n            if (!rowValid && errorContainer && (!_this16.component.rowDrafts || _this16.shouldValidateDraft(editRow))) {\n              _this16.addClass(errorContainer, 'help-block');\n\n              errorContainer.textContent = _this16.t('invalidRowError');\n            }\n          }\n        } // If this is a dirty check, and any rows are still editing, we need to throw validation error.\n\n\n        rowsEditing |= dirty && _this16.isOpen(editRow);\n      });\n\n      if (!rowsValid) {\n        var _this$root4;\n\n        if (!silentCheck && (!this.component.rowDrafts || (_this$root4 = this.root) !== null && _this$root4 !== void 0 && _this$root4.submitted)) {\n          this.setCustomValidity(this.t('invalidRowsError'), dirty); // Delete this class, because otherwise all the components inside EditGrid will has red border even if they are valid\n\n          this.removeClass(this.element, 'has-error');\n        }\n\n        return false;\n      } else if (rowsEditing && this.saveEditMode) {\n        this.setCustomValidity(this.t('unsavedRowsError'), dirty);\n        return false;\n      }\n\n      var message = this.invalid || this.invalidMessage(data, dirty);\n\n      if (((_this$errors = this.errors) === null || _this$errors === void 0 ? void 0 : _this$errors.length) !== errorsLength && (_this$root5 = this.root) !== null && _this$root5 !== void 0 && _this$root5.submitted && !message) {\n        this.setCustomValidity(message, dirty);\n        this.root.showErrors();\n      } else {\n        this.setCustomValidity(message, dirty);\n      }\n\n      return superValid;\n    }\n  }, {\n    key: \"changeState\",\n    value: function changeState(changed, flags) {\n      if (changed || flags.resetValue && this.component.modalEdit) {\n        this.rebuild();\n      } else {\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this17 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        value = this.defaultValue;\n      }\n\n      if (!Array.isArray(value)) {\n        if (_typeof(value) === 'object') {\n          value = [value];\n        } else {\n          return false;\n        }\n      }\n\n      var changed = this.hasChanged(value, this.dataValue);\n\n      if (this.parent) {\n        this.parent.checkComponentConditions();\n      }\n\n      this.dataValue = value; // Refresh editRow data when data changes.\n\n      this.dataValue.forEach(function (row, rowIndex) {\n        var editRow = _this17.editRows[rowIndex];\n\n        if (editRow) {\n          editRow.data = row;\n\n          _this17.restoreRowContext(editRow, flags);\n\n          editRow.state = EditRowState.Saved;\n          editRow.backup = null;\n          editRow.error = null;\n        } else {\n          _this17.editRows[rowIndex] = {\n            components: _this17.lazyLoad ? [] : _this17.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        }\n      });\n      var dataLength = this.dataValue.length; // If the last row is a new row, then do not remove it.\n\n      if (this.editRows[dataLength] && this.editRows[dataLength].state === EditRowState.New) {\n        dataLength = dataLength + 1;\n      }\n\n      this.editRows.slice(dataLength).forEach(function (editRow, index) {\n        return _this17.baseRemoveRow(dataLength + index);\n      });\n      this.editRows = this.editRows.slice(0, dataLength);\n      this.openWhenEmpty();\n      this.updateOnChange(flags, changed);\n      this.checkData();\n      this.changeState(changed, flags);\n      return changed;\n    }\n  }, {\n    key: \"openWhenEmpty\",\n    value: function openWhenEmpty() {\n      var shouldBeOpened = !this.dataValue.length && this.component.openWhenEmpty;\n      var hasNoRows = !this.editRows.length;\n\n      if (hasNoRows && shouldBeOpened && !this.builderMode) {\n        var dataObj = {};\n        this.createRow(dataObj, 0);\n      }\n    }\n  }, {\n    key: \"restoreRowContext\",\n    value: function restoreRowContext(editRow) {\n      var _this18 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      editRow.components.forEach(function (component) {\n        component.data = editRow.data;\n\n        _this18.setNestedValue(component, editRow.data, flags);\n      });\n    }\n  }, {\n    key: \"emptyRows\",\n    value: function emptyRows() {\n      var _this19 = this;\n\n      this.editRows.forEach(function (editRow, index) {\n        return _this19.destroyComponents(index);\n      });\n      this.editRows = [];\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(EditGridComponent.prototype), \"resetValue\", this).call(this);\n\n      this.emptyRows();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _NestedArrayComponent2.default.schema.apply(_NestedArrayComponent2.default, [{\n        type: 'editgrid',\n        label: 'Edit Grid',\n        key: 'editGrid',\n        clearOnHide: true,\n        input: true,\n        tree: true,\n        removeRow: 'Cancel',\n        defaultOpen: false,\n        openWhenEmpty: false,\n        modal: false,\n        components: [],\n        inlineEdit: false,\n        templates: {\n          header: EditGridComponent.defaultHeaderTemplate,\n          row: EditGridComponent.defaultRowTemplate,\n          tableHeader: EditGridComponent.defaultTableHeaderTemplate,\n          tableRow: EditGridComponent.defaultTableRowTemplate,\n          footer: ''\n        }\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Edit Grid',\n        icon: 'tasks',\n        group: 'data',\n        documentation: '/userguide/#editgrid',\n        weight: 30,\n        schema: EditGridComponent.schema()\n      };\n    }\n  }, {\n    key: \"defaultHeaderTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">{{ t(component.label) }}</div>\\n        {% } %}\\n      {% }) %}\\n    </div>\";\n    }\n  }, {\n    key: \"defaultTableHeaderTemplate\",\n    get: function get() {\n      return \"\\n      <tr>\\n        {% util.eachComponent(components, function(component) { %}\\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\\n            <td class=\\\"editgrid-table-column\\\">{{ component.label }}</td>\\n          {% } %}\\n        {% }) %}\\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\\n          <td class=\\\"editgrid-table-column\\\">Actions</td>\\n        {% } %}\\n      </tr>\\n    \";\n    }\n  }, {\n    key: \"defaultRowTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">\\n            {{ isVisibleInRow(component) ? getView(component, row[component.key]) : ''}}\\n          </div>\\n        {% } %}\\n      {% }) %}\\n      {% if (!instance.options.readOnly && !instance.disabled) { %}\\n        <div class=\\\"col-sm-2\\\">\\n          <div class=\\\"btn-group pull-right\\\">\\n            <button class=\\\"btn btn-default btn-light btn-sm editRow\\\"><i class=\\\"{{ iconClass('edit') }}\\\"></i></button>\\n            {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\\n              <button class=\\\"btn btn-danger btn-sm removeRow\\\"><i class=\\\"{{ iconClass('trash') }}\\\"></i></button>\\n            {% } %}\\n          </div>\\n        </div>\\n      {% } %}\\n    </div>\";\n    }\n  }, {\n    key: \"defaultTableRowTemplate\",\n    get: function get() {\n      return \"\\n      {% util.eachComponent(components, function(component) { %}\\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\\n            <td class=\\\"editgrid-table-column\\\">\\n              {{ getView(component, row[component.key]) }}\\n            </td>\\n          {% } %}\\n        {% }) %}\\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\\n          <td class=\\\"editgrid-table-column\\\">\\n            <div class=\\\"btn-group\\\">\\n              <button class=\\\"btn btn-default btn-light btn-sm editRow\\\" aria-label=\\\"{{ t('Edit row') }}\\\"><i class=\\\"{{ iconClass('edit') }}\\\"></i></button>\\n              {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\\n              <button class=\\\"btn btn-danger btn-sm removeRow\\\" aria-label=\\\"{{ t('Remove row') }}\\\"><i class=\\\"{{ iconClass('trash') }}\\\"></i></button>\\n              {% } %}\\n            </div>\\n          </td>\\n        {% } %}\\n    \";\n    }\n  }]);\n\n  return EditGridComponent;\n}(_NestedArrayComponent2.default);\n\nexports.default = EditGridComponent;\nEditGridComponent.prototype.hasChanged = _Component.default.prototype.hasChanged;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/jag-servebc/forms-flow-ai/forms-flow-web/node_modules/formiojs/components/editgrid/EditGrid.js"],"names":["require","Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","_nativePromiseOnly","_NestedArrayComponent2","_Component","_Alert","_utils","_templates","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","Array","from","test","iter","isArray","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","set","property","receiver","base","_superPropBase","desc","_set","isStrict","s","Error","_get","get","hasOwnProperty","getPrototypeOf","EditRowState","New","Editing","Saved","Viewing","Removed","Draft","EditGridComponent","_NestedArrayComponent","_super","_this","_len","args","_key","concat","type","t","displayAsTable","defaultTableRowTemplate","defaultRowTemplate","defaultTableHeaderTemplate","defaultHeaderTemplate","rowTemplate","Evaluator","noeval","tableRow","row","component","headerTemplate","tableHeader","header","inlineEditMode","schema","editgridKey","refs","rowRef","addRowRef","saveRowRef","cancelRowRef","inlineEdit","_data","data","dataValue","editRows","index","state","rowData","components","defaultValue","times","minLength","hasRemoveButtons","disableAddingRemovingRows","options","readOnly","disabled","fullMode","init","_this2","builderMode","openWhenEmpty","dataObj","createRow","map","rowIndex","lazyLoad","createRowComponents","backup","error","prevHasAddButton","hasAddButton","checkData","isOpen","editRow","includes","isComponentVisibleInSomeRow","_this3","rows","savedStates","savedRows","visibleInHeader","changeVisibleInHeader","isVisible","remove","isEmpty","rowComponents","checkComponent","eachComponent","comp","checkConditions","visible","removeComponent","isOpenRowWhenEmpty","some","editingRow","flattenedComponents","flattenComponents","render","children","_this4","bind","templateName","renderTemplate","ref","addRow","saveRow","cancelRow","renderString","displayValue","displayComponentValue","footer","renderRow","openRows","errors","renderComponents","getComponents","attach","element","_this$loadRefs","_this5","loadRefs","addRowElements","addButton","addEventListener","openRowCount","rowElements","isRowSelected","classList","add","attachComponents","saveRowElements","cancelRowElements","className","event","action","removeRow","then","rowDrafts","_this5$root","validateRow","hasErrors","shouldShowRowErrorsAlert","modal","root","submitted","alert","showErrors","alerts","toggle","eventName","emit","_ref","elements","getElementsByClassName","addClass","removeClass","flattenRowDataValue","_this6","flattened","isObject","isNil","assign","isComponentVisibleInRow","tableView","_this7","isVisibleInRow","getView","_instance$component","view","htmlTagRegExp","RegExp","template","replace","fn","each","restoreComponentsContext","_this8","_this8$editRows$compo","editRowData","everyComponent","flattenAs","isNumber","reduce","destroyComponents","_this9","triggerChange","checkRow","addRowModal","redraw","_this10","modalContent","ce","willBeSaved","innerHTML","dialog","createModal","showDialog","undefined","id","clear","dialogContents","setPristine","confirmationDialog","appendChild","class","onClick","close","isEqual","resolve","wrapper","dialogContent","dialogTemplate","defaultDialogTemplate","dialogHeader","dialogCancelButton","dialogYesButton","preventDefault","dialogResult","promise","reject","isAlreadyEditing","prevState","dataSnapshot","fastCloneDeep","restoreRowContext","clearErrors","setCustomValidity","splice","checkValidity","modified","_this11","isRowValid","saveEditMode","newIndex","updateValue","noPristineChangeOnModified","isolateRow","pristine","beforeFocus","parent","relativePath","getRelativePath","path","arrayPath","getArrayFromComponentPath","updateComponentsRowIndex","colIndex","updateRowsComponents","_this12","baseRemoveRow","_this13","col","column","clone","onChange","_changed$instance$roo","_this13$root","flags","changed","triggerRootChange","silentCheck","shouldValidateDraft","createComponent","inEditGrid","hasOpenRows","_this14","_this$root","_this$root2","shouldValidateRow","dirty","forceSilentCheck","_this15","_this$root3","valid","errorsSnapshot","validate","evaluate","err","showRowErrorAlerts","_editRow$errors","rootValue","checkCondition","checkComponentValidity","_this16","_this$errors","_this$root5","errorsLength","superValid","shouldSkipValidation","rowsValid","rowsEditing","rowValid","rowRefs","rowContainer","errorContainer","querySelector","textContent","_this$root4","message","invalid","invalidMessage","changeState","resetValue","modalEdit","rebuild","setValue","_this17","hasChanged","checkComponentConditions","dataLength","updateOnChange","shouldBeOpened","hasNoRows","_this18","setNestedValue","emptyRows","_this19","_len2","extend","_key2","label","clearOnHide","input","tree","defaultOpen","templates","title","icon","group","documentation","weight"],"mappings":"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","sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.reflect.set.js\");\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _NestedArrayComponent2 = _interopRequireDefault(require(\"../_classes/nestedarray/NestedArrayComponent\"));\n\nvar _Component = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _Alert = _interopRequireDefault(require(\"../alert/Alert\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _templates = _interopRequireDefault(require(\"./templates\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction set(target, property, value, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.set) { set = Reflect.set; } else { set = function set(target, property, value, receiver) { var base = _superPropBase(target, property); var desc; if (base) { desc = Object.getOwnPropertyDescriptor(base, property); if (desc.set) { desc.set.call(receiver, value); return true; } else if (!desc.writable) { return false; } } desc = Object.getOwnPropertyDescriptor(receiver, property); if (desc) { if (!desc.writable) { return false; } desc.value = value; Object.defineProperty(receiver, property, desc); } else { _defineProperty(receiver, property, value); } return true; }; } return set(target, property, value, receiver); }\n\nfunction _set(target, property, value, receiver, isStrict) { var s = set(target, property, value, receiver || target); if (!s && isStrict) { throw new Error('failed to set property'); } return value; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar EditRowState = {\n  New: 'new',\n  Editing: 'editing',\n  Saved: 'saved',\n  Viewing: 'viewing',\n  Removed: 'removed',\n  Draft: 'draft'\n};\n\nvar EditGridComponent = /*#__PURE__*/function (_NestedArrayComponent) {\n  _inherits(EditGridComponent, _NestedArrayComponent);\n\n  var _super = _createSuper(EditGridComponent);\n\n  function EditGridComponent() {\n    var _this;\n\n    _classCallCheck(this, EditGridComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.type = 'editgrid';\n    return _this;\n  }\n\n  _createClass(EditGridComponent, [{\n    key: \"defaultDialogTemplate\",\n    get: function get() {\n      return \"\\n    <h3 ref=\\\"dialogHeader\\\">\".concat(this.t('Do you want to clear data?'), \"</h3>\\n    <div style=\\\"display:flex; justify-content: flex-end;\\\">\\n      <button ref=\\\"dialogCancelButton\\\" class=\\\"btn btn-secondary\\\" aria-label=\\\"\").concat(this.t('Cancel'), \"\\\">\").concat(this.t('Cancel'), \"</button>\\n      <button ref=\\\"dialogYesButton\\\" class=\\\"btn btn-danger\\\" aria-label=\\\"\").concat(this.t('Yes, delete it'), \"\\\">\").concat(this.t('Yes, delete it'), \"</button>\\n    </div>\\n  \");\n    }\n  }, {\n    key: \"defaultRowTemplate\",\n    get: function get() {\n      return this.displayAsTable ? EditGridComponent.defaultTableRowTemplate : EditGridComponent.defaultRowTemplate;\n    }\n  }, {\n    key: \"defaultHeaderTemplate\",\n    get: function get() {\n      return this.displayAsTable ? EditGridComponent.defaultTableHeaderTemplate : EditGridComponent.defaultHeaderTemplate;\n    }\n  }, {\n    key: \"rowTemplate\",\n    get: function get() {\n      var rowTemplate;\n\n      if (_utils.Evaluator.noeval) {\n        rowTemplate = this.displayAsTable ? _templates.default.tableRow : _templates.default.row;\n      } else {\n        rowTemplate = this.displayAsTable ? _lodash.default.get(this.component, 'templates.tableRow', this.defaultRowTemplate) : _lodash.default.get(this.component, 'templates.row', this.defaultRowTemplate);\n      }\n\n      return rowTemplate;\n    }\n  }, {\n    key: \"headerTemplate\",\n    get: function get() {\n      var headerTemplate;\n\n      if (_utils.Evaluator.noeval) {\n        headerTemplate = this.displayAsTable ? _templates.default.tableHeader : _templates.default.header;\n      } else {\n        headerTemplate = this.displayAsTable ? _lodash.default.get(this.component, 'templates.tableHeader', this.defaultHeaderTemplate) : _lodash.default.get(this.component, 'templates.header', this.defaultHeaderTemplate);\n      }\n\n      return headerTemplate;\n    }\n    /**\n     * Returns true if the component has nested components which don't trigger changes on the root level\n     */\n\n  }, {\n    key: \"hasScopedChildren\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return EditGridComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return [];\n    }\n  }, {\n    key: \"editgridKey\",\n    get: function get() {\n      return \"editgrid-\".concat(this.key);\n    }\n  }, {\n    key: \"rowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-row\");\n    }\n  }, {\n    key: \"rowElements\",\n    get: function get() {\n      return this.refs[this.rowRef];\n    }\n  }, {\n    key: \"rowRefs\",\n    get: function get() {\n      return this.refs[\"editgrid-\".concat(this.component.key, \"-row\")];\n    }\n  }, {\n    key: \"addRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-addRow\");\n    }\n  }, {\n    key: \"addRowElements\",\n    get: function get() {\n      return this.refs[this.addRowRef];\n    }\n  }, {\n    key: \"saveRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-saveRow\");\n    }\n  }, {\n    key: \"saveRowElements\",\n    get: function get() {\n      return this.refs[this.saveRowRef];\n    }\n  }, {\n    key: \"cancelRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-cancelRow\");\n    }\n  }, {\n    key: \"cancelRowElements\",\n    get: function get() {\n      return this.refs[this.cancelRowRef];\n    }\n  }, {\n    key: \"inlineEditMode\",\n    get: function get() {\n      return this.component.inlineEdit;\n    }\n  }, {\n    key: \"saveEditMode\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"minLength\",\n    get: function get() {\n      return _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      this._data = value;\n      var data = this.dataValue;\n      (this.editRows || []).forEach(function (row, index) {\n        if (!data[index] && row.state !== EditRowState.New) {\n          data[index] = {};\n        }\n\n        var rowData = data[index] || {};\n        row.data = rowData;\n        row.components.forEach(function (component) {\n          component.data = rowData;\n        });\n      });\n    }\n  }, {\n    key: \"dataValue\",\n    get: function get() {\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"dataValue\", this) || [];\n    },\n    set: function set(value) {\n      _set(_getPrototypeOf(EditGridComponent.prototype), \"dataValue\", value, this, true);\n    }\n  }, {\n    key: \"displayAsTable\",\n    get: function get() {\n      return this.component.displayAsTable;\n    }\n  }, {\n    key: \"iteratableRows\",\n    get: function get() {\n      return this.editRows;\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var value = _get(_getPrototypeOf(EditGridComponent.prototype), \"defaultValue\", this);\n\n      var defaultValue = Array.isArray(value) ? value : [];\n\n      _lodash.default.times(this.minLength - defaultValue.length, function () {\n        return defaultValue.push({});\n      });\n\n      return defaultValue;\n    }\n  }, {\n    key: \"hasRemoveButtons\",\n    value: function hasRemoveButtons() {\n      return !this.component.disableAddingRemovingRows && !this.options.readOnly && !this.disabled && this.fullMode && this.dataValue.length > _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      if (this.builderMode) {\n        this.editRows = [];\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"init\", this).call(this);\n      }\n\n      this.components = this.components || [];\n      var dataValue = this.dataValue;\n      var openWhenEmpty = !dataValue.length && this.component.openWhenEmpty;\n\n      if (openWhenEmpty) {\n        var dataObj = {};\n        this.editRows = [];\n        this.createRow(dataObj, 0);\n      } else {\n        this.editRows = dataValue.map(function (row, rowIndex) {\n          return {\n            components: _this2.lazyLoad ? [] : _this2.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        });\n      }\n\n      this.prevHasAddButton = this.hasAddButton();\n      this.checkData();\n    }\n  }, {\n    key: \"isOpen\",\n    value: function isOpen(editRow) {\n      return [EditRowState.New, EditRowState.Editing, EditRowState.Viewing].includes(editRow.state);\n    }\n  }, {\n    key: \"isComponentVisibleInSomeRow\",\n    value: function isComponentVisibleInSomeRow(component) {\n      var _this3 = this;\n\n      var rows = this.editRows;\n      var savedStates = [EditRowState.Saved, EditRowState.Editing, EditRowState.Draft];\n      var savedRows = rows.filter(function (row) {\n        return _lodash.default.includes(savedStates, row.state);\n      });\n      this.visibleInHeader = this.visibleInHeader || [];\n\n      var changeVisibleInHeader = function changeVisibleInHeader(component, isVisible) {\n        if (!isVisible) {\n          _lodash.default.remove(_this3.visibleInHeader, function (key) {\n            return key === component.key;\n          });\n        }\n\n        if (isVisible && !_lodash.default.includes(_this3.visibleInHeader, component.key)) {\n          _this3.visibleInHeader.push(component.key);\n        }\n      };\n\n      if (_lodash.default.isEmpty(rows)) {\n        var rowComponents = this.createRowComponents({}, 0);\n        var checkComponent;\n        (0, _utils.eachComponent)(rowComponents, function (comp) {\n          if (comp.component.key === component.key) {\n            checkComponent = comp;\n          }\n\n          comp.checkConditions();\n        });\n        var isVisible = checkComponent ? checkComponent.visible : true;\n\n        _toConsumableArray(this.components).forEach(function (comp) {\n          return _this3.removeComponent(comp, _this3.components);\n        });\n\n        changeVisibleInHeader(component, isVisible);\n        return isVisible;\n      }\n\n      var isOpenRowWhenEmpty = _lodash.default.get(this.component, 'openWhenEmpty') && rows.length === 1 && rows[0].state === EditRowState.New;\n\n      if (!_lodash.default.isEmpty(rows) && _lodash.default.isEmpty(savedRows) && !isOpenRowWhenEmpty) {\n        return _lodash.default.includes(this.visibleInHeader, component.key);\n      }\n\n      return _lodash.default.some(isOpenRowWhenEmpty ? rows : savedRows, function (row, index) {\n        var editingRow = row.state === EditRowState.Editing;\n        var isVisible;\n\n        if (!editingRow) {\n          var flattenedComponents = _this3.flattenComponents(index);\n\n          var instance = flattenedComponents[component.key];\n          isVisible = instance ? instance.visible : true;\n          changeVisibleInHeader(component, isVisible);\n        } else {\n          isVisible = _lodash.default.includes(_this3.visibleInHeader, component.key);\n        }\n\n        return isVisible;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      var _this4 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this);\n      }\n\n      var dataValue = this.dataValue;\n      var headerTemplate = this.headerTemplate;\n      var t = this.t.bind(this);\n      var templateName = this.displayAsTable ? 'editgridTable' : 'editgrid';\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this, children || this.renderTemplate(templateName, {\n        ref: {\n          row: this.rowRef,\n          addRow: this.addRowRef,\n          saveRow: this.saveRowRef,\n          cancelRow: this.cancelRowRef\n        },\n        header: this.renderString(headerTemplate, {\n          displayValue: function displayValue(component) {\n            return _this4.displayComponentValue(component, true);\n          },\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        footer: this.renderString(_lodash.default.get(this.component, 'templates.footer'), {\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        rows: this.editRows.map(this.renderRow.bind(this)),\n        openRows: this.editRows.map(function (row) {\n          return _this4.isOpen(row);\n        }),\n        errors: this.editRows.map(function (row) {\n          return row.error;\n        }),\n        hasAddButton: this.hasAddButton(),\n        hasRemoveButtons: this.hasRemoveButtons()\n      }));\n    }\n  }, {\n    key: \"renderComponents\",\n    value: function renderComponents(components) {\n      components = components || this.getComponents();\n      var children = components.map(function (component) {\n        return component.render();\n      });\n      var templateName = this.displayAsTable && this.prevHasAddButton ? 'tableComponents' : 'components';\n      return this.renderTemplate(templateName, {\n        children: children,\n        components: components\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs,\n          _this5 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      this.loadRefs(element, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, this.addRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.saveRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.cancelRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.rowRef, 'multiple'), _this$loadRefs));\n      this.addRowElements.forEach(function (addButton) {\n        _this5.addEventListener(addButton, 'click', function () {\n          return _this5.addRow();\n        });\n      });\n      var openRowCount = 0;\n      this.rowElements.forEach(function (row, rowIndex) {\n        var editRow = _this5.editRows[rowIndex];\n\n        if (editRow !== null && editRow !== void 0 && editRow.isRowSelected) {\n          row.classList.add('selected');\n        }\n\n        if (_this5.isOpen(editRow)) {\n          _this5.attachComponents(row, editRow.components);\n\n          _this5.addEventListener(_this5.saveRowElements[openRowCount], 'click', function () {\n            return _this5.saveRow(rowIndex, true);\n          });\n\n          _this5.addEventListener(_this5.cancelRowElements[openRowCount], 'click', function () {\n            return _this5.cancelRow(rowIndex);\n          });\n\n          openRowCount++;\n        } else {\n          // Attach edit and remove button events.\n          [{\n            className: 'removeRow',\n            event: 'click',\n            action: function action() {\n              return _this5.removeRow(rowIndex, true);\n            }\n          }, {\n            className: 'editRow',\n            event: 'click',\n            action: function action() {\n              _this5.editRow(rowIndex).then(function () {\n                if (_this5.component.rowDrafts) {\n                  var _this5$root;\n\n                  _this5.validateRow(editRow, false);\n\n                  var hasErrors = editRow.errors && !!editRow.errors.length;\n                  var shouldShowRowErrorsAlert = _this5.component.modal && hasErrors && ((_this5$root = _this5.root) === null || _this5$root === void 0 ? void 0 : _this5$root.submitted);\n\n                  if (shouldShowRowErrorsAlert) {\n                    _this5.alert.showErrors(editRow.errors, false);\n\n                    editRow.alerts = true;\n                  }\n                }\n              });\n            }\n          }, {\n            className: 'row',\n            event: 'click',\n            action: function action() {\n              row.classList.toggle('selected');\n              var eventName = 'editGridSelectRow';\n\n              if (Array.from(row.classList).includes('selected')) {\n                editRow.isRowSelected = true;\n              } else {\n                delete editRow.isRowSelected;\n                eventName = 'editGridUnSelectRow';\n              }\n\n              _this5.emit(eventName, {\n                component: _this5.component,\n                data: _this5.dataValue[rowIndex]\n              });\n            }\n          }].forEach(function (_ref) {\n            var className = _ref.className,\n                event = _ref.event,\n                action = _ref.action;\n            var elements = row.getElementsByClassName(className);\n            Array.prototype.forEach.call(elements, function (element) {\n              _this5.addEventListener(element, event, action);\n            });\n          });\n        }\n      }); // Add open class to the element if any edit grid row is open\n\n      if (openRowCount) {\n        this.addClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      } else {\n        this.removeClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      }\n\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n    }\n  }, {\n    key: \"flattenRowDataValue\",\n    value: function flattenRowDataValue(dataValue) {\n      var _this6 = this;\n\n      var flattened = {};\n      Object.keys(dataValue).forEach(function (key) {\n        if (_lodash.default.isObject(dataValue[key]) && !_lodash.default.isNil(dataValue[key])) {\n          Object.assign(flattened, _this6.flattenRowDataValue(dataValue[key]));\n        } else {\n          flattened[key] = dataValue[key];\n        }\n      });\n      return flattened;\n    }\n  }, {\n    key: \"isComponentVisibleInRow\",\n    value: function isComponentVisibleInRow(component, flattenedComponents) {\n      var instance = flattenedComponents[component.key];\n      return instance ? instance.visible : true;\n    }\n  }, {\n    key: \"displayComponentValue\",\n    value: function displayComponentValue(component, header) {\n      return !!((!component.hasOwnProperty('tableView') || component.tableView) && header ? this.isComponentVisibleInSomeRow(component) : _lodash.default.includes(this.visibleInHeader, component.key));\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(row, rowIndex) {\n      var _this7 = this;\n\n      var dataValue = this.dataValue;\n\n      if (this.isOpen(row)) {\n        return this.renderComponents(row.components);\n      } else {\n        var flattenedComponents = this.flattenComponents(rowIndex);\n        var rowTemplate = this.rowTemplate;\n        return this.renderString(rowTemplate, {\n          row: dataValue[rowIndex] || {},\n          data: this.data,\n          rowIndex: rowIndex,\n          components: this.component.components,\n          flattenedComponents: flattenedComponents,\n          displayValue: function displayValue(component) {\n            return _this7.displayComponentValue(component);\n          },\n          isVisibleInRow: function isVisibleInRow(component) {\n            return _this7.isComponentVisibleInRow(component, flattenedComponents);\n          },\n          getView: function getView(component, data) {\n            var _instance$component;\n\n            var instance = flattenedComponents[component.key];\n            var view = instance ? instance.getView(data || instance.dataValue) : ''; // If there is an html tag in view, don't allow it to be injected in template\n\n            var htmlTagRegExp = new RegExp('<(.*?)>');\n            return typeof view === 'string' && view.length && !((_instance$component = instance.component) !== null && _instance$component !== void 0 && _instance$component.template) && htmlTagRegExp.test(view) ? \"<input type=\\\"text\\\" value=\\\"\".concat(view.replace(/\"/g, '&quot;'), \"\\\" readonly/>\") : view;\n          },\n          state: this.editRows[rowIndex].state,\n          t: this.t.bind(this)\n        });\n      }\n    }\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn, rowIndex) {\n      _lodash.default.each(this.getComponents(rowIndex), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this8 = this;\n\n      this.getComponents().forEach(function (component) {\n        var _this8$editRows$compo;\n\n        var rowData = _this8.dataValue[component.rowIndex];\n        var editRowData = (_this8$editRows$compo = _this8.editRows[component.rowIndex]) === null || _this8$editRows$compo === void 0 ? void 0 : _this8$editRows$compo.data;\n        component.data = rowData || editRowData;\n      });\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents(rowIndex) {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      }, rowIndex);\n      return result;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents(rowIndex) {\n      // Ensure editrows is set.\n      this.editRows = this.editRows || [];\n      return this.builderMode ? _get(_getPrototypeOf(EditGridComponent.prototype), \"getComponents\", this).call(this) : _lodash.default.isNumber(rowIndex) ? this.editRows[rowIndex].components || [] : this.editRows.reduce(function (result, row) {\n        return result.concat(row.components || []);\n      }, []);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents(rowIndex) {\n      var _this9 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"destroyComponents\", this).call(this);\n      }\n\n      var components = this.getComponents(rowIndex).slice();\n      components.forEach(function (comp) {\n        return _this9.removeComponent(comp, _this9.components);\n      });\n    }\n  }, {\n    key: \"createRow\",\n    value: function createRow(dataObj, rowIndex) {\n      var editRow = {\n        components: this.createRowComponents(dataObj, rowIndex),\n        data: dataObj,\n        state: EditRowState.New,\n        backup: null,\n        error: null\n      };\n      this.editRows.push(editRow);\n\n      if (this.inlineEditMode) {\n        this.dataValue.push(dataObj);\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRow\",\n    value: function addRow() {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var dataObj = {};\n      var rowIndex = this.editRows.length;\n      var editRow = this.createRow(dataObj, rowIndex);\n\n      if (this.inlineEditMode) {\n        this.triggerChange();\n      }\n\n      this.emit('editGridAddRow', {\n        component: this.component,\n        row: editRow\n      });\n      this.checkRow('checkData', null, {}, editRow.data, editRow.components);\n\n      if (this.component.modal) {\n        this.addRowModal(rowIndex);\n      } else {\n        this.redraw();\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRowModal\",\n    value: function addRowModal(rowIndex) {\n      var _this10 = this;\n\n      var modalContent = this.ce('div');\n      var editRow = this.editRows[rowIndex];\n      editRow.willBeSaved = false;\n      var components = editRow.components;\n      modalContent.innerHTML = this.renderComponents(components);\n      var dialog = this.component.modal ? this.createModal(modalContent, {}, function () {\n        return _this10.showDialog(rowIndex);\n      }) : undefined;\n      dialog.classList.add(\"editgrid-row-modal-\".concat(this.id));\n      editRow.dialog = dialog;\n\n      if (this.alert) {\n        this.alert.clear();\n        this.alert = null;\n      }\n\n      this.alert = new _Alert.default(dialog.refs.dialogContents, this);\n      this.addEventListener(dialog, 'close', function () {\n        if (!editRow.willBeSaved) {\n          if (_this10.editRows[rowIndex] && _this10.editRows[rowIndex].state !== EditRowState.New) {\n            _this10.editRows[rowIndex].components.forEach(function (comp) {\n              comp.setPristine(true);\n            });\n          }\n\n          _this10.cancelRow(rowIndex);\n        }\n\n        if (_this10.alert) {\n          _this10.alert.clear();\n\n          _this10.alert = null;\n        } // Remove references to dialog elements to prevent possible in some cases memory leaks\n\n\n        delete editRow.confirmationDialog;\n        delete editRow.dialog;\n      });\n      dialog.refs.dialogContents.appendChild(this.ce('button', {\n        class: 'btn btn-primary',\n        onClick: function onClick() {\n          // After an attempt to save, all the components inside the row should become not pristine\n          if (!_this10.component.rowDrafts) {\n            editRow.components.forEach(function (comp) {\n              return comp.setPristine(false);\n            });\n          }\n\n          if (_this10.validateRow(editRow, true) || _this10.component.rowDrafts) {\n            editRow.willBeSaved = true;\n            dialog.close();\n\n            _this10.saveRow(rowIndex, true);\n          } else {\n            _this10.alert.showErrors(editRow.errors, false);\n\n            editRow.alerts = true;\n          }\n        }\n      }, this.component.saveRow || 'Save'));\n      return this.attachComponents(modalContent, components);\n    }\n  }, {\n    key: \"showDialog\",\n    value: function showDialog(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (_lodash.default.isEqual(editRow.backup, editRow.data)) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      var wrapper = this.ce('div', {\n        ref: 'confirmationDialog'\n      });\n      var dialogContent = this.component.dialogTemplate || this.defaultDialogTemplate;\n      wrapper.innerHTML = dialogContent;\n      wrapper.refs = {};\n      this.loadRefs.call(wrapper, wrapper, {\n        dialogHeader: 'single',\n        dialogCancelButton: 'single',\n        dialogYesButton: 'single'\n      });\n      var dialog = this.createModal(wrapper);\n      dialog.classList.add(\"editgrid-row-modal-confirmation-\".concat(this.id));\n\n      var close = function close(event) {\n        event.preventDefault();\n        dialog.close();\n      };\n\n      var dialogResult;\n      var promise = new _nativePromiseOnly.default(function (resolve, reject) {\n        dialogResult = {\n          resolve: resolve,\n          reject: reject\n        };\n      });\n      this.addEventListener(wrapper.refs.dialogYesButton, 'click', function (event) {\n        close(event);\n        dialogResult.resolve();\n      });\n      this.addEventListener(wrapper.refs.dialogCancelButton, 'click', function (event) {\n        close(event);\n        dialogResult.reject();\n      });\n      editRow.confirmationDialog = dialog;\n      return promise;\n    }\n  }, {\n    key: \"editRow\",\n    value: function editRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      var isAlreadyEditing = editRow.state === EditRowState.Editing || editRow.state === EditRowState.New;\n\n      if (!editRow || isAlreadyEditing) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      editRow.prevState = editRow.state;\n      editRow.state = this.options.readOnly ? EditRowState.Viewing : EditRowState.Editing;\n\n      if (this.lazyLoad && editRow.components.length === 0) {\n        editRow.components = this.createRowComponents(editRow.data, rowIndex);\n      }\n\n      var dataSnapshot = (0, _utils.fastCloneDeep)(editRow.data);\n\n      if (this.inlineEditMode) {\n        editRow.backup = dataSnapshot;\n      } else {\n        editRow.backup = (0, _utils.fastCloneDeep)(editRow.data);\n        editRow.data = dataSnapshot;\n        this.restoreRowContext(editRow);\n      }\n\n      if (this.component.modal) {\n        return this.addRowModal(rowIndex);\n      }\n\n      return this.redraw();\n    }\n  }, {\n    key: \"clearErrors\",\n    value: function clearErrors(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (editRow && Array.isArray(editRow.components)) {\n        editRow.components.forEach(function (comp) {\n          comp.setPristine(true);\n          comp.setCustomValidity('');\n        });\n      }\n    }\n  }, {\n    key: \"cancelRow\",\n    value: function cancelRow(rowIndex) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var editRow = this.editRows[rowIndex];\n\n      switch (editRow.state) {\n        case EditRowState.New:\n          {\n            editRow.state = EditRowState.Removed;\n            this.clearErrors(rowIndex);\n            this.destroyComponents(rowIndex);\n\n            if (this.inlineEditMode) {\n              this.splice(rowIndex);\n            }\n\n            this.editRows.splice(rowIndex, 1);\n            this.openWhenEmpty();\n            break;\n          }\n\n        case EditRowState.Editing:\n          {\n            editRow.state = editRow.prevState;\n\n            if (this.inlineEditMode) {\n              this.dataValue[rowIndex] = editRow.backup;\n            }\n\n            editRow.data = editRow.backup;\n            editRow.backup = null;\n            this.restoreRowContext(editRow);\n            this.clearErrors(rowIndex);\n            break;\n          }\n      }\n\n      this.emit('editGridCancelRow', {\n        instance: this,\n        component: this.component,\n        editRow: editRow\n      });\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (this.component.rowDrafts) {\n        this.checkValidity(this.data, false);\n      }\n    }\n  }, {\n    key: \"saveRow\",\n    value: function saveRow(rowIndex, modified) {\n      var _this11 = this;\n\n      var editRow = this.editRows[rowIndex];\n\n      if (this.options.readOnly) {\n        return;\n      } // After an attempt to save, all the components inside the row should become not pristine\n\n\n      if (!this.component.rowDrafts) {\n        editRow.components.forEach(function (comp) {\n          return comp.setPristine(false);\n        });\n      }\n\n      var isRowValid = this.validateRow(editRow, true);\n\n      if (!this.component.rowDrafts) {\n        if (!isRowValid) {\n          return false;\n        }\n      }\n\n      if (this.saveEditMode) {\n        var dataValue = this.dataValue;\n\n        switch (editRow.state) {\n          case EditRowState.New:\n            {\n              var newIndex = dataValue.length;\n              dataValue.push(editRow.data);\n              editRow.components.forEach(function (component) {\n                return component.rowIndex = newIndex;\n              });\n\n              if (rowIndex !== newIndex) {\n                this.editRows.splice(rowIndex, 1);\n                this.editRows.splice(newIndex, 0, editRow);\n              }\n\n              break;\n            }\n\n          case EditRowState.Editing:\n            {\n              dataValue[rowIndex] = editRow.data;\n              break;\n            }\n        }\n      }\n\n      editRow.state = this.component.rowDrafts && !isRowValid ? EditRowState.Draft : EditRowState.Saved;\n      editRow.backup = null;\n      this.updateValue();\n      this.emit('editGridSaveRow', {\n        component: this.component,\n        row: editRow.data,\n        instance: this\n      });\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n\n      if (this.component.rowDrafts) {\n        editRow.components.forEach(function (comp) {\n          return comp.setPristine(_this11.pristine);\n        });\n      }\n\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (editRow.alerts) {\n        editRow.alerts = false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus(component) {\n      if ('beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n\n      var relativePath = this.getRelativePath(component.path);\n      var arrayPath = (0, _utils.getArrayFromComponentPath)(relativePath);\n\n      if (_lodash.default.isNumber(arrayPath[0])) {\n        this.editRow(arrayPath[0]);\n      }\n    }\n  }, {\n    key: \"updateComponentsRowIndex\",\n    value: function updateComponentsRowIndex(components, rowIndex) {\n      components.forEach(function (component, colIndex) {\n        component.rowIndex = rowIndex;\n        component.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n      });\n    }\n  }, {\n    key: \"updateRowsComponents\",\n    value: function updateRowsComponents(rowIndex) {\n      var _this12 = this;\n\n      this.editRows.slice(rowIndex).forEach(function (row, index) {\n        _this12.updateComponentsRowIndex(row.components, rowIndex + index);\n      });\n    }\n  }, {\n    key: \"baseRemoveRow\",\n    value: function baseRemoveRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      editRow.state = EditRowState.Removed;\n      this.destroyComponents(rowIndex);\n      return editRow;\n    }\n  }, {\n    key: \"removeRow\",\n    value: function removeRow(rowIndex, modified) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      this.clearErrors(rowIndex);\n      this.baseRemoveRow(rowIndex);\n      this.splice(rowIndex);\n      this.emit('editGridDeleteRow', {\n        index: rowIndex\n      });\n      this.editRows.splice(rowIndex, 1);\n      this.openWhenEmpty();\n      this.updateRowsComponents(rowIndex);\n      this.updateValue();\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n      this.checkValidity(null, true);\n      this.checkData();\n      this.redraw();\n    }\n  }, {\n    key: \"createRowComponents\",\n    value: function createRowComponents(row, rowIndex) {\n      var _this13 = this;\n\n      return this.component.components.map(function (col, colIndex) {\n        var column = _lodash.default.clone(col);\n\n        var options = _lodash.default.clone(_this13.options);\n\n        options.name += \"[\".concat(rowIndex, \"]\");\n        options.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n\n        options.onChange = function () {\n          var _changed$instance$roo, _this13$root;\n\n          var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          var changed = arguments.length > 1 ? arguments[1] : undefined;\n          var modified = arguments.length > 2 ? arguments[2] : undefined;\n\n          if ((_changed$instance$roo = changed.instance.root) !== null && _changed$instance$roo !== void 0 && _changed$instance$roo.id && ((_this13$root = _this13.root) === null || _this13$root === void 0 ? void 0 : _this13$root.id) !== changed.instance.root.id) {\n            changed.instance.root.triggerChange(flags, changed, modified);\n          } else if (!_this13.component.modal) {\n            _this13.triggerRootChange(flags, changed, modified);\n          }\n\n          if (_this13.inlineEditMode) {\n            return;\n          }\n\n          var editRow = _this13.editRows[rowIndex];\n\n          if (editRow !== null && editRow !== void 0 && editRow.alerts) {\n            _this13.checkData(null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              rowIndex: rowIndex\n            }), _this13.data);\n          } else if (editRow) {\n            // If drafts allowed, perform validation silently if there was no attempt to submit a form\n            var silentCheck = _this13.component.rowDrafts && !_this13.shouldValidateDraft(editRow);\n\n            _this13.checkRow('checkData', null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              silentCheck: silentCheck\n            }), editRow.data, editRow.components, silentCheck);\n          }\n        };\n\n        var comp = _this13.createComponent(_lodash.default.assign({}, column, {\n          row: options.row\n        }), options, row);\n\n        comp.rowIndex = rowIndex;\n        comp.inEditGrid = true;\n        return comp;\n      });\n    }\n  }, {\n    key: \"hasOpenRows\",\n    value: function hasOpenRows() {\n      var _this14 = this;\n\n      return this.editRows.some(function (row) {\n        return _this14.isOpen(row);\n      });\n    }\n  }, {\n    key: \"shouldValidateDraft\",\n    value: function shouldValidateDraft(editRow) {\n      var _this$root, _this$root2;\n\n      // Draft rows should be validated only when there was an attempt to submit a form\n      return editRow.state === EditRowState.Draft && !this.pristine && !((_this$root = this.root) !== null && _this$root !== void 0 && _this$root.pristine) && !this.hasOpenRows() || ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : _this$root2.submitted);\n    }\n  }, {\n    key: \"shouldValidateRow\",\n    value: function shouldValidateRow(editRow, dirty) {\n      return this.shouldValidateDraft(editRow) || editRow.state === EditRowState.Editing || editRow.alerts || dirty;\n    }\n  }, {\n    key: \"validateRow\",\n    value: function validateRow(editRow, dirty, forceSilentCheck) {\n      var _this15 = this,\n          _this$root3;\n\n      var valid = true;\n\n      var errorsSnapshot = _toConsumableArray(this.errors);\n\n      if (this.shouldValidateRow(editRow, dirty)) {\n        editRow.components.forEach(function (comp) {\n          var silentCheck = _this15.component.rowDrafts && !_this15.shouldValidateDraft(editRow) || forceSilentCheck;\n          valid &= comp.checkValidity(null, dirty, null, silentCheck);\n        });\n      }\n\n      if (this.component.validate && this.component.validate.row) {\n        valid = this.evaluate(this.component.validate.row, {\n          valid: valid,\n          row: editRow.data\n        }, 'valid', true);\n\n        if (valid.toString() !== 'true') {\n          editRow.error = valid;\n          valid = false;\n        } else {\n          editRow.error = null;\n        }\n\n        if (valid === null) {\n          valid = \"Invalid row validation for \".concat(this.key);\n        }\n      }\n\n      editRow.errors = !valid ? this.errors.filter(function (err) {\n        return !errorsSnapshot.includes(err);\n      }) : null;\n\n      if (!this.component.rowDrafts || (_this$root3 = this.root) !== null && _this$root3 !== void 0 && _this$root3.submitted) {\n        this.showRowErrorAlerts(editRow, !!valid);\n      }\n\n      return !!valid;\n    }\n  }, {\n    key: \"showRowErrorAlerts\",\n    value: function showRowErrorAlerts(editRow, valid) {\n      if (editRow.alerts) {\n        if (this.alert) {\n          var _editRow$errors;\n\n          if ((_editRow$errors = editRow.errors) !== null && _editRow$errors !== void 0 && _editRow$errors.length && !valid) {\n            this.alert.showErrors(editRow.errors, false);\n            editRow.alerts = true;\n          } else {\n            this.alert.clear();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      data = data || this.rootValue;\n      row = row || this.data;\n\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      return this.checkComponentValidity(data, dirty, row, {\n        silentCheck: silentCheck\n      });\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row) {\n      var _this16 = this,\n          _this$errors,\n          _this$root5;\n\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var silentCheck = options.silentCheck;\n      var errorsLength = this.errors.length;\n\n      var superValid = _get(_getPrototypeOf(EditGridComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options); // If super tells us that component invalid and there is no need to update alerts, just return false\n\n\n      if (!superValid && !this.alert && !this.hasOpenRows()) {\n        return false;\n      }\n\n      if (this.shouldSkipValidation(data, dirty, row)) {\n        return true;\n      }\n\n      var rowsValid = true;\n      var rowsEditing = false;\n      this.editRows.forEach(function (editRow, index) {\n        // Trigger all errors on the row.\n        var rowValid = _this16.validateRow(editRow, dirty, silentCheck);\n\n        rowsValid &= rowValid;\n\n        if (_this16.rowRefs) {\n          var rowContainer = _this16.rowRefs[index];\n\n          if (rowContainer) {\n            var errorContainer = rowContainer.querySelector('.editgrid-row-error');\n\n            if (!rowValid && errorContainer && (!_this16.component.rowDrafts || _this16.shouldValidateDraft(editRow))) {\n              _this16.addClass(errorContainer, 'help-block');\n\n              errorContainer.textContent = _this16.t('invalidRowError');\n            }\n          }\n        } // If this is a dirty check, and any rows are still editing, we need to throw validation error.\n\n\n        rowsEditing |= dirty && _this16.isOpen(editRow);\n      });\n\n      if (!rowsValid) {\n        var _this$root4;\n\n        if (!silentCheck && (!this.component.rowDrafts || (_this$root4 = this.root) !== null && _this$root4 !== void 0 && _this$root4.submitted)) {\n          this.setCustomValidity(this.t('invalidRowsError'), dirty); // Delete this class, because otherwise all the components inside EditGrid will has red border even if they are valid\n\n          this.removeClass(this.element, 'has-error');\n        }\n\n        return false;\n      } else if (rowsEditing && this.saveEditMode) {\n        this.setCustomValidity(this.t('unsavedRowsError'), dirty);\n        return false;\n      }\n\n      var message = this.invalid || this.invalidMessage(data, dirty);\n\n      if (((_this$errors = this.errors) === null || _this$errors === void 0 ? void 0 : _this$errors.length) !== errorsLength && (_this$root5 = this.root) !== null && _this$root5 !== void 0 && _this$root5.submitted && !message) {\n        this.setCustomValidity(message, dirty);\n        this.root.showErrors();\n      } else {\n        this.setCustomValidity(message, dirty);\n      }\n\n      return superValid;\n    }\n  }, {\n    key: \"changeState\",\n    value: function changeState(changed, flags) {\n      if (changed || flags.resetValue && this.component.modalEdit) {\n        this.rebuild();\n      } else {\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this17 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        value = this.defaultValue;\n      }\n\n      if (!Array.isArray(value)) {\n        if (_typeof(value) === 'object') {\n          value = [value];\n        } else {\n          return false;\n        }\n      }\n\n      var changed = this.hasChanged(value, this.dataValue);\n\n      if (this.parent) {\n        this.parent.checkComponentConditions();\n      }\n\n      this.dataValue = value; // Refresh editRow data when data changes.\n\n      this.dataValue.forEach(function (row, rowIndex) {\n        var editRow = _this17.editRows[rowIndex];\n\n        if (editRow) {\n          editRow.data = row;\n\n          _this17.restoreRowContext(editRow, flags);\n\n          editRow.state = EditRowState.Saved;\n          editRow.backup = null;\n          editRow.error = null;\n        } else {\n          _this17.editRows[rowIndex] = {\n            components: _this17.lazyLoad ? [] : _this17.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        }\n      });\n      var dataLength = this.dataValue.length; // If the last row is a new row, then do not remove it.\n\n      if (this.editRows[dataLength] && this.editRows[dataLength].state === EditRowState.New) {\n        dataLength = dataLength + 1;\n      }\n\n      this.editRows.slice(dataLength).forEach(function (editRow, index) {\n        return _this17.baseRemoveRow(dataLength + index);\n      });\n      this.editRows = this.editRows.slice(0, dataLength);\n      this.openWhenEmpty();\n      this.updateOnChange(flags, changed);\n      this.checkData();\n      this.changeState(changed, flags);\n      return changed;\n    }\n  }, {\n    key: \"openWhenEmpty\",\n    value: function openWhenEmpty() {\n      var shouldBeOpened = !this.dataValue.length && this.component.openWhenEmpty;\n      var hasNoRows = !this.editRows.length;\n\n      if (hasNoRows && shouldBeOpened && !this.builderMode) {\n        var dataObj = {};\n        this.createRow(dataObj, 0);\n      }\n    }\n  }, {\n    key: \"restoreRowContext\",\n    value: function restoreRowContext(editRow) {\n      var _this18 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      editRow.components.forEach(function (component) {\n        component.data = editRow.data;\n\n        _this18.setNestedValue(component, editRow.data, flags);\n      });\n    }\n  }, {\n    key: \"emptyRows\",\n    value: function emptyRows() {\n      var _this19 = this;\n\n      this.editRows.forEach(function (editRow, index) {\n        return _this19.destroyComponents(index);\n      });\n      this.editRows = [];\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(EditGridComponent.prototype), \"resetValue\", this).call(this);\n\n      this.emptyRows();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _NestedArrayComponent2.default.schema.apply(_NestedArrayComponent2.default, [{\n        type: 'editgrid',\n        label: 'Edit Grid',\n        key: 'editGrid',\n        clearOnHide: true,\n        input: true,\n        tree: true,\n        removeRow: 'Cancel',\n        defaultOpen: false,\n        openWhenEmpty: false,\n        modal: false,\n        components: [],\n        inlineEdit: false,\n        templates: {\n          header: EditGridComponent.defaultHeaderTemplate,\n          row: EditGridComponent.defaultRowTemplate,\n          tableHeader: EditGridComponent.defaultTableHeaderTemplate,\n          tableRow: EditGridComponent.defaultTableRowTemplate,\n          footer: ''\n        }\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Edit Grid',\n        icon: 'tasks',\n        group: 'data',\n        documentation: '/userguide/#editgrid',\n        weight: 30,\n        schema: EditGridComponent.schema()\n      };\n    }\n  }, {\n    key: \"defaultHeaderTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">{{ t(component.label) }}</div>\\n        {% } %}\\n      {% }) %}\\n    </div>\";\n    }\n  }, {\n    key: \"defaultTableHeaderTemplate\",\n    get: function get() {\n      return \"\\n      <tr>\\n        {% util.eachComponent(components, function(component) { %}\\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\\n            <td class=\\\"editgrid-table-column\\\">{{ component.label }}</td>\\n          {% } %}\\n        {% }) %}\\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\\n          <td class=\\\"editgrid-table-column\\\">Actions</td>\\n        {% } %}\\n      </tr>\\n    \";\n    }\n  }, {\n    key: \"defaultRowTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">\\n            {{ isVisibleInRow(component) ? getView(component, row[component.key]) : ''}}\\n          </div>\\n        {% } %}\\n      {% }) %}\\n      {% if (!instance.options.readOnly && !instance.disabled) { %}\\n        <div class=\\\"col-sm-2\\\">\\n          <div class=\\\"btn-group pull-right\\\">\\n            <button class=\\\"btn btn-default btn-light btn-sm editRow\\\"><i class=\\\"{{ iconClass('edit') }}\\\"></i></button>\\n            {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\\n              <button class=\\\"btn btn-danger btn-sm removeRow\\\"><i class=\\\"{{ iconClass('trash') }}\\\"></i></button>\\n            {% } %}\\n          </div>\\n        </div>\\n      {% } %}\\n    </div>\";\n    }\n  }, {\n    key: \"defaultTableRowTemplate\",\n    get: function get() {\n      return \"\\n      {% util.eachComponent(components, function(component) { %}\\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\\n            <td class=\\\"editgrid-table-column\\\">\\n              {{ getView(component, row[component.key]) }}\\n            </td>\\n          {% } %}\\n        {% }) %}\\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\\n          <td class=\\\"editgrid-table-column\\\">\\n            <div class=\\\"btn-group\\\">\\n              <button class=\\\"btn btn-default btn-light btn-sm editRow\\\" aria-label=\\\"{{ t('Edit row') }}\\\"><i class=\\\"{{ iconClass('edit') }}\\\"></i></button>\\n              {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\\n              <button class=\\\"btn btn-danger btn-sm removeRow\\\" aria-label=\\\"{{ t('Remove row') }}\\\"><i class=\\\"{{ iconClass('trash') }}\\\"></i></button>\\n              {% } %}\\n            </div>\\n          </td>\\n        {% } %}\\n    \";\n    }\n  }]);\n\n  return EditGridComponent;\n}(_NestedArrayComponent2.default);\n\nexports.default = EditGridComponent;\nEditGridComponent.prototype.hasChanged = _Component.default.prototype.hasChanged;"]},"metadata":{},"sourceType":"script"}