{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _exportNames = {\n  evaluate: true,\n  getRandomComponentId: true,\n  getPropertyValue: true,\n  getElementRect: true,\n  boolValue: true,\n  isMongoId: true,\n  checkCalculated: true,\n  checkSimpleConditional: true,\n  checkCustomConditional: true,\n  checkJsonConditional: true,\n  checkCondition: true,\n  checkTrigger: true,\n  setActionProperty: true,\n  unescapeHTML: true,\n  convertStringToHTMLElement: true,\n  uniqueName: true,\n  guid: true,\n  getDateSetting: true,\n  isValidDate: true,\n  currentTimezone: true,\n  offsetDate: true,\n  zonesLoaded: true,\n  shouldLoadZones: true,\n  loadZones: true,\n  momentDate: true,\n  formatDate: true,\n  formatOffset: true,\n  getLocaleDateFormatInfo: true,\n  convertFormatToFlatpickr: true,\n  convertFormatToMoment: true,\n  convertFormatToMask: true,\n  getInputMask: true,\n  unmaskValue: true,\n  matchInputMask: true,\n  getNumberSeparators: true,\n  getNumberDecimalLimit: true,\n  getCurrencyAffixes: true,\n  fieldData: true,\n  delay: true,\n  iterateKey: true,\n  uniqueKey: true,\n  bootstrapVersion: true,\n  unfold: true,\n  firstNonNil: true,\n  withSwitch: true,\n  observeOverload: true,\n  getContextComponents: true,\n  getContextButtons: true,\n  translateHTMLTemplate: true,\n  sanitize: true,\n  fastCloneDeep: true,\n  interpolate: true,\n  isInputComponent: true,\n  getArrayFromComponentPath: true,\n  hasInvalidComponent: true,\n  getStringFromComponentPath: true,\n  round: true,\n  getIEBrowserVersion: true,\n  getBrowserInfo: true,\n  getComponentPathWithoutIndicies: true,\n  getComponentPath: true,\n  getDataParentComponent: true,\n  isPromise: true,\n  isInsideScopingComponent: true,\n  getFocusableElements: true,\n  _: true,\n  jsonLogic: true,\n  moment: true,\n  Evaluator: true\n};\nObject.defineProperty(exports, \"Evaluator\", {\n  enumerable: true,\n  get: function get() {\n    return _Evaluator.default;\n  }\n});\nObject.defineProperty(exports, \"_\", {\n  enumerable: true,\n  get: function get() {\n    return _lodash.default;\n  }\n});\nexports.boolValue = boolValue;\nexports.bootstrapVersion = bootstrapVersion;\nexports.checkCalculated = checkCalculated;\nexports.checkCondition = checkCondition;\nexports.checkCustomConditional = checkCustomConditional;\nexports.checkJsonConditional = checkJsonConditional;\nexports.checkSimpleConditional = checkSimpleConditional;\nexports.checkTrigger = checkTrigger;\nexports.convertFormatToFlatpickr = convertFormatToFlatpickr;\nexports.convertFormatToMask = convertFormatToMask;\nexports.convertFormatToMoment = convertFormatToMoment;\nexports.convertStringToHTMLElement = convertStringToHTMLElement;\nexports.currentTimezone = currentTimezone;\nexports.delay = delay;\nexports.evaluate = evaluate;\nexports.fastCloneDeep = fastCloneDeep;\nexports.fieldData = fieldData;\nexports.firstNonNil = void 0;\nexports.formatDate = formatDate;\nexports.formatOffset = formatOffset;\nexports.getArrayFromComponentPath = getArrayFromComponentPath;\nexports.getBrowserInfo = getBrowserInfo;\nexports.getComponentPath = getComponentPath;\nexports.getComponentPathWithoutIndicies = getComponentPathWithoutIndicies;\nexports.getContextButtons = getContextButtons;\nexports.getContextComponents = getContextComponents;\nexports.getCurrencyAffixes = getCurrencyAffixes;\nexports.getDataParentComponent = getDataParentComponent;\nexports.getDateSetting = getDateSetting;\nexports.getElementRect = getElementRect;\nexports.getFocusableElements = getFocusableElements;\nexports.getIEBrowserVersion = getIEBrowserVersion;\nexports.getInputMask = getInputMask;\nexports.getLocaleDateFormatInfo = getLocaleDateFormatInfo;\nexports.getNumberDecimalLimit = getNumberDecimalLimit;\nexports.getNumberSeparators = getNumberSeparators;\nexports.getPropertyValue = getPropertyValue;\nexports.getRandomComponentId = getRandomComponentId;\nexports.getStringFromComponentPath = getStringFromComponentPath;\nexports.guid = guid;\nexports.hasInvalidComponent = hasInvalidComponent;\nexports.interpolate = void 0;\nexports.isInputComponent = isInputComponent;\nexports.isInsideScopingComponent = isInsideScopingComponent;\nexports.isMongoId = isMongoId;\nexports.isPromise = isPromise;\nexports.isValidDate = isValidDate;\nexports.iterateKey = iterateKey;\nObject.defineProperty(exports, \"jsonLogic\", {\n  enumerable: true,\n  get: function get() {\n    return _jsonLogicJs.default;\n  }\n});\nexports.loadZones = loadZones;\nexports.matchInputMask = matchInputMask;\nObject.defineProperty(exports, \"moment\", {\n  enumerable: true,\n  get: function get() {\n    return _momentTimezone.default;\n  }\n});\nexports.momentDate = momentDate;\nexports.observeOverload = observeOverload;\nexports.offsetDate = offsetDate;\nexports.round = round;\nexports.sanitize = sanitize;\nexports.setActionProperty = setActionProperty;\nexports.shouldLoadZones = shouldLoadZones;\nexports.translateHTMLTemplate = translateHTMLTemplate;\nexports.unescapeHTML = unescapeHTML;\nexports.unfold = unfold;\nexports.uniqueKey = uniqueKey;\nexports.uniqueName = uniqueName;\nexports.unmaskValue = unmaskValue;\nexports.withSwitch = withSwitch;\nexports.zonesLoaded = zonesLoaded;\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.string.starts-with.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.string.trim.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _fetchPonyfill2 = _interopRequireDefault(require(\"fetch-ponyfill\"));\n\nvar _jsonLogicJs = _interopRequireDefault(require(\"json-logic-js\"));\n\nvar _momentTimezone = _interopRequireDefault(require(\"moment-timezone/moment-timezone\"));\n\nvar _jstimezonedetect = _interopRequireDefault(require(\"jstimezonedetect\"));\n\nvar _operators = require(\"./jsonlogic/operators\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _dompurify = _interopRequireDefault(require(\"dompurify\"));\n\nvar _formUtils = require(\"./formUtils\");\n\nObject.keys(_formUtils).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  if (key in exports && exports[key] === _formUtils[key]) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _formUtils[key];\n    }\n  });\n});\n\nvar _Evaluator = _interopRequireDefault(require(\"./Evaluator\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar interpolate = _Evaluator.default.interpolate;\nexports.interpolate = interpolate;\n\nvar _fetchPonyfill = (0, _fetchPonyfill2.default)({\n  Promise: _nativePromiseOnly.default\n}),\n    fetch = _fetchPonyfill.fetch; // Configure JsonLogic\n\n\n_operators.lodashOperators.forEach(function (name) {\n  return _jsonLogicJs.default.add_operation(\"_\".concat(name), _lodash.default[name]);\n}); // Retrieve Any Date\n\n\n_jsonLogicJs.default.add_operation('getDate', function (date) {\n  return (0, _momentTimezone.default)(date).toISOString();\n}); // Set Relative Minimum Date\n\n\n_jsonLogicJs.default.add_operation('relativeMinDate', function (relativeMinDate) {\n  return (0, _momentTimezone.default)().subtract(relativeMinDate, 'days').toISOString();\n}); // Set Relative Maximum Date\n\n\n_jsonLogicJs.default.add_operation('relativeMaxDate', function (relativeMaxDate) {\n  return (0, _momentTimezone.default)().add(relativeMaxDate, 'days').toISOString();\n});\n\nfunction setPathToComponentAndPerentSchema(component) {\n  component.path = getComponentPath(component);\n  var dataParent = getDataParentComponent(component);\n\n  if (dataParent && _typeof(dataParent) === 'object') {\n    dataParent.path = getComponentPath(dataParent);\n  }\n}\n/**\n * Evaluate a method.\n *\n * @param func\n * @param args\n * @return {*}\n */\n\n\nfunction evaluate(func, args, ret, tokenize) {\n  var returnVal = null;\n  var component = args.component ? args.component : {\n    key: 'unknown'\n  };\n\n  if (!args.form && args.instance) {\n    args.form = _lodash.default.get(args.instance, 'root._form', {});\n  }\n\n  var componentKey = component.key;\n\n  if (typeof func === 'string') {\n    if (ret) {\n      func += \";return \".concat(ret);\n    }\n\n    if (tokenize) {\n      // Replace all {{ }} references with actual data.\n      func = func.replace(/({{\\s+(.*)\\s+}})/, function (match, $1, $2) {\n        if ($2.indexOf('data.') === 0) {\n          return _lodash.default.get(args.data, $2.replace('data.', ''));\n        } else if ($2.indexOf('row.') === 0) {\n          return _lodash.default.get(args.row, $2.replace('row.', ''));\n        } // Support legacy...\n\n\n        return _lodash.default.get(args.data, $2);\n      });\n    }\n\n    try {\n      func = _Evaluator.default.evaluator(func, args);\n      args = _lodash.default.values(args);\n    } catch (err) {\n      console.warn(\"An error occured within the custom function for \".concat(componentKey), err);\n      returnVal = null;\n      func = false;\n    }\n  }\n\n  if (typeof func === 'function') {\n    try {\n      returnVal = _Evaluator.default.evaluate(func, args);\n    } catch (err) {\n      returnVal = null;\n      console.warn(\"An error occured within custom function for \".concat(componentKey), err);\n    }\n  } else if (_typeof(func) === 'object') {\n    try {\n      returnVal = _jsonLogicJs.default.apply(func, args);\n    } catch (err) {\n      returnVal = null;\n      console.warn(\"An error occured within custom function for \".concat(componentKey), err);\n    }\n  } else if (func) {\n    console.warn(\"Unknown function type for \".concat(componentKey));\n  }\n\n  return returnVal;\n}\n\nfunction getRandomComponentId() {\n  return \"e\".concat(Math.random().toString(36).substring(7));\n}\n/**\n * Get a property value of an element.\n *\n * @param style\n * @param prop\n * @return {number}\n */\n\n\nfunction getPropertyValue(style, prop) {\n  var value = style.getPropertyValue(prop);\n  value = value ? value.replace(/[^0-9.]/g, '') : '0';\n  return parseFloat(value);\n}\n/**\n * Get an elements bounding rectagle.\n *\n * @param element\n * @return {{x: string, y: string, width: string, height: string}}\n */\n\n\nfunction getElementRect(element) {\n  var style = window.getComputedStyle(element, null);\n  return {\n    x: getPropertyValue(style, 'left'),\n    y: getPropertyValue(style, 'top'),\n    width: getPropertyValue(style, 'width'),\n    height: getPropertyValue(style, 'height')\n  };\n}\n/**\n * Determines the boolean value of a setting.\n *\n * @param value\n * @return {boolean}\n */\n\n\nfunction boolValue(value) {\n  if (_lodash.default.isBoolean(value)) {\n    return value;\n  } else if (_lodash.default.isString(value)) {\n    return value.toLowerCase() === 'true';\n  } else {\n    return !!value;\n  }\n}\n/**\n * Check to see if an ID is a mongoID.\n * @param text\n * @return {Array|{index: number, input: string}|Boolean|*}\n */\n\n\nfunction isMongoId(text) {\n  return text.toString().match(/^[0-9a-fA-F]{24}$/);\n}\n/**\n * Checks the calculated value for a provided component and data.\n *\n * @param {Object} component\n *   The component to check for the calculated value.\n * @param {Object} submission\n *   A submission object.\n * @param data\n *   The full submission data.\n */\n\n\nfunction checkCalculated(component, submission, rowData) {\n  // Process calculated value stuff if present.\n  if (component.calculateValue) {\n    _lodash.default.set(rowData, component.key, evaluate(component.calculateValue, {\n      value: undefined,\n      data: submission ? submission.data : rowData,\n      row: rowData,\n      util: this,\n      component: component\n    }, 'value'));\n  }\n}\n/**\n * Check if a simple conditional evaluates to true.\n *\n * @param condition\n * @param condition\n * @param row\n * @param data\n * @returns {boolean}\n */\n\n\nfunction checkSimpleConditional(component, condition, row, data) {\n  var value = null;\n\n  if (row) {\n    value = (0, _formUtils.getValue)({\n      data: row\n    }, condition.when);\n  }\n\n  if (data && _lodash.default.isNil(value)) {\n    value = (0, _formUtils.getValue)({\n      data: data\n    }, condition.when);\n  } // FOR-400 - Fix issue where falsey values were being evaluated as show=true\n\n\n  if (_lodash.default.isNil(value)) {\n    value = '';\n  }\n\n  var eq = String(condition.eq);\n  var show = String(condition.show); // Special check for selectboxes component.\n\n  if (_lodash.default.isObject(value) && _lodash.default.has(value, condition.eq)) {\n    return String(value[condition.eq]) === show;\n  } // FOR-179 - Check for multiple values.\n\n\n  if (Array.isArray(value) && value.map(String).includes(eq)) {\n    return show === 'true';\n  }\n\n  return String(value) === eq === (show === 'true');\n}\n/**\n * Check custom javascript conditional.\n *\n * @param component\n * @param custom\n * @param row\n * @param data\n * @returns {*}\n */\n\n\nfunction checkCustomConditional(component, custom, row, data, form, variable, onError, instance) {\n  if (typeof custom === 'string') {\n    custom = \"var \".concat(variable, \" = true; \").concat(custom, \"; return \").concat(variable, \";\");\n  }\n\n  var value = instance && instance.evaluate ? instance.evaluate(custom, {\n    row: row,\n    data: data,\n    form: form\n  }) : evaluate(custom, {\n    row: row,\n    data: data,\n    form: form\n  });\n\n  if (value === null) {\n    return onError;\n  }\n\n  return value;\n}\n\nfunction checkJsonConditional(component, json, row, data, form, onError) {\n  try {\n    return _jsonLogicJs.default.apply(json, {\n      data: data,\n      row: row,\n      form: form,\n      _: _lodash.default\n    });\n  } catch (err) {\n    console.warn(\"An error occurred in jsonLogic advanced condition for \".concat(component.key), err);\n    return onError;\n  }\n}\n\nfunction getRow(component, row, instance, conditional) {\n  var _condition$when;\n\n  var condition = conditional || component.conditional; // If no component's instance passed (happens only in 6.x server), calculate its path based on the schema\n\n  if (!instance) {\n    instance = _lodash.default.cloneDeep(component);\n    setPathToComponentAndPerentSchema(instance);\n  }\n\n  var dataParent = getDataParentComponent(instance);\n  var parentPath = dataParent ? getComponentPath(dataParent) : null;\n\n  if (dataParent && (_condition$when = condition.when) !== null && _condition$when !== void 0 && _condition$when.startsWith(parentPath)) {\n    var newRow = {};\n\n    _lodash.default.set(newRow, parentPath, row);\n\n    row = newRow;\n  }\n\n  return row;\n}\n/**\n * Checks the conditions for a provided component and data.\n *\n * @param component\n *   The component to check for the condition.\n * @param row\n *   The data within a row\n * @param data\n *   The full submission data.\n *\n * @returns {boolean}\n */\n\n\nfunction checkCondition(component, row, data, form, instance) {\n  var customConditional = component.customConditional,\n      conditional = component.conditional;\n\n  if (customConditional) {\n    return checkCustomConditional(component, customConditional, row, data, form, 'show', true, instance);\n  } else if (conditional && conditional.when) {\n    row = getRow(component, row, instance);\n    return checkSimpleConditional(component, conditional, row, data);\n  } else if (conditional && conditional.json) {\n    return checkJsonConditional(component, conditional.json, row, data, form, true);\n  } // Default to show.\n\n\n  return true;\n}\n/**\n * Test a trigger on a component.\n *\n * @param component\n * @param action\n * @param data\n * @param row\n * @returns {mixed}\n */\n\n\nfunction checkTrigger(component, trigger, row, data, form, instance) {\n  // If trigger is empty, don't fire it\n  if (!trigger[trigger.type]) {\n    return false;\n  }\n\n  switch (trigger.type) {\n    case 'simple':\n      row = getRow(component, row, instance, trigger.simple);\n      return checkSimpleConditional(component, trigger.simple, row, data);\n\n    case 'javascript':\n      return checkCustomConditional(component, trigger.javascript, row, data, form, 'result', false, instance);\n\n    case 'json':\n      return checkJsonConditional(component, trigger.json, row, data, form, false);\n  } // If none of the types matched, don't fire the trigger.\n\n\n  return false;\n}\n\nfunction setActionProperty(component, action, result, row, data, instance) {\n  var property = action.property.value;\n\n  switch (action.property.type) {\n    case 'boolean':\n      {\n        var currentValue = _lodash.default.get(component, property, false).toString();\n\n        var newValue = action.state.toString();\n\n        if (currentValue !== newValue) {\n          _lodash.default.set(component, property, newValue === 'true');\n        }\n\n        break;\n      }\n\n    case 'string':\n      {\n        var evalData = {\n          data: data,\n          row: row,\n          component: component,\n          result: result\n        };\n        var textValue = action.property.component ? action[action.property.component] : action.text;\n\n        var _currentValue = _lodash.default.get(component, property, '');\n\n        var _newValue = instance && instance.interpolate ? instance.interpolate(textValue, evalData) : _Evaluator.default.interpolate(textValue, evalData);\n\n        if (_newValue !== _currentValue) {\n          _lodash.default.set(component, property, _newValue);\n        }\n\n        break;\n      }\n  }\n\n  return component;\n}\n/**\n * Unescape HTML characters like &lt, &gt, &amp and etc.\n * @param str\n * @returns {string}\n */\n\n\nfunction unescapeHTML(str) {\n  if (typeof window === 'undefined' || !('DOMParser' in window)) {\n    return str;\n  }\n\n  var doc = new window.DOMParser().parseFromString(str, 'text/html');\n  return doc.documentElement.textContent;\n}\n/**\n * Make HTML element from string\n * @param str\n * @param selector\n * @returns {HTMLElement}\n */\n\n\nfunction convertStringToHTMLElement(str, selector) {\n  var doc = new window.DOMParser().parseFromString(str, 'text/html');\n  return doc.body.querySelector(selector);\n}\n/**\n * Make a filename guaranteed to be unique.\n * @param name\n * @param template\n * @param evalContext\n * @returns {string}\n */\n\n\nfunction uniqueName(name, template, evalContext) {\n  template = template || '{{fileName}}-{{guid}}'; //include guid in template anyway, to prevent overwriting issue if filename matches existing file\n\n  if (!template.includes('{{guid}}')) {\n    template = \"\".concat(template, \"-{{guid}}\");\n  }\n\n  var parts = name.split('.');\n  var fileName = parts.slice(0, parts.length - 1).join('.');\n  var extension = parts.length > 1 ? \".\".concat(_lodash.default.last(parts)) : ''; //allow only 100 characters from original name to avoid issues with filename length restrictions\n\n  fileName = fileName.substr(0, 100);\n  evalContext = Object.assign(evalContext || {}, {\n    fileName: fileName,\n    guid: guid()\n  }); //only letters, numbers, dots, dashes, underscores and spaces are allowed. Anything else will be replaced with dash\n\n  var uniqueName = \"\".concat(_Evaluator.default.interpolate(template, evalContext)).concat(extension).replace(/[^0-9a-zA-Z.\\-_ ]/g, '-');\n  return uniqueName;\n}\n\nfunction guid() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n/**\n * Return a translated date setting.\n *\n * @param date\n * @return {(null|Date)}\n */\n\n\nfunction getDateSetting(date) {\n  if (_lodash.default.isNil(date) || _lodash.default.isNaN(date) || date === '') {\n    return null;\n  }\n\n  if (date instanceof Date) {\n    return date;\n  } else if (typeof date.toDate === 'function') {\n    return date.isValid() ? date.toDate() : null;\n  }\n\n  var dateSetting = typeof date !== 'string' || date.indexOf('moment(') === -1 ? (0, _momentTimezone.default)(date) : null;\n\n  if (dateSetting && dateSetting.isValid()) {\n    return dateSetting.toDate();\n  }\n\n  dateSetting = null;\n\n  try {\n    var value = _Evaluator.default.evaluator(\"return \".concat(date, \";\"), 'moment')(_momentTimezone.default);\n\n    if (typeof value === 'string') {\n      dateSetting = (0, _momentTimezone.default)(value);\n    } else if (typeof value.toDate === 'function') {\n      dateSetting = (0, _momentTimezone.default)(value.toDate().toUTCString());\n    } else if (value instanceof Date) {\n      dateSetting = (0, _momentTimezone.default)(value);\n    }\n  } catch (e) {\n    return null;\n  }\n\n  if (!dateSetting) {\n    return null;\n  } // Ensure this is a date.\n\n\n  if (!dateSetting.isValid()) {\n    return null;\n  }\n\n  return dateSetting.toDate();\n}\n\nfunction isValidDate(date) {\n  return _lodash.default.isDate(date) && !_lodash.default.isNaN(date.getDate());\n}\n/**\n * Get the current timezone string.\n *\n * @return {string}\n */\n\n\nfunction currentTimezone() {\n  if (_momentTimezone.default.currentTimezone) {\n    return _momentTimezone.default.currentTimezone;\n  }\n\n  _momentTimezone.default.currentTimezone = _jstimezonedetect.default.determine().name();\n  return _momentTimezone.default.currentTimezone;\n}\n/**\n * Get an offset date provided a date object and timezone object.\n *\n * @param date\n * @param timezone\n * @return {Date}\n */\n\n\nfunction offsetDate(date, timezone) {\n  if (timezone === 'UTC') {\n    return {\n      date: new Date(date.getTime() + date.getTimezoneOffset() * 60000),\n      abbr: 'UTC'\n    };\n  }\n\n  var dateMoment = (0, _momentTimezone.default)(date).tz(timezone);\n  return {\n    date: new Date(date.getTime() + (dateMoment.utcOffset() + date.getTimezoneOffset()) * 60000),\n    abbr: dateMoment.format('z')\n  };\n}\n/**\n * Returns if the zones are loaded.\n *\n * @return {boolean}\n */\n\n\nfunction zonesLoaded() {\n  return _momentTimezone.default.zonesLoaded;\n}\n/**\n * Returns if we should load the zones.\n *\n * @param timezone\n * @return {boolean}\n */\n\n\nfunction shouldLoadZones(timezone) {\n  if (timezone === currentTimezone() || timezone === 'UTC') {\n    return false;\n  }\n\n  return true;\n}\n/**\n * Externally load the timezone data.\n *\n * @return {Promise<any> | *}\n */\n\n\nfunction loadZones(timezone) {\n  if (timezone && !shouldLoadZones(timezone)) {\n    // Return non-resolving promise.\n    return new _nativePromiseOnly.default(_lodash.default.noop);\n  }\n\n  if (_momentTimezone.default.zonesPromise) {\n    return _momentTimezone.default.zonesPromise;\n  }\n\n  return _momentTimezone.default.zonesPromise = fetch('https://cdn.form.io/moment-timezone/data/packed/latest.json').then(function (resp) {\n    return resp.json().then(function (zones) {\n      _momentTimezone.default.tz.load(zones);\n\n      _momentTimezone.default.zonesLoaded = true; // Trigger a global event that the timezones have finished loading.\n\n      if (document && document.createEvent && document.body && document.body.dispatchEvent) {\n        var event = document.createEvent('Event');\n        event.initEvent('zonesLoaded', true, true);\n        document.body.dispatchEvent(event);\n      }\n    });\n  });\n}\n/**\n * Get the moment date object for translating dates with timezones.\n *\n * @param value\n * @param format\n * @param timezone\n * @return {*}\n */\n\n\nfunction momentDate(value, format, timezone) {\n  var momentDate = (0, _momentTimezone.default)(value);\n\n  if (timezone === 'UTC') {\n    timezone = 'Etc/UTC';\n  }\n\n  if ((timezone !== currentTimezone() || format && format.match(/\\s(z$|z\\s)/)) && _momentTimezone.default.zonesLoaded) {\n    return momentDate.tz(timezone);\n  }\n\n  return momentDate;\n}\n/**\n * Format a date provided a value, format, and timezone object.\n *\n * @param value\n * @param format\n * @param timezone\n * @return {string}\n */\n\n\nfunction formatDate(value, format, timezone, flatPickrInputFormat) {\n  var momentDate = (0, _momentTimezone.default)(value, flatPickrInputFormat || undefined);\n\n  if (timezone === currentTimezone()) {\n    // See if our format contains a \"z\" timezone character.\n    if (format.match(/\\s(z$|z\\s)/)) {\n      loadZones();\n\n      if (_momentTimezone.default.zonesLoaded) {\n        return momentDate.tz(timezone).format(convertFormatToMoment(format));\n      } else {\n        return momentDate.format(convertFormatToMoment(format.replace(/\\s(z$|z\\s)/, '')));\n      }\n    } // Return the standard format.\n\n\n    return momentDate.format(convertFormatToMoment(format));\n  }\n\n  if (timezone === 'UTC') {\n    var offset = offsetDate(momentDate.toDate(), 'UTC');\n    return \"\".concat((0, _momentTimezone.default)(offset.date).format(convertFormatToMoment(format)), \" UTC\");\n  } // Load the zones since we need timezone information.\n\n\n  loadZones();\n\n  if (_momentTimezone.default.zonesLoaded && timezone) {\n    return momentDate.tz(timezone).format(\"\".concat(convertFormatToMoment(format), \" z\"));\n  } else {\n    return momentDate.format(convertFormatToMoment(format));\n  }\n}\n/**\n * Pass a format function to format within a timezone.\n *\n * @param formatFn\n * @param date\n * @param format\n * @param timezone\n * @return {string}\n */\n\n\nfunction formatOffset(formatFn, date, format, timezone) {\n  if (timezone === currentTimezone()) {\n    return formatFn(date, format);\n  }\n\n  if (timezone === 'UTC') {\n    return \"\".concat(formatFn(offsetDate(date, 'UTC').date, format), \" UTC\");\n  } // Load the zones since we need timezone information.\n\n\n  loadZones();\n\n  if (_momentTimezone.default.zonesLoaded) {\n    var offset = offsetDate(date, timezone);\n    return \"\".concat(formatFn(offset.date, format), \" \").concat(offset.abbr);\n  } else {\n    return formatFn(date, format);\n  }\n}\n\nfunction getLocaleDateFormatInfo(locale) {\n  var formatInfo = {};\n  var day = 21;\n  var exampleDate = new Date(2017, 11, day);\n  var localDateString = exampleDate.toLocaleDateString(locale);\n  formatInfo.dayFirst = localDateString.slice(0, 2) === day.toString();\n  return formatInfo;\n}\n/**\n * Convert the format from the angular-datepicker module to flatpickr format.\n * @param format\n * @return {string}\n */\n\n\nfunction convertFormatToFlatpickr(format) {\n  return format // Remove the Z timezone offset, not supported by flatpickr.\n  .replace(/Z/g, '') // Year conversion.\n  .replace(/y/g, 'Y').replace('YYYY', 'Y').replace('YY', 'y') // Month conversion.\n  .replace('MMMM', 'F').replace(/M/g, 'n').replace('nnn', 'M').replace('nn', 'm') // Day in month.\n  .replace(/d/g, 'j').replace(/jj/g, 'd') // Day in week.\n  .replace('EEEE', 'l').replace('EEE', 'D') // Hours, minutes, seconds\n  .replace('HH', 'H').replace('hh', 'G').replace('mm', 'i').replace('ss', 'S').replace(/a/g, 'K');\n}\n/**\n * Convert the format from the angular-datepicker module to moment format.\n * @param format\n * @return {string}\n */\n\n\nfunction convertFormatToMoment(format) {\n  return format // Year conversion.\n  .replace(/y/g, 'Y') // Day in month.\n  .replace(/d/g, 'D') // Day in week.\n  .replace(/E/g, 'd') // AM/PM marker\n  .replace(/a/g, 'A') // Unix Timestamp\n  .replace(/U/g, 'X');\n}\n\nfunction convertFormatToMask(format) {\n  return format // Long month replacement.\n  .replace(/M{4}/g, 'MM') // Initial short month conversion.\n  .replace(/M{3}/g, '***') // Short month conversion if input as text.\n  .replace(/e/g, 'Q') // Year conversion.\n  .replace(/[ydhmsHMG]/g, '9') // AM/PM conversion.\n  .replace(/a/g, 'AA');\n}\n/**\n * Returns an input mask that is compatible with the input mask library.\n * @param {string} mask - The Form.io input mask.\n * @param {string} placeholderChar - Char which is used as a placeholder.\n * @returns {Array} - The input mask for the mask library.\n */\n\n\nfunction getInputMask(mask, placeholderChar) {\n  if (mask instanceof Array) {\n    return mask;\n  }\n\n  var maskArray = [];\n  maskArray.numeric = true;\n\n  for (var i = 0; i < mask.length; i++) {\n    switch (mask[i]) {\n      case '9':\n        maskArray.push(/\\d/);\n        break;\n\n      case 'A':\n        maskArray.numeric = false;\n        maskArray.push(/[a-zA-Z]/);\n        break;\n\n      case 'a':\n        maskArray.numeric = false;\n        maskArray.push(/[a-z]/);\n        break;\n\n      case '*':\n        maskArray.numeric = false;\n        maskArray.push(/[a-zA-Z0-9]/);\n        break;\n      // If char which is used inside mask placeholder was used in the mask, replace it with space to prevent errors\n\n      case placeholderChar:\n        maskArray.numeric = false;\n        maskArray.push(' ');\n        break;\n\n      default:\n        maskArray.numeric = false;\n        maskArray.push(mask[i]);\n        break;\n    }\n  }\n\n  return maskArray;\n}\n\nfunction unmaskValue(value, mask, placeholderChar) {\n  if (!mask || !value || value.length > mask.length) {\n    return value;\n  }\n\n  var unmaskedValue = value.split('');\n\n  for (var i = 0; i < mask.length; i++) {\n    var char = value[i] || '';\n    var charPart = mask[i];\n\n    if (!_lodash.default.isRegExp(charPart) && char === charPart) {\n      unmaskedValue[i] = '';\n    }\n  }\n\n  unmaskedValue = unmaskedValue.join('').replace(placeholderChar, '');\n  return unmaskedValue;\n}\n\nfunction matchInputMask(value, inputMask) {\n  if (!inputMask) {\n    return true;\n  } // If value is longer than mask, it isn't valid.\n\n\n  if (value.length > inputMask.length) {\n    return false;\n  }\n\n  for (var i = 0; i < inputMask.length; i++) {\n    var char = value[i] || '';\n    var charPart = inputMask[i];\n\n    if (!(_lodash.default.isRegExp(charPart) && charPart.test(char) || charPart === char)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction getNumberSeparators() {\n  var lang = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'en';\n  var formattedNumberString = 12345.6789.toLocaleString(lang);\n  var delimeters = formattedNumberString.match(/..(.)...(.)../);\n\n  if (!delimeters) {\n    return {\n      delimiter: ',',\n      decimalSeparator: '.'\n    };\n  }\n\n  return {\n    delimiter: delimeters.length > 1 ? delimeters[1] : ',',\n    decimalSeparator: delimeters.length > 2 ? delimeters[2] : '.'\n  };\n}\n\nfunction getNumberDecimalLimit(component, defaultLimit) {\n  if (_lodash.default.has(component, 'decimalLimit')) {\n    return _lodash.default.get(component, 'decimalLimit');\n  } // Determine the decimal limit. Defaults to 20 but can be overridden by validate.step or decimalLimit settings.\n\n\n  var decimalLimit = defaultLimit || 20;\n\n  var step = _lodash.default.get(component, 'validate.step', 'any');\n\n  if (step !== 'any') {\n    var parts = step.toString().split('.');\n\n    if (parts.length > 1) {\n      decimalLimit = parts[1].length;\n    }\n  }\n\n  return decimalLimit;\n}\n\nfunction getCurrencyAffixes(_ref) {\n  var _ref$currency = _ref.currency,\n      currency = _ref$currency === void 0 ? 'USD' : _ref$currency,\n      decimalLimit = _ref.decimalLimit,\n      decimalSeparator = _ref.decimalSeparator,\n      lang = _ref.lang; // Get the prefix and suffix from the localized string.\n\n  var regex = \"(.*)?\".concat(100 .toLocaleString(lang));\n\n  if (decimalLimit) {\n    regex += \"\".concat(decimalSeparator === '.' ? '\\\\.' : decimalSeparator).concat(0 .toLocaleString(lang), \"{\").concat(decimalLimit, \"}\");\n  }\n\n  regex += '(.*)?';\n  var parts = 100 .toLocaleString(lang, {\n    style: 'currency',\n    currency: currency,\n    useGrouping: true,\n    maximumFractionDigits: decimalLimit || 0,\n    minimumFractionDigits: decimalLimit || 0\n  }).replace('.', decimalSeparator).match(new RegExp(regex));\n  return {\n    prefix: (parts === null || parts === void 0 ? void 0 : parts[1]) || '',\n    suffix: (parts === null || parts === void 0 ? void 0 : parts[2]) || ''\n  };\n}\n/**\n * Fetch the field data provided a component.\n *\n * @param data\n * @param component\n * @return {*}\n */\n\n\nfunction fieldData(data, component) {\n  if (!data) {\n    return '';\n  }\n\n  if (!component || !component.key) {\n    return data;\n  }\n\n  if (component.key.includes('.')) {\n    var value = data;\n    var parts = component.key.split('.');\n    var key = '';\n\n    for (var i = 0; i < parts.length; i++) {\n      key = parts[i]; // Handle nested resources\n\n      if (value.hasOwnProperty('_id')) {\n        value = value.data;\n      } // Return if the key is not found on the value.\n\n\n      if (!value.hasOwnProperty(key)) {\n        return;\n      } // Convert old single field data in submissions to multiple\n\n\n      if (key === parts[parts.length - 1] && component.multiple && !Array.isArray(value[key])) {\n        value[key] = [value[key]];\n      } // Set the value of this key.\n\n\n      value = value[key];\n    }\n\n    return value;\n  } else {\n    // Convert old single field data in submissions to multiple\n    if (component.multiple && !Array.isArray(data[component.key])) {\n      data[component.key] = [data[component.key]];\n    } // Fix for checkbox type radio submission values in tableView\n\n\n    if (component.type === 'checkbox' && component.inputType === 'radio') {\n      return data[component.name] === component.value;\n    }\n\n    return data[component.key];\n  }\n}\n/**\n * Delays function execution with possibility to execute function synchronously or cancel it.\n *\n * @param fn Function to delay\n * @param delay Delay time\n * @return {*}\n */\n\n\nfunction delay(fn) {\n  var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  var timer = setTimeout.apply(void 0, [fn, delay].concat(args));\n\n  function cancel() {\n    clearTimeout(timer);\n  }\n\n  function earlyCall() {\n    cancel();\n    return fn.apply(void 0, args);\n  }\n\n  earlyCall.timer = timer;\n  earlyCall.cancel = cancel;\n  return earlyCall;\n}\n/**\n * Iterate the given key to make it unique.\n *\n * @param {String} key\n *   Modify the component key to be unique.\n *\n * @returns {String}\n *   The new component key.\n */\n\n\nfunction iterateKey(key) {\n  if (!key.match(/(\\d+)$/)) {\n    return \"\".concat(key, \"1\");\n  }\n\n  return key.replace(/(\\d+)$/, function (suffix) {\n    return Number(suffix) + 1;\n  });\n}\n/**\n * Determines a unique key within a map provided the base key.\n *\n * @param map\n * @param base\n * @return {*}\n */\n\n\nfunction uniqueKey(map, base) {\n  var newKey = base;\n\n  while (map.hasOwnProperty(newKey)) {\n    newKey = iterateKey(newKey);\n  }\n\n  return newKey;\n}\n/**\n * Determines the major version number of bootstrap.\n *\n * @return {number}\n */\n\n\nfunction bootstrapVersion(options) {\n  if (options.bootstrap) {\n    return options.bootstrap;\n  }\n\n  if (typeof $ === 'function' && typeof $().collapse === 'function') {\n    return parseInt($.fn.collapse.Constructor.VERSION.split('.')[0], 10);\n  }\n\n  return 0;\n}\n/**\n * Retrun provided argument.\n * If argument is a function, returns the result of a function call.\n * @param {*} e;\n *\n * @return {*}\n */\n\n\nfunction unfold(e) {\n  if (typeof e === 'function') {\n    return e();\n  }\n\n  return e;\n}\n/**\n * Map values through unfold and return first non-nil value.\n * @param {Array<T>} collection;\n *\n * @return {T}\n */\n\n\nvar firstNonNil = _lodash.default.flow([_lodash.default.partialRight(_lodash.default.map, unfold), _lodash.default.partialRight(_lodash.default.find, function (v) {\n  return !_lodash.default.isUndefined(v);\n})]);\n/*\n * Create enclosed state.\n * Returns functions to getting and cycling between states.\n * @param {*} a - initial state.\n * @param {*} b - next state.\n * @return {Functions[]} -- [get, toggle];\n */\n\n\nexports.firstNonNil = firstNonNil;\n\nfunction withSwitch(a, b) {\n  var state = a;\n  var next = b;\n\n  function get() {\n    return state;\n  }\n\n  function toggle() {\n    var prev = state;\n    state = next;\n    next = prev;\n  }\n\n  return [get, toggle];\n}\n\nfunction observeOverload(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _options$limit = options.limit,\n      limit = _options$limit === void 0 ? 50 : _options$limit,\n      _options$delay = options.delay,\n      delay = _options$delay === void 0 ? 500 : _options$delay;\n  var callCount = 0;\n  var timeoutID = 0;\n\n  var reset = function reset() {\n    return callCount = 0;\n  };\n\n  return function () {\n    if (timeoutID !== 0) {\n      clearTimeout(timeoutID);\n      timeoutID = 0;\n    }\n\n    timeoutID = setTimeout(reset, delay);\n    callCount += 1;\n\n    if (callCount >= limit) {\n      clearTimeout(timeoutID);\n      reset();\n      return callback();\n    }\n  };\n}\n\nfunction getContextComponents(context) {\n  var values = [];\n  context.utils.eachComponent(context.instance.options.editForm.components, function (component, path) {\n    if (component.key !== context.data.key) {\n      values.push({\n        label: \"\".concat(component.label || component.key, \" (\").concat(path, \")\"),\n        value: path\n      });\n    }\n  });\n  return values;\n}\n\nfunction getContextButtons(context) {\n  var values = [];\n  context.utils.eachComponent(context.instance.options.editForm.components, function (component) {\n    if (component.type === 'button') {\n      values.push({\n        label: \"\".concat(component.key, \" (\").concat(component.label, \")\"),\n        value: component.key\n      });\n    }\n  });\n  return values;\n} // Tags that could be in text, that should be ommited or handled in a special way\n\n\nvar inTextTags = ['#text', 'A', 'B', 'EM', 'I', 'SMALL', 'STRONG', 'SUB', 'SUP', 'INS', 'DEL', 'MARK', 'CODE'];\n/**\n * Helper function for 'translateHTMLTemplate'. Translates text value of the passed html element.\n *\n * @param {HTMLElement} elem\n * @param {Function} translate\n *\n * @returns {String}\n *   Translated element template.\n */\n\nfunction translateElemValue(elem, translate) {\n  if (!elem.innerText) {\n    return elem.innerHTML;\n  }\n\n  var elemValue = elem.innerText.replace(_Evaluator.default.templateSettings.interpolate, '').replace(/\\s\\s+/g, ' ').trim();\n  var translatedValue = translate(elemValue);\n\n  if (elemValue !== translatedValue) {\n    var links = elem.innerHTML.match(/<a[^>]*>(.*?)<\\/a>/g);\n\n    if (links && links.length) {\n      if (links.length === 1 && links[0].length === elem.innerHTML.length) {\n        return elem.innerHTML.replace(elemValue, translatedValue);\n      }\n\n      var translatedLinks = links.map(function (link) {\n        var linkElem = document.createElement('a');\n        linkElem.innerHTML = link;\n        return translateElemValue(linkElem, translate);\n      });\n      return \"\".concat(translatedValue, \" (\").concat(translatedLinks.join(', '), \")\");\n    } else {\n      return elem.innerText.replace(elemValue, translatedValue);\n    }\n  } else {\n    return elem.innerHTML;\n  }\n}\n/**\n * Helper function for 'translateHTMLTemplate'. Goes deep through html tag children and calls function to translate their text values.\n *\n * @param {HTMLElement} tag\n * @param {Function} translate\n *\n * @returns {void}\n */\n\n\nfunction translateDeepTag(tag, translate) {\n  var children = tag.children.length && _toConsumableArray(tag.children);\n\n  var shouldTranslateEntireContent = children && children.every(function (child) {\n    return child.children.length === 0 && inTextTags.some(function (tag) {\n      return child.nodeName === tag;\n    });\n  });\n\n  if (!children || shouldTranslateEntireContent) {\n    tag.innerHTML = translateElemValue(tag, translate);\n  } else {\n    children.forEach(function (child) {\n      return translateDeepTag(child, translate);\n    });\n  }\n}\n/**\n * Translates text values in html template.\n *\n * @param {String} template\n * @param {Function} translate\n *\n * @returns {String}\n *   Html template with translated values.\n */\n\n\nfunction translateHTMLTemplate(template, translate) {\n  var isHTML = /<[^>]*>/.test(template);\n\n  if (!isHTML) {\n    return translate(template);\n  }\n\n  var tempElem = document.createElement('div');\n  tempElem.innerHTML = template;\n\n  if (tempElem.innerText && tempElem.children.length) {\n    translateDeepTag(tempElem, translate);\n    return tempElem.innerHTML;\n  }\n\n  return template;\n}\n/**\n * Sanitize an html string.\n *\n * @param string\n * @returns {*}\n */\n\n\nfunction sanitize(string, options) {\n  if (typeof _dompurify.default.sanitize !== 'function') {\n    return string;\n  } // Dompurify configuration\n\n\n  var sanitizeOptions = {\n    ADD_ATTR: ['ref', 'target'],\n    USE_PROFILES: {\n      html: true\n    }\n  }; // Add attrs\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.addAttr) && options.sanitizeConfig.addAttr.length > 0) {\n    options.sanitizeConfig.addAttr.forEach(function (attr) {\n      sanitizeOptions.ADD_ATTR.push(attr);\n    });\n  } // Add tags\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.addTags) && options.sanitizeConfig.addTags.length > 0) {\n    sanitizeOptions.ADD_TAGS = options.sanitizeConfig.addTags;\n  } // Allow tags\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.allowedTags) && options.sanitizeConfig.allowedTags.length > 0) {\n    sanitizeOptions.ALLOWED_TAGS = options.sanitizeConfig.allowedTags;\n  } // Allow attributes\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.allowedAttrs) && options.sanitizeConfig.allowedAttrs.length > 0) {\n    sanitizeOptions.ALLOWED_ATTR = options.sanitizeConfig.allowedAttrs;\n  } // Allowd URI Regex\n\n\n  if (options.sanitizeConfig && options.sanitizeConfig.allowedUriRegex) {\n    sanitizeOptions.ALLOWED_URI_REGEXP = options.sanitizeConfig.allowedUriRegex;\n  } // Allow to extend the existing array of elements that are safe for URI-like values\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.addUriSafeAttr) && options.sanitizeConfig.addUriSafeAttr.length > 0) {\n    sanitizeOptions.ADD_URI_SAFE_ATTR = options.sanitizeConfig.addUriSafeAttr;\n  }\n\n  return _dompurify.default.sanitize(string, sanitizeOptions);\n}\n/**\n * Fast cloneDeep for JSON objects only.\n */\n\n\nfunction fastCloneDeep(obj) {\n  return obj ? JSON.parse(JSON.stringify(obj)) : obj;\n}\n\nfunction isInputComponent(componentJson) {\n  if (componentJson.input === false || componentJson.input === true) {\n    return componentJson.input;\n  }\n\n  switch (componentJson.type) {\n    case 'htmlelement':\n    case 'content':\n    case 'columns':\n    case 'fieldset':\n    case 'panel':\n    case 'table':\n    case 'tabs':\n    case 'well':\n    case 'button':\n      return false;\n\n    default:\n      return true;\n  }\n}\n\nfunction getArrayFromComponentPath(pathStr) {\n  if (!pathStr || !_lodash.default.isString(pathStr)) {\n    if (!_lodash.default.isArray(pathStr)) {\n      return [pathStr];\n    }\n\n    return pathStr;\n  }\n\n  return pathStr.replace(/[[\\]]/g, '.').replace(/\\.\\./g, '.').replace(/(^\\.)|(\\.$)/g, '').split('.').map(function (part) {\n    return _lodash.default.defaultTo(_lodash.default.toNumber(part), part);\n  });\n}\n\nfunction hasInvalidComponent(component) {\n  return component.getComponents().some(function (comp) {\n    if (_lodash.default.isArray(comp.components)) {\n      return hasInvalidComponent(comp);\n    }\n\n    return comp.error;\n  });\n}\n\nfunction getStringFromComponentPath(path) {\n  if (!_lodash.default.isArray(path)) {\n    return path;\n  }\n\n  var strPath = '';\n  path.forEach(function (part, i) {\n    if (_lodash.default.isNumber(part)) {\n      strPath += \"[\".concat(part, \"]\");\n    } else {\n      strPath += i === 0 ? part : \".\".concat(part);\n    }\n  });\n  return strPath;\n}\n\nfunction round(number, precision) {\n  if (_lodash.default.isNumber(number)) {\n    return number.toFixed(precision);\n  }\n\n  return number;\n}\n/**\n * Check for Internet Explorer browser version\n *\n * @return {(number|null)}\n */\n\n\nfunction getIEBrowserVersion() {\n  var _getBrowserInfo = getBrowserInfo(),\n      ie = _getBrowserInfo.ie,\n      version = _getBrowserInfo.version;\n\n  return ie ? version : null;\n}\n/**\n * Get browser name and version (modified from 'jquery-browser-plugin')\n *\n * @return {Object} -- {{browser name, version, isWebkit?}}\n * Possible browser names: chrome, safari, ie, edge, opera, mozilla, yabrowser\n */\n\n\nfunction getBrowserInfo() {\n  var browser = {};\n\n  if (typeof window === 'undefined') {\n    return browser;\n  }\n\n  var ua = window.navigator.userAgent.toLowerCase();\n  var match = /(edge|edg)\\/([\\w.]+)/.exec(ua) || /(opr)[/]([\\w.]+)/.exec(ua) || /(yabrowser)[ /]([\\w.]+)/.exec(ua) || /(chrome)[ /]([\\w.]+)/.exec(ua) || /(iemobile)[/]([\\w.]+)/.exec(ua) || /(version)(applewebkit)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) || /(webkit)[ /]([\\w.]+).*(version)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) || /(webkit)[ /]([\\w.]+)/.exec(ua) || /(opera)(?:.*version|)[ /]([\\w.]+)/.exec(ua) || /(msie) ([\\w.]+)/.exec(ua) || ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua) || ua.indexOf('compatible') < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(ua) || [];\n  var matched = {\n    browser: match[5] || match[3] || match[1] || '',\n    version: match[4] || match[2] || '0'\n  };\n\n  if (matched.browser) {\n    browser[matched.browser] = true;\n    browser.version = parseInt(matched.version, 10);\n  } // Chrome, Opera 15+, Safari and Yandex.Browser are webkit based browsers\n\n\n  if (browser.chrome || browser.opr || browser.safari || browser.edg || browser.yabrowser) {\n    browser.isWebkit = true;\n  } // IE11 has a new token so we will assign it ie to avoid breaking changes\n\n\n  if (browser.rv || browser.iemobile) {\n    browser.ie = true;\n  } // Edge has a new token since it became webkit based\n\n\n  if (browser.edg) {\n    browser.edge = true;\n  } // Opera 15+ are identified as opr\n\n\n  if (browser.opr) {\n    browser.opera = true;\n  }\n\n  return browser;\n}\n\nfunction getComponentPathWithoutIndicies() {\n  var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return path.replace(/\\[\\d+\\]/, '');\n}\n/**\n * Returns a path to the component which based on its schema\n * @param {*} component is a component's schema containing link to its parent's schema in the 'parent' property\n */\n\n\nfunction getComponentPath(component) {\n  var _component$_form;\n\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n  if (!component || !component.key || (component === null || component === void 0 ? void 0 : (_component$_form = component._form) === null || _component$_form === void 0 ? void 0 : _component$_form.display) === 'wizard') {\n    // unlike the Webform, the Wizard has the key and it is a duplicate of the panel key\n    return path;\n  }\n\n  path = component.isInputComponent || component.input === true ? \"\".concat(component.key).concat(path ? '.' : '').concat(path) : path;\n  return getComponentPath(component.parent, path);\n}\n/**\n * Returns a parent component of the passed component instance skipping all the Layout components\n * @param {*} componentInstance\n * @return {(Component|undefined)}\n */\n\n\nfunction getDataParentComponent(componentInstance) {\n  if (!componentInstance) {\n    return;\n  }\n\n  var parent = componentInstance.parent;\n\n  if (parent && (parent.isInputComponent || parent.input)) {\n    return parent;\n  } else {\n    return getDataParentComponent(parent);\n  }\n}\n/**\n * Returns whether the value is a promise\n * @param value\n * @return {boolean}\n */\n\n\nfunction isPromise(value) {\n  var _value$constructor;\n\n  return value && value.then && typeof value.then === 'function' && (value === null || value === void 0 ? void 0 : (_value$constructor = value.constructor) === null || _value$constructor === void 0 ? void 0 : _value$constructor.name) === 'Promise';\n}\n/**\n * Determines if the component has a scoping parent in tree (a component which scopes its children and manages its\n * changes by itself, e.g. EditGrid)\n * @param componentInstance\n * @param firstPass\n * @returns {boolean|boolean|*}\n */\n\n\nfunction isInsideScopingComponent(componentInstance) {\n  var firstPass = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n  if (!firstPass && componentInstance !== null && componentInstance !== void 0 && componentInstance.hasScopedChildren) {\n    return true;\n  }\n\n  var dataParent = getDataParentComponent(componentInstance);\n\n  if (dataParent !== null && dataParent !== void 0 && dataParent.hasScopedChildren) {\n    return true;\n  } else if (dataParent !== null && dataParent !== void 0 && dataParent.parent) {\n    return isInsideScopingComponent(dataParent.parent, false);\n  }\n\n  return false;\n}\n\nfunction getFocusableElements(element) {\n  var focusableSelector = \"button:not([disabled]), input:not([disabled]), select:not([disabled]),\\n    textarea:not([disabled]), button:not([disabled]), [href]\";\n  return element.querySelectorAll(focusableSelector);\n} // Export lodash to save space with other libraries.","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/forms-flow-master/forms-flow-ai/forms-flow-web/node_modules/formiojs/utils/utils.js"],"names":["require","Object","defineProperty","exports","value","_exportNames","evaluate","getRandomComponentId","getPropertyValue","getElementRect","boolValue","isMongoId","checkCalculated","checkSimpleConditional","checkCustomConditional","checkJsonConditional","checkCondition","checkTrigger","setActionProperty","unescapeHTML","convertStringToHTMLElement","uniqueName","guid","getDateSetting","isValidDate","currentTimezone","offsetDate","zonesLoaded","shouldLoadZones","loadZones","momentDate","formatDate","formatOffset","getLocaleDateFormatInfo","convertFormatToFlatpickr","convertFormatToMoment","convertFormatToMask","getInputMask","unmaskValue","matchInputMask","getNumberSeparators","getNumberDecimalLimit","getCurrencyAffixes","fieldData","delay","iterateKey","uniqueKey","bootstrapVersion","unfold","firstNonNil","withSwitch","observeOverload","getContextComponents","getContextButtons","translateHTMLTemplate","sanitize","fastCloneDeep","interpolate","isInputComponent","getArrayFromComponentPath","hasInvalidComponent","getStringFromComponentPath","round","getIEBrowserVersion","getBrowserInfo","getComponentPathWithoutIndicies","getComponentPath","getDataParentComponent","isPromise","isInsideScopingComponent","getFocusableElements","_","jsonLogic","moment","Evaluator","enumerable","get","_Evaluator","default","_lodash","_jsonLogicJs","_momentTimezone","_interopRequireDefault","_fetchPonyfill2","_jstimezonedetect","_operators","_nativePromiseOnly","_dompurify","_formUtils","keys","forEach","key","prototype","hasOwnProperty","call","obj","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","_typeof","_fetchPonyfill","Promise","fetch","lodashOperators","add_operation","concat","date","toISOString","relativeMinDate","subtract","relativeMaxDate","add","setPathToComponentAndPerentSchema","component","path","dataParent","func","args","ret","tokenize","returnVal","form","instance","componentKey","replace","match","$1","$2","indexOf","data","row","evaluator","values","err","console","warn","apply","Math","random","substring","style","prop","parseFloat","element","window","getComputedStyle","x","y","width","height","isBoolean","isString","toLowerCase","text","submission","rowData","calculateValue","set","undefined","util","condition","getValue","when","isNil","eq","String","show","isObject","has","map","includes","custom","variable","onError","json","getRow","conditional","_condition$when","cloneDeep","parentPath","startsWith","newRow","customConditional","trigger","type","simple","javascript","action","result","property","currentValue","newValue","state","evalData","textValue","_currentValue","_newValue","str","doc","DOMParser","parseFromString","documentElement","textContent","selector","body","querySelector","template","evalContext","parts","split","fileName","join","extension","last","substr","assign","c","r","v","isNaN","Date","toDate","isValid","dateSetting","toUTCString","e","isDate","getDate","determine","timezone","getTime","getTimezoneOffset","abbr","dateMoment","tz","utcOffset","format","noop","zonesPromise","then","resp","zones","load","document","createEvent","dispatchEvent","event","initEvent","flatPickrInputFormat","offset","formatFn","locale","formatInfo","day","exampleDate","localDateString","toLocaleDateString","dayFirst","mask","placeholderChar","maskArray","numeric","push","unmaskedValue","char","charPart","isRegExp","inputMask","lang","arguments","formattedNumberString","toLocaleString","delimeters","delimiter","decimalSeparator","defaultLimit","decimalLimit","step","_ref","_ref$currency","currency","regex","useGrouping","maximumFractionDigits","minimumFractionDigits","RegExp","prefix","suffix","multiple","inputType","fn","_len","_key","timer","setTimeout","cancel","clearTimeout","earlyCall","Number","base","newKey","options","bootstrap","$","collapse","parseInt","Constructor","VERSION","flow","partialRight","find","isUndefined","a","b","next","toggle","prev","callback","_options$limit","limit","_options$delay","callCount","timeoutID","reset","context","utils","eachComponent","editForm","components","label","inTextTags","translateElemValue","elem","translate","innerText","innerHTML","elemValue","templateSettings","trim","translatedValue","links","translatedLinks","link","linkElem","createElement","translateDeepTag","tag","children","shouldTranslateEntireContent","every","child","some","nodeName","isHTML","tempElem","string","sanitizeOptions","ADD_ATTR","USE_PROFILES","html","sanitizeConfig","addAttr","attr","addTags","ADD_TAGS","allowedTags","ALLOWED_TAGS","allowedAttrs","ALLOWED_ATTR","allowedUriRegex","ALLOWED_URI_REGEXP","addUriSafeAttr","ADD_URI_SAFE_ATTR","JSON","parse","stringify","componentJson","input","pathStr","part","defaultTo","toNumber","getComponents","comp","error","strPath","isNumber","number","precision","toFixed","_getBrowserInfo","ie","version","browser","ua","navigator","userAgent","exec","matched","chrome","opr","safari","edg","yabrowser","isWebkit","rv","iemobile","edge","opera","_component$_form","_form","display","parent","componentInstance","_value$constructor","firstPass","hasScopedChildren","focusableSelector","querySelectorAll"],"mappings":"AAAA;;AAEAA,OAAO,CAAC,8BAAD,CAAP;;AAEAA,OAAO,CAAC,0CAAD,CAAP;;AAEAA,OAAO,CAAC,uCAAD,CAAP;;AAEAA,OAAO,CAAC,uCAAD,CAAP;;AAEAA,OAAO,CAAC,kCAAD,CAAP;;AAEAA,OAAO,CAAC,mCAAD,CAAP;;AAEAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGA,IAAIC,YAAY,GAAG;AACjBC,EAAAA,QAAQ,EAAE,IADO;AAEjBC,EAAAA,oBAAoB,EAAE,IAFL;AAGjBC,EAAAA,gBAAgB,EAAE,IAHD;AAIjBC,EAAAA,cAAc,EAAE,IAJC;AAKjBC,EAAAA,SAAS,EAAE,IALM;AAMjBC,EAAAA,SAAS,EAAE,IANM;AAOjBC,EAAAA,eAAe,EAAE,IAPA;AAQjBC,EAAAA,sBAAsB,EAAE,IARP;AASjBC,EAAAA,sBAAsB,EAAE,IATP;AAUjBC,EAAAA,oBAAoB,EAAE,IAVL;AAWjBC,EAAAA,cAAc,EAAE,IAXC;AAYjBC,EAAAA,YAAY,EAAE,IAZG;AAajBC,EAAAA,iBAAiB,EAAE,IAbF;AAcjBC,EAAAA,YAAY,EAAE,IAdG;AAejBC,EAAAA,0BAA0B,EAAE,IAfX;AAgBjBC,EAAAA,UAAU,EAAE,IAhBK;AAiBjBC,EAAAA,IAAI,EAAE,IAjBW;AAkBjBC,EAAAA,cAAc,EAAE,IAlBC;AAmBjBC,EAAAA,WAAW,EAAE,IAnBI;AAoBjBC,EAAAA,eAAe,EAAE,IApBA;AAqBjBC,EAAAA,UAAU,EAAE,IArBK;AAsBjBC,EAAAA,WAAW,EAAE,IAtBI;AAuBjBC,EAAAA,eAAe,EAAE,IAvBA;AAwBjBC,EAAAA,SAAS,EAAE,IAxBM;AAyBjBC,EAAAA,UAAU,EAAE,IAzBK;AA0BjBC,EAAAA,UAAU,EAAE,IA1BK;AA2BjBC,EAAAA,YAAY,EAAE,IA3BG;AA4BjBC,EAAAA,uBAAuB,EAAE,IA5BR;AA6BjBC,EAAAA,wBAAwB,EAAE,IA7BT;AA8BjBC,EAAAA,qBAAqB,EAAE,IA9BN;AA+BjBC,EAAAA,mBAAmB,EAAE,IA/BJ;AAgCjBC,EAAAA,YAAY,EAAE,IAhCG;AAiCjBC,EAAAA,WAAW,EAAE,IAjCI;AAkCjBC,EAAAA,cAAc,EAAE,IAlCC;AAmCjBC,EAAAA,mBAAmB,EAAE,IAnCJ;AAoCjBC,EAAAA,qBAAqB,EAAE,IApCN;AAqCjBC,EAAAA,kBAAkB,EAAE,IArCH;AAsCjBC,EAAAA,SAAS,EAAE,IAtCM;AAuCjBC,EAAAA,KAAK,EAAE,IAvCU;AAwCjBC,EAAAA,UAAU,EAAE,IAxCK;AAyCjBC,EAAAA,SAAS,EAAE,IAzCM;AA0CjBC,EAAAA,gBAAgB,EAAE,IA1CD;AA2CjBC,EAAAA,MAAM,EAAE,IA3CS;AA4CjBC,EAAAA,WAAW,EAAE,IA5CI;AA6CjBC,EAAAA,UAAU,EAAE,IA7CK;AA8CjBC,EAAAA,eAAe,EAAE,IA9CA;AA+CjBC,EAAAA,oBAAoB,EAAE,IA/CL;AAgDjBC,EAAAA,iBAAiB,EAAE,IAhDF;AAiDjBC,EAAAA,qBAAqB,EAAE,IAjDN;AAkDjBC,EAAAA,QAAQ,EAAE,IAlDO;AAmDjBC,EAAAA,aAAa,EAAE,IAnDE;AAoDjBC,EAAAA,WAAW,EAAE,IApDI;AAqDjBC,EAAAA,gBAAgB,EAAE,IArDD;AAsDjBC,EAAAA,yBAAyB,EAAE,IAtDV;AAuDjBC,EAAAA,mBAAmB,EAAE,IAvDJ;AAwDjBC,EAAAA,0BAA0B,EAAE,IAxDX;AAyDjBC,EAAAA,KAAK,EAAE,IAzDU;AA0DjBC,EAAAA,mBAAmB,EAAE,IA1DJ;AA2DjBC,EAAAA,cAAc,EAAE,IA3DC;AA4DjBC,EAAAA,+BAA+B,EAAE,IA5DhB;AA6DjBC,EAAAA,gBAAgB,EAAE,IA7DD;AA8DjBC,EAAAA,sBAAsB,EAAE,IA9DP;AA+DjBC,EAAAA,SAAS,EAAE,IA/DM;AAgEjBC,EAAAA,wBAAwB,EAAE,IAhET;AAiEjBC,EAAAA,oBAAoB,EAAE,IAjEL;AAkEjBC,EAAAA,CAAC,EAAE,IAlEc;AAmEjBC,EAAAA,SAAS,EAAE,IAnEM;AAoEjBC,EAAAA,MAAM,EAAE,IApES;AAqEjBC,EAAAA,SAAS,EAAE;AArEM,CAAnB;AAuEAzE,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,WAA/B,EAA4C;AAC1CwE,EAAAA,UAAU,EAAE,IAD8B;AAE1CC,EAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,WAAOC,UAAU,CAACC,OAAlB;AACD;AAJyC,CAA5C;AAMA7E,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,GAA/B,EAAoC;AAClCwE,EAAAA,UAAU,EAAE,IADsB;AAElCC,EAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,WAAOG,OAAO,CAACD,OAAf;AACD;AAJiC,CAApC;AAMA3E,OAAO,CAACO,SAAR,GAAoBA,SAApB;AACAP,OAAO,CAAC4C,gBAAR,GAA2BA,gBAA3B;AACA5C,OAAO,CAACS,eAAR,GAA0BA,eAA1B;AACAT,OAAO,CAACa,cAAR,GAAyBA,cAAzB;AACAb,OAAO,CAACW,sBAAR,GAAiCA,sBAAjC;AACAX,OAAO,CAACY,oBAAR,GAA+BA,oBAA/B;AACAZ,OAAO,CAACU,sBAAR,GAAiCA,sBAAjC;AACAV,OAAO,CAACc,YAAR,GAAuBA,YAAvB;AACAd,OAAO,CAAC+B,wBAAR,GAAmCA,wBAAnC;AACA/B,OAAO,CAACiC,mBAAR,GAA8BA,mBAA9B;AACAjC,OAAO,CAACgC,qBAAR,GAAgCA,qBAAhC;AACAhC,OAAO,CAACiB,0BAAR,GAAqCA,0BAArC;AACAjB,OAAO,CAACsB,eAAR,GAA0BA,eAA1B;AACAtB,OAAO,CAACyC,KAAR,GAAgBA,KAAhB;AACAzC,OAAO,CAACG,QAAR,GAAmBA,QAAnB;AACAH,OAAO,CAACqD,aAAR,GAAwBA,aAAxB;AACArD,OAAO,CAACwC,SAAR,GAAoBA,SAApB;AACAxC,OAAO,CAAC8C,WAAR,GAAsB,KAAK,CAA3B;AACA9C,OAAO,CAAC4B,UAAR,GAAqBA,UAArB;AACA5B,OAAO,CAAC6B,YAAR,GAAuBA,YAAvB;AACA7B,OAAO,CAACwD,yBAAR,GAAoCA,yBAApC;AACAxD,OAAO,CAAC6D,cAAR,GAAyBA,cAAzB;AACA7D,OAAO,CAAC+D,gBAAR,GAA2BA,gBAA3B;AACA/D,OAAO,CAAC8D,+BAAR,GAA0CA,+BAA1C;AACA9D,OAAO,CAACkD,iBAAR,GAA4BA,iBAA5B;AACAlD,OAAO,CAACiD,oBAAR,GAA+BA,oBAA/B;AACAjD,OAAO,CAACuC,kBAAR,GAA6BA,kBAA7B;AACAvC,OAAO,CAACgE,sBAAR,GAAiCA,sBAAjC;AACAhE,OAAO,CAACoB,cAAR,GAAyBA,cAAzB;AACApB,OAAO,CAACM,cAAR,GAAyBA,cAAzB;AACAN,OAAO,CAACmE,oBAAR,GAA+BA,oBAA/B;AACAnE,OAAO,CAAC4D,mBAAR,GAA8BA,mBAA9B;AACA5D,OAAO,CAACkC,YAAR,GAAuBA,YAAvB;AACAlC,OAAO,CAAC8B,uBAAR,GAAkCA,uBAAlC;AACA9B,OAAO,CAACsC,qBAAR,GAAgCA,qBAAhC;AACAtC,OAAO,CAACqC,mBAAR,GAA8BA,mBAA9B;AACArC,OAAO,CAACK,gBAAR,GAA2BA,gBAA3B;AACAL,OAAO,CAACI,oBAAR,GAA+BA,oBAA/B;AACAJ,OAAO,CAAC0D,0BAAR,GAAqCA,0BAArC;AACA1D,OAAO,CAACmB,IAAR,GAAeA,IAAf;AACAnB,OAAO,CAACyD,mBAAR,GAA8BA,mBAA9B;AACAzD,OAAO,CAACsD,WAAR,GAAsB,KAAK,CAA3B;AACAtD,OAAO,CAACuD,gBAAR,GAA2BA,gBAA3B;AACAvD,OAAO,CAACkE,wBAAR,GAAmCA,wBAAnC;AACAlE,OAAO,CAACQ,SAAR,GAAoBA,SAApB;AACAR,OAAO,CAACiE,SAAR,GAAoBA,SAApB;AACAjE,OAAO,CAACqB,WAAR,GAAsBA,WAAtB;AACArB,OAAO,CAAC0C,UAAR,GAAqBA,UAArB;AACA5C,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,WAA/B,EAA4C;AAC1CwE,EAAAA,UAAU,EAAE,IAD8B;AAE1CC,EAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,WAAOI,YAAY,CAACF,OAApB;AACD;AAJyC,CAA5C;AAMA3E,OAAO,CAAC0B,SAAR,GAAoBA,SAApB;AACA1B,OAAO,CAACoC,cAAR,GAAyBA,cAAzB;AACAtC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,QAA/B,EAAyC;AACvCwE,EAAAA,UAAU,EAAE,IAD2B;AAEvCC,EAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,WAAOK,eAAe,CAACH,OAAvB;AACD;AAJsC,CAAzC;AAMA3E,OAAO,CAAC2B,UAAR,GAAqBA,UAArB;AACA3B,OAAO,CAACgD,eAAR,GAA0BA,eAA1B;AACAhD,OAAO,CAACuB,UAAR,GAAqBA,UAArB;AACAvB,OAAO,CAAC2D,KAAR,GAAgBA,KAAhB;AACA3D,OAAO,CAACoD,QAAR,GAAmBA,QAAnB;AACApD,OAAO,CAACe,iBAAR,GAA4BA,iBAA5B;AACAf,OAAO,CAACyB,eAAR,GAA0BA,eAA1B;AACAzB,OAAO,CAACmD,qBAAR,GAAgCA,qBAAhC;AACAnD,OAAO,CAACgB,YAAR,GAAuBA,YAAvB;AACAhB,OAAO,CAAC6C,MAAR,GAAiBA,MAAjB;AACA7C,OAAO,CAAC2C,SAAR,GAAoBA,SAApB;AACA3C,OAAO,CAACkB,UAAR,GAAqBA,UAArB;AACAlB,OAAO,CAACmC,WAAR,GAAsBA,WAAtB;AACAnC,OAAO,CAAC+C,UAAR,GAAqBA,UAArB;AACA/C,OAAO,CAACwB,WAAR,GAAsBA,WAAtB;;AAEA3B,OAAO,CAAC,iDAAD,CAAP;;AAEAA,OAAO,CAAC,mCAAD,CAAP;;AAEAA,OAAO,CAAC,sCAAD,CAAP;;AAEAA,OAAO,CAAC,sCAAD,CAAP;;AAEAA,OAAO,CAAC,wCAAD,CAAP;;AAEAA,OAAO,CAAC,iDAAD,CAAP;;AAEAA,OAAO,CAAC,wCAAD,CAAP;;AAEAA,OAAO,CAAC,oCAAD,CAAP;;AAEAA,OAAO,CAAC,sCAAD,CAAP;;AAEAA,OAAO,CAAC,uCAAD,CAAP;;AAEAA,OAAO,CAAC,iCAAD,CAAP;;AAEAA,OAAO,CAAC,oCAAD,CAAP;;AAEAA,OAAO,CAAC,0CAAD,CAAP;;AAEAA,OAAO,CAAC,oCAAD,CAAP;;AAIAA,OAAO,CAAC,mCAAD,CAAP;;AAEAA,OAAO,CAAC,qCAAD,CAAP;;AAIAA,OAAO,CAAC,0CAAD,CAAP;;AAEAA,OAAO,CAAC,0CAAD,CAAP;;AAEAA,OAAO,CAAC,kCAAD,CAAP;;AAEAA,OAAO,CAAC,mCAAD,CAAP;;AAIA,IAAI+E,OAAO,GAAGG,sBAAsB,CAAClF,OAAO,CAAC,QAAD,CAAR,CAApC;;AAEA,IAAImF,eAAe,GAAGD,sBAAsB,CAAClF,OAAO,CAAC,gBAAD,CAAR,CAA5C;;AAEA,IAAIgF,YAAY,GAAGE,sBAAsB,CAAClF,OAAO,CAAC,eAAD,CAAR,CAAzC;;AAEA,IAAIiF,eAAe,GAAGC,sBAAsB,CAAClF,OAAO,CAAC,iCAAD,CAAR,CAA5C;;AAEA,IAAIoF,iBAAiB,GAAGF,sBAAsB,CAAClF,OAAO,CAAC,kBAAD,CAAR,CAA9C;;AAEA,IAAIqF,UAAU,GAAGrF,OAAO,CAAC,uBAAD,CAAxB;;AAEA,IAAIsF,kBAAkB,GAAGJ,sBAAsB,CAAClF,OAAO,CAAC,qBAAD,CAAR,CAA/C;;AAEA,IAAIuF,UAAU,GAAGL,sBAAsB,CAAClF,OAAO,CAAC,WAAD,CAAR,CAAvC;;AAEA,IAAIwF,UAAU,GAAGxF,OAAO,CAAC,aAAD,CAAxB;;AAEAC,MAAM,CAACwF,IAAP,CAAYD,UAAZ,EAAwBE,OAAxB,CAAgC,UAAUC,GAAV,EAAe;AAC7C,MAAIA,GAAG,KAAK,SAAR,IAAqBA,GAAG,KAAK,YAAjC,EAA+C;AAC/C,MAAI1F,MAAM,CAAC2F,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCzF,YAArC,EAAmDsF,GAAnD,CAAJ,EAA6D;AAC7D,MAAIA,GAAG,IAAIxF,OAAP,IAAkBA,OAAO,CAACwF,GAAD,CAAP,KAAiBH,UAAU,CAACG,GAAD,CAAjD,EAAwD;AACxD1F,EAAAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+BwF,GAA/B,EAAoC;AAClChB,IAAAA,UAAU,EAAE,IADsB;AAElCC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOY,UAAU,CAACG,GAAD,CAAjB;AACD;AAJiC,GAApC;AAMD,CAVD;;AAYA,IAAId,UAAU,GAAGK,sBAAsB,CAAClF,OAAO,CAAC,aAAD,CAAR,CAAvC;;AAEA,SAASkF,sBAAT,CAAgCa,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEjB,IAAAA,OAAO,EAAEiB;AAAX,GAArC;AAAwD;;AAE/F,SAASE,kBAAT,CAA4BC,GAA5B,EAAiC;AAAE,SAAOC,kBAAkB,CAACD,GAAD,CAAlB,IAA2BE,gBAAgB,CAACF,GAAD,CAA3C,IAAoDG,2BAA2B,CAACH,GAAD,CAA/E,IAAwFI,kBAAkB,EAAjH;AAAsH;;AAEzJ,SAASA,kBAAT,GAA8B;AAAE,QAAM,IAAIC,SAAJ,CAAc,sIAAd,CAAN;AAA8J;;AAE9L,SAASF,2BAAT,CAAqCG,CAArC,EAAwCC,MAAxC,EAAgD;AAAE,MAAI,CAACD,CAAL,EAAQ;AAAQ,MAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B,OAAOE,iBAAiB,CAACF,CAAD,EAAIC,MAAJ,CAAxB;AAAqC,MAAIE,CAAC,GAAG1G,MAAM,CAAC2F,SAAP,CAAiBgB,QAAjB,CAA0Bd,IAA1B,CAA+BU,CAA/B,EAAkCK,KAAlC,CAAwC,CAAxC,EAA2C,CAAC,CAA5C,CAAR;AAAwD,MAAIF,CAAC,KAAK,QAAN,IAAkBH,CAAC,CAACM,WAAxB,EAAqCH,CAAC,GAAGH,CAAC,CAACM,WAAF,CAAcC,IAAlB;AAAwB,MAAIJ,CAAC,KAAK,KAAN,IAAeA,CAAC,KAAK,KAAzB,EAAgC,OAAOK,KAAK,CAACC,IAAN,CAAWT,CAAX,CAAP;AAAsB,MAAIG,CAAC,KAAK,WAAN,IAAqB,2CAA2CO,IAA3C,CAAgDP,CAAhD,CAAzB,EAA6E,OAAOD,iBAAiB,CAACF,CAAD,EAAIC,MAAJ,CAAxB;AAAsC;;AAEha,SAASL,gBAAT,CAA0Be,IAA1B,EAAgC;AAAE,MAAI,OAAOC,MAAP,KAAkB,WAAlB,IAAiCD,IAAI,CAACC,MAAM,CAACC,QAAR,CAAJ,IAAyB,IAA1D,IAAkEF,IAAI,CAAC,YAAD,CAAJ,IAAsB,IAA5F,EAAkG,OAAOH,KAAK,CAACC,IAAN,CAAWE,IAAX,CAAP;AAA0B;;AAE9J,SAAShB,kBAAT,CAA4BD,GAA5B,EAAiC;AAAE,MAAIc,KAAK,CAACM,OAAN,CAAcpB,GAAd,CAAJ,EAAwB,OAAOQ,iBAAiB,CAACR,GAAD,CAAxB;AAAgC;;AAE3F,SAASQ,iBAAT,CAA2BR,GAA3B,EAAgCqB,GAAhC,EAAqC;AAAE,MAAIA,GAAG,IAAI,IAAP,IAAeA,GAAG,GAAGrB,GAAG,CAACsB,MAA7B,EAAqCD,GAAG,GAAGrB,GAAG,CAACsB,MAAV;;AAAkB,OAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,IAAI,GAAG,IAAIV,KAAJ,CAAUO,GAAV,CAAvB,EAAuCE,CAAC,GAAGF,GAA3C,EAAgDE,CAAC,EAAjD,EAAqD;AAAEC,IAAAA,IAAI,CAACD,CAAD,CAAJ,GAAUvB,GAAG,CAACuB,CAAD,CAAb;AAAmB;;AAAC,SAAOC,IAAP;AAAc;;AAEvL,SAASC,OAAT,CAAiB5B,GAAjB,EAAsB;AAAE;;AAA2B,MAAI,OAAOqB,MAAP,KAAkB,UAAlB,IAAgC,OAAOA,MAAM,CAACC,QAAd,KAA2B,QAA/D,EAAyE;AAAEM,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiB5B,GAAjB,EAAsB;AAAE,aAAO,OAAOA,GAAd;AAAoB,KAAtD;AAAyD,GAApI,MAA0I;AAAE4B,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiB5B,GAAjB,EAAsB;AAAE,aAAOA,GAAG,IAAI,OAAOqB,MAAP,KAAkB,UAAzB,IAAuCrB,GAAG,CAACe,WAAJ,KAAoBM,MAA3D,IAAqErB,GAAG,KAAKqB,MAAM,CAACxB,SAApF,GAAgG,QAAhG,GAA2G,OAAOG,GAAzH;AAA+H,KAAjK;AAAoK;;AAAC,SAAO4B,OAAO,CAAC5B,GAAD,CAAd;AAAsB;;AAE1X,IAAItC,WAAW,GAAGoB,UAAU,CAACC,OAAX,CAAmBrB,WAArC;AACAtD,OAAO,CAACsD,WAAR,GAAsBA,WAAtB;;AAEA,IAAImE,cAAc,GAAG,CAAC,GAAGzC,eAAe,CAACL,OAApB,EAA6B;AAChD+C,EAAAA,OAAO,EAAEvC,kBAAkB,CAACR;AADoB,CAA7B,CAArB;AAAA,IAGIgD,KAAK,GAAGF,cAAc,CAACE,KAH3B,C,CAKA;;;AACAzC,UAAU,CAAC0C,eAAX,CAA2BrC,OAA3B,CAAmC,UAAUqB,IAAV,EAAgB;AACjD,SAAO/B,YAAY,CAACF,OAAb,CAAqBkD,aAArB,CAAmC,IAAIC,MAAJ,CAAWlB,IAAX,CAAnC,EAAqDhC,OAAO,CAACD,OAAR,CAAgBiC,IAAhB,CAArD,CAAP;AACD,CAFD,E,CAEI;;;AAGJ/B,YAAY,CAACF,OAAb,CAAqBkD,aAArB,CAAmC,SAAnC,EAA8C,UAAUE,IAAV,EAAgB;AAC5D,SAAO,CAAC,GAAGjD,eAAe,CAACH,OAApB,EAA6BoD,IAA7B,EAAmCC,WAAnC,EAAP;AACD,CAFD,E,CAEI;;;AAGJnD,YAAY,CAACF,OAAb,CAAqBkD,aAArB,CAAmC,iBAAnC,EAAsD,UAAUI,eAAV,EAA2B;AAC/E,SAAO,CAAC,GAAGnD,eAAe,CAACH,OAApB,IAA+BuD,QAA/B,CAAwCD,eAAxC,EAAyD,MAAzD,EAAiED,WAAjE,EAAP;AACD,CAFD,E,CAEI;;;AAGJnD,YAAY,CAACF,OAAb,CAAqBkD,aAArB,CAAmC,iBAAnC,EAAsD,UAAUM,eAAV,EAA2B;AAC/E,SAAO,CAAC,GAAGrD,eAAe,CAACH,OAApB,IAA+ByD,GAA/B,CAAmCD,eAAnC,EAAoD,MAApD,EAA4DH,WAA5D,EAAP;AACD,CAFD;;AAIA,SAASK,iCAAT,CAA2CC,SAA3C,EAAsD;AACpDA,EAAAA,SAAS,CAACC,IAAV,GAAiBxE,gBAAgB,CAACuE,SAAD,CAAjC;AACA,MAAIE,UAAU,GAAGxE,sBAAsB,CAACsE,SAAD,CAAvC;;AAEA,MAAIE,UAAU,IAAIhB,OAAO,CAACgB,UAAD,CAAP,KAAwB,QAA1C,EAAoD;AAClDA,IAAAA,UAAU,CAACD,IAAX,GAAkBxE,gBAAgB,CAACyE,UAAD,CAAlC;AACD;AACF;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASrI,QAAT,CAAkBsI,IAAlB,EAAwBC,IAAxB,EAA8BC,GAA9B,EAAmCC,QAAnC,EAA6C;AAC3C,MAAIC,SAAS,GAAG,IAAhB;AACA,MAAIP,SAAS,GAAGI,IAAI,CAACJ,SAAL,GAAiBI,IAAI,CAACJ,SAAtB,GAAkC;AAChD9C,IAAAA,GAAG,EAAE;AAD2C,GAAlD;;AAIA,MAAI,CAACkD,IAAI,CAACI,IAAN,IAAcJ,IAAI,CAACK,QAAvB,EAAiC;AAC/BL,IAAAA,IAAI,CAACI,IAAL,GAAYlE,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoBiE,IAAI,CAACK,QAAzB,EAAmC,YAAnC,EAAiD,EAAjD,CAAZ;AACD;;AAED,MAAIC,YAAY,GAAGV,SAAS,CAAC9C,GAA7B;;AAEA,MAAI,OAAOiD,IAAP,KAAgB,QAApB,EAA8B;AAC5B,QAAIE,GAAJ,EAAS;AACPF,MAAAA,IAAI,IAAI,WAAWX,MAAX,CAAkBa,GAAlB,CAAR;AACD;;AAED,QAAIC,QAAJ,EAAc;AACZ;AACAH,MAAAA,IAAI,GAAGA,IAAI,CAACQ,OAAL,CAAa,kBAAb,EAAiC,UAAUC,KAAV,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyB;AAC/D,YAAIA,EAAE,CAACC,OAAH,CAAW,OAAX,MAAwB,CAA5B,EAA+B;AAC7B,iBAAOzE,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoBiE,IAAI,CAACY,IAAzB,EAA+BF,EAAE,CAACH,OAAH,CAAW,OAAX,EAAoB,EAApB,CAA/B,CAAP;AACD,SAFD,MAEO,IAAIG,EAAE,CAACC,OAAH,CAAW,MAAX,MAAuB,CAA3B,EAA8B;AACnC,iBAAOzE,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoBiE,IAAI,CAACa,GAAzB,EAA8BH,EAAE,CAACH,OAAH,CAAW,MAAX,EAAmB,EAAnB,CAA9B,CAAP;AACD,SAL8D,CAK7D;;;AAGF,eAAOrE,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoBiE,IAAI,CAACY,IAAzB,EAA+BF,EAA/B,CAAP;AACD,OATM,CAAP;AAUD;;AAED,QAAI;AACFX,MAAAA,IAAI,GAAG/D,UAAU,CAACC,OAAX,CAAmB6E,SAAnB,CAA6Bf,IAA7B,EAAmCC,IAAnC,CAAP;AACAA,MAAAA,IAAI,GAAG9D,OAAO,CAACD,OAAR,CAAgB8E,MAAhB,CAAuBf,IAAvB,CAAP;AACD,KAHD,CAGE,OAAOgB,GAAP,EAAY;AACZC,MAAAA,OAAO,CAACC,IAAR,CAAa,mDAAmD9B,MAAnD,CAA0DkB,YAA1D,CAAb,EAAsFU,GAAtF;AACAb,MAAAA,SAAS,GAAG,IAAZ;AACAJ,MAAAA,IAAI,GAAG,KAAP;AACD;AACF;;AAED,MAAI,OAAOA,IAAP,KAAgB,UAApB,EAAgC;AAC9B,QAAI;AACFI,MAAAA,SAAS,GAAGnE,UAAU,CAACC,OAAX,CAAmBxE,QAAnB,CAA4BsI,IAA5B,EAAkCC,IAAlC,CAAZ;AACD,KAFD,CAEE,OAAOgB,GAAP,EAAY;AACZb,MAAAA,SAAS,GAAG,IAAZ;AACAc,MAAAA,OAAO,CAACC,IAAR,CAAa,+CAA+C9B,MAA/C,CAAsDkB,YAAtD,CAAb,EAAkFU,GAAlF;AACD;AACF,GAPD,MAOO,IAAIlC,OAAO,CAACiB,IAAD,CAAP,KAAkB,QAAtB,EAAgC;AACrC,QAAI;AACFI,MAAAA,SAAS,GAAGhE,YAAY,CAACF,OAAb,CAAqBkF,KAArB,CAA2BpB,IAA3B,EAAiCC,IAAjC,CAAZ;AACD,KAFD,CAEE,OAAOgB,GAAP,EAAY;AACZb,MAAAA,SAAS,GAAG,IAAZ;AACAc,MAAAA,OAAO,CAACC,IAAR,CAAa,+CAA+C9B,MAA/C,CAAsDkB,YAAtD,CAAb,EAAkFU,GAAlF;AACD;AACF,GAPM,MAOA,IAAIjB,IAAJ,EAAU;AACfkB,IAAAA,OAAO,CAACC,IAAR,CAAa,6BAA6B9B,MAA7B,CAAoCkB,YAApC,CAAb;AACD;;AAED,SAAOH,SAAP;AACD;;AAED,SAASzI,oBAAT,GAAgC;AAC9B,SAAO,IAAI0H,MAAJ,CAAWgC,IAAI,CAACC,MAAL,GAActD,QAAd,CAAuB,EAAvB,EAA2BuD,SAA3B,CAAqC,CAArC,CAAX,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS3J,gBAAT,CAA0B4J,KAA1B,EAAiCC,IAAjC,EAAuC;AACrC,MAAIjK,KAAK,GAAGgK,KAAK,CAAC5J,gBAAN,CAAuB6J,IAAvB,CAAZ;AACAjK,EAAAA,KAAK,GAAGA,KAAK,GAAGA,KAAK,CAACgJ,OAAN,CAAc,UAAd,EAA0B,EAA1B,CAAH,GAAmC,GAAhD;AACA,SAAOkB,UAAU,CAAClK,KAAD,CAAjB;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASK,cAAT,CAAwB8J,OAAxB,EAAiC;AAC/B,MAAIH,KAAK,GAAGI,MAAM,CAACC,gBAAP,CAAwBF,OAAxB,EAAiC,IAAjC,CAAZ;AACA,SAAO;AACLG,IAAAA,CAAC,EAAElK,gBAAgB,CAAC4J,KAAD,EAAQ,MAAR,CADd;AAELO,IAAAA,CAAC,EAAEnK,gBAAgB,CAAC4J,KAAD,EAAQ,KAAR,CAFd;AAGLQ,IAAAA,KAAK,EAAEpK,gBAAgB,CAAC4J,KAAD,EAAQ,OAAR,CAHlB;AAILS,IAAAA,MAAM,EAAErK,gBAAgB,CAAC4J,KAAD,EAAQ,QAAR;AAJnB,GAAP;AAMD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS1J,SAAT,CAAmBN,KAAnB,EAA0B;AACxB,MAAI2E,OAAO,CAACD,OAAR,CAAgBgG,SAAhB,CAA0B1K,KAA1B,CAAJ,EAAsC;AACpC,WAAOA,KAAP;AACD,GAFD,MAEO,IAAI2E,OAAO,CAACD,OAAR,CAAgBiG,QAAhB,CAAyB3K,KAAzB,CAAJ,EAAqC;AAC1C,WAAOA,KAAK,CAAC4K,WAAN,OAAwB,MAA/B;AACD,GAFM,MAEA;AACL,WAAO,CAAC,CAAC5K,KAAT;AACD;AACF;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAASO,SAAT,CAAmBsK,IAAnB,EAAyB;AACvB,SAAOA,IAAI,CAACrE,QAAL,GAAgByC,KAAhB,CAAsB,mBAAtB,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASzI,eAAT,CAAyB6H,SAAzB,EAAoCyC,UAApC,EAAgDC,OAAhD,EAAyD;AACvD;AACA,MAAI1C,SAAS,CAAC2C,cAAd,EAA8B;AAC5BrG,IAAAA,OAAO,CAACD,OAAR,CAAgBuG,GAAhB,CAAoBF,OAApB,EAA6B1C,SAAS,CAAC9C,GAAvC,EAA4CrF,QAAQ,CAACmI,SAAS,CAAC2C,cAAX,EAA2B;AAC7EhL,MAAAA,KAAK,EAAEkL,SADsE;AAE7E7B,MAAAA,IAAI,EAAEyB,UAAU,GAAGA,UAAU,CAACzB,IAAd,GAAqB0B,OAFwC;AAG7EzB,MAAAA,GAAG,EAAEyB,OAHwE;AAI7EI,MAAAA,IAAI,EAAE,IAJuE;AAK7E9C,MAAAA,SAAS,EAAEA;AALkE,KAA3B,EAMjD,OANiD,CAApD;AAOD;AACF;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS5H,sBAAT,CAAgC4H,SAAhC,EAA2C+C,SAA3C,EAAsD9B,GAAtD,EAA2DD,IAA3D,EAAiE;AAC/D,MAAIrJ,KAAK,GAAG,IAAZ;;AAEA,MAAIsJ,GAAJ,EAAS;AACPtJ,IAAAA,KAAK,GAAG,CAAC,GAAGoF,UAAU,CAACiG,QAAf,EAAyB;AAC/BhC,MAAAA,IAAI,EAAEC;AADyB,KAAzB,EAEL8B,SAAS,CAACE,IAFL,CAAR;AAGD;;AAED,MAAIjC,IAAI,IAAI1E,OAAO,CAACD,OAAR,CAAgB6G,KAAhB,CAAsBvL,KAAtB,CAAZ,EAA0C;AACxCA,IAAAA,KAAK,GAAG,CAAC,GAAGoF,UAAU,CAACiG,QAAf,EAAyB;AAC/BhC,MAAAA,IAAI,EAAEA;AADyB,KAAzB,EAEL+B,SAAS,CAACE,IAFL,CAAR;AAGD,GAb8D,CAa7D;;;AAGF,MAAI3G,OAAO,CAACD,OAAR,CAAgB6G,KAAhB,CAAsBvL,KAAtB,CAAJ,EAAkC;AAChCA,IAAAA,KAAK,GAAG,EAAR;AACD;;AAED,MAAIwL,EAAE,GAAGC,MAAM,CAACL,SAAS,CAACI,EAAX,CAAf;AACA,MAAIE,IAAI,GAAGD,MAAM,CAACL,SAAS,CAACM,IAAX,CAAjB,CArB+D,CAqB5B;;AAEnC,MAAI/G,OAAO,CAACD,OAAR,CAAgBiH,QAAhB,CAAyB3L,KAAzB,KAAmC2E,OAAO,CAACD,OAAR,CAAgBkH,GAAhB,CAAoB5L,KAApB,EAA2BoL,SAAS,CAACI,EAArC,CAAvC,EAAiF;AAC/E,WAAOC,MAAM,CAACzL,KAAK,CAACoL,SAAS,CAACI,EAAX,CAAN,CAAN,KAAgCE,IAAvC;AACD,GAzB8D,CAyB7D;;;AAGF,MAAI9E,KAAK,CAACM,OAAN,CAAclH,KAAd,KAAwBA,KAAK,CAAC6L,GAAN,CAAUJ,MAAV,EAAkBK,QAAlB,CAA2BN,EAA3B,CAA5B,EAA4D;AAC1D,WAAOE,IAAI,KAAK,MAAhB;AACD;;AAED,SAAOD,MAAM,CAACzL,KAAD,CAAN,KAAkBwL,EAAlB,MAA0BE,IAAI,KAAK,MAAnC,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAShL,sBAAT,CAAgC2H,SAAhC,EAA2C0D,MAA3C,EAAmDzC,GAAnD,EAAwDD,IAAxD,EAA8DR,IAA9D,EAAoEmD,QAApE,EAA8EC,OAA9E,EAAuFnD,QAAvF,EAAiG;AAC/F,MAAI,OAAOiD,MAAP,KAAkB,QAAtB,EAAgC;AAC9BA,IAAAA,MAAM,GAAG,OAAOlE,MAAP,CAAcmE,QAAd,EAAwB,WAAxB,EAAqCnE,MAArC,CAA4CkE,MAA5C,EAAoD,WAApD,EAAiElE,MAAjE,CAAwEmE,QAAxE,EAAkF,GAAlF,CAAT;AACD;;AAED,MAAIhM,KAAK,GAAG8I,QAAQ,IAAIA,QAAQ,CAAC5I,QAArB,GAAgC4I,QAAQ,CAAC5I,QAAT,CAAkB6L,MAAlB,EAA0B;AACpEzC,IAAAA,GAAG,EAAEA,GAD+D;AAEpED,IAAAA,IAAI,EAAEA,IAF8D;AAGpER,IAAAA,IAAI,EAAEA;AAH8D,GAA1B,CAAhC,GAIP3I,QAAQ,CAAC6L,MAAD,EAAS;AACpBzC,IAAAA,GAAG,EAAEA,GADe;AAEpBD,IAAAA,IAAI,EAAEA,IAFc;AAGpBR,IAAAA,IAAI,EAAEA;AAHc,GAAT,CAJb;;AAUA,MAAI7I,KAAK,KAAK,IAAd,EAAoB;AAClB,WAAOiM,OAAP;AACD;;AAED,SAAOjM,KAAP;AACD;;AAED,SAASW,oBAAT,CAA8B0H,SAA9B,EAAyC6D,IAAzC,EAA+C5C,GAA/C,EAAoDD,IAApD,EAA0DR,IAA1D,EAAgEoD,OAAhE,EAAyE;AACvE,MAAI;AACF,WAAOrH,YAAY,CAACF,OAAb,CAAqBkF,KAArB,CAA2BsC,IAA3B,EAAiC;AACtC7C,MAAAA,IAAI,EAAEA,IADgC;AAEtCC,MAAAA,GAAG,EAAEA,GAFiC;AAGtCT,MAAAA,IAAI,EAAEA,IAHgC;AAItC1E,MAAAA,CAAC,EAAEQ,OAAO,CAACD;AAJ2B,KAAjC,CAAP;AAMD,GAPD,CAOE,OAAO+E,GAAP,EAAY;AACZC,IAAAA,OAAO,CAACC,IAAR,CAAa,yDAAyD9B,MAAzD,CAAgEQ,SAAS,CAAC9C,GAA1E,CAAb,EAA6FkE,GAA7F;AACA,WAAOwC,OAAP;AACD;AACF;;AAED,SAASE,MAAT,CAAgB9D,SAAhB,EAA2BiB,GAA3B,EAAgCR,QAAhC,EAA0CsD,WAA1C,EAAuD;AACrD,MAAIC,eAAJ;;AAEA,MAAIjB,SAAS,GAAGgB,WAAW,IAAI/D,SAAS,CAAC+D,WAAzC,CAHqD,CAGC;;AAEtD,MAAI,CAACtD,QAAL,EAAe;AACbA,IAAAA,QAAQ,GAAGnE,OAAO,CAACD,OAAR,CAAgB4H,SAAhB,CAA0BjE,SAA1B,CAAX;AACAD,IAAAA,iCAAiC,CAACU,QAAD,CAAjC;AACD;;AAED,MAAIP,UAAU,GAAGxE,sBAAsB,CAAC+E,QAAD,CAAvC;AACA,MAAIyD,UAAU,GAAGhE,UAAU,GAAGzE,gBAAgB,CAACyE,UAAD,CAAnB,GAAkC,IAA7D;;AAEA,MAAIA,UAAU,IAAI,CAAC8D,eAAe,GAAGjB,SAAS,CAACE,IAA7B,MAAuC,IAArD,IAA6De,eAAe,KAAK,KAAK,CAAtF,IAA2FA,eAAe,CAACG,UAAhB,CAA2BD,UAA3B,CAA/F,EAAuI;AACrI,QAAIE,MAAM,GAAG,EAAb;;AAEA9H,IAAAA,OAAO,CAACD,OAAR,CAAgBuG,GAAhB,CAAoBwB,MAApB,EAA4BF,UAA5B,EAAwCjD,GAAxC;;AAEAA,IAAAA,GAAG,GAAGmD,MAAN;AACD;;AAED,SAAOnD,GAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS1I,cAAT,CAAwByH,SAAxB,EAAmCiB,GAAnC,EAAwCD,IAAxC,EAA8CR,IAA9C,EAAoDC,QAApD,EAA8D;AAC5D,MAAI4D,iBAAiB,GAAGrE,SAAS,CAACqE,iBAAlC;AAAA,MACIN,WAAW,GAAG/D,SAAS,CAAC+D,WAD5B;;AAGA,MAAIM,iBAAJ,EAAuB;AACrB,WAAOhM,sBAAsB,CAAC2H,SAAD,EAAYqE,iBAAZ,EAA+BpD,GAA/B,EAAoCD,IAApC,EAA0CR,IAA1C,EAAgD,MAAhD,EAAwD,IAAxD,EAA8DC,QAA9D,CAA7B;AACD,GAFD,MAEO,IAAIsD,WAAW,IAAIA,WAAW,CAACd,IAA/B,EAAqC;AAC1ChC,IAAAA,GAAG,GAAG6C,MAAM,CAAC9D,SAAD,EAAYiB,GAAZ,EAAiBR,QAAjB,CAAZ;AACA,WAAOrI,sBAAsB,CAAC4H,SAAD,EAAY+D,WAAZ,EAAyB9C,GAAzB,EAA8BD,IAA9B,CAA7B;AACD,GAHM,MAGA,IAAI+C,WAAW,IAAIA,WAAW,CAACF,IAA/B,EAAqC;AAC1C,WAAOvL,oBAAoB,CAAC0H,SAAD,EAAY+D,WAAW,CAACF,IAAxB,EAA8B5C,GAA9B,EAAmCD,IAAnC,EAAyCR,IAAzC,EAA+C,IAA/C,CAA3B;AACD,GAX2D,CAW1D;;;AAGF,SAAO,IAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAShI,YAAT,CAAsBwH,SAAtB,EAAiCsE,OAAjC,EAA0CrD,GAA1C,EAA+CD,IAA/C,EAAqDR,IAArD,EAA2DC,QAA3D,EAAqE;AACnE;AACA,MAAI,CAAC6D,OAAO,CAACA,OAAO,CAACC,IAAT,CAAZ,EAA4B;AAC1B,WAAO,KAAP;AACD;;AAED,UAAQD,OAAO,CAACC,IAAhB;AACE,SAAK,QAAL;AACEtD,MAAAA,GAAG,GAAG6C,MAAM,CAAC9D,SAAD,EAAYiB,GAAZ,EAAiBR,QAAjB,EAA2B6D,OAAO,CAACE,MAAnC,CAAZ;AACA,aAAOpM,sBAAsB,CAAC4H,SAAD,EAAYsE,OAAO,CAACE,MAApB,EAA4BvD,GAA5B,EAAiCD,IAAjC,CAA7B;;AAEF,SAAK,YAAL;AACE,aAAO3I,sBAAsB,CAAC2H,SAAD,EAAYsE,OAAO,CAACG,UAApB,EAAgCxD,GAAhC,EAAqCD,IAArC,EAA2CR,IAA3C,EAAiD,QAAjD,EAA2D,KAA3D,EAAkEC,QAAlE,CAA7B;;AAEF,SAAK,MAAL;AACE,aAAOnI,oBAAoB,CAAC0H,SAAD,EAAYsE,OAAO,CAACT,IAApB,EAA0B5C,GAA1B,EAA+BD,IAA/B,EAAqCR,IAArC,EAA2C,KAA3C,CAA3B;AATJ,GANmE,CAgBjE;;;AAGF,SAAO,KAAP;AACD;;AAED,SAAS/H,iBAAT,CAA2BuH,SAA3B,EAAsC0E,MAAtC,EAA8CC,MAA9C,EAAsD1D,GAAtD,EAA2DD,IAA3D,EAAiEP,QAAjE,EAA2E;AACzE,MAAImE,QAAQ,GAAGF,MAAM,CAACE,QAAP,CAAgBjN,KAA/B;;AAEA,UAAQ+M,MAAM,CAACE,QAAP,CAAgBL,IAAxB;AACE,SAAK,SAAL;AACE;AACE,YAAIM,YAAY,GAAGvI,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoB6D,SAApB,EAA+B4E,QAA/B,EAAyC,KAAzC,EAAgDzG,QAAhD,EAAnB;;AAEA,YAAI2G,QAAQ,GAAGJ,MAAM,CAACK,KAAP,CAAa5G,QAAb,EAAf;;AAEA,YAAI0G,YAAY,KAAKC,QAArB,EAA+B;AAC7BxI,UAAAA,OAAO,CAACD,OAAR,CAAgBuG,GAAhB,CAAoB5C,SAApB,EAA+B4E,QAA/B,EAAyCE,QAAQ,KAAK,MAAtD;AACD;;AAED;AACD;;AAEH,SAAK,QAAL;AACE;AACE,YAAIE,QAAQ,GAAG;AACbhE,UAAAA,IAAI,EAAEA,IADO;AAEbC,UAAAA,GAAG,EAAEA,GAFQ;AAGbjB,UAAAA,SAAS,EAAEA,SAHE;AAIb2E,UAAAA,MAAM,EAAEA;AAJK,SAAf;AAMA,YAAIM,SAAS,GAAGP,MAAM,CAACE,QAAP,CAAgB5E,SAAhB,GAA4B0E,MAAM,CAACA,MAAM,CAACE,QAAP,CAAgB5E,SAAjB,CAAlC,GAAgE0E,MAAM,CAAClC,IAAvF;;AAEA,YAAI0C,aAAa,GAAG5I,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoB6D,SAApB,EAA+B4E,QAA/B,EAAyC,EAAzC,CAApB;;AAEA,YAAIO,SAAS,GAAG1E,QAAQ,IAAIA,QAAQ,CAACzF,WAArB,GAAmCyF,QAAQ,CAACzF,WAAT,CAAqBiK,SAArB,EAAgCD,QAAhC,CAAnC,GAA+E5I,UAAU,CAACC,OAAX,CAAmBrB,WAAnB,CAA+BiK,SAA/B,EAA0CD,QAA1C,CAA/F;;AAEA,YAAIG,SAAS,KAAKD,aAAlB,EAAiC;AAC/B5I,UAAAA,OAAO,CAACD,OAAR,CAAgBuG,GAAhB,CAAoB5C,SAApB,EAA+B4E,QAA/B,EAAyCO,SAAzC;AACD;;AAED;AACD;AAjCL;;AAoCA,SAAOnF,SAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAStH,YAAT,CAAsB0M,GAAtB,EAA2B;AACzB,MAAI,OAAOrD,MAAP,KAAkB,WAAlB,IAAiC,EAAE,eAAeA,MAAjB,CAArC,EAA+D;AAC7D,WAAOqD,GAAP;AACD;;AAED,MAAIC,GAAG,GAAG,IAAItD,MAAM,CAACuD,SAAX,GAAuBC,eAAvB,CAAuCH,GAAvC,EAA4C,WAA5C,CAAV;AACA,SAAOC,GAAG,CAACG,eAAJ,CAAoBC,WAA3B;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS9M,0BAAT,CAAoCyM,GAApC,EAAyCM,QAAzC,EAAmD;AACjD,MAAIL,GAAG,GAAG,IAAItD,MAAM,CAACuD,SAAX,GAAuBC,eAAvB,CAAuCH,GAAvC,EAA4C,WAA5C,CAAV;AACA,SAAOC,GAAG,CAACM,IAAJ,CAASC,aAAT,CAAuBF,QAAvB,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS9M,UAAT,CAAoB0F,IAApB,EAA0BuH,QAA1B,EAAoCC,WAApC,EAAiD;AAC/CD,EAAAA,QAAQ,GAAGA,QAAQ,IAAI,uBAAvB,CAD+C,CACC;;AAEhD,MAAI,CAACA,QAAQ,CAACpC,QAAT,CAAkB,UAAlB,CAAL,EAAoC;AAClCoC,IAAAA,QAAQ,GAAG,GAAGrG,MAAH,CAAUqG,QAAV,EAAoB,WAApB,CAAX;AACD;;AAED,MAAIE,KAAK,GAAGzH,IAAI,CAAC0H,KAAL,CAAW,GAAX,CAAZ;AACA,MAAIC,QAAQ,GAAGF,KAAK,CAAC3H,KAAN,CAAY,CAAZ,EAAe2H,KAAK,CAAChH,MAAN,GAAe,CAA9B,EAAiCmH,IAAjC,CAAsC,GAAtC,CAAf;AACA,MAAIC,SAAS,GAAGJ,KAAK,CAAChH,MAAN,GAAe,CAAf,GAAmB,IAAIS,MAAJ,CAAWlD,OAAO,CAACD,OAAR,CAAgB+J,IAAhB,CAAqBL,KAArB,CAAX,CAAnB,GAA6D,EAA7E,CAT+C,CASkC;;AAEjFE,EAAAA,QAAQ,GAAGA,QAAQ,CAACI,MAAT,CAAgB,CAAhB,EAAmB,GAAnB,CAAX;AACAP,EAAAA,WAAW,GAAGtO,MAAM,CAAC8O,MAAP,CAAcR,WAAW,IAAI,EAA7B,EAAiC;AAC7CG,IAAAA,QAAQ,EAAEA,QADmC;AAE7CpN,IAAAA,IAAI,EAAEA,IAAI;AAFmC,GAAjC,CAAd,CAZ+C,CAe3C;;AAEJ,MAAID,UAAU,GAAG,GAAG4G,MAAH,CAAUpD,UAAU,CAACC,OAAX,CAAmBrB,WAAnB,CAA+B6K,QAA/B,EAAyCC,WAAzC,CAAV,EAAiEtG,MAAjE,CAAwE2G,SAAxE,EAAmFxF,OAAnF,CAA2F,oBAA3F,EAAiH,GAAjH,CAAjB;AACA,SAAO/H,UAAP;AACD;;AAED,SAASC,IAAT,GAAgB;AACd,SAAO,uCAAuC8H,OAAvC,CAA+C,OAA/C,EAAwD,UAAU4F,CAAV,EAAa;AAC1E,QAAIC,CAAC,GAAGhF,IAAI,CAACC,MAAL,KAAgB,EAAhB,GAAqB,CAA7B;AACA,QAAIgF,CAAC,GAAGF,CAAC,KAAK,GAAN,GAAYC,CAAZ,GAAgBA,CAAC,GAAG,GAAJ,GAAU,GAAlC;AACA,WAAOC,CAAC,CAACtI,QAAF,CAAW,EAAX,CAAP;AACD,GAJM,CAAP;AAKD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASrF,cAAT,CAAwB2G,IAAxB,EAA8B;AAC5B,MAAInD,OAAO,CAACD,OAAR,CAAgB6G,KAAhB,CAAsBzD,IAAtB,KAA+BnD,OAAO,CAACD,OAAR,CAAgBqK,KAAhB,CAAsBjH,IAAtB,CAA/B,IAA8DA,IAAI,KAAK,EAA3E,EAA+E;AAC7E,WAAO,IAAP;AACD;;AAED,MAAIA,IAAI,YAAYkH,IAApB,EAA0B;AACxB,WAAOlH,IAAP;AACD,GAFD,MAEO,IAAI,OAAOA,IAAI,CAACmH,MAAZ,KAAuB,UAA3B,EAAuC;AAC5C,WAAOnH,IAAI,CAACoH,OAAL,KAAiBpH,IAAI,CAACmH,MAAL,EAAjB,GAAiC,IAAxC;AACD;;AAED,MAAIE,WAAW,GAAG,OAAOrH,IAAP,KAAgB,QAAhB,IAA4BA,IAAI,CAACsB,OAAL,CAAa,SAAb,MAA4B,CAAC,CAAzD,GAA6D,CAAC,GAAGvE,eAAe,CAACH,OAApB,EAA6BoD,IAA7B,CAA7D,GAAkG,IAApH;;AAEA,MAAIqH,WAAW,IAAIA,WAAW,CAACD,OAAZ,EAAnB,EAA0C;AACxC,WAAOC,WAAW,CAACF,MAAZ,EAAP;AACD;;AAEDE,EAAAA,WAAW,GAAG,IAAd;;AAEA,MAAI;AACF,QAAInP,KAAK,GAAGyE,UAAU,CAACC,OAAX,CAAmB6E,SAAnB,CAA6B,UAAU1B,MAAV,CAAiBC,IAAjB,EAAuB,GAAvB,CAA7B,EAA0D,QAA1D,EAAoEjD,eAAe,CAACH,OAApF,CAAZ;;AAEA,QAAI,OAAO1E,KAAP,KAAiB,QAArB,EAA+B;AAC7BmP,MAAAA,WAAW,GAAG,CAAC,GAAGtK,eAAe,CAACH,OAApB,EAA6B1E,KAA7B,CAAd;AACD,KAFD,MAEO,IAAI,OAAOA,KAAK,CAACiP,MAAb,KAAwB,UAA5B,EAAwC;AAC7CE,MAAAA,WAAW,GAAG,CAAC,GAAGtK,eAAe,CAACH,OAApB,EAA6B1E,KAAK,CAACiP,MAAN,GAAeG,WAAf,EAA7B,CAAd;AACD,KAFM,MAEA,IAAIpP,KAAK,YAAYgP,IAArB,EAA2B;AAChCG,MAAAA,WAAW,GAAG,CAAC,GAAGtK,eAAe,CAACH,OAApB,EAA6B1E,KAA7B,CAAd;AACD;AACF,GAVD,CAUE,OAAOqP,CAAP,EAAU;AACV,WAAO,IAAP;AACD;;AAED,MAAI,CAACF,WAAL,EAAkB;AAChB,WAAO,IAAP;AACD,GAnC2B,CAmC1B;;;AAGF,MAAI,CAACA,WAAW,CAACD,OAAZ,EAAL,EAA4B;AAC1B,WAAO,IAAP;AACD;;AAED,SAAOC,WAAW,CAACF,MAAZ,EAAP;AACD;;AAED,SAAS7N,WAAT,CAAqB0G,IAArB,EAA2B;AACzB,SAAOnD,OAAO,CAACD,OAAR,CAAgB4K,MAAhB,CAAuBxH,IAAvB,KAAgC,CAACnD,OAAO,CAACD,OAAR,CAAgBqK,KAAhB,CAAsBjH,IAAI,CAACyH,OAAL,EAAtB,CAAxC;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAASlO,eAAT,GAA2B;AACzB,MAAIwD,eAAe,CAACH,OAAhB,CAAwBrD,eAA5B,EAA6C;AAC3C,WAAOwD,eAAe,CAACH,OAAhB,CAAwBrD,eAA/B;AACD;;AAEDwD,EAAAA,eAAe,CAACH,OAAhB,CAAwBrD,eAAxB,GAA0C2D,iBAAiB,CAACN,OAAlB,CAA0B8K,SAA1B,GAAsC7I,IAAtC,EAA1C;AACA,SAAO9B,eAAe,CAACH,OAAhB,CAAwBrD,eAA/B;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASC,UAAT,CAAoBwG,IAApB,EAA0B2H,QAA1B,EAAoC;AAClC,MAAIA,QAAQ,KAAK,KAAjB,EAAwB;AACtB,WAAO;AACL3H,MAAAA,IAAI,EAAE,IAAIkH,IAAJ,CAASlH,IAAI,CAAC4H,OAAL,KAAiB5H,IAAI,CAAC6H,iBAAL,KAA2B,KAArD,CADD;AAELC,MAAAA,IAAI,EAAE;AAFD,KAAP;AAID;;AAED,MAAIC,UAAU,GAAG,CAAC,GAAGhL,eAAe,CAACH,OAApB,EAA6BoD,IAA7B,EAAmCgI,EAAnC,CAAsCL,QAAtC,CAAjB;AACA,SAAO;AACL3H,IAAAA,IAAI,EAAE,IAAIkH,IAAJ,CAASlH,IAAI,CAAC4H,OAAL,KAAiB,CAACG,UAAU,CAACE,SAAX,KAAyBjI,IAAI,CAAC6H,iBAAL,EAA1B,IAAsD,KAAhF,CADD;AAELC,IAAAA,IAAI,EAAEC,UAAU,CAACG,MAAX,CAAkB,GAAlB;AAFD,GAAP;AAID;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAASzO,WAAT,GAAuB;AACrB,SAAOsD,eAAe,CAACH,OAAhB,CAAwBnD,WAA/B;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASC,eAAT,CAAyBiO,QAAzB,EAAmC;AACjC,MAAIA,QAAQ,KAAKpO,eAAe,EAA5B,IAAkCoO,QAAQ,KAAK,KAAnD,EAA0D;AACxD,WAAO,KAAP;AACD;;AAED,SAAO,IAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAShO,SAAT,CAAmBgO,QAAnB,EAA6B;AAC3B,MAAIA,QAAQ,IAAI,CAACjO,eAAe,CAACiO,QAAD,CAAhC,EAA4C;AAC1C;AACA,WAAO,IAAIvK,kBAAkB,CAACR,OAAvB,CAA+BC,OAAO,CAACD,OAAR,CAAgBuL,IAA/C,CAAP;AACD;;AAED,MAAIpL,eAAe,CAACH,OAAhB,CAAwBwL,YAA5B,EAA0C;AACxC,WAAOrL,eAAe,CAACH,OAAhB,CAAwBwL,YAA/B;AACD;;AAED,SAAOrL,eAAe,CAACH,OAAhB,CAAwBwL,YAAxB,GAAuCxI,KAAK,CAAC,6DAAD,CAAL,CAAqEyI,IAArE,CAA0E,UAAUC,IAAV,EAAgB;AACtI,WAAOA,IAAI,CAAClE,IAAL,GAAYiE,IAAZ,CAAiB,UAAUE,KAAV,EAAiB;AACvCxL,MAAAA,eAAe,CAACH,OAAhB,CAAwBoL,EAAxB,CAA2BQ,IAA3B,CAAgCD,KAAhC;;AAEAxL,MAAAA,eAAe,CAACH,OAAhB,CAAwBnD,WAAxB,GAAsC,IAAtC,CAHuC,CAGK;;AAE5C,UAAIgP,QAAQ,IAAIA,QAAQ,CAACC,WAArB,IAAoCD,QAAQ,CAACvC,IAA7C,IAAqDuC,QAAQ,CAACvC,IAAT,CAAcyC,aAAvE,EAAsF;AACpF,YAAIC,KAAK,GAAGH,QAAQ,CAACC,WAAT,CAAqB,OAArB,CAAZ;AACAE,QAAAA,KAAK,CAACC,SAAN,CAAgB,aAAhB,EAA+B,IAA/B,EAAqC,IAArC;AACAJ,QAAAA,QAAQ,CAACvC,IAAT,CAAcyC,aAAd,CAA4BC,KAA5B;AACD;AACF,KAVM,CAAP;AAWD,GAZ6C,CAA9C;AAaD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAShP,UAAT,CAAoB1B,KAApB,EAA2BgQ,MAA3B,EAAmCP,QAAnC,EAA6C;AAC3C,MAAI/N,UAAU,GAAG,CAAC,GAAGmD,eAAe,CAACH,OAApB,EAA6B1E,KAA7B,CAAjB;;AAEA,MAAIyP,QAAQ,KAAK,KAAjB,EAAwB;AACtBA,IAAAA,QAAQ,GAAG,SAAX;AACD;;AAED,MAAI,CAACA,QAAQ,KAAKpO,eAAe,EAA5B,IAAkC2O,MAAM,IAAIA,MAAM,CAAC/G,KAAP,CAAa,YAAb,CAA7C,KAA4EpE,eAAe,CAACH,OAAhB,CAAwBnD,WAAxG,EAAqH;AACnH,WAAOG,UAAU,CAACoO,EAAX,CAAcL,QAAd,CAAP;AACD;;AAED,SAAO/N,UAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASC,UAAT,CAAoB3B,KAApB,EAA2BgQ,MAA3B,EAAmCP,QAAnC,EAA6CmB,oBAA7C,EAAmE;AACjE,MAAIlP,UAAU,GAAG,CAAC,GAAGmD,eAAe,CAACH,OAApB,EAA6B1E,KAA7B,EAAoC4Q,oBAAoB,IAAI1F,SAA5D,CAAjB;;AAEA,MAAIuE,QAAQ,KAAKpO,eAAe,EAAhC,EAAoC;AAClC;AACA,QAAI2O,MAAM,CAAC/G,KAAP,CAAa,YAAb,CAAJ,EAAgC;AAC9BxH,MAAAA,SAAS;;AAET,UAAIoD,eAAe,CAACH,OAAhB,CAAwBnD,WAA5B,EAAyC;AACvC,eAAOG,UAAU,CAACoO,EAAX,CAAcL,QAAd,EAAwBO,MAAxB,CAA+BjO,qBAAqB,CAACiO,MAAD,CAApD,CAAP;AACD,OAFD,MAEO;AACL,eAAOtO,UAAU,CAACsO,MAAX,CAAkBjO,qBAAqB,CAACiO,MAAM,CAAChH,OAAP,CAAe,YAAf,EAA6B,EAA7B,CAAD,CAAvC,CAAP;AACD;AACF,KAViC,CAUhC;;;AAGF,WAAOtH,UAAU,CAACsO,MAAX,CAAkBjO,qBAAqB,CAACiO,MAAD,CAAvC,CAAP;AACD;;AAED,MAAIP,QAAQ,KAAK,KAAjB,EAAwB;AACtB,QAAIoB,MAAM,GAAGvP,UAAU,CAACI,UAAU,CAACuN,MAAX,EAAD,EAAsB,KAAtB,CAAvB;AACA,WAAO,GAAGpH,MAAH,CAAU,CAAC,GAAGhD,eAAe,CAACH,OAApB,EAA6BmM,MAAM,CAAC/I,IAApC,EAA0CkI,MAA1C,CAAiDjO,qBAAqB,CAACiO,MAAD,CAAtE,CAAV,EAA2F,MAA3F,CAAP;AACD,GAtBgE,CAsB/D;;;AAGFvO,EAAAA,SAAS;;AAET,MAAIoD,eAAe,CAACH,OAAhB,CAAwBnD,WAAxB,IAAuCkO,QAA3C,EAAqD;AACnD,WAAO/N,UAAU,CAACoO,EAAX,CAAcL,QAAd,EAAwBO,MAAxB,CAA+B,GAAGnI,MAAH,CAAU9F,qBAAqB,CAACiO,MAAD,CAA/B,EAAyC,IAAzC,CAA/B,CAAP;AACD,GAFD,MAEO;AACL,WAAOtO,UAAU,CAACsO,MAAX,CAAkBjO,qBAAqB,CAACiO,MAAD,CAAvC,CAAP;AACD;AACF;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASpO,YAAT,CAAsBkP,QAAtB,EAAgChJ,IAAhC,EAAsCkI,MAAtC,EAA8CP,QAA9C,EAAwD;AACtD,MAAIA,QAAQ,KAAKpO,eAAe,EAAhC,EAAoC;AAClC,WAAOyP,QAAQ,CAAChJ,IAAD,EAAOkI,MAAP,CAAf;AACD;;AAED,MAAIP,QAAQ,KAAK,KAAjB,EAAwB;AACtB,WAAO,GAAG5H,MAAH,CAAUiJ,QAAQ,CAACxP,UAAU,CAACwG,IAAD,EAAO,KAAP,CAAV,CAAwBA,IAAzB,EAA+BkI,MAA/B,CAAlB,EAA0D,MAA1D,CAAP;AACD,GAPqD,CAOpD;;;AAGFvO,EAAAA,SAAS;;AAET,MAAIoD,eAAe,CAACH,OAAhB,CAAwBnD,WAA5B,EAAyC;AACvC,QAAIsP,MAAM,GAAGvP,UAAU,CAACwG,IAAD,EAAO2H,QAAP,CAAvB;AACA,WAAO,GAAG5H,MAAH,CAAUiJ,QAAQ,CAACD,MAAM,CAAC/I,IAAR,EAAckI,MAAd,CAAlB,EAAyC,GAAzC,EAA8CnI,MAA9C,CAAqDgJ,MAAM,CAACjB,IAA5D,CAAP;AACD,GAHD,MAGO;AACL,WAAOkB,QAAQ,CAAChJ,IAAD,EAAOkI,MAAP,CAAf;AACD;AACF;;AAED,SAASnO,uBAAT,CAAiCkP,MAAjC,EAAyC;AACvC,MAAIC,UAAU,GAAG,EAAjB;AACA,MAAIC,GAAG,GAAG,EAAV;AACA,MAAIC,WAAW,GAAG,IAAIlC,IAAJ,CAAS,IAAT,EAAe,EAAf,EAAmBiC,GAAnB,CAAlB;AACA,MAAIE,eAAe,GAAGD,WAAW,CAACE,kBAAZ,CAA+BL,MAA/B,CAAtB;AACAC,EAAAA,UAAU,CAACK,QAAX,GAAsBF,eAAe,CAAC1K,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,MAAgCwK,GAAG,CAACzK,QAAJ,EAAtD;AACA,SAAOwK,UAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAASlP,wBAAT,CAAkCkO,MAAlC,EAA0C;AACxC,SAAOA,MAAM,CAAC;AAAD,GACZhH,OADM,CACE,IADF,EACQ,EADR,EACY;AADZ,GAENA,OAFM,CAEE,IAFF,EAEQ,GAFR,EAEaA,OAFb,CAEqB,MAFrB,EAE6B,GAF7B,EAEkCA,OAFlC,CAE0C,IAF1C,EAEgD,GAFhD,EAEqD;AAFrD,GAGNA,OAHM,CAGE,MAHF,EAGU,GAHV,EAGeA,OAHf,CAGuB,IAHvB,EAG6B,GAH7B,EAGkCA,OAHlC,CAG0C,KAH1C,EAGiD,GAHjD,EAGsDA,OAHtD,CAG8D,IAH9D,EAGoE,GAHpE,EAGyE;AAHzE,GAINA,OAJM,CAIE,IAJF,EAIQ,GAJR,EAIaA,OAJb,CAIqB,KAJrB,EAI4B,GAJ5B,EAIiC;AAJjC,GAKNA,OALM,CAKE,MALF,EAKU,GALV,EAKeA,OALf,CAKuB,KALvB,EAK8B,GAL9B,EAKmC;AALnC,GAMNA,OANM,CAME,IANF,EAMQ,GANR,EAMaA,OANb,CAMqB,IANrB,EAM2B,GAN3B,EAMgCA,OANhC,CAMwC,IANxC,EAM8C,GAN9C,EAMmDA,OANnD,CAM2D,IAN3D,EAMiE,GANjE,EAMsEA,OANtE,CAM8E,IAN9E,EAMoF,GANpF,CAAP;AAOD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAASjH,qBAAT,CAA+BiO,MAA/B,EAAuC;AACrC,SAAOA,MAAM,CAAC;AAAD,GACZhH,OADM,CACE,IADF,EACQ,GADR,EACa;AADb,GAENA,OAFM,CAEE,IAFF,EAEQ,GAFR,EAEa;AAFb,GAGNA,OAHM,CAGE,IAHF,EAGQ,GAHR,EAGa;AAHb,GAINA,OAJM,CAIE,IAJF,EAIQ,GAJR,EAIa;AAJb,GAKNA,OALM,CAKE,IALF,EAKQ,GALR,CAAP;AAMD;;AAED,SAAShH,mBAAT,CAA6BgO,MAA7B,EAAqC;AACnC,SAAOA,MAAM,CAAC;AAAD,GACZhH,OADM,CACE,OADF,EACW,IADX,EACiB;AADjB,GAENA,OAFM,CAEE,OAFF,EAEW,KAFX,EAEkB;AAFlB,GAGNA,OAHM,CAGE,IAHF,EAGQ,GAHR,EAGa;AAHb,GAINA,OAJM,CAIE,aAJF,EAIiB,GAJjB,EAIsB;AAJtB,GAKNA,OALM,CAKE,IALF,EAKQ,IALR,CAAP;AAMD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS/G,YAAT,CAAsBqP,IAAtB,EAA4BC,eAA5B,EAA6C;AAC3C,MAAID,IAAI,YAAY1K,KAApB,EAA2B;AACzB,WAAO0K,IAAP;AACD;;AAED,MAAIE,SAAS,GAAG,EAAhB;AACAA,EAAAA,SAAS,CAACC,OAAV,GAAoB,IAApB;;AAEA,OAAK,IAAIpK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiK,IAAI,CAAClK,MAAzB,EAAiCC,CAAC,EAAlC,EAAsC;AACpC,YAAQiK,IAAI,CAACjK,CAAD,CAAZ;AACE,WAAK,GAAL;AACEmK,QAAAA,SAAS,CAACE,IAAV,CAAe,IAAf;AACA;;AAEF,WAAK,GAAL;AACEF,QAAAA,SAAS,CAACC,OAAV,GAAoB,KAApB;AACAD,QAAAA,SAAS,CAACE,IAAV,CAAe,UAAf;AACA;;AAEF,WAAK,GAAL;AACEF,QAAAA,SAAS,CAACC,OAAV,GAAoB,KAApB;AACAD,QAAAA,SAAS,CAACE,IAAV,CAAe,OAAf;AACA;;AAEF,WAAK,GAAL;AACEF,QAAAA,SAAS,CAACC,OAAV,GAAoB,KAApB;AACAD,QAAAA,SAAS,CAACE,IAAV,CAAe,aAAf;AACA;AACF;;AAEA,WAAKH,eAAL;AACEC,QAAAA,SAAS,CAACC,OAAV,GAAoB,KAApB;AACAD,QAAAA,SAAS,CAACE,IAAV,CAAe,GAAf;AACA;;AAEF;AACEF,QAAAA,SAAS,CAACC,OAAV,GAAoB,KAApB;AACAD,QAAAA,SAAS,CAACE,IAAV,CAAeJ,IAAI,CAACjK,CAAD,CAAnB;AACA;AA7BJ;AA+BD;;AAED,SAAOmK,SAAP;AACD;;AAED,SAAStP,WAAT,CAAqBlC,KAArB,EAA4BsR,IAA5B,EAAkCC,eAAlC,EAAmD;AACjD,MAAI,CAACD,IAAD,IAAS,CAACtR,KAAV,IAAmBA,KAAK,CAACoH,MAAN,GAAekK,IAAI,CAAClK,MAA3C,EAAmD;AACjD,WAAOpH,KAAP;AACD;;AAED,MAAI2R,aAAa,GAAG3R,KAAK,CAACqO,KAAN,CAAY,EAAZ,CAApB;;AAEA,OAAK,IAAIhH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiK,IAAI,CAAClK,MAAzB,EAAiCC,CAAC,EAAlC,EAAsC;AACpC,QAAIuK,IAAI,GAAG5R,KAAK,CAACqH,CAAD,CAAL,IAAY,EAAvB;AACA,QAAIwK,QAAQ,GAAGP,IAAI,CAACjK,CAAD,CAAnB;;AAEA,QAAI,CAAC1C,OAAO,CAACD,OAAR,CAAgBoN,QAAhB,CAAyBD,QAAzB,CAAD,IAAuCD,IAAI,KAAKC,QAApD,EAA8D;AAC5DF,MAAAA,aAAa,CAACtK,CAAD,CAAb,GAAmB,EAAnB;AACD;AACF;;AAEDsK,EAAAA,aAAa,GAAGA,aAAa,CAACpD,IAAd,CAAmB,EAAnB,EAAuBvF,OAAvB,CAA+BuI,eAA/B,EAAgD,EAAhD,CAAhB;AACA,SAAOI,aAAP;AACD;;AAED,SAASxP,cAAT,CAAwBnC,KAAxB,EAA+B+R,SAA/B,EAA0C;AACxC,MAAI,CAACA,SAAL,EAAgB;AACd,WAAO,IAAP;AACD,GAHuC,CAGtC;;;AAGF,MAAI/R,KAAK,CAACoH,MAAN,GAAe2K,SAAS,CAAC3K,MAA7B,EAAqC;AACnC,WAAO,KAAP;AACD;;AAED,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0K,SAAS,CAAC3K,MAA9B,EAAsCC,CAAC,EAAvC,EAA2C;AACzC,QAAIuK,IAAI,GAAG5R,KAAK,CAACqH,CAAD,CAAL,IAAY,EAAvB;AACA,QAAIwK,QAAQ,GAAGE,SAAS,CAAC1K,CAAD,CAAxB;;AAEA,QAAI,EAAE1C,OAAO,CAACD,OAAR,CAAgBoN,QAAhB,CAAyBD,QAAzB,KAAsCA,QAAQ,CAAC/K,IAAT,CAAc8K,IAAd,CAAtC,IAA6DC,QAAQ,KAAKD,IAA5E,CAAJ,EAAuF;AACrF,aAAO,KAAP;AACD;AACF;;AAED,SAAO,IAAP;AACD;;AAED,SAASxP,mBAAT,GAA+B;AAC7B,MAAI4P,IAAI,GAAGC,SAAS,CAAC7K,MAAV,GAAmB,CAAnB,IAAwB6K,SAAS,CAAC,CAAD,CAAT,KAAiB/G,SAAzC,GAAqD+G,SAAS,CAAC,CAAD,CAA9D,GAAoE,IAA/E;AACA,MAAIC,qBAAqB,GAAG,WAAWC,cAAX,CAA0BH,IAA1B,CAA5B;AACA,MAAII,UAAU,GAAGF,qBAAqB,CAACjJ,KAAtB,CAA4B,eAA5B,CAAjB;;AAEA,MAAI,CAACmJ,UAAL,EAAiB;AACf,WAAO;AACLC,MAAAA,SAAS,EAAE,GADN;AAELC,MAAAA,gBAAgB,EAAE;AAFb,KAAP;AAID;;AAED,SAAO;AACLD,IAAAA,SAAS,EAAED,UAAU,CAAChL,MAAX,GAAoB,CAApB,GAAwBgL,UAAU,CAAC,CAAD,CAAlC,GAAwC,GAD9C;AAELE,IAAAA,gBAAgB,EAAEF,UAAU,CAAChL,MAAX,GAAoB,CAApB,GAAwBgL,UAAU,CAAC,CAAD,CAAlC,GAAwC;AAFrD,GAAP;AAID;;AAED,SAAS/P,qBAAT,CAA+BgG,SAA/B,EAA0CkK,YAA1C,EAAwD;AACtD,MAAI5N,OAAO,CAACD,OAAR,CAAgBkH,GAAhB,CAAoBvD,SAApB,EAA+B,cAA/B,CAAJ,EAAoD;AAClD,WAAO1D,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoB6D,SAApB,EAA+B,cAA/B,CAAP;AACD,GAHqD,CAGpD;;;AAGF,MAAImK,YAAY,GAAGD,YAAY,IAAI,EAAnC;;AAEA,MAAIE,IAAI,GAAG9N,OAAO,CAACD,OAAR,CAAgBF,GAAhB,CAAoB6D,SAApB,EAA+B,eAA/B,EAAgD,KAAhD,CAAX;;AAEA,MAAIoK,IAAI,KAAK,KAAb,EAAoB;AAClB,QAAIrE,KAAK,GAAGqE,IAAI,CAACjM,QAAL,GAAgB6H,KAAhB,CAAsB,GAAtB,CAAZ;;AAEA,QAAID,KAAK,CAAChH,MAAN,GAAe,CAAnB,EAAsB;AACpBoL,MAAAA,YAAY,GAAGpE,KAAK,CAAC,CAAD,CAAL,CAAShH,MAAxB;AACD;AACF;;AAED,SAAOoL,YAAP;AACD;;AAED,SAASlQ,kBAAT,CAA4BoQ,IAA5B,EAAkC;AAChC,MAAIC,aAAa,GAAGD,IAAI,CAACE,QAAzB;AAAA,MACIA,QAAQ,GAAGD,aAAa,KAAK,KAAK,CAAvB,GAA2B,KAA3B,GAAmCA,aADlD;AAAA,MAEIH,YAAY,GAAGE,IAAI,CAACF,YAFxB;AAAA,MAGIF,gBAAgB,GAAGI,IAAI,CAACJ,gBAH5B;AAAA,MAIIN,IAAI,GAAGU,IAAI,CAACV,IAJhB,CADgC,CAMhC;;AACA,MAAIa,KAAK,GAAG,QAAQhL,MAAR,CAAe,KAAKsK,cAAL,CAAoBH,IAApB,CAAf,CAAZ;;AAEA,MAAIQ,YAAJ,EAAkB;AAChBK,IAAAA,KAAK,IAAI,GAAGhL,MAAH,CAAUyK,gBAAgB,KAAK,GAArB,GAA2B,KAA3B,GAAmCA,gBAA7C,EAA+DzK,MAA/D,CAAsE,GAAGsK,cAAH,CAAkBH,IAAlB,CAAtE,EAA+F,GAA/F,EAAoGnK,MAApG,CAA2G2K,YAA3G,EAAyH,GAAzH,CAAT;AACD;;AAEDK,EAAAA,KAAK,IAAI,OAAT;AACA,MAAIzE,KAAK,GAAG,KAAK+D,cAAL,CAAoBH,IAApB,EAA0B;AACpChI,IAAAA,KAAK,EAAE,UAD6B;AAEpC4I,IAAAA,QAAQ,EAAEA,QAF0B;AAGpCE,IAAAA,WAAW,EAAE,IAHuB;AAIpCC,IAAAA,qBAAqB,EAAEP,YAAY,IAAI,CAJH;AAKpCQ,IAAAA,qBAAqB,EAAER,YAAY,IAAI;AALH,GAA1B,EAMTxJ,OANS,CAMD,GANC,EAMIsJ,gBANJ,EAMsBrJ,KANtB,CAM4B,IAAIgK,MAAJ,CAAWJ,KAAX,CAN5B,CAAZ;AAOA,SAAO;AACLK,IAAAA,MAAM,EAAE,CAAC9E,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqC,KAAK,CAA1C,GAA8CA,KAAK,CAAC,CAAD,CAApD,KAA4D,EAD/D;AAEL+E,IAAAA,MAAM,EAAE,CAAC/E,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqC,KAAK,CAA1C,GAA8CA,KAAK,CAAC,CAAD,CAApD,KAA4D;AAF/D,GAAP;AAID;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS7L,SAAT,CAAmB8G,IAAnB,EAAyBhB,SAAzB,EAAoC;AAClC,MAAI,CAACgB,IAAL,EAAW;AACT,WAAO,EAAP;AACD;;AAED,MAAI,CAAChB,SAAD,IAAc,CAACA,SAAS,CAAC9C,GAA7B,EAAkC;AAChC,WAAO8D,IAAP;AACD;;AAED,MAAIhB,SAAS,CAAC9C,GAAV,CAAcuG,QAAd,CAAuB,GAAvB,CAAJ,EAAiC;AAC/B,QAAI9L,KAAK,GAAGqJ,IAAZ;AACA,QAAI+E,KAAK,GAAG/F,SAAS,CAAC9C,GAAV,CAAc8I,KAAd,CAAoB,GAApB,CAAZ;AACA,QAAI9I,GAAG,GAAG,EAAV;;AAEA,SAAK,IAAI8B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+G,KAAK,CAAChH,MAA1B,EAAkCC,CAAC,EAAnC,EAAuC;AACrC9B,MAAAA,GAAG,GAAG6I,KAAK,CAAC/G,CAAD,CAAX,CADqC,CACrB;;AAEhB,UAAIrH,KAAK,CAACyF,cAAN,CAAqB,KAArB,CAAJ,EAAiC;AAC/BzF,QAAAA,KAAK,GAAGA,KAAK,CAACqJ,IAAd;AACD,OALoC,CAKnC;;;AAGF,UAAI,CAACrJ,KAAK,CAACyF,cAAN,CAAqBF,GAArB,CAAL,EAAgC;AAC9B;AACD,OAVoC,CAUnC;;;AAGF,UAAIA,GAAG,KAAK6I,KAAK,CAACA,KAAK,CAAChH,MAAN,GAAe,CAAhB,CAAb,IAAmCiB,SAAS,CAAC+K,QAA7C,IAAyD,CAACxM,KAAK,CAACM,OAAN,CAAclH,KAAK,CAACuF,GAAD,CAAnB,CAA9D,EAAyF;AACvFvF,QAAAA,KAAK,CAACuF,GAAD,CAAL,GAAa,CAACvF,KAAK,CAACuF,GAAD,CAAN,CAAb;AACD,OAfoC,CAenC;;;AAGFvF,MAAAA,KAAK,GAAGA,KAAK,CAACuF,GAAD,CAAb;AACD;;AAED,WAAOvF,KAAP;AACD,GA3BD,MA2BO;AACL;AACA,QAAIqI,SAAS,CAAC+K,QAAV,IAAsB,CAACxM,KAAK,CAACM,OAAN,CAAcmC,IAAI,CAAChB,SAAS,CAAC9C,GAAX,CAAlB,CAA3B,EAA+D;AAC7D8D,MAAAA,IAAI,CAAChB,SAAS,CAAC9C,GAAX,CAAJ,GAAsB,CAAC8D,IAAI,CAAChB,SAAS,CAAC9C,GAAX,CAAL,CAAtB;AACD,KAJI,CAIH;;;AAGF,QAAI8C,SAAS,CAACuE,IAAV,KAAmB,UAAnB,IAAiCvE,SAAS,CAACgL,SAAV,KAAwB,OAA7D,EAAsE;AACpE,aAAOhK,IAAI,CAAChB,SAAS,CAAC1B,IAAX,CAAJ,KAAyB0B,SAAS,CAACrI,KAA1C;AACD;;AAED,WAAOqJ,IAAI,CAAChB,SAAS,CAAC9C,GAAX,CAAX;AACD;AACF;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS/C,KAAT,CAAe8Q,EAAf,EAAmB;AACjB,MAAI9Q,KAAK,GAAGyP,SAAS,CAAC7K,MAAV,GAAmB,CAAnB,IAAwB6K,SAAS,CAAC,CAAD,CAAT,KAAiB/G,SAAzC,GAAqD+G,SAAS,CAAC,CAAD,CAA9D,GAAoE,CAAhF;;AAEA,OAAK,IAAIsB,IAAI,GAAGtB,SAAS,CAAC7K,MAArB,EAA6BqB,IAAI,GAAG,IAAI7B,KAAJ,CAAU2M,IAAI,GAAG,CAAP,GAAWA,IAAI,GAAG,CAAlB,GAAsB,CAAhC,CAApC,EAAwEC,IAAI,GAAG,CAApF,EAAuFA,IAAI,GAAGD,IAA9F,EAAoGC,IAAI,EAAxG,EAA4G;AAC1G/K,IAAAA,IAAI,CAAC+K,IAAI,GAAG,CAAR,CAAJ,GAAiBvB,SAAS,CAACuB,IAAD,CAA1B;AACD;;AAED,MAAIC,KAAK,GAAGC,UAAU,CAAC9J,KAAX,CAAiB,KAAK,CAAtB,EAAyB,CAAC0J,EAAD,EAAK9Q,KAAL,EAAYqF,MAAZ,CAAmBY,IAAnB,CAAzB,CAAZ;;AAEA,WAASkL,MAAT,GAAkB;AAChBC,IAAAA,YAAY,CAACH,KAAD,CAAZ;AACD;;AAED,WAASI,SAAT,GAAqB;AACnBF,IAAAA,MAAM;AACN,WAAOL,EAAE,CAAC1J,KAAH,CAAS,KAAK,CAAd,EAAiBnB,IAAjB,CAAP;AACD;;AAEDoL,EAAAA,SAAS,CAACJ,KAAV,GAAkBA,KAAlB;AACAI,EAAAA,SAAS,CAACF,MAAV,GAAmBA,MAAnB;AACA,SAAOE,SAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASpR,UAAT,CAAoB8C,GAApB,EAAyB;AACvB,MAAI,CAACA,GAAG,CAAC0D,KAAJ,CAAU,QAAV,CAAL,EAA0B;AACxB,WAAO,GAAGpB,MAAH,CAAUtC,GAAV,EAAe,GAAf,CAAP;AACD;;AAED,SAAOA,GAAG,CAACyD,OAAJ,CAAY,QAAZ,EAAsB,UAAUmK,MAAV,EAAkB;AAC7C,WAAOW,MAAM,CAACX,MAAD,CAAN,GAAiB,CAAxB;AACD,GAFM,CAAP;AAGD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASzQ,SAAT,CAAmBmJ,GAAnB,EAAwBkI,IAAxB,EAA8B;AAC5B,MAAIC,MAAM,GAAGD,IAAb;;AAEA,SAAOlI,GAAG,CAACpG,cAAJ,CAAmBuO,MAAnB,CAAP,EAAmC;AACjCA,IAAAA,MAAM,GAAGvR,UAAU,CAACuR,MAAD,CAAnB;AACD;;AAED,SAAOA,MAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAASrR,gBAAT,CAA0BsR,OAA1B,EAAmC;AACjC,MAAIA,OAAO,CAACC,SAAZ,EAAuB;AACrB,WAAOD,OAAO,CAACC,SAAf;AACD;;AAED,MAAI,OAAOC,CAAP,KAAa,UAAb,IAA2B,OAAOA,CAAC,GAAGC,QAAX,KAAwB,UAAvD,EAAmE;AACjE,WAAOC,QAAQ,CAACF,CAAC,CAACb,EAAF,CAAKc,QAAL,CAAcE,WAAd,CAA0BC,OAA1B,CAAkClG,KAAlC,CAAwC,GAAxC,EAA6C,CAA7C,CAAD,EAAkD,EAAlD,CAAf;AACD;;AAED,SAAO,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASzL,MAAT,CAAgByM,CAAhB,EAAmB;AACjB,MAAI,OAAOA,CAAP,KAAa,UAAjB,EAA6B;AAC3B,WAAOA,CAAC,EAAR;AACD;;AAED,SAAOA,CAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,IAAIxM,WAAW,GAAG8B,OAAO,CAACD,OAAR,CAAgB8P,IAAhB,CAAqB,CAAC7P,OAAO,CAACD,OAAR,CAAgB+P,YAAhB,CAA6B9P,OAAO,CAACD,OAAR,CAAgBmH,GAA7C,EAAkDjJ,MAAlD,CAAD,EAA4D+B,OAAO,CAACD,OAAR,CAAgB+P,YAAhB,CAA6B9P,OAAO,CAACD,OAAR,CAAgBgQ,IAA7C,EAAmD,UAAU5F,CAAV,EAAa;AACjK,SAAO,CAACnK,OAAO,CAACD,OAAR,CAAgBiQ,WAAhB,CAA4B7F,CAA5B,CAAR;AACD,CAFkG,CAA5D,CAArB,CAAlB;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA/O,OAAO,CAAC8C,WAAR,GAAsBA,WAAtB;;AAEA,SAASC,UAAT,CAAoB8R,CAApB,EAAuBC,CAAvB,EAA0B;AACxB,MAAIzH,KAAK,GAAGwH,CAAZ;AACA,MAAIE,IAAI,GAAGD,CAAX;;AAEA,WAASrQ,GAAT,GAAe;AACb,WAAO4I,KAAP;AACD;;AAED,WAAS2H,MAAT,GAAkB;AAChB,QAAIC,IAAI,GAAG5H,KAAX;AACAA,IAAAA,KAAK,GAAG0H,IAAR;AACAA,IAAAA,IAAI,GAAGE,IAAP;AACD;;AAED,SAAO,CAACxQ,GAAD,EAAMuQ,MAAN,CAAP;AACD;;AAED,SAAShS,eAAT,CAAyBkS,QAAzB,EAAmC;AACjC,MAAIhB,OAAO,GAAGhC,SAAS,CAAC7K,MAAV,GAAmB,CAAnB,IAAwB6K,SAAS,CAAC,CAAD,CAAT,KAAiB/G,SAAzC,GAAqD+G,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAlF;AACA,MAAIiD,cAAc,GAAGjB,OAAO,CAACkB,KAA7B;AAAA,MACIA,KAAK,GAAGD,cAAc,KAAK,KAAK,CAAxB,GAA4B,EAA5B,GAAiCA,cAD7C;AAAA,MAEIE,cAAc,GAAGnB,OAAO,CAACzR,KAF7B;AAAA,MAGIA,KAAK,GAAG4S,cAAc,KAAK,KAAK,CAAxB,GAA4B,GAA5B,GAAkCA,cAH9C;AAIA,MAAIC,SAAS,GAAG,CAAhB;AACA,MAAIC,SAAS,GAAG,CAAhB;;AAEA,MAAIC,KAAK,GAAG,SAASA,KAAT,GAAiB;AAC3B,WAAOF,SAAS,GAAG,CAAnB;AACD,GAFD;;AAIA,SAAO,YAAY;AACjB,QAAIC,SAAS,KAAK,CAAlB,EAAqB;AACnB1B,MAAAA,YAAY,CAAC0B,SAAD,CAAZ;AACAA,MAAAA,SAAS,GAAG,CAAZ;AACD;;AAEDA,IAAAA,SAAS,GAAG5B,UAAU,CAAC6B,KAAD,EAAQ/S,KAAR,CAAtB;AACA6S,IAAAA,SAAS,IAAI,CAAb;;AAEA,QAAIA,SAAS,IAAIF,KAAjB,EAAwB;AACtBvB,MAAAA,YAAY,CAAC0B,SAAD,CAAZ;AACAC,MAAAA,KAAK;AACL,aAAON,QAAQ,EAAf;AACD;AACF,GAdD;AAeD;;AAED,SAASjS,oBAAT,CAA8BwS,OAA9B,EAAuC;AACrC,MAAIhM,MAAM,GAAG,EAAb;AACAgM,EAAAA,OAAO,CAACC,KAAR,CAAcC,aAAd,CAA4BF,OAAO,CAAC1M,QAAR,CAAiBmL,OAAjB,CAAyB0B,QAAzB,CAAkCC,UAA9D,EAA0E,UAAUvN,SAAV,EAAqBC,IAArB,EAA2B;AACnG,QAAID,SAAS,CAAC9C,GAAV,KAAkBiQ,OAAO,CAACnM,IAAR,CAAa9D,GAAnC,EAAwC;AACtCiE,MAAAA,MAAM,CAACkI,IAAP,CAAY;AACVmE,QAAAA,KAAK,EAAE,GAAGhO,MAAH,CAAUQ,SAAS,CAACwN,KAAV,IAAmBxN,SAAS,CAAC9C,GAAvC,EAA4C,IAA5C,EAAkDsC,MAAlD,CAAyDS,IAAzD,EAA+D,GAA/D,CADG;AAEVtI,QAAAA,KAAK,EAAEsI;AAFG,OAAZ;AAID;AACF,GAPD;AAQA,SAAOkB,MAAP;AACD;;AAED,SAASvG,iBAAT,CAA2BuS,OAA3B,EAAoC;AAClC,MAAIhM,MAAM,GAAG,EAAb;AACAgM,EAAAA,OAAO,CAACC,KAAR,CAAcC,aAAd,CAA4BF,OAAO,CAAC1M,QAAR,CAAiBmL,OAAjB,CAAyB0B,QAAzB,CAAkCC,UAA9D,EAA0E,UAAUvN,SAAV,EAAqB;AAC7F,QAAIA,SAAS,CAACuE,IAAV,KAAmB,QAAvB,EAAiC;AAC/BpD,MAAAA,MAAM,CAACkI,IAAP,CAAY;AACVmE,QAAAA,KAAK,EAAE,GAAGhO,MAAH,CAAUQ,SAAS,CAAC9C,GAApB,EAAyB,IAAzB,EAA+BsC,MAA/B,CAAsCQ,SAAS,CAACwN,KAAhD,EAAuD,GAAvD,CADG;AAEV7V,QAAAA,KAAK,EAAEqI,SAAS,CAAC9C;AAFP,OAAZ;AAID;AACF,GAPD;AAQA,SAAOiE,MAAP;AACD,C,CAAC;;;AAGF,IAAIsM,UAAU,GAAG,CAAC,OAAD,EAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B,GAA1B,EAA+B,OAA/B,EAAwC,QAAxC,EAAkD,KAAlD,EAAyD,KAAzD,EAAgE,KAAhE,EAAuE,KAAvE,EAA8E,MAA9E,EAAsF,MAAtF,CAAjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASC,kBAAT,CAA4BC,IAA5B,EAAkCC,SAAlC,EAA6C;AAC3C,MAAI,CAACD,IAAI,CAACE,SAAV,EAAqB;AACnB,WAAOF,IAAI,CAACG,SAAZ;AACD;;AAED,MAAIC,SAAS,GAAGJ,IAAI,CAACE,SAAL,CAAelN,OAAf,CAAuBvE,UAAU,CAACC,OAAX,CAAmB2R,gBAAnB,CAAoChT,WAA3D,EAAwE,EAAxE,EAA4E2F,OAA5E,CAAoF,QAApF,EAA8F,GAA9F,EAAmGsN,IAAnG,EAAhB;AACA,MAAIC,eAAe,GAAGN,SAAS,CAACG,SAAD,CAA/B;;AAEA,MAAIA,SAAS,KAAKG,eAAlB,EAAmC;AACjC,QAAIC,KAAK,GAAGR,IAAI,CAACG,SAAL,CAAelN,KAAf,CAAqB,qBAArB,CAAZ;;AAEA,QAAIuN,KAAK,IAAIA,KAAK,CAACpP,MAAnB,EAA2B;AACzB,UAAIoP,KAAK,CAACpP,MAAN,KAAiB,CAAjB,IAAsBoP,KAAK,CAAC,CAAD,CAAL,CAASpP,MAAT,KAAoB4O,IAAI,CAACG,SAAL,CAAe/O,MAA7D,EAAqE;AACnE,eAAO4O,IAAI,CAACG,SAAL,CAAenN,OAAf,CAAuBoN,SAAvB,EAAkCG,eAAlC,CAAP;AACD;;AAED,UAAIE,eAAe,GAAGD,KAAK,CAAC3K,GAAN,CAAU,UAAU6K,IAAV,EAAgB;AAC9C,YAAIC,QAAQ,GAAGpG,QAAQ,CAACqG,aAAT,CAAuB,GAAvB,CAAf;AACAD,QAAAA,QAAQ,CAACR,SAAT,GAAqBO,IAArB;AACA,eAAOX,kBAAkB,CAACY,QAAD,EAAWV,SAAX,CAAzB;AACD,OAJqB,CAAtB;AAKA,aAAO,GAAGpO,MAAH,CAAU0O,eAAV,EAA2B,IAA3B,EAAiC1O,MAAjC,CAAwC4O,eAAe,CAAClI,IAAhB,CAAqB,IAArB,CAAxC,EAAoE,GAApE,CAAP;AACD,KAXD,MAWO;AACL,aAAOyH,IAAI,CAACE,SAAL,CAAelN,OAAf,CAAuBoN,SAAvB,EAAkCG,eAAlC,CAAP;AACD;AACF,GAjBD,MAiBO;AACL,WAAOP,IAAI,CAACG,SAAZ;AACD;AACF;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASU,gBAAT,CAA0BC,GAA1B,EAA+Bb,SAA/B,EAA0C;AACxC,MAAIc,QAAQ,GAAGD,GAAG,CAACC,QAAJ,CAAa3P,MAAb,IAAuBvB,kBAAkB,CAACiR,GAAG,CAACC,QAAL,CAAxD;;AAEA,MAAIC,4BAA4B,GAAGD,QAAQ,IAAIA,QAAQ,CAACE,KAAT,CAAe,UAAUC,KAAV,EAAiB;AAC7E,WAAOA,KAAK,CAACH,QAAN,CAAe3P,MAAf,KAA0B,CAA1B,IAA+B0O,UAAU,CAACqB,IAAX,CAAgB,UAAUL,GAAV,EAAe;AACnE,aAAOI,KAAK,CAACE,QAAN,KAAmBN,GAA1B;AACD,KAFqC,CAAtC;AAGD,GAJ8C,CAA/C;;AAMA,MAAI,CAACC,QAAD,IAAaC,4BAAjB,EAA+C;AAC7CF,IAAAA,GAAG,CAACX,SAAJ,GAAgBJ,kBAAkB,CAACe,GAAD,EAAMb,SAAN,CAAlC;AACD,GAFD,MAEO;AACLc,IAAAA,QAAQ,CAACzR,OAAT,CAAiB,UAAU4R,KAAV,EAAiB;AAChC,aAAOL,gBAAgB,CAACK,KAAD,EAAQjB,SAAR,CAAvB;AACD,KAFD;AAGD;AACF;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS/S,qBAAT,CAA+BgL,QAA/B,EAAyC+H,SAAzC,EAAoD;AAClD,MAAIoB,MAAM,GAAG,UAAUvQ,IAAV,CAAeoH,QAAf,CAAb;;AAEA,MAAI,CAACmJ,MAAL,EAAa;AACX,WAAOpB,SAAS,CAAC/H,QAAD,CAAhB;AACD;;AAED,MAAIoJ,QAAQ,GAAG/G,QAAQ,CAACqG,aAAT,CAAuB,KAAvB,CAAf;AACAU,EAAAA,QAAQ,CAACnB,SAAT,GAAqBjI,QAArB;;AAEA,MAAIoJ,QAAQ,CAACpB,SAAT,IAAsBoB,QAAQ,CAACP,QAAT,CAAkB3P,MAA5C,EAAoD;AAClDyP,IAAAA,gBAAgB,CAACS,QAAD,EAAWrB,SAAX,CAAhB;AACA,WAAOqB,QAAQ,CAACnB,SAAhB;AACD;;AAED,SAAOjI,QAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS/K,QAAT,CAAkBoU,MAAlB,EAA0BtD,OAA1B,EAAmC;AACjC,MAAI,OAAO9O,UAAU,CAACT,OAAX,CAAmBvB,QAA1B,KAAuC,UAA3C,EAAuD;AACrD,WAAOoU,MAAP;AACD,GAHgC,CAG/B;;;AAGF,MAAIC,eAAe,GAAG;AACpBC,IAAAA,QAAQ,EAAE,CAAC,KAAD,EAAQ,QAAR,CADU;AAEpBC,IAAAA,YAAY,EAAE;AACZC,MAAAA,IAAI,EAAE;AADM;AAFM,GAAtB,CANiC,CAW9B;;AAEH,MAAI1D,OAAO,CAAC2D,cAAR,IAA0BhR,KAAK,CAACM,OAAN,CAAc+M,OAAO,CAAC2D,cAAR,CAAuBC,OAArC,CAA1B,IAA2E5D,OAAO,CAAC2D,cAAR,CAAuBC,OAAvB,CAA+BzQ,MAA/B,GAAwC,CAAvH,EAA0H;AACxH6M,IAAAA,OAAO,CAAC2D,cAAR,CAAuBC,OAAvB,CAA+BvS,OAA/B,CAAuC,UAAUwS,IAAV,EAAgB;AACrDN,MAAAA,eAAe,CAACC,QAAhB,CAAyB/F,IAAzB,CAA8BoG,IAA9B;AACD,KAFD;AAGD,GAjBgC,CAiB/B;;;AAGF,MAAI7D,OAAO,CAAC2D,cAAR,IAA0BhR,KAAK,CAACM,OAAN,CAAc+M,OAAO,CAAC2D,cAAR,CAAuBG,OAArC,CAA1B,IAA2E9D,OAAO,CAAC2D,cAAR,CAAuBG,OAAvB,CAA+B3Q,MAA/B,GAAwC,CAAvH,EAA0H;AACxHoQ,IAAAA,eAAe,CAACQ,QAAhB,GAA2B/D,OAAO,CAAC2D,cAAR,CAAuBG,OAAlD;AACD,GAtBgC,CAsB/B;;;AAGF,MAAI9D,OAAO,CAAC2D,cAAR,IAA0BhR,KAAK,CAACM,OAAN,CAAc+M,OAAO,CAAC2D,cAAR,CAAuBK,WAArC,CAA1B,IAA+EhE,OAAO,CAAC2D,cAAR,CAAuBK,WAAvB,CAAmC7Q,MAAnC,GAA4C,CAA/H,EAAkI;AAChIoQ,IAAAA,eAAe,CAACU,YAAhB,GAA+BjE,OAAO,CAAC2D,cAAR,CAAuBK,WAAtD;AACD,GA3BgC,CA2B/B;;;AAGF,MAAIhE,OAAO,CAAC2D,cAAR,IAA0BhR,KAAK,CAACM,OAAN,CAAc+M,OAAO,CAAC2D,cAAR,CAAuBO,YAArC,CAA1B,IAAgFlE,OAAO,CAAC2D,cAAR,CAAuBO,YAAvB,CAAoC/Q,MAApC,GAA6C,CAAjI,EAAoI;AAClIoQ,IAAAA,eAAe,CAACY,YAAhB,GAA+BnE,OAAO,CAAC2D,cAAR,CAAuBO,YAAtD;AACD,GAhCgC,CAgC/B;;;AAGF,MAAIlE,OAAO,CAAC2D,cAAR,IAA0B3D,OAAO,CAAC2D,cAAR,CAAuBS,eAArD,EAAsE;AACpEb,IAAAA,eAAe,CAACc,kBAAhB,GAAqCrE,OAAO,CAAC2D,cAAR,CAAuBS,eAA5D;AACD,GArCgC,CAqC/B;;;AAGF,MAAIpE,OAAO,CAAC2D,cAAR,IAA0BhR,KAAK,CAACM,OAAN,CAAc+M,OAAO,CAAC2D,cAAR,CAAuBW,cAArC,CAA1B,IAAkFtE,OAAO,CAAC2D,cAAR,CAAuBW,cAAvB,CAAsCnR,MAAtC,GAA+C,CAArI,EAAwI;AACtIoQ,IAAAA,eAAe,CAACgB,iBAAhB,GAAoCvE,OAAO,CAAC2D,cAAR,CAAuBW,cAA3D;AACD;;AAED,SAAOpT,UAAU,CAACT,OAAX,CAAmBvB,QAAnB,CAA4BoU,MAA5B,EAAoCC,eAApC,CAAP;AACD;AACD;AACA;AACA;;;AAGA,SAASpU,aAAT,CAAuBuC,GAAvB,EAA4B;AAC1B,SAAOA,GAAG,GAAG8S,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAehT,GAAf,CAAX,CAAH,GAAqCA,GAA/C;AACD;;AAED,SAASrC,gBAAT,CAA0BsV,aAA1B,EAAyC;AACvC,MAAIA,aAAa,CAACC,KAAd,KAAwB,KAAxB,IAAiCD,aAAa,CAACC,KAAd,KAAwB,IAA7D,EAAmE;AACjE,WAAOD,aAAa,CAACC,KAArB;AACD;;AAED,UAAQD,aAAa,CAAChM,IAAtB;AACE,SAAK,aAAL;AACA,SAAK,SAAL;AACA,SAAK,SAAL;AACA,SAAK,UAAL;AACA,SAAK,OAAL;AACA,SAAK,OAAL;AACA,SAAK,MAAL;AACA,SAAK,MAAL;AACA,SAAK,QAAL;AACE,aAAO,KAAP;;AAEF;AACE,aAAO,IAAP;AAbJ;AAeD;;AAED,SAASrJ,yBAAT,CAAmCuV,OAAnC,EAA4C;AAC1C,MAAI,CAACA,OAAD,IAAY,CAACnU,OAAO,CAACD,OAAR,CAAgBiG,QAAhB,CAAyBmO,OAAzB,CAAjB,EAAoD;AAClD,QAAI,CAACnU,OAAO,CAACD,OAAR,CAAgBwC,OAAhB,CAAwB4R,OAAxB,CAAL,EAAuC;AACrC,aAAO,CAACA,OAAD,CAAP;AACD;;AAED,WAAOA,OAAP;AACD;;AAED,SAAOA,OAAO,CAAC9P,OAAR,CAAgB,QAAhB,EAA0B,GAA1B,EAA+BA,OAA/B,CAAuC,OAAvC,EAAgD,GAAhD,EAAqDA,OAArD,CAA6D,cAA7D,EAA6E,EAA7E,EAAiFqF,KAAjF,CAAuF,GAAvF,EAA4FxC,GAA5F,CAAgG,UAAUkN,IAAV,EAAgB;AACrH,WAAOpU,OAAO,CAACD,OAAR,CAAgBsU,SAAhB,CAA0BrU,OAAO,CAACD,OAAR,CAAgBuU,QAAhB,CAAyBF,IAAzB,CAA1B,EAA0DA,IAA1D,CAAP;AACD,GAFM,CAAP;AAGD;;AAED,SAASvV,mBAAT,CAA6B6E,SAA7B,EAAwC;AACtC,SAAOA,SAAS,CAAC6Q,aAAV,GAA0B/B,IAA1B,CAA+B,UAAUgC,IAAV,EAAgB;AACpD,QAAIxU,OAAO,CAACD,OAAR,CAAgBwC,OAAhB,CAAwBiS,IAAI,CAACvD,UAA7B,CAAJ,EAA8C;AAC5C,aAAOpS,mBAAmB,CAAC2V,IAAD,CAA1B;AACD;;AAED,WAAOA,IAAI,CAACC,KAAZ;AACD,GANM,CAAP;AAOD;;AAED,SAAS3V,0BAAT,CAAoC6E,IAApC,EAA0C;AACxC,MAAI,CAAC3D,OAAO,CAACD,OAAR,CAAgBwC,OAAhB,CAAwBoB,IAAxB,CAAL,EAAoC;AAClC,WAAOA,IAAP;AACD;;AAED,MAAI+Q,OAAO,GAAG,EAAd;AACA/Q,EAAAA,IAAI,CAAChD,OAAL,CAAa,UAAUyT,IAAV,EAAgB1R,CAAhB,EAAmB;AAC9B,QAAI1C,OAAO,CAACD,OAAR,CAAgB4U,QAAhB,CAAyBP,IAAzB,CAAJ,EAAoC;AAClCM,MAAAA,OAAO,IAAI,IAAIxR,MAAJ,CAAWkR,IAAX,EAAiB,GAAjB,CAAX;AACD,KAFD,MAEO;AACLM,MAAAA,OAAO,IAAIhS,CAAC,KAAK,CAAN,GAAU0R,IAAV,GAAiB,IAAIlR,MAAJ,CAAWkR,IAAX,CAA5B;AACD;AACF,GAND;AAOA,SAAOM,OAAP;AACD;;AAED,SAAS3V,KAAT,CAAe6V,MAAf,EAAuBC,SAAvB,EAAkC;AAChC,MAAI7U,OAAO,CAACD,OAAR,CAAgB4U,QAAhB,CAAyBC,MAAzB,CAAJ,EAAsC;AACpC,WAAOA,MAAM,CAACE,OAAP,CAAeD,SAAf,CAAP;AACD;;AAED,SAAOD,MAAP;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAS5V,mBAAT,GAA+B;AAC7B,MAAI+V,eAAe,GAAG9V,cAAc,EAApC;AAAA,MACI+V,EAAE,GAAGD,eAAe,CAACC,EADzB;AAAA,MAEIC,OAAO,GAAGF,eAAe,CAACE,OAF9B;;AAIA,SAAOD,EAAE,GAAGC,OAAH,GAAa,IAAtB;AACD;AACD;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAShW,cAAT,GAA0B;AACxB,MAAIiW,OAAO,GAAG,EAAd;;AAEA,MAAI,OAAOzP,MAAP,KAAkB,WAAtB,EAAmC;AACjC,WAAOyP,OAAP;AACD;;AAED,MAAIC,EAAE,GAAG1P,MAAM,CAAC2P,SAAP,CAAiBC,SAAjB,CAA2BpP,WAA3B,EAAT;AACA,MAAI3B,KAAK,GAAG,uBAAuBgR,IAAvB,CAA4BH,EAA5B,KAAmC,mBAAmBG,IAAnB,CAAwBH,EAAxB,CAAnC,IAAkE,0BAA0BG,IAA1B,CAA+BH,EAA/B,CAAlE,IAAwG,uBAAuBG,IAAvB,CAA4BH,EAA5B,CAAxG,IAA2I,wBAAwBG,IAAxB,CAA6BH,EAA7B,CAA3I,IAA+K,2DAA2DG,IAA3D,CAAgEH,EAAhE,CAA/K,IAAsP,oEAAoEG,IAApE,CAAyEH,EAAzE,CAAtP,IAAsU,uBAAuBG,IAAvB,CAA4BH,EAA5B,CAAtU,IAAyW,oCAAoCG,IAApC,CAAyCH,EAAzC,CAAzW,IAAyZ,kBAAkBG,IAAlB,CAAuBH,EAAvB,CAAzZ,IAAubA,EAAE,CAAC1Q,OAAH,CAAW,SAAX,KAAyB,CAAzB,IAA8B,sBAAsB6Q,IAAtB,CAA2BH,EAA3B,CAArd,IAAufA,EAAE,CAAC1Q,OAAH,CAAW,YAAX,IAA2B,CAA3B,IAAgC,gCAAgC6Q,IAAhC,CAAqCH,EAArC,CAAvhB,IAAmkB,EAA/kB;AACA,MAAII,OAAO,GAAG;AACZL,IAAAA,OAAO,EAAE5Q,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAjB,IAAwBA,KAAK,CAAC,CAAD,CAA7B,IAAoC,EADjC;AAEZ2Q,IAAAA,OAAO,EAAE3Q,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAjB,IAAwB;AAFrB,GAAd;;AAKA,MAAIiR,OAAO,CAACL,OAAZ,EAAqB;AACnBA,IAAAA,OAAO,CAACK,OAAO,CAACL,OAAT,CAAP,GAA2B,IAA3B;AACAA,IAAAA,OAAO,CAACD,OAAR,GAAkBvF,QAAQ,CAAC6F,OAAO,CAACN,OAAT,EAAkB,EAAlB,CAA1B;AACD,GAjBuB,CAiBtB;;;AAGF,MAAIC,OAAO,CAACM,MAAR,IAAkBN,OAAO,CAACO,GAA1B,IAAiCP,OAAO,CAACQ,MAAzC,IAAmDR,OAAO,CAACS,GAA3D,IAAkET,OAAO,CAACU,SAA9E,EAAyF;AACvFV,IAAAA,OAAO,CAACW,QAAR,GAAmB,IAAnB;AACD,GAtBuB,CAsBtB;;;AAGF,MAAIX,OAAO,CAACY,EAAR,IAAcZ,OAAO,CAACa,QAA1B,EAAoC;AAClCb,IAAAA,OAAO,CAACF,EAAR,GAAa,IAAb;AACD,GA3BuB,CA2BtB;;;AAGF,MAAIE,OAAO,CAACS,GAAZ,EAAiB;AACfT,IAAAA,OAAO,CAACc,IAAR,GAAe,IAAf;AACD,GAhCuB,CAgCtB;;;AAGF,MAAId,OAAO,CAACO,GAAZ,EAAiB;AACfP,IAAAA,OAAO,CAACe,KAAR,GAAgB,IAAhB;AACD;;AAED,SAAOf,OAAP;AACD;;AAED,SAAShW,+BAAT,GAA2C;AACzC,MAAIyE,IAAI,GAAG2J,SAAS,CAAC7K,MAAV,GAAmB,CAAnB,IAAwB6K,SAAS,CAAC,CAAD,CAAT,KAAiB/G,SAAzC,GAAqD+G,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAA/E;AACA,SAAO3J,IAAI,CAACU,OAAL,CAAa,SAAb,EAAwB,EAAxB,CAAP;AACD;AACD;AACA;AACA;AACA;;;AAGA,SAASlF,gBAAT,CAA0BuE,SAA1B,EAAqC;AACnC,MAAIwS,gBAAJ;;AAEA,MAAIvS,IAAI,GAAG2J,SAAS,CAAC7K,MAAV,GAAmB,CAAnB,IAAwB6K,SAAS,CAAC,CAAD,CAAT,KAAiB/G,SAAzC,GAAqD+G,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAA/E;;AAEA,MAAI,CAAC5J,SAAD,IAAc,CAACA,SAAS,CAAC9C,GAAzB,IAAgC,CAAC8C,SAAS,KAAK,IAAd,IAAsBA,SAAS,KAAK,KAAK,CAAzC,GAA6C,KAAK,CAAlD,GAAsD,CAACwS,gBAAgB,GAAGxS,SAAS,CAACyS,KAA9B,MAAyC,IAAzC,IAAiDD,gBAAgB,KAAK,KAAK,CAA3E,GAA+E,KAAK,CAApF,GAAwFA,gBAAgB,CAACE,OAAhK,MAA6K,QAAjN,EAA2N;AACzN;AACA,WAAOzS,IAAP;AACD;;AAEDA,EAAAA,IAAI,GAAGD,SAAS,CAAC/E,gBAAV,IAA8B+E,SAAS,CAACwQ,KAAV,KAAoB,IAAlD,GAAyD,GAAGhR,MAAH,CAAUQ,SAAS,CAAC9C,GAApB,EAAyBsC,MAAzB,CAAgCS,IAAI,GAAG,GAAH,GAAS,EAA7C,EAAiDT,MAAjD,CAAwDS,IAAxD,CAAzD,GAAyHA,IAAhI;AACA,SAAOxE,gBAAgB,CAACuE,SAAS,CAAC2S,MAAX,EAAmB1S,IAAnB,CAAvB;AACD;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAASvE,sBAAT,CAAgCkX,iBAAhC,EAAmD;AACjD,MAAI,CAACA,iBAAL,EAAwB;AACtB;AACD;;AAED,MAAID,MAAM,GAAGC,iBAAiB,CAACD,MAA/B;;AAEA,MAAIA,MAAM,KAAKA,MAAM,CAAC1X,gBAAP,IAA2B0X,MAAM,CAACnC,KAAvC,CAAV,EAAyD;AACvD,WAAOmC,MAAP;AACD,GAFD,MAEO;AACL,WAAOjX,sBAAsB,CAACiX,MAAD,CAA7B;AACD;AACF;AACD;AACA;AACA;AACA;AACA;;;AAGA,SAAShX,SAAT,CAAmBhE,KAAnB,EAA0B;AACxB,MAAIkb,kBAAJ;;AAEA,SAAOlb,KAAK,IAAIA,KAAK,CAACmQ,IAAf,IAAuB,OAAOnQ,KAAK,CAACmQ,IAAb,KAAsB,UAA7C,IAA2D,CAACnQ,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqC,KAAK,CAA1C,GAA8C,CAACkb,kBAAkB,GAAGlb,KAAK,CAAC0G,WAA5B,MAA6C,IAA7C,IAAqDwU,kBAAkB,KAAK,KAAK,CAAjF,GAAqF,KAAK,CAA1F,GAA8FA,kBAAkB,CAACvU,IAAhK,MAA0K,SAA5O;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAAS1C,wBAAT,CAAkCgX,iBAAlC,EAAqD;AACnD,MAAIE,SAAS,GAAGlJ,SAAS,CAAC7K,MAAV,GAAmB,CAAnB,IAAwB6K,SAAS,CAAC,CAAD,CAAT,KAAiB/G,SAAzC,GAAqD+G,SAAS,CAAC,CAAD,CAA9D,GAAoE,IAApF;;AAEA,MAAI,CAACkJ,SAAD,IAAcF,iBAAiB,KAAK,IAApC,IAA4CA,iBAAiB,KAAK,KAAK,CAAvE,IAA4EA,iBAAiB,CAACG,iBAAlG,EAAqH;AACnH,WAAO,IAAP;AACD;;AAED,MAAI7S,UAAU,GAAGxE,sBAAsB,CAACkX,iBAAD,CAAvC;;AAEA,MAAI1S,UAAU,KAAK,IAAf,IAAuBA,UAAU,KAAK,KAAK,CAA3C,IAAgDA,UAAU,CAAC6S,iBAA/D,EAAkF;AAChF,WAAO,IAAP;AACD,GAFD,MAEO,IAAI7S,UAAU,KAAK,IAAf,IAAuBA,UAAU,KAAK,KAAK,CAA3C,IAAgDA,UAAU,CAACyS,MAA/D,EAAuE;AAC5E,WAAO/W,wBAAwB,CAACsE,UAAU,CAACyS,MAAZ,EAAoB,KAApB,CAA/B;AACD;;AAED,SAAO,KAAP;AACD;;AAED,SAAS9W,oBAAT,CAA8BiG,OAA9B,EAAuC;AACrC,MAAIkR,iBAAiB,GAAG,sIAAxB;AACA,SAAOlR,OAAO,CAACmR,gBAAR,CAAyBD,iBAAzB,CAAP;AACD,C,CAAC","sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _exportNames = {\n  evaluate: true,\n  getRandomComponentId: true,\n  getPropertyValue: true,\n  getElementRect: true,\n  boolValue: true,\n  isMongoId: true,\n  checkCalculated: true,\n  checkSimpleConditional: true,\n  checkCustomConditional: true,\n  checkJsonConditional: true,\n  checkCondition: true,\n  checkTrigger: true,\n  setActionProperty: true,\n  unescapeHTML: true,\n  convertStringToHTMLElement: true,\n  uniqueName: true,\n  guid: true,\n  getDateSetting: true,\n  isValidDate: true,\n  currentTimezone: true,\n  offsetDate: true,\n  zonesLoaded: true,\n  shouldLoadZones: true,\n  loadZones: true,\n  momentDate: true,\n  formatDate: true,\n  formatOffset: true,\n  getLocaleDateFormatInfo: true,\n  convertFormatToFlatpickr: true,\n  convertFormatToMoment: true,\n  convertFormatToMask: true,\n  getInputMask: true,\n  unmaskValue: true,\n  matchInputMask: true,\n  getNumberSeparators: true,\n  getNumberDecimalLimit: true,\n  getCurrencyAffixes: true,\n  fieldData: true,\n  delay: true,\n  iterateKey: true,\n  uniqueKey: true,\n  bootstrapVersion: true,\n  unfold: true,\n  firstNonNil: true,\n  withSwitch: true,\n  observeOverload: true,\n  getContextComponents: true,\n  getContextButtons: true,\n  translateHTMLTemplate: true,\n  sanitize: true,\n  fastCloneDeep: true,\n  interpolate: true,\n  isInputComponent: true,\n  getArrayFromComponentPath: true,\n  hasInvalidComponent: true,\n  getStringFromComponentPath: true,\n  round: true,\n  getIEBrowserVersion: true,\n  getBrowserInfo: true,\n  getComponentPathWithoutIndicies: true,\n  getComponentPath: true,\n  getDataParentComponent: true,\n  isPromise: true,\n  isInsideScopingComponent: true,\n  getFocusableElements: true,\n  _: true,\n  jsonLogic: true,\n  moment: true,\n  Evaluator: true\n};\nObject.defineProperty(exports, \"Evaluator\", {\n  enumerable: true,\n  get: function get() {\n    return _Evaluator.default;\n  }\n});\nObject.defineProperty(exports, \"_\", {\n  enumerable: true,\n  get: function get() {\n    return _lodash.default;\n  }\n});\nexports.boolValue = boolValue;\nexports.bootstrapVersion = bootstrapVersion;\nexports.checkCalculated = checkCalculated;\nexports.checkCondition = checkCondition;\nexports.checkCustomConditional = checkCustomConditional;\nexports.checkJsonConditional = checkJsonConditional;\nexports.checkSimpleConditional = checkSimpleConditional;\nexports.checkTrigger = checkTrigger;\nexports.convertFormatToFlatpickr = convertFormatToFlatpickr;\nexports.convertFormatToMask = convertFormatToMask;\nexports.convertFormatToMoment = convertFormatToMoment;\nexports.convertStringToHTMLElement = convertStringToHTMLElement;\nexports.currentTimezone = currentTimezone;\nexports.delay = delay;\nexports.evaluate = evaluate;\nexports.fastCloneDeep = fastCloneDeep;\nexports.fieldData = fieldData;\nexports.firstNonNil = void 0;\nexports.formatDate = formatDate;\nexports.formatOffset = formatOffset;\nexports.getArrayFromComponentPath = getArrayFromComponentPath;\nexports.getBrowserInfo = getBrowserInfo;\nexports.getComponentPath = getComponentPath;\nexports.getComponentPathWithoutIndicies = getComponentPathWithoutIndicies;\nexports.getContextButtons = getContextButtons;\nexports.getContextComponents = getContextComponents;\nexports.getCurrencyAffixes = getCurrencyAffixes;\nexports.getDataParentComponent = getDataParentComponent;\nexports.getDateSetting = getDateSetting;\nexports.getElementRect = getElementRect;\nexports.getFocusableElements = getFocusableElements;\nexports.getIEBrowserVersion = getIEBrowserVersion;\nexports.getInputMask = getInputMask;\nexports.getLocaleDateFormatInfo = getLocaleDateFormatInfo;\nexports.getNumberDecimalLimit = getNumberDecimalLimit;\nexports.getNumberSeparators = getNumberSeparators;\nexports.getPropertyValue = getPropertyValue;\nexports.getRandomComponentId = getRandomComponentId;\nexports.getStringFromComponentPath = getStringFromComponentPath;\nexports.guid = guid;\nexports.hasInvalidComponent = hasInvalidComponent;\nexports.interpolate = void 0;\nexports.isInputComponent = isInputComponent;\nexports.isInsideScopingComponent = isInsideScopingComponent;\nexports.isMongoId = isMongoId;\nexports.isPromise = isPromise;\nexports.isValidDate = isValidDate;\nexports.iterateKey = iterateKey;\nObject.defineProperty(exports, \"jsonLogic\", {\n  enumerable: true,\n  get: function get() {\n    return _jsonLogicJs.default;\n  }\n});\nexports.loadZones = loadZones;\nexports.matchInputMask = matchInputMask;\nObject.defineProperty(exports, \"moment\", {\n  enumerable: true,\n  get: function get() {\n    return _momentTimezone.default;\n  }\n});\nexports.momentDate = momentDate;\nexports.observeOverload = observeOverload;\nexports.offsetDate = offsetDate;\nexports.round = round;\nexports.sanitize = sanitize;\nexports.setActionProperty = setActionProperty;\nexports.shouldLoadZones = shouldLoadZones;\nexports.translateHTMLTemplate = translateHTMLTemplate;\nexports.unescapeHTML = unescapeHTML;\nexports.unfold = unfold;\nexports.uniqueKey = uniqueKey;\nexports.uniqueName = uniqueName;\nexports.unmaskValue = unmaskValue;\nexports.withSwitch = withSwitch;\nexports.zonesLoaded = zonesLoaded;\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.string.starts-with.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.string.trim.js\");\n\nrequire(\"core-js/modules/es.number.to-fixed.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _fetchPonyfill2 = _interopRequireDefault(require(\"fetch-ponyfill\"));\n\nvar _jsonLogicJs = _interopRequireDefault(require(\"json-logic-js\"));\n\nvar _momentTimezone = _interopRequireDefault(require(\"moment-timezone/moment-timezone\"));\n\nvar _jstimezonedetect = _interopRequireDefault(require(\"jstimezonedetect\"));\n\nvar _operators = require(\"./jsonlogic/operators\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _dompurify = _interopRequireDefault(require(\"dompurify\"));\n\nvar _formUtils = require(\"./formUtils\");\n\nObject.keys(_formUtils).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  if (key in exports && exports[key] === _formUtils[key]) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _formUtils[key];\n    }\n  });\n});\n\nvar _Evaluator = _interopRequireDefault(require(\"./Evaluator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar interpolate = _Evaluator.default.interpolate;\nexports.interpolate = interpolate;\n\nvar _fetchPonyfill = (0, _fetchPonyfill2.default)({\n  Promise: _nativePromiseOnly.default\n}),\n    fetch = _fetchPonyfill.fetch;\n\n// Configure JsonLogic\n_operators.lodashOperators.forEach(function (name) {\n  return _jsonLogicJs.default.add_operation(\"_\".concat(name), _lodash.default[name]);\n}); // Retrieve Any Date\n\n\n_jsonLogicJs.default.add_operation('getDate', function (date) {\n  return (0, _momentTimezone.default)(date).toISOString();\n}); // Set Relative Minimum Date\n\n\n_jsonLogicJs.default.add_operation('relativeMinDate', function (relativeMinDate) {\n  return (0, _momentTimezone.default)().subtract(relativeMinDate, 'days').toISOString();\n}); // Set Relative Maximum Date\n\n\n_jsonLogicJs.default.add_operation('relativeMaxDate', function (relativeMaxDate) {\n  return (0, _momentTimezone.default)().add(relativeMaxDate, 'days').toISOString();\n});\n\nfunction setPathToComponentAndPerentSchema(component) {\n  component.path = getComponentPath(component);\n  var dataParent = getDataParentComponent(component);\n\n  if (dataParent && _typeof(dataParent) === 'object') {\n    dataParent.path = getComponentPath(dataParent);\n  }\n}\n/**\n * Evaluate a method.\n *\n * @param func\n * @param args\n * @return {*}\n */\n\n\nfunction evaluate(func, args, ret, tokenize) {\n  var returnVal = null;\n  var component = args.component ? args.component : {\n    key: 'unknown'\n  };\n\n  if (!args.form && args.instance) {\n    args.form = _lodash.default.get(args.instance, 'root._form', {});\n  }\n\n  var componentKey = component.key;\n\n  if (typeof func === 'string') {\n    if (ret) {\n      func += \";return \".concat(ret);\n    }\n\n    if (tokenize) {\n      // Replace all {{ }} references with actual data.\n      func = func.replace(/({{\\s+(.*)\\s+}})/, function (match, $1, $2) {\n        if ($2.indexOf('data.') === 0) {\n          return _lodash.default.get(args.data, $2.replace('data.', ''));\n        } else if ($2.indexOf('row.') === 0) {\n          return _lodash.default.get(args.row, $2.replace('row.', ''));\n        } // Support legacy...\n\n\n        return _lodash.default.get(args.data, $2);\n      });\n    }\n\n    try {\n      func = _Evaluator.default.evaluator(func, args);\n      args = _lodash.default.values(args);\n    } catch (err) {\n      console.warn(\"An error occured within the custom function for \".concat(componentKey), err);\n      returnVal = null;\n      func = false;\n    }\n  }\n\n  if (typeof func === 'function') {\n    try {\n      returnVal = _Evaluator.default.evaluate(func, args);\n    } catch (err) {\n      returnVal = null;\n      console.warn(\"An error occured within custom function for \".concat(componentKey), err);\n    }\n  } else if (_typeof(func) === 'object') {\n    try {\n      returnVal = _jsonLogicJs.default.apply(func, args);\n    } catch (err) {\n      returnVal = null;\n      console.warn(\"An error occured within custom function for \".concat(componentKey), err);\n    }\n  } else if (func) {\n    console.warn(\"Unknown function type for \".concat(componentKey));\n  }\n\n  return returnVal;\n}\n\nfunction getRandomComponentId() {\n  return \"e\".concat(Math.random().toString(36).substring(7));\n}\n/**\n * Get a property value of an element.\n *\n * @param style\n * @param prop\n * @return {number}\n */\n\n\nfunction getPropertyValue(style, prop) {\n  var value = style.getPropertyValue(prop);\n  value = value ? value.replace(/[^0-9.]/g, '') : '0';\n  return parseFloat(value);\n}\n/**\n * Get an elements bounding rectagle.\n *\n * @param element\n * @return {{x: string, y: string, width: string, height: string}}\n */\n\n\nfunction getElementRect(element) {\n  var style = window.getComputedStyle(element, null);\n  return {\n    x: getPropertyValue(style, 'left'),\n    y: getPropertyValue(style, 'top'),\n    width: getPropertyValue(style, 'width'),\n    height: getPropertyValue(style, 'height')\n  };\n}\n/**\n * Determines the boolean value of a setting.\n *\n * @param value\n * @return {boolean}\n */\n\n\nfunction boolValue(value) {\n  if (_lodash.default.isBoolean(value)) {\n    return value;\n  } else if (_lodash.default.isString(value)) {\n    return value.toLowerCase() === 'true';\n  } else {\n    return !!value;\n  }\n}\n/**\n * Check to see if an ID is a mongoID.\n * @param text\n * @return {Array|{index: number, input: string}|Boolean|*}\n */\n\n\nfunction isMongoId(text) {\n  return text.toString().match(/^[0-9a-fA-F]{24}$/);\n}\n/**\n * Checks the calculated value for a provided component and data.\n *\n * @param {Object} component\n *   The component to check for the calculated value.\n * @param {Object} submission\n *   A submission object.\n * @param data\n *   The full submission data.\n */\n\n\nfunction checkCalculated(component, submission, rowData) {\n  // Process calculated value stuff if present.\n  if (component.calculateValue) {\n    _lodash.default.set(rowData, component.key, evaluate(component.calculateValue, {\n      value: undefined,\n      data: submission ? submission.data : rowData,\n      row: rowData,\n      util: this,\n      component: component\n    }, 'value'));\n  }\n}\n/**\n * Check if a simple conditional evaluates to true.\n *\n * @param condition\n * @param condition\n * @param row\n * @param data\n * @returns {boolean}\n */\n\n\nfunction checkSimpleConditional(component, condition, row, data) {\n  var value = null;\n\n  if (row) {\n    value = (0, _formUtils.getValue)({\n      data: row\n    }, condition.when);\n  }\n\n  if (data && _lodash.default.isNil(value)) {\n    value = (0, _formUtils.getValue)({\n      data: data\n    }, condition.when);\n  } // FOR-400 - Fix issue where falsey values were being evaluated as show=true\n\n\n  if (_lodash.default.isNil(value)) {\n    value = '';\n  }\n\n  var eq = String(condition.eq);\n  var show = String(condition.show); // Special check for selectboxes component.\n\n  if (_lodash.default.isObject(value) && _lodash.default.has(value, condition.eq)) {\n    return String(value[condition.eq]) === show;\n  } // FOR-179 - Check for multiple values.\n\n\n  if (Array.isArray(value) && value.map(String).includes(eq)) {\n    return show === 'true';\n  }\n\n  return String(value) === eq === (show === 'true');\n}\n/**\n * Check custom javascript conditional.\n *\n * @param component\n * @param custom\n * @param row\n * @param data\n * @returns {*}\n */\n\n\nfunction checkCustomConditional(component, custom, row, data, form, variable, onError, instance) {\n  if (typeof custom === 'string') {\n    custom = \"var \".concat(variable, \" = true; \").concat(custom, \"; return \").concat(variable, \";\");\n  }\n\n  var value = instance && instance.evaluate ? instance.evaluate(custom, {\n    row: row,\n    data: data,\n    form: form\n  }) : evaluate(custom, {\n    row: row,\n    data: data,\n    form: form\n  });\n\n  if (value === null) {\n    return onError;\n  }\n\n  return value;\n}\n\nfunction checkJsonConditional(component, json, row, data, form, onError) {\n  try {\n    return _jsonLogicJs.default.apply(json, {\n      data: data,\n      row: row,\n      form: form,\n      _: _lodash.default\n    });\n  } catch (err) {\n    console.warn(\"An error occurred in jsonLogic advanced condition for \".concat(component.key), err);\n    return onError;\n  }\n}\n\nfunction getRow(component, row, instance, conditional) {\n  var _condition$when;\n\n  var condition = conditional || component.conditional; // If no component's instance passed (happens only in 6.x server), calculate its path based on the schema\n\n  if (!instance) {\n    instance = _lodash.default.cloneDeep(component);\n    setPathToComponentAndPerentSchema(instance);\n  }\n\n  var dataParent = getDataParentComponent(instance);\n  var parentPath = dataParent ? getComponentPath(dataParent) : null;\n\n  if (dataParent && (_condition$when = condition.when) !== null && _condition$when !== void 0 && _condition$when.startsWith(parentPath)) {\n    var newRow = {};\n\n    _lodash.default.set(newRow, parentPath, row);\n\n    row = newRow;\n  }\n\n  return row;\n}\n/**\n * Checks the conditions for a provided component and data.\n *\n * @param component\n *   The component to check for the condition.\n * @param row\n *   The data within a row\n * @param data\n *   The full submission data.\n *\n * @returns {boolean}\n */\n\n\nfunction checkCondition(component, row, data, form, instance) {\n  var customConditional = component.customConditional,\n      conditional = component.conditional;\n\n  if (customConditional) {\n    return checkCustomConditional(component, customConditional, row, data, form, 'show', true, instance);\n  } else if (conditional && conditional.when) {\n    row = getRow(component, row, instance);\n    return checkSimpleConditional(component, conditional, row, data);\n  } else if (conditional && conditional.json) {\n    return checkJsonConditional(component, conditional.json, row, data, form, true);\n  } // Default to show.\n\n\n  return true;\n}\n/**\n * Test a trigger on a component.\n *\n * @param component\n * @param action\n * @param data\n * @param row\n * @returns {mixed}\n */\n\n\nfunction checkTrigger(component, trigger, row, data, form, instance) {\n  // If trigger is empty, don't fire it\n  if (!trigger[trigger.type]) {\n    return false;\n  }\n\n  switch (trigger.type) {\n    case 'simple':\n      row = getRow(component, row, instance, trigger.simple);\n      return checkSimpleConditional(component, trigger.simple, row, data);\n\n    case 'javascript':\n      return checkCustomConditional(component, trigger.javascript, row, data, form, 'result', false, instance);\n\n    case 'json':\n      return checkJsonConditional(component, trigger.json, row, data, form, false);\n  } // If none of the types matched, don't fire the trigger.\n\n\n  return false;\n}\n\nfunction setActionProperty(component, action, result, row, data, instance) {\n  var property = action.property.value;\n\n  switch (action.property.type) {\n    case 'boolean':\n      {\n        var currentValue = _lodash.default.get(component, property, false).toString();\n\n        var newValue = action.state.toString();\n\n        if (currentValue !== newValue) {\n          _lodash.default.set(component, property, newValue === 'true');\n        }\n\n        break;\n      }\n\n    case 'string':\n      {\n        var evalData = {\n          data: data,\n          row: row,\n          component: component,\n          result: result\n        };\n        var textValue = action.property.component ? action[action.property.component] : action.text;\n\n        var _currentValue = _lodash.default.get(component, property, '');\n\n        var _newValue = instance && instance.interpolate ? instance.interpolate(textValue, evalData) : _Evaluator.default.interpolate(textValue, evalData);\n\n        if (_newValue !== _currentValue) {\n          _lodash.default.set(component, property, _newValue);\n        }\n\n        break;\n      }\n  }\n\n  return component;\n}\n/**\n * Unescape HTML characters like &lt, &gt, &amp and etc.\n * @param str\n * @returns {string}\n */\n\n\nfunction unescapeHTML(str) {\n  if (typeof window === 'undefined' || !('DOMParser' in window)) {\n    return str;\n  }\n\n  var doc = new window.DOMParser().parseFromString(str, 'text/html');\n  return doc.documentElement.textContent;\n}\n/**\n * Make HTML element from string\n * @param str\n * @param selector\n * @returns {HTMLElement}\n */\n\n\nfunction convertStringToHTMLElement(str, selector) {\n  var doc = new window.DOMParser().parseFromString(str, 'text/html');\n  return doc.body.querySelector(selector);\n}\n/**\n * Make a filename guaranteed to be unique.\n * @param name\n * @param template\n * @param evalContext\n * @returns {string}\n */\n\n\nfunction uniqueName(name, template, evalContext) {\n  template = template || '{{fileName}}-{{guid}}'; //include guid in template anyway, to prevent overwriting issue if filename matches existing file\n\n  if (!template.includes('{{guid}}')) {\n    template = \"\".concat(template, \"-{{guid}}\");\n  }\n\n  var parts = name.split('.');\n  var fileName = parts.slice(0, parts.length - 1).join('.');\n  var extension = parts.length > 1 ? \".\".concat(_lodash.default.last(parts)) : ''; //allow only 100 characters from original name to avoid issues with filename length restrictions\n\n  fileName = fileName.substr(0, 100);\n  evalContext = Object.assign(evalContext || {}, {\n    fileName: fileName,\n    guid: guid()\n  }); //only letters, numbers, dots, dashes, underscores and spaces are allowed. Anything else will be replaced with dash\n\n  var uniqueName = \"\".concat(_Evaluator.default.interpolate(template, evalContext)).concat(extension).replace(/[^0-9a-zA-Z.\\-_ ]/g, '-');\n  return uniqueName;\n}\n\nfunction guid() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n/**\n * Return a translated date setting.\n *\n * @param date\n * @return {(null|Date)}\n */\n\n\nfunction getDateSetting(date) {\n  if (_lodash.default.isNil(date) || _lodash.default.isNaN(date) || date === '') {\n    return null;\n  }\n\n  if (date instanceof Date) {\n    return date;\n  } else if (typeof date.toDate === 'function') {\n    return date.isValid() ? date.toDate() : null;\n  }\n\n  var dateSetting = typeof date !== 'string' || date.indexOf('moment(') === -1 ? (0, _momentTimezone.default)(date) : null;\n\n  if (dateSetting && dateSetting.isValid()) {\n    return dateSetting.toDate();\n  }\n\n  dateSetting = null;\n\n  try {\n    var value = _Evaluator.default.evaluator(\"return \".concat(date, \";\"), 'moment')(_momentTimezone.default);\n\n    if (typeof value === 'string') {\n      dateSetting = (0, _momentTimezone.default)(value);\n    } else if (typeof value.toDate === 'function') {\n      dateSetting = (0, _momentTimezone.default)(value.toDate().toUTCString());\n    } else if (value instanceof Date) {\n      dateSetting = (0, _momentTimezone.default)(value);\n    }\n  } catch (e) {\n    return null;\n  }\n\n  if (!dateSetting) {\n    return null;\n  } // Ensure this is a date.\n\n\n  if (!dateSetting.isValid()) {\n    return null;\n  }\n\n  return dateSetting.toDate();\n}\n\nfunction isValidDate(date) {\n  return _lodash.default.isDate(date) && !_lodash.default.isNaN(date.getDate());\n}\n/**\n * Get the current timezone string.\n *\n * @return {string}\n */\n\n\nfunction currentTimezone() {\n  if (_momentTimezone.default.currentTimezone) {\n    return _momentTimezone.default.currentTimezone;\n  }\n\n  _momentTimezone.default.currentTimezone = _jstimezonedetect.default.determine().name();\n  return _momentTimezone.default.currentTimezone;\n}\n/**\n * Get an offset date provided a date object and timezone object.\n *\n * @param date\n * @param timezone\n * @return {Date}\n */\n\n\nfunction offsetDate(date, timezone) {\n  if (timezone === 'UTC') {\n    return {\n      date: new Date(date.getTime() + date.getTimezoneOffset() * 60000),\n      abbr: 'UTC'\n    };\n  }\n\n  var dateMoment = (0, _momentTimezone.default)(date).tz(timezone);\n  return {\n    date: new Date(date.getTime() + (dateMoment.utcOffset() + date.getTimezoneOffset()) * 60000),\n    abbr: dateMoment.format('z')\n  };\n}\n/**\n * Returns if the zones are loaded.\n *\n * @return {boolean}\n */\n\n\nfunction zonesLoaded() {\n  return _momentTimezone.default.zonesLoaded;\n}\n/**\n * Returns if we should load the zones.\n *\n * @param timezone\n * @return {boolean}\n */\n\n\nfunction shouldLoadZones(timezone) {\n  if (timezone === currentTimezone() || timezone === 'UTC') {\n    return false;\n  }\n\n  return true;\n}\n/**\n * Externally load the timezone data.\n *\n * @return {Promise<any> | *}\n */\n\n\nfunction loadZones(timezone) {\n  if (timezone && !shouldLoadZones(timezone)) {\n    // Return non-resolving promise.\n    return new _nativePromiseOnly.default(_lodash.default.noop);\n  }\n\n  if (_momentTimezone.default.zonesPromise) {\n    return _momentTimezone.default.zonesPromise;\n  }\n\n  return _momentTimezone.default.zonesPromise = fetch('https://cdn.form.io/moment-timezone/data/packed/latest.json').then(function (resp) {\n    return resp.json().then(function (zones) {\n      _momentTimezone.default.tz.load(zones);\n\n      _momentTimezone.default.zonesLoaded = true; // Trigger a global event that the timezones have finished loading.\n\n      if (document && document.createEvent && document.body && document.body.dispatchEvent) {\n        var event = document.createEvent('Event');\n        event.initEvent('zonesLoaded', true, true);\n        document.body.dispatchEvent(event);\n      }\n    });\n  });\n}\n/**\n * Get the moment date object for translating dates with timezones.\n *\n * @param value\n * @param format\n * @param timezone\n * @return {*}\n */\n\n\nfunction momentDate(value, format, timezone) {\n  var momentDate = (0, _momentTimezone.default)(value);\n\n  if (timezone === 'UTC') {\n    timezone = 'Etc/UTC';\n  }\n\n  if ((timezone !== currentTimezone() || format && format.match(/\\s(z$|z\\s)/)) && _momentTimezone.default.zonesLoaded) {\n    return momentDate.tz(timezone);\n  }\n\n  return momentDate;\n}\n/**\n * Format a date provided a value, format, and timezone object.\n *\n * @param value\n * @param format\n * @param timezone\n * @return {string}\n */\n\n\nfunction formatDate(value, format, timezone, flatPickrInputFormat) {\n  var momentDate = (0, _momentTimezone.default)(value, flatPickrInputFormat || undefined);\n\n  if (timezone === currentTimezone()) {\n    // See if our format contains a \"z\" timezone character.\n    if (format.match(/\\s(z$|z\\s)/)) {\n      loadZones();\n\n      if (_momentTimezone.default.zonesLoaded) {\n        return momentDate.tz(timezone).format(convertFormatToMoment(format));\n      } else {\n        return momentDate.format(convertFormatToMoment(format.replace(/\\s(z$|z\\s)/, '')));\n      }\n    } // Return the standard format.\n\n\n    return momentDate.format(convertFormatToMoment(format));\n  }\n\n  if (timezone === 'UTC') {\n    var offset = offsetDate(momentDate.toDate(), 'UTC');\n    return \"\".concat((0, _momentTimezone.default)(offset.date).format(convertFormatToMoment(format)), \" UTC\");\n  } // Load the zones since we need timezone information.\n\n\n  loadZones();\n\n  if (_momentTimezone.default.zonesLoaded && timezone) {\n    return momentDate.tz(timezone).format(\"\".concat(convertFormatToMoment(format), \" z\"));\n  } else {\n    return momentDate.format(convertFormatToMoment(format));\n  }\n}\n/**\n * Pass a format function to format within a timezone.\n *\n * @param formatFn\n * @param date\n * @param format\n * @param timezone\n * @return {string}\n */\n\n\nfunction formatOffset(formatFn, date, format, timezone) {\n  if (timezone === currentTimezone()) {\n    return formatFn(date, format);\n  }\n\n  if (timezone === 'UTC') {\n    return \"\".concat(formatFn(offsetDate(date, 'UTC').date, format), \" UTC\");\n  } // Load the zones since we need timezone information.\n\n\n  loadZones();\n\n  if (_momentTimezone.default.zonesLoaded) {\n    var offset = offsetDate(date, timezone);\n    return \"\".concat(formatFn(offset.date, format), \" \").concat(offset.abbr);\n  } else {\n    return formatFn(date, format);\n  }\n}\n\nfunction getLocaleDateFormatInfo(locale) {\n  var formatInfo = {};\n  var day = 21;\n  var exampleDate = new Date(2017, 11, day);\n  var localDateString = exampleDate.toLocaleDateString(locale);\n  formatInfo.dayFirst = localDateString.slice(0, 2) === day.toString();\n  return formatInfo;\n}\n/**\n * Convert the format from the angular-datepicker module to flatpickr format.\n * @param format\n * @return {string}\n */\n\n\nfunction convertFormatToFlatpickr(format) {\n  return format // Remove the Z timezone offset, not supported by flatpickr.\n  .replace(/Z/g, '') // Year conversion.\n  .replace(/y/g, 'Y').replace('YYYY', 'Y').replace('YY', 'y') // Month conversion.\n  .replace('MMMM', 'F').replace(/M/g, 'n').replace('nnn', 'M').replace('nn', 'm') // Day in month.\n  .replace(/d/g, 'j').replace(/jj/g, 'd') // Day in week.\n  .replace('EEEE', 'l').replace('EEE', 'D') // Hours, minutes, seconds\n  .replace('HH', 'H').replace('hh', 'G').replace('mm', 'i').replace('ss', 'S').replace(/a/g, 'K');\n}\n/**\n * Convert the format from the angular-datepicker module to moment format.\n * @param format\n * @return {string}\n */\n\n\nfunction convertFormatToMoment(format) {\n  return format // Year conversion.\n  .replace(/y/g, 'Y') // Day in month.\n  .replace(/d/g, 'D') // Day in week.\n  .replace(/E/g, 'd') // AM/PM marker\n  .replace(/a/g, 'A') // Unix Timestamp\n  .replace(/U/g, 'X');\n}\n\nfunction convertFormatToMask(format) {\n  return format // Long month replacement.\n  .replace(/M{4}/g, 'MM') // Initial short month conversion.\n  .replace(/M{3}/g, '***') // Short month conversion if input as text.\n  .replace(/e/g, 'Q') // Year conversion.\n  .replace(/[ydhmsHMG]/g, '9') // AM/PM conversion.\n  .replace(/a/g, 'AA');\n}\n/**\n * Returns an input mask that is compatible with the input mask library.\n * @param {string} mask - The Form.io input mask.\n * @param {string} placeholderChar - Char which is used as a placeholder.\n * @returns {Array} - The input mask for the mask library.\n */\n\n\nfunction getInputMask(mask, placeholderChar) {\n  if (mask instanceof Array) {\n    return mask;\n  }\n\n  var maskArray = [];\n  maskArray.numeric = true;\n\n  for (var i = 0; i < mask.length; i++) {\n    switch (mask[i]) {\n      case '9':\n        maskArray.push(/\\d/);\n        break;\n\n      case 'A':\n        maskArray.numeric = false;\n        maskArray.push(/[a-zA-Z]/);\n        break;\n\n      case 'a':\n        maskArray.numeric = false;\n        maskArray.push(/[a-z]/);\n        break;\n\n      case '*':\n        maskArray.numeric = false;\n        maskArray.push(/[a-zA-Z0-9]/);\n        break;\n      // If char which is used inside mask placeholder was used in the mask, replace it with space to prevent errors\n\n      case placeholderChar:\n        maskArray.numeric = false;\n        maskArray.push(' ');\n        break;\n\n      default:\n        maskArray.numeric = false;\n        maskArray.push(mask[i]);\n        break;\n    }\n  }\n\n  return maskArray;\n}\n\nfunction unmaskValue(value, mask, placeholderChar) {\n  if (!mask || !value || value.length > mask.length) {\n    return value;\n  }\n\n  var unmaskedValue = value.split('');\n\n  for (var i = 0; i < mask.length; i++) {\n    var char = value[i] || '';\n    var charPart = mask[i];\n\n    if (!_lodash.default.isRegExp(charPart) && char === charPart) {\n      unmaskedValue[i] = '';\n    }\n  }\n\n  unmaskedValue = unmaskedValue.join('').replace(placeholderChar, '');\n  return unmaskedValue;\n}\n\nfunction matchInputMask(value, inputMask) {\n  if (!inputMask) {\n    return true;\n  } // If value is longer than mask, it isn't valid.\n\n\n  if (value.length > inputMask.length) {\n    return false;\n  }\n\n  for (var i = 0; i < inputMask.length; i++) {\n    var char = value[i] || '';\n    var charPart = inputMask[i];\n\n    if (!(_lodash.default.isRegExp(charPart) && charPart.test(char) || charPart === char)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction getNumberSeparators() {\n  var lang = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'en';\n  var formattedNumberString = 12345.6789.toLocaleString(lang);\n  var delimeters = formattedNumberString.match(/..(.)...(.)../);\n\n  if (!delimeters) {\n    return {\n      delimiter: ',',\n      decimalSeparator: '.'\n    };\n  }\n\n  return {\n    delimiter: delimeters.length > 1 ? delimeters[1] : ',',\n    decimalSeparator: delimeters.length > 2 ? delimeters[2] : '.'\n  };\n}\n\nfunction getNumberDecimalLimit(component, defaultLimit) {\n  if (_lodash.default.has(component, 'decimalLimit')) {\n    return _lodash.default.get(component, 'decimalLimit');\n  } // Determine the decimal limit. Defaults to 20 but can be overridden by validate.step or decimalLimit settings.\n\n\n  var decimalLimit = defaultLimit || 20;\n\n  var step = _lodash.default.get(component, 'validate.step', 'any');\n\n  if (step !== 'any') {\n    var parts = step.toString().split('.');\n\n    if (parts.length > 1) {\n      decimalLimit = parts[1].length;\n    }\n  }\n\n  return decimalLimit;\n}\n\nfunction getCurrencyAffixes(_ref) {\n  var _ref$currency = _ref.currency,\n      currency = _ref$currency === void 0 ? 'USD' : _ref$currency,\n      decimalLimit = _ref.decimalLimit,\n      decimalSeparator = _ref.decimalSeparator,\n      lang = _ref.lang;\n  // Get the prefix and suffix from the localized string.\n  var regex = \"(.*)?\".concat(100 .toLocaleString(lang));\n\n  if (decimalLimit) {\n    regex += \"\".concat(decimalSeparator === '.' ? '\\\\.' : decimalSeparator).concat(0 .toLocaleString(lang), \"{\").concat(decimalLimit, \"}\");\n  }\n\n  regex += '(.*)?';\n  var parts = 100 .toLocaleString(lang, {\n    style: 'currency',\n    currency: currency,\n    useGrouping: true,\n    maximumFractionDigits: decimalLimit || 0,\n    minimumFractionDigits: decimalLimit || 0\n  }).replace('.', decimalSeparator).match(new RegExp(regex));\n  return {\n    prefix: (parts === null || parts === void 0 ? void 0 : parts[1]) || '',\n    suffix: (parts === null || parts === void 0 ? void 0 : parts[2]) || ''\n  };\n}\n/**\n * Fetch the field data provided a component.\n *\n * @param data\n * @param component\n * @return {*}\n */\n\n\nfunction fieldData(data, component) {\n  if (!data) {\n    return '';\n  }\n\n  if (!component || !component.key) {\n    return data;\n  }\n\n  if (component.key.includes('.')) {\n    var value = data;\n    var parts = component.key.split('.');\n    var key = '';\n\n    for (var i = 0; i < parts.length; i++) {\n      key = parts[i]; // Handle nested resources\n\n      if (value.hasOwnProperty('_id')) {\n        value = value.data;\n      } // Return if the key is not found on the value.\n\n\n      if (!value.hasOwnProperty(key)) {\n        return;\n      } // Convert old single field data in submissions to multiple\n\n\n      if (key === parts[parts.length - 1] && component.multiple && !Array.isArray(value[key])) {\n        value[key] = [value[key]];\n      } // Set the value of this key.\n\n\n      value = value[key];\n    }\n\n    return value;\n  } else {\n    // Convert old single field data in submissions to multiple\n    if (component.multiple && !Array.isArray(data[component.key])) {\n      data[component.key] = [data[component.key]];\n    } // Fix for checkbox type radio submission values in tableView\n\n\n    if (component.type === 'checkbox' && component.inputType === 'radio') {\n      return data[component.name] === component.value;\n    }\n\n    return data[component.key];\n  }\n}\n/**\n * Delays function execution with possibility to execute function synchronously or cancel it.\n *\n * @param fn Function to delay\n * @param delay Delay time\n * @return {*}\n */\n\n\nfunction delay(fn) {\n  var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  var timer = setTimeout.apply(void 0, [fn, delay].concat(args));\n\n  function cancel() {\n    clearTimeout(timer);\n  }\n\n  function earlyCall() {\n    cancel();\n    return fn.apply(void 0, args);\n  }\n\n  earlyCall.timer = timer;\n  earlyCall.cancel = cancel;\n  return earlyCall;\n}\n/**\n * Iterate the given key to make it unique.\n *\n * @param {String} key\n *   Modify the component key to be unique.\n *\n * @returns {String}\n *   The new component key.\n */\n\n\nfunction iterateKey(key) {\n  if (!key.match(/(\\d+)$/)) {\n    return \"\".concat(key, \"1\");\n  }\n\n  return key.replace(/(\\d+)$/, function (suffix) {\n    return Number(suffix) + 1;\n  });\n}\n/**\n * Determines a unique key within a map provided the base key.\n *\n * @param map\n * @param base\n * @return {*}\n */\n\n\nfunction uniqueKey(map, base) {\n  var newKey = base;\n\n  while (map.hasOwnProperty(newKey)) {\n    newKey = iterateKey(newKey);\n  }\n\n  return newKey;\n}\n/**\n * Determines the major version number of bootstrap.\n *\n * @return {number}\n */\n\n\nfunction bootstrapVersion(options) {\n  if (options.bootstrap) {\n    return options.bootstrap;\n  }\n\n  if (typeof $ === 'function' && typeof $().collapse === 'function') {\n    return parseInt($.fn.collapse.Constructor.VERSION.split('.')[0], 10);\n  }\n\n  return 0;\n}\n/**\n * Retrun provided argument.\n * If argument is a function, returns the result of a function call.\n * @param {*} e;\n *\n * @return {*}\n */\n\n\nfunction unfold(e) {\n  if (typeof e === 'function') {\n    return e();\n  }\n\n  return e;\n}\n/**\n * Map values through unfold and return first non-nil value.\n * @param {Array<T>} collection;\n *\n * @return {T}\n */\n\n\nvar firstNonNil = _lodash.default.flow([_lodash.default.partialRight(_lodash.default.map, unfold), _lodash.default.partialRight(_lodash.default.find, function (v) {\n  return !_lodash.default.isUndefined(v);\n})]);\n/*\n * Create enclosed state.\n * Returns functions to getting and cycling between states.\n * @param {*} a - initial state.\n * @param {*} b - next state.\n * @return {Functions[]} -- [get, toggle];\n */\n\n\nexports.firstNonNil = firstNonNil;\n\nfunction withSwitch(a, b) {\n  var state = a;\n  var next = b;\n\n  function get() {\n    return state;\n  }\n\n  function toggle() {\n    var prev = state;\n    state = next;\n    next = prev;\n  }\n\n  return [get, toggle];\n}\n\nfunction observeOverload(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _options$limit = options.limit,\n      limit = _options$limit === void 0 ? 50 : _options$limit,\n      _options$delay = options.delay,\n      delay = _options$delay === void 0 ? 500 : _options$delay;\n  var callCount = 0;\n  var timeoutID = 0;\n\n  var reset = function reset() {\n    return callCount = 0;\n  };\n\n  return function () {\n    if (timeoutID !== 0) {\n      clearTimeout(timeoutID);\n      timeoutID = 0;\n    }\n\n    timeoutID = setTimeout(reset, delay);\n    callCount += 1;\n\n    if (callCount >= limit) {\n      clearTimeout(timeoutID);\n      reset();\n      return callback();\n    }\n  };\n}\n\nfunction getContextComponents(context) {\n  var values = [];\n  context.utils.eachComponent(context.instance.options.editForm.components, function (component, path) {\n    if (component.key !== context.data.key) {\n      values.push({\n        label: \"\".concat(component.label || component.key, \" (\").concat(path, \")\"),\n        value: path\n      });\n    }\n  });\n  return values;\n}\n\nfunction getContextButtons(context) {\n  var values = [];\n  context.utils.eachComponent(context.instance.options.editForm.components, function (component) {\n    if (component.type === 'button') {\n      values.push({\n        label: \"\".concat(component.key, \" (\").concat(component.label, \")\"),\n        value: component.key\n      });\n    }\n  });\n  return values;\n} // Tags that could be in text, that should be ommited or handled in a special way\n\n\nvar inTextTags = ['#text', 'A', 'B', 'EM', 'I', 'SMALL', 'STRONG', 'SUB', 'SUP', 'INS', 'DEL', 'MARK', 'CODE'];\n/**\n * Helper function for 'translateHTMLTemplate'. Translates text value of the passed html element.\n *\n * @param {HTMLElement} elem\n * @param {Function} translate\n *\n * @returns {String}\n *   Translated element template.\n */\n\nfunction translateElemValue(elem, translate) {\n  if (!elem.innerText) {\n    return elem.innerHTML;\n  }\n\n  var elemValue = elem.innerText.replace(_Evaluator.default.templateSettings.interpolate, '').replace(/\\s\\s+/g, ' ').trim();\n  var translatedValue = translate(elemValue);\n\n  if (elemValue !== translatedValue) {\n    var links = elem.innerHTML.match(/<a[^>]*>(.*?)<\\/a>/g);\n\n    if (links && links.length) {\n      if (links.length === 1 && links[0].length === elem.innerHTML.length) {\n        return elem.innerHTML.replace(elemValue, translatedValue);\n      }\n\n      var translatedLinks = links.map(function (link) {\n        var linkElem = document.createElement('a');\n        linkElem.innerHTML = link;\n        return translateElemValue(linkElem, translate);\n      });\n      return \"\".concat(translatedValue, \" (\").concat(translatedLinks.join(', '), \")\");\n    } else {\n      return elem.innerText.replace(elemValue, translatedValue);\n    }\n  } else {\n    return elem.innerHTML;\n  }\n}\n/**\n * Helper function for 'translateHTMLTemplate'. Goes deep through html tag children and calls function to translate their text values.\n *\n * @param {HTMLElement} tag\n * @param {Function} translate\n *\n * @returns {void}\n */\n\n\nfunction translateDeepTag(tag, translate) {\n  var children = tag.children.length && _toConsumableArray(tag.children);\n\n  var shouldTranslateEntireContent = children && children.every(function (child) {\n    return child.children.length === 0 && inTextTags.some(function (tag) {\n      return child.nodeName === tag;\n    });\n  });\n\n  if (!children || shouldTranslateEntireContent) {\n    tag.innerHTML = translateElemValue(tag, translate);\n  } else {\n    children.forEach(function (child) {\n      return translateDeepTag(child, translate);\n    });\n  }\n}\n/**\n * Translates text values in html template.\n *\n * @param {String} template\n * @param {Function} translate\n *\n * @returns {String}\n *   Html template with translated values.\n */\n\n\nfunction translateHTMLTemplate(template, translate) {\n  var isHTML = /<[^>]*>/.test(template);\n\n  if (!isHTML) {\n    return translate(template);\n  }\n\n  var tempElem = document.createElement('div');\n  tempElem.innerHTML = template;\n\n  if (tempElem.innerText && tempElem.children.length) {\n    translateDeepTag(tempElem, translate);\n    return tempElem.innerHTML;\n  }\n\n  return template;\n}\n/**\n * Sanitize an html string.\n *\n * @param string\n * @returns {*}\n */\n\n\nfunction sanitize(string, options) {\n  if (typeof _dompurify.default.sanitize !== 'function') {\n    return string;\n  } // Dompurify configuration\n\n\n  var sanitizeOptions = {\n    ADD_ATTR: ['ref', 'target'],\n    USE_PROFILES: {\n      html: true\n    }\n  }; // Add attrs\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.addAttr) && options.sanitizeConfig.addAttr.length > 0) {\n    options.sanitizeConfig.addAttr.forEach(function (attr) {\n      sanitizeOptions.ADD_ATTR.push(attr);\n    });\n  } // Add tags\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.addTags) && options.sanitizeConfig.addTags.length > 0) {\n    sanitizeOptions.ADD_TAGS = options.sanitizeConfig.addTags;\n  } // Allow tags\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.allowedTags) && options.sanitizeConfig.allowedTags.length > 0) {\n    sanitizeOptions.ALLOWED_TAGS = options.sanitizeConfig.allowedTags;\n  } // Allow attributes\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.allowedAttrs) && options.sanitizeConfig.allowedAttrs.length > 0) {\n    sanitizeOptions.ALLOWED_ATTR = options.sanitizeConfig.allowedAttrs;\n  } // Allowd URI Regex\n\n\n  if (options.sanitizeConfig && options.sanitizeConfig.allowedUriRegex) {\n    sanitizeOptions.ALLOWED_URI_REGEXP = options.sanitizeConfig.allowedUriRegex;\n  } // Allow to extend the existing array of elements that are safe for URI-like values\n\n\n  if (options.sanitizeConfig && Array.isArray(options.sanitizeConfig.addUriSafeAttr) && options.sanitizeConfig.addUriSafeAttr.length > 0) {\n    sanitizeOptions.ADD_URI_SAFE_ATTR = options.sanitizeConfig.addUriSafeAttr;\n  }\n\n  return _dompurify.default.sanitize(string, sanitizeOptions);\n}\n/**\n * Fast cloneDeep for JSON objects only.\n */\n\n\nfunction fastCloneDeep(obj) {\n  return obj ? JSON.parse(JSON.stringify(obj)) : obj;\n}\n\nfunction isInputComponent(componentJson) {\n  if (componentJson.input === false || componentJson.input === true) {\n    return componentJson.input;\n  }\n\n  switch (componentJson.type) {\n    case 'htmlelement':\n    case 'content':\n    case 'columns':\n    case 'fieldset':\n    case 'panel':\n    case 'table':\n    case 'tabs':\n    case 'well':\n    case 'button':\n      return false;\n\n    default:\n      return true;\n  }\n}\n\nfunction getArrayFromComponentPath(pathStr) {\n  if (!pathStr || !_lodash.default.isString(pathStr)) {\n    if (!_lodash.default.isArray(pathStr)) {\n      return [pathStr];\n    }\n\n    return pathStr;\n  }\n\n  return pathStr.replace(/[[\\]]/g, '.').replace(/\\.\\./g, '.').replace(/(^\\.)|(\\.$)/g, '').split('.').map(function (part) {\n    return _lodash.default.defaultTo(_lodash.default.toNumber(part), part);\n  });\n}\n\nfunction hasInvalidComponent(component) {\n  return component.getComponents().some(function (comp) {\n    if (_lodash.default.isArray(comp.components)) {\n      return hasInvalidComponent(comp);\n    }\n\n    return comp.error;\n  });\n}\n\nfunction getStringFromComponentPath(path) {\n  if (!_lodash.default.isArray(path)) {\n    return path;\n  }\n\n  var strPath = '';\n  path.forEach(function (part, i) {\n    if (_lodash.default.isNumber(part)) {\n      strPath += \"[\".concat(part, \"]\");\n    } else {\n      strPath += i === 0 ? part : \".\".concat(part);\n    }\n  });\n  return strPath;\n}\n\nfunction round(number, precision) {\n  if (_lodash.default.isNumber(number)) {\n    return number.toFixed(precision);\n  }\n\n  return number;\n}\n/**\n * Check for Internet Explorer browser version\n *\n * @return {(number|null)}\n */\n\n\nfunction getIEBrowserVersion() {\n  var _getBrowserInfo = getBrowserInfo(),\n      ie = _getBrowserInfo.ie,\n      version = _getBrowserInfo.version;\n\n  return ie ? version : null;\n}\n/**\n * Get browser name and version (modified from 'jquery-browser-plugin')\n *\n * @return {Object} -- {{browser name, version, isWebkit?}}\n * Possible browser names: chrome, safari, ie, edge, opera, mozilla, yabrowser\n */\n\n\nfunction getBrowserInfo() {\n  var browser = {};\n\n  if (typeof window === 'undefined') {\n    return browser;\n  }\n\n  var ua = window.navigator.userAgent.toLowerCase();\n  var match = /(edge|edg)\\/([\\w.]+)/.exec(ua) || /(opr)[/]([\\w.]+)/.exec(ua) || /(yabrowser)[ /]([\\w.]+)/.exec(ua) || /(chrome)[ /]([\\w.]+)/.exec(ua) || /(iemobile)[/]([\\w.]+)/.exec(ua) || /(version)(applewebkit)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) || /(webkit)[ /]([\\w.]+).*(version)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) || /(webkit)[ /]([\\w.]+)/.exec(ua) || /(opera)(?:.*version|)[ /]([\\w.]+)/.exec(ua) || /(msie) ([\\w.]+)/.exec(ua) || ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua) || ua.indexOf('compatible') < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(ua) || [];\n  var matched = {\n    browser: match[5] || match[3] || match[1] || '',\n    version: match[4] || match[2] || '0'\n  };\n\n  if (matched.browser) {\n    browser[matched.browser] = true;\n    browser.version = parseInt(matched.version, 10);\n  } // Chrome, Opera 15+, Safari and Yandex.Browser are webkit based browsers\n\n\n  if (browser.chrome || browser.opr || browser.safari || browser.edg || browser.yabrowser) {\n    browser.isWebkit = true;\n  } // IE11 has a new token so we will assign it ie to avoid breaking changes\n\n\n  if (browser.rv || browser.iemobile) {\n    browser.ie = true;\n  } // Edge has a new token since it became webkit based\n\n\n  if (browser.edg) {\n    browser.edge = true;\n  } // Opera 15+ are identified as opr\n\n\n  if (browser.opr) {\n    browser.opera = true;\n  }\n\n  return browser;\n}\n\nfunction getComponentPathWithoutIndicies() {\n  var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return path.replace(/\\[\\d+\\]/, '');\n}\n/**\n * Returns a path to the component which based on its schema\n * @param {*} component is a component's schema containing link to its parent's schema in the 'parent' property\n */\n\n\nfunction getComponentPath(component) {\n  var _component$_form;\n\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n  if (!component || !component.key || (component === null || component === void 0 ? void 0 : (_component$_form = component._form) === null || _component$_form === void 0 ? void 0 : _component$_form.display) === 'wizard') {\n    // unlike the Webform, the Wizard has the key and it is a duplicate of the panel key\n    return path;\n  }\n\n  path = component.isInputComponent || component.input === true ? \"\".concat(component.key).concat(path ? '.' : '').concat(path) : path;\n  return getComponentPath(component.parent, path);\n}\n/**\n * Returns a parent component of the passed component instance skipping all the Layout components\n * @param {*} componentInstance\n * @return {(Component|undefined)}\n */\n\n\nfunction getDataParentComponent(componentInstance) {\n  if (!componentInstance) {\n    return;\n  }\n\n  var parent = componentInstance.parent;\n\n  if (parent && (parent.isInputComponent || parent.input)) {\n    return parent;\n  } else {\n    return getDataParentComponent(parent);\n  }\n}\n/**\n * Returns whether the value is a promise\n * @param value\n * @return {boolean}\n */\n\n\nfunction isPromise(value) {\n  var _value$constructor;\n\n  return value && value.then && typeof value.then === 'function' && (value === null || value === void 0 ? void 0 : (_value$constructor = value.constructor) === null || _value$constructor === void 0 ? void 0 : _value$constructor.name) === 'Promise';\n}\n/**\n * Determines if the component has a scoping parent in tree (a component which scopes its children and manages its\n * changes by itself, e.g. EditGrid)\n * @param componentInstance\n * @param firstPass\n * @returns {boolean|boolean|*}\n */\n\n\nfunction isInsideScopingComponent(componentInstance) {\n  var firstPass = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n  if (!firstPass && componentInstance !== null && componentInstance !== void 0 && componentInstance.hasScopedChildren) {\n    return true;\n  }\n\n  var dataParent = getDataParentComponent(componentInstance);\n\n  if (dataParent !== null && dataParent !== void 0 && dataParent.hasScopedChildren) {\n    return true;\n  } else if (dataParent !== null && dataParent !== void 0 && dataParent.parent) {\n    return isInsideScopingComponent(dataParent.parent, false);\n  }\n\n  return false;\n}\n\nfunction getFocusableElements(element) {\n  var focusableSelector = \"button:not([disabled]), input:not([disabled]), select:not([disabled]),\\n    textarea:not([disabled]), button:not([disabled]), [href]\";\n  return element.querySelectorAll(focusableSelector);\n} // Export lodash to save space with other libraries."]},"metadata":{},"sourceType":"script"}