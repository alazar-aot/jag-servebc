{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.ValidationChecker = void 0;\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.string.trim.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.object.values.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _utils = require(\"../utils/utils\");\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _fetchPonyfill2 = _interopRequireDefault(require(\"fetch-ponyfill\"));\n\nvar _calendarUtils = require(\"../utils/calendarUtils\");\n\nvar _Rules = _interopRequireDefault(require(\"./Rules\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar _fetchPonyfill = (0, _fetchPonyfill2.default)({\n  Promise: _nativePromiseOnly.default\n}),\n    fetch = _fetchPonyfill.fetch,\n    Headers = _fetchPonyfill.Headers,\n    Request = _fetchPonyfill.Request;\n\nvar ValidationChecker = /*#__PURE__*/function () {\n  function ValidationChecker() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, ValidationChecker);\n\n    this.config = _lodash.default.defaults(config, ValidationChecker.config);\n    this.validators = {\n      required: {\n        key: 'validate.required',\n        method: 'validateRequired',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('required'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          if (!(0, _utils.boolValue)(setting) || component.isValueHidden()) {\n            return true;\n          }\n\n          var isCalendar = component.validators.some(function (validator) {\n            return validator === 'calendar';\n          });\n\n          if (!value && isCalendar && component.widget.enteredDate) {\n            return !this.validators.calendar.check.call(this, component, setting, value);\n          }\n\n          return !component.isEmpty(value);\n        }\n      },\n      onlyAvailableItems: {\n        key: 'validate.onlyAvailableItems',\n        method: 'validateValueAvailability',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('valueIsNotAvailable'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting) {\n          return !(0, _utils.boolValue)(setting);\n        }\n      },\n      unique: {\n        key: 'validate.unique',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('unique'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var _this = this; // Skip if setting is falsy\n\n\n          if (!(0, _utils.boolValue)(setting)) {\n            return true;\n          } // Skip if value is empty object or falsy\n\n\n          if (!value || _lodash.default.isObjectLike(value) && _lodash.default.isEmpty(value)) {\n            return true;\n          } // Skip if we don't have a database connection\n\n\n          if (!this.config.db) {\n            return true;\n          }\n\n          return new _nativePromiseOnly.default(function (resolve) {\n            var form = _this.config.form;\n            var submission = _this.config.submission;\n            var path = \"data.\".concat(component.path);\n\n            var addPathQueryParams = function addPathQueryParams(pathQueryParams, query, path) {\n              var pathArray = path.split(/\\[\\d+\\]?./);\n              var needValuesInArray = pathArray.length > 1;\n              var pathToValue = path;\n\n              if (needValuesInArray) {\n                pathToValue = pathArray.shift();\n                var pathQueryObj = {};\n\n                _lodash.default.reduce(pathArray, function (pathQueryPath, pathPart, index) {\n                  var isLastPathPart = index === pathArray.length - 1;\n\n                  var obj = _lodash.default.get(pathQueryObj, pathQueryPath, pathQueryObj);\n\n                  var addedPath = \"$elemMatch['\".concat(pathPart, \"']\");\n\n                  _lodash.default.set(obj, addedPath, isLastPathPart ? pathQueryParams : {});\n\n                  return pathQueryPath ? \"\".concat(pathQueryPath, \".\").concat(addedPath) : addedPath;\n                }, '');\n\n                query[pathToValue] = pathQueryObj;\n              } else {\n                query[pathToValue] = pathQueryParams;\n              }\n            }; // Build the query\n\n\n            var query = {\n              form: form._id\n            };\n\n            if (_lodash.default.isString(value)) {\n              if (component.component.dbIndex) {\n                addPathQueryParams(value, query, path);\n              } else {\n                addPathQueryParams({\n                  $regex: new RegExp(\"^\".concat((0, _utils.escapeRegExCharacters)(value), \"$\")),\n                  $options: 'i'\n                }, query, path);\n              }\n            } // FOR-213 - Pluck the unique location id\n            else if (_lodash.default.isPlainObject(value) && value.address && value.address['address_components'] && value.address['place_id']) {\n              addPathQueryParams({\n                $regex: new RegExp(\"^\".concat((0, _utils.escapeRegExCharacters)(value.address['place_id']), \"$\")),\n                $options: 'i'\n              }, query, \"\".concat(path, \".address.place_id\"));\n            } // Compare the contents of arrays vs the order.\n            else if (_lodash.default.isArray(value)) {\n              addPathQueryParams({\n                $all: value\n              }, query, path);\n            } else if (_lodash.default.isObject(value) || _lodash.default.isNumber(value)) {\n              addPathQueryParams({\n                $eq: value\n              }, query, path);\n            } // Only search for non-deleted items\n\n\n            query.deleted = {\n              $eq: null\n            }; // Try to find an existing value within the form\n\n            _this.config.db.findOne(query, function (err, result) {\n              if (err) {\n                return resolve(false);\n              } else if (result) {\n                // Only OK if it matches the current submission\n                if (submission._id && result._id.toString() === submission._id) {\n                  resolve(true);\n                } else {\n                  component.conflictId = result._id.toString();\n                  return resolve(false);\n                }\n              } else {\n                return resolve(true);\n              }\n            });\n          }).catch(function () {\n            return false;\n          });\n        }\n      },\n      multiple: {\n        key: 'validate.multiple',\n        hasLabel: true,\n        message: function message(component) {\n          var shouldBeArray = (0, _utils.boolValue)(component.component.multiple) || Array.isArray(component.emptyValue);\n          var isRequired = component.component.validate.required;\n          var messageKey = shouldBeArray ? isRequired ? 'array_nonempty' : 'array' : 'nonarray';\n          return component.t(component.errorMessage(messageKey), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          // Skip multiple validation if the component tells us to\n          if (!component.validateMultiple()) {\n            return true;\n          }\n\n          var shouldBeArray = (0, _utils.boolValue)(setting);\n          var canBeArray = Array.isArray(component.emptyValue);\n          var isArray = Array.isArray(value);\n          var isRequired = component.component.validate.required;\n\n          if (shouldBeArray) {\n            if (isArray) {\n              return isRequired ? !!value.length : true;\n            } else {\n              // Null/undefined is ok if this value isn't required; anything else should fail\n              return _lodash.default.isNil(value) ? !isRequired : false;\n            }\n          } else {\n            return canBeArray || !isArray;\n          }\n        }\n      },\n      select: {\n        key: 'validate.select',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('select'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value, data, index, row, async) {\n          // Skip if setting is falsy\n          if (!(0, _utils.boolValue)(setting)) {\n            return true;\n          } // Skip if value is empty\n\n\n          if (!value || _lodash.default.isEmpty(value)) {\n            return true;\n          } // Skip if we're not async-capable\n\n\n          if (!async) {\n            return true;\n          }\n\n          var schema = component.component; // Initialize the request options\n\n          var requestOptions = {\n            url: setting,\n            method: 'GET',\n            qs: {},\n            json: true,\n            headers: {}\n          }; // If the url is a boolean value\n\n          if (_lodash.default.isBoolean(requestOptions.url)) {\n            requestOptions.url = !!requestOptions.url;\n\n            if (!requestOptions.url || schema.dataSrc !== 'url' || !schema.data.url || !schema.searchField) {\n              return true;\n            } // Get the validation url\n\n\n            requestOptions.url = schema.data.url; // Add the search field\n\n            requestOptions.qs[schema.searchField] = value; // Add the filters\n\n            if (schema.filter) {\n              requestOptions.url += (!requestOptions.url.includes('?') ? '?' : '&') + schema.filter;\n            } // If they only wish to return certain fields.\n\n\n            if (schema.selectFields) {\n              requestOptions.qs.select = schema.selectFields;\n            }\n          }\n\n          if (!requestOptions.url) {\n            return true;\n          } // Make sure to interpolate.\n\n\n          requestOptions.url = (0, _utils.interpolate)(requestOptions.url, {\n            data: component.data\n          }); // Add query string to URL\n\n          requestOptions.url += (requestOptions.url.includes('?') ? '&' : '?') + _lodash.default.chain(requestOptions.qs).map(function (val, key) {\n            return \"\".concat(encodeURIComponent(key), \"=\").concat(encodeURIComponent(val));\n          }).join('&').value(); // Set custom headers.\n\n          if (schema.data && schema.data.headers) {\n            _lodash.default.each(schema.data.headers, function (header) {\n              if (header.key) {\n                requestOptions.headers[header.key] = header.value;\n              }\n            });\n          } // Set form.io authentication.\n\n\n          if (schema.authenticate && this.config.token) {\n            requestOptions.headers['x-jwt-token'] = this.config.token;\n          }\n\n          return fetch(new Request(requestOptions.url, {\n            headers: new Headers(requestOptions.headers)\n          })).then(function (response) {\n            if (!response.ok) {\n              return false;\n            }\n\n            return response.json();\n          }).then(function (results) {\n            return results && results.length;\n          }).catch(function () {\n            return false;\n          });\n        }\n      },\n      min: {\n        key: 'validate.min',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('min'), {\n            field: component.errorLabel,\n            min: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var min = parseFloat(setting);\n          var parsedValue = parseFloat(value);\n\n          if (Number.isNaN(min) || Number.isNaN(parsedValue)) {\n            return true;\n          }\n\n          return parsedValue >= min;\n        }\n      },\n      max: {\n        key: 'validate.max',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('max'), {\n            field: component.errorLabel,\n            max: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var max = parseFloat(setting);\n          var parsedValue = parseFloat(value);\n\n          if (Number.isNaN(max) || Number.isNaN(parsedValue)) {\n            return true;\n          }\n\n          return parsedValue <= max;\n        }\n      },\n      minSelectedCount: {\n        key: 'validate.minSelectedCount',\n        message: function message(component, setting) {\n          return component.component.minSelectedCountMessage ? component.component.minSelectedCountMessage : component.t(component.errorMessage('minSelectedCount'), {\n            minCount: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var min = parseFloat(setting);\n\n          if (!min) {\n            return true;\n          }\n\n          var count = Object.keys(value).reduce(function (total, key) {\n            if (value[key]) {\n              total++;\n            }\n\n            return total;\n          }, 0); // Should not be triggered if there is no options selected at all\n\n          return !count || count >= min;\n        }\n      },\n      maxSelectedCount: {\n        key: 'validate.maxSelectedCount',\n        message: function message(component, setting) {\n          return component.component.maxSelectedCountMessage ? component.component.maxSelectedCountMessage : component.t(component.errorMessage('maxSelectedCount'), {\n            minCount: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var max = parseFloat(setting);\n\n          if (!max) {\n            return true;\n          }\n\n          var count = Object.keys(value).reduce(function (total, key) {\n            if (value[key]) {\n              total++;\n            }\n\n            return total;\n          }, 0);\n          return count <= max;\n        }\n      },\n      minLength: {\n        key: 'validate.minLength',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('minLength'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var minLength = parseInt(setting, 10);\n\n          if (!value || !minLength || typeof value !== 'string' || component.isEmpty(value)) {\n            return true;\n          }\n\n          return value.length >= minLength;\n        }\n      },\n      maxLength: {\n        key: 'validate.maxLength',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('maxLength'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var maxLength = parseInt(setting, 10);\n\n          if (!maxLength || typeof value !== 'string') {\n            return true;\n          }\n\n          return value.length <= maxLength;\n        }\n      },\n      maxWords: {\n        key: 'validate.maxWords',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('maxWords'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var maxWords = parseInt(setting, 10);\n\n          if (!maxWords || typeof value !== 'string') {\n            return true;\n          }\n\n          return value.trim().split(/\\s+/).length <= maxWords;\n        }\n      },\n      minWords: {\n        key: 'validate.minWords',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('minWords'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var minWords = parseInt(setting, 10);\n\n          if (!minWords || !value || typeof value !== 'string') {\n            return true;\n          }\n\n          return value.trim().split(/\\s+/).length >= minWords;\n        }\n      },\n      email: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_email'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          /* eslint-disable max-len */\n          // From http://stackoverflow.com/questions/46155/validate-email-address-in-javascript\n          var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n          /* eslint-enable max-len */\n          // Allow emails to be valid if the component is pristine and no value is provided.\n\n          return !value || re.test(value);\n        }\n      },\n      url: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_url'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          /* eslint-disable max-len */\n          // From https://stackoverflow.com/questions/8667070/javascript-regular-expression-to-validate-url\n          var re = /^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i; // From http://stackoverflow.com/questions/46155/validate-email-address-in-javascript\n\n          var emailRe = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n          /* eslint-enable max-len */\n          // Allow urls to be valid if the component is pristine and no value is provided.\n\n          return !value || re.test(value) && !emailRe.test(value);\n        }\n      },\n      date: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_date'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          return value !== 'Invalid date';\n        }\n      },\n      day: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_day'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          if (!value) {\n            return true;\n          }\n\n          var _ref = component.dayFirst ? [0, 1, 2] : [1, 0, 2],\n              _ref2 = _slicedToArray(_ref, 3),\n              DAY = _ref2[0],\n              MONTH = _ref2[1],\n              YEAR = _ref2[2];\n\n          var values = value.split('/').map(function (x) {\n            return parseInt(x, 10);\n          }),\n              day = values[DAY],\n              month = values[MONTH],\n              year = values[YEAR],\n              maxDay = getDaysInMonthCount(month, year);\n\n          if (day < 0 || day > maxDay) {\n            return false;\n          }\n\n          if (month < 0 || month > 12) {\n            return false;\n          }\n\n          if (year < 0 || year > 9999) {\n            return false;\n          }\n\n          return true;\n\n          function isLeapYear(year) {\n            // Year is leap if it is evenly divisible by 400 or evenly divisible by 4 and not evenly divisible by 100.\n            return !(year % 400) || !!(year % 100) && !(year % 4);\n          }\n\n          function getDaysInMonthCount(month, year) {\n            switch (month) {\n              case 1: // January\n\n              case 3: // March\n\n              case 5: // May\n\n              case 7: // July\n\n              case 8: // August\n\n              case 10: // October\n\n              case 12:\n                // December\n                return 31;\n\n              case 4: // April\n\n              case 6: // June\n\n              case 9: // September\n\n              case 11:\n                // November\n                return 30;\n\n              case 2:\n                // February\n                return isLeapYear(year) ? 29 : 28;\n\n              default:\n                return 31;\n            }\n          }\n        }\n      },\n      pattern: {\n        key: 'validate.pattern',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(_lodash.default.get(component, 'component.validate.patternMessage', component.errorMessage('pattern')), {\n            field: component.errorLabel,\n            pattern: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          if (component.isEmpty(value)) return true;\n          var pattern = setting;\n\n          if (!pattern) {\n            return true;\n          }\n\n          var regex = new RegExp(\"^\".concat(pattern, \"$\"));\n          return regex.test(value);\n        }\n      },\n      json: {\n        key: 'validate.json',\n        check: function check(component, setting, value, data, index, row) {\n          if (!setting) {\n            return true;\n          }\n\n          var valid = component.evaluate(setting, {\n            data: data,\n            row: row,\n            rowIndex: index,\n            input: value\n          });\n\n          if (valid === null) {\n            return true;\n          }\n\n          return valid;\n        }\n      },\n      mask: {\n        key: 'inputMask',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('mask'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var inputMask;\n\n          if (component.isMultipleMasksField) {\n            var maskName = value ? value.maskName : undefined;\n            var formioInputMask = component.getMaskByName(maskName);\n\n            if (formioInputMask) {\n              inputMask = formioInputMask;\n            }\n\n            value = value ? value.value : value;\n          } else {\n            inputMask = setting;\n          }\n\n          inputMask = inputMask ? (0, _utils.getInputMask)(inputMask) : null;\n\n          if (value && inputMask && !component.skipMaskValidation) {\n            // If char which is used inside mask placeholder was used in the mask, replace it with space to prevent errors\n            inputMask = inputMask.map(function (char) {\n              return char === component.placeholderChar ? ' ' : char;\n            });\n            return (0, _utils.matchInputMask)(value, inputMask);\n          }\n\n          return true;\n        }\n      },\n      custom: {\n        key: 'validate.custom',\n        message: function message(component) {\n          return component.t(component.errorMessage('custom'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value, data, index, row) {\n          if (!setting) {\n            return true;\n          }\n\n          var valid = component.evaluate(setting, {\n            valid: true,\n            data: data,\n            rowIndex: index,\n            row: row,\n            input: value\n          }, 'valid', true);\n\n          if (valid === null) {\n            return true;\n          }\n\n          return valid;\n        }\n      },\n      maxDate: {\n        key: 'maxDate',\n        hasLabel: true,\n        message: function message(component, setting) {\n          var date = (0, _utils.getDateSetting)(setting);\n          return component.t(component.errorMessage('maxDate'), {\n            field: component.errorLabel,\n            maxDate: (0, _moment.default)(date).format(component.format)\n          });\n        },\n        check: function check(component, setting, value) {\n          //if any parts of day are missing, skip maxDate validation\n          if (component.isPartialDay && component.isPartialDay(value)) {\n            return true;\n          }\n\n          var date = component.getValidationFormat ? (0, _moment.default)(value, component.getValidationFormat()) : (0, _moment.default)(value);\n          var maxDate = (0, _utils.getDateSetting)(setting);\n\n          if (_lodash.default.isNull(maxDate)) {\n            return true;\n          } else {\n            maxDate.setHours(0, 0, 0, 0);\n          }\n\n          return date.isBefore(maxDate) || date.isSame(maxDate);\n        }\n      },\n      minDate: {\n        key: 'minDate',\n        hasLabel: true,\n        message: function message(component, setting) {\n          var date = (0, _utils.getDateSetting)(setting);\n          return component.t(component.errorMessage('minDate'), {\n            field: component.errorLabel,\n            minDate: (0, _moment.default)(date).format(component.format)\n          });\n        },\n        check: function check(component, setting, value) {\n          //if any parts of day are missing, skip minDate validation\n          if (component.isPartialDay && component.isPartialDay(value)) {\n            return true;\n          }\n\n          var date = component.getValidationFormat ? (0, _moment.default)(value, component.getValidationFormat()) : (0, _moment.default)(value);\n          var minDate = (0, _utils.getDateSetting)(setting);\n\n          if (_lodash.default.isNull(minDate)) {\n            return true;\n          } else {\n            minDate.setHours(0, 0, 0, 0);\n          }\n\n          return date.isAfter(minDate) || date.isSame(minDate);\n        }\n      },\n      minYear: {\n        key: 'minYear',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('minYear'), {\n            field: component.errorLabel,\n            minYear: setting\n          });\n        },\n        check: function check(component, setting, value) {\n          var minYear = setting;\n          var year = /\\d{4}$/.exec(value);\n          year = year ? year[0] : null;\n\n          if (!+minYear || !+year) {\n            return true;\n          }\n\n          return +year >= +minYear;\n        }\n      },\n      maxYear: {\n        key: 'maxYear',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('maxYear'), {\n            field: component.errorLabel,\n            maxYear: setting\n          });\n        },\n        check: function check(component, setting, value) {\n          var maxYear = setting;\n          var year = /\\d{4}$/.exec(value);\n          year = year ? year[0] : null;\n\n          if (!+maxYear || !+year) {\n            return true;\n          }\n\n          return +year <= +maxYear;\n        }\n      },\n      calendar: {\n        key: 'validate.calendar',\n        messageText: '',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage(this.validators.calendar.messageText), {\n            field: component.errorLabel,\n            maxDate: (0, _moment.default)(component.dataValue).format(component.format)\n          });\n        },\n        check: function check(component, setting, value, data, index) {\n          this.validators.calendar.messageText = '';\n          var widget = component.getWidget(index);\n\n          if (!widget) {\n            return true;\n          }\n\n          var settings = widget.settings,\n              enteredDate = widget.enteredDate;\n          var minDate = settings.minDate,\n              maxDate = settings.maxDate,\n              format = settings.format;\n          var momentFormat = [(0, _utils.convertFormatToMoment)(format)];\n\n          if (momentFormat[0].match(/M{3,}/g)) {\n            momentFormat.push(momentFormat[0].replace(/M{3,}/g, 'MM'));\n          }\n\n          if (!value && enteredDate) {\n            var _checkInvalidDate = (0, _calendarUtils.checkInvalidDate)(enteredDate, momentFormat, minDate, maxDate),\n                message = _checkInvalidDate.message,\n                result = _checkInvalidDate.result;\n\n            if (!result) {\n              this.validators.calendar.messageText = message;\n              return result;\n            }\n          }\n\n          if (value && enteredDate) {\n            if ((0, _moment.default)(value).format() !== (0, _moment.default)(enteredDate, momentFormat, true).format() && enteredDate.match(/_/gi)) {\n              this.validators.calendar.messageText = _calendarUtils.CALENDAR_ERROR_MESSAGES.INCOMPLETE;\n              return false;\n            } else {\n              widget.enteredDate = '';\n              return true;\n            }\n          }\n        }\n      },\n      time: {\n        key: 'validate.time',\n        messageText: 'Invalid time',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage(this.validators.time.messageText), {\n            field: component.errorLabel\n          });\n        },\n        check: function check(component, setting, value) {\n          if (component.isEmpty(value)) return true;\n          return (0, _moment.default)(value, component.component.format).isValid();\n        }\n      }\n    };\n  }\n\n  _createClass(ValidationChecker, [{\n    key: \"checkValidator\",\n    value: function checkValidator(component, validator, setting, value, data, index, row, async) {\n      var _this2 = this;\n\n      var resultOrPromise = null; // Allow each component to override their own validators by implementing the validator.method\n\n      if (validator.method && typeof component[validator.method] === 'function') {\n        resultOrPromise = component[validator.method](setting, value, data, index, row, async);\n      } else {\n        resultOrPromise = validator.check.call(this, component, setting, value, data, index, row, async);\n      }\n\n      var processResult = function processResult(result) {\n        if (typeof result === 'string') {\n          return result;\n        }\n\n        if (!result && validator.message) {\n          return validator.message.call(_this2, component, setting, index, row);\n        }\n\n        return '';\n      };\n\n      if (async) {\n        return _nativePromiseOnly.default.resolve(resultOrPromise).then(processResult);\n      } else {\n        return processResult(resultOrPromise);\n      }\n    }\n  }, {\n    key: \"validate\",\n    value: function validate(component, validatorName, value, data, index, row, async, conditionallyVisible, validationObj) {\n      // Skip validation for conditionally hidden components\n      if (!conditionallyVisible) {\n        return false;\n      }\n\n      var validator = this.validators[validatorName];\n\n      var setting = _lodash.default.get(validationObj || component.component, validator.key, null);\n\n      var resultOrPromise = this.checkValidator(component, validator, setting, value, data, index, row, async);\n\n      var processResult = function processResult(result) {\n        if (result) {\n          var _component$refs$input;\n\n          var resultData = {\n            message: (0, _utils.unescapeHTML)(_lodash.default.get(result, 'message', result)),\n            level: _lodash.default.get(result, 'level') === 'warning' ? 'warning' : 'error',\n            path: (0, _utils.getArrayFromComponentPath)(component.path || ''),\n            context: {\n              validator: validatorName,\n              hasLabel: validator.hasLabel,\n              setting: setting,\n              key: component.key,\n              label: component.label,\n              value: value,\n              index: index,\n              input: (_component$refs$input = component.refs.input) === null || _component$refs$input === void 0 ? void 0 : _component$refs$input[index]\n            }\n          };\n\n          if (validatorName === 'unique' && component.conflictId) {\n            resultData.conflictId = component.conflictId;\n          }\n\n          return resultData;\n        } else {\n          return false;\n        }\n      };\n\n      if (async) {\n        return _nativePromiseOnly.default.resolve(resultOrPromise).then(processResult);\n      } else {\n        return processResult(resultOrPromise);\n      }\n    }\n  }, {\n    key: \"checkComponent\",\n    value: function checkComponent(component, data, row) {\n      var _component$addons,\n          _this3 = this;\n\n      var includeWarnings = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var async = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var isServerSidePersistent = typeof process !== 'undefined' && _lodash.default.get(process, 'release.name') === 'node' && !_lodash.default.defaultTo(component.component.persistent, true); // If we're server-side and it's not a persistent component, don't run validation at all\n\n      if (isServerSidePersistent || component.component.validate === false) {\n        return async ? _nativePromiseOnly.default.resolve([]) : [];\n      }\n\n      data = data || component.rootValue;\n      row = row || component.data;\n      var values = component.component.multiple && Array.isArray(component.validationValue) ? component.validationValue : [component.validationValue];\n      var conditionallyVisible = component.conditionallyVisible();\n      var addonsValidations = [];\n\n      if (component !== null && component !== void 0 && (_component$addons = component.addons) !== null && _component$addons !== void 0 && _component$addons.length) {\n        values.forEach(function (value) {\n          component.addons.forEach(function (addon) {\n            if (!addon.checkValidity(value)) {\n              addonsValidations.push.apply(addonsValidations, _toConsumableArray(addon.errors || []));\n            }\n          });\n        });\n      } // If this component has the new validation system enabled, use it instead.\n\n\n      var validations = _lodash.default.get(component, 'component.validations');\n\n      var nextGenResultsOrPromises = [];\n\n      if (validations && Array.isArray(validations) && validations.length) {\n        var validationsGroupedByMode = _lodash.default.chain(validations).groupBy(function (validation) {\n          return validation.mode;\n        }).value();\n\n        if (component.calculateCondition) {\n          includeWarnings = true;\n\n          var uiGroupedValidation = _lodash.default.chain(validationsGroupedByMode.ui).filter('active').groupBy(function (validation) {\n            return validation.group || null;\n          }).value();\n\n          var commonValidations = uiGroupedValidation.null || [];\n          delete uiGroupedValidation.null;\n          commonValidations.forEach(function (_ref3) {\n            var condition = _ref3.condition,\n                message = _ref3.message,\n                severity = _ref3.severity;\n\n            if (!component.calculateCondition(condition)) {\n              nextGenResultsOrPromises.push({\n                level: severity || 'error',\n                message: component.t(message),\n                componentInstance: component\n              });\n            }\n          });\n\n          _lodash.default.forEach(uiGroupedValidation, function (validationGroup) {\n            _lodash.default.forEach(validationGroup, function (_ref4) {\n              var condition = _ref4.condition,\n                  message = _ref4.message,\n                  severity = _ref4.severity;\n\n              if (!component.calculateCondition(condition)) {\n                nextGenResultsOrPromises.push({\n                  level: severity || 'error',\n                  message: component.t(message),\n                  componentInstance: component\n                });\n                return false;\n              }\n            });\n          });\n        } else {\n          nextGenResultsOrPromises = this.checkValidations(component, validations, data, row, values, async);\n        }\n\n        if (component.validators.includes('custom') && validationsGroupedByMode.js) {\n          _lodash.default.each(validationsGroupedByMode.js, function (validation) {\n            nextGenResultsOrPromises.push(_lodash.default.map(values, function (value, index) {\n              return _this3.validate(component, 'custom', value, data, index, row, async, conditionallyVisible, validation);\n            }));\n          });\n        }\n\n        if (component.validators.includes('json') && validationsGroupedByMode.json) {\n          _lodash.default.each(validationsGroupedByMode.json, function (validation) {\n            nextGenResultsOrPromises.push(_lodash.default.map(values, function (value, index) {\n              return _this3.validate(component, 'json', value, data, index, row, async, conditionallyVisible, validation);\n            }));\n          });\n        }\n      }\n\n      var validateCustom = _lodash.default.get(component, 'component.validate.custom');\n\n      var customErrorMessage = _lodash.default.get(component, 'component.validate.customMessage'); // Run primary validators\n\n\n      var resultsOrPromises = (0, _lodash.default)(component.validators).chain().map(function (validatorName) {\n        if (!_this3.validators.hasOwnProperty(validatorName)) {\n          return {\n            message: \"Validator for \\\"\".concat(validatorName, \"\\\" is not defined\"),\n            level: 'warning',\n            context: {\n              validator: validatorName,\n              key: component.key,\n              label: component.label\n            }\n          };\n        } // Handle the case when there is no values defined and it is required.\n\n\n        if (validatorName === 'required' && !values.length) {\n          return [_this3.validate(component, validatorName, null, data, 0, row, async, conditionallyVisible)];\n        }\n\n        return _lodash.default.map(values, function (value, index) {\n          return _this3.validate(component, validatorName, value, data, index, row, async, conditionallyVisible);\n        });\n      }).flatten().value(); // Run the \"unique\" pseudo-validator\n\n      component.component.validate = component.component.validate || {};\n      component.component.validate.unique = component.component.unique;\n      resultsOrPromises.push(this.validate(component, 'unique', component.validationValue, data, 0, data, async, conditionallyVisible)); // Run the \"multiple\" pseudo-validator\n\n      component.component.validate.multiple = component.component.multiple;\n      resultsOrPromises.push(this.validate(component, 'multiple', component.validationValue, data, 0, data, async, conditionallyVisible));\n      resultsOrPromises.push.apply(resultsOrPromises, addonsValidations);\n      resultsOrPromises.push.apply(resultsOrPromises, _toConsumableArray(nextGenResultsOrPromises)); // Define how results should be formatted\n\n      var formatResults = function formatResults(results) {\n        // Condense to a single flat array\n        results = (0, _lodash.default)(results).chain().flatten().compact().value();\n\n        if (customErrorMessage || validateCustom) {\n          _lodash.default.each(results, function (result) {\n            result.message = component.t(customErrorMessage || result.message, {\n              field: component.errorLabel,\n              data: data,\n              row: row,\n              error: result\n            });\n            result.context.hasLabel = false;\n          });\n        }\n\n        return includeWarnings ? results : _lodash.default.reject(results, function (result) {\n          return result.level === 'warning';\n        });\n      }; // Wait for results if using async mode, otherwise process and return immediately\n\n\n      if (async) {\n        return _nativePromiseOnly.default.all(resultsOrPromises).then(formatResults);\n      } else {\n        return formatResults(resultsOrPromises);\n      }\n    }\n    /**\n     * Use the new validations engine to evaluate any errors.\n     *\n     * @param component\n     * @param validations\n     * @param data\n     * @param row\n     * @param values\n     * @returns {any[]}\n     */\n\n  }, {\n    key: \"checkValidations\",\n    value: function checkValidations(component, validations, data, row, values, async) {\n      var _this4 = this; // Get results.\n\n\n      var results = validations.map(function (validation) {\n        return _this4.checkRule(component, validation, data, row, values, async);\n      }); // Flatten array and filter out empty results.\n\n      var messages = results.reduce(function (prev, result) {\n        if (result) {\n          return [].concat(_toConsumableArray(prev), _toConsumableArray(result));\n        }\n\n        return prev;\n      }, []).filter(function (result) {\n        return result;\n      }); // Keep only the last error for each rule.\n\n      var rules = messages.reduce(function (prev, message) {\n        prev[message.context.validator] = message;\n        return prev;\n      }, {});\n      return Object.values(rules);\n    }\n  }, {\n    key: \"checkRule\",\n    value: function checkRule(component, validation, data, row, values, async) {\n      var Rule = _Rules.default.getRule(validation.rule);\n\n      var results = [];\n\n      if (Rule) {\n        var rule = new Rule(component, validation.settings, this.config);\n        values.map(function (value, index) {\n          var result = rule.check(value, data, row, async);\n\n          if (result !== true) {\n            results.push({\n              level: validation.level || 'error',\n              message: component.t(validation.message || rule.defaultMessage, {\n                settings: validation.settings,\n                field: component.errorLabel,\n                data: data,\n                row: row,\n                error: result\n              }),\n              context: {\n                key: component.key,\n                index: index,\n                label: component.label,\n                validator: validation.rule\n              }\n            });\n          }\n        });\n      } // If there are no results, return false so it is removed by filter.\n\n\n      return results.length === 0 ? false : results;\n    }\n  }, {\n    key: \"check\",\n    get: function get() {\n      return this.checkComponent;\n    }\n  }, {\n    key: \"get\",\n    value: function get() {\n      _lodash.default.get.call(this, arguments);\n    }\n  }, {\n    key: \"each\",\n    value: function each() {\n      _lodash.default.each.call(this, arguments);\n    }\n  }, {\n    key: \"has\",\n    value: function has() {\n      _lodash.default.has.call(this, arguments);\n    }\n  }]);\n\n  return ValidationChecker;\n}();\n\nexports.ValidationChecker = ValidationChecker;\nValidationChecker.config = {\n  db: null,\n  token: null,\n  form: null,\n  submission: null\n};\nvar instance = new ValidationChecker();\nexports.default = instance;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/jag-servebc/forms-flow-ai/forms-flow-web/node_modules/formiojs/validator/Validator.js"],"names":["require","Object","defineProperty","exports","value","default","ValidationChecker","_lodash","_interopRequireDefault","_utils","_moment","_nativePromiseOnly","_fetchPonyfill2","_calendarUtils","_Rules","obj","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Array","from","isArray","_arrayLikeToArray","_slicedToArray","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","prototype","toString","call","slice","constructor","name","test","len","length","arr2","_i","_arr","_n","_d","_s","_e","next","done","push","err","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_fetchPonyfill","Promise","fetch","Headers","Request","config","arguments","undefined","defaults","validators","required","method","hasLabel","message","component","t","errorMessage","field","errorLabel","data","check","setting","boolValue","isValueHidden","isCalendar","some","validator","widget","enteredDate","calendar","isEmpty","onlyAvailableItems","unique","_this","isObjectLike","db","resolve","form","submission","path","concat","addPathQueryParams","pathQueryParams","query","pathArray","split","needValuesInArray","pathToValue","shift","pathQueryObj","reduce","pathQueryPath","pathPart","index","isLastPathPart","get","addedPath","set","_id","isString","dbIndex","$regex","RegExp","escapeRegExCharacters","$options","isPlainObject","address","$all","isObject","isNumber","$eq","deleted","findOne","result","conflictId","catch","multiple","shouldBeArray","emptyValue","isRequired","validate","messageKey","validateMultiple","canBeArray","isNil","select","row","async","schema","requestOptions","url","qs","json","headers","isBoolean","dataSrc","searchField","filter","includes","selectFields","interpolate","chain","map","val","encodeURIComponent","join","each","header","authenticate","token","then","response","ok","results","min","parseFloat","parsedValue","Number","isNaN","max","minSelectedCount","minSelectedCountMessage","minCount","count","keys","total","maxSelectedCount","maxSelectedCountMessage","minLength","parseInt","maxLength","maxWords","trim","minWords","email","re","emailRe","date","day","_ref","dayFirst","_ref2","DAY","MONTH","YEAR","values","x","month","year","maxDay","getDaysInMonthCount","isLeapYear","pattern","regex","valid","evaluate","rowIndex","input","mask","inputMask","isMultipleMasksField","maskName","formioInputMask","getMaskByName","getInputMask","skipMaskValidation","char","placeholderChar","matchInputMask","custom","maxDate","getDateSetting","format","isPartialDay","getValidationFormat","isNull","setHours","isBefore","isSame","minDate","isAfter","minYear","exec","maxYear","messageText","dataValue","getWidget","settings","momentFormat","convertFormatToMoment","match","replace","_checkInvalidDate","checkInvalidDate","CALENDAR_ERROR_MESSAGES","INCOMPLETE","time","isValid","checkValidator","_this2","resultOrPromise","processResult","validatorName","conditionallyVisible","validationObj","_component$refs$input","resultData","unescapeHTML","level","getArrayFromComponentPath","context","label","refs","checkComponent","_component$addons","_this3","includeWarnings","isServerSidePersistent","process","defaultTo","persistent","rootValue","validationValue","addonsValidations","addons","forEach","addon","checkValidity","apply","errors","validations","nextGenResultsOrPromises","validationsGroupedByMode","groupBy","validation","mode","calculateCondition","uiGroupedValidation","ui","group","commonValidations","null","_ref3","condition","severity","componentInstance","validationGroup","_ref4","checkValidations","js","validateCustom","customErrorMessage","resultsOrPromises","hasOwnProperty","flatten","formatResults","compact","error","reject","all","_this4","checkRule","messages","prev","rules","Rule","getRule","rule","defaultMessage","has"],"mappings":"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","sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.ValidationChecker = void 0;\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.number.is-nan.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.string.trim.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.object.values.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _utils = require(\"../utils/utils\");\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _fetchPonyfill2 = _interopRequireDefault(require(\"fetch-ponyfill\"));\n\nvar _calendarUtils = require(\"../utils/calendarUtils\");\n\nvar _Rules = _interopRequireDefault(require(\"./Rules\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar _fetchPonyfill = (0, _fetchPonyfill2.default)({\n  Promise: _nativePromiseOnly.default\n}),\n    fetch = _fetchPonyfill.fetch,\n    Headers = _fetchPonyfill.Headers,\n    Request = _fetchPonyfill.Request;\n\nvar ValidationChecker = /*#__PURE__*/function () {\n  function ValidationChecker() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, ValidationChecker);\n\n    this.config = _lodash.default.defaults(config, ValidationChecker.config);\n    this.validators = {\n      required: {\n        key: 'validate.required',\n        method: 'validateRequired',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('required'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          if (!(0, _utils.boolValue)(setting) || component.isValueHidden()) {\n            return true;\n          }\n\n          var isCalendar = component.validators.some(function (validator) {\n            return validator === 'calendar';\n          });\n\n          if (!value && isCalendar && component.widget.enteredDate) {\n            return !this.validators.calendar.check.call(this, component, setting, value);\n          }\n\n          return !component.isEmpty(value);\n        }\n      },\n      onlyAvailableItems: {\n        key: 'validate.onlyAvailableItems',\n        method: 'validateValueAvailability',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('valueIsNotAvailable'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting) {\n          return !(0, _utils.boolValue)(setting);\n        }\n      },\n      unique: {\n        key: 'validate.unique',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('unique'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var _this = this;\n\n          // Skip if setting is falsy\n          if (!(0, _utils.boolValue)(setting)) {\n            return true;\n          } // Skip if value is empty object or falsy\n\n\n          if (!value || _lodash.default.isObjectLike(value) && _lodash.default.isEmpty(value)) {\n            return true;\n          } // Skip if we don't have a database connection\n\n\n          if (!this.config.db) {\n            return true;\n          }\n\n          return new _nativePromiseOnly.default(function (resolve) {\n            var form = _this.config.form;\n            var submission = _this.config.submission;\n            var path = \"data.\".concat(component.path);\n\n            var addPathQueryParams = function addPathQueryParams(pathQueryParams, query, path) {\n              var pathArray = path.split(/\\[\\d+\\]?./);\n              var needValuesInArray = pathArray.length > 1;\n              var pathToValue = path;\n\n              if (needValuesInArray) {\n                pathToValue = pathArray.shift();\n                var pathQueryObj = {};\n\n                _lodash.default.reduce(pathArray, function (pathQueryPath, pathPart, index) {\n                  var isLastPathPart = index === pathArray.length - 1;\n\n                  var obj = _lodash.default.get(pathQueryObj, pathQueryPath, pathQueryObj);\n\n                  var addedPath = \"$elemMatch['\".concat(pathPart, \"']\");\n\n                  _lodash.default.set(obj, addedPath, isLastPathPart ? pathQueryParams : {});\n\n                  return pathQueryPath ? \"\".concat(pathQueryPath, \".\").concat(addedPath) : addedPath;\n                }, '');\n\n                query[pathToValue] = pathQueryObj;\n              } else {\n                query[pathToValue] = pathQueryParams;\n              }\n            }; // Build the query\n\n\n            var query = {\n              form: form._id\n            };\n\n            if (_lodash.default.isString(value)) {\n              if (component.component.dbIndex) {\n                addPathQueryParams(value, query, path);\n              } else {\n                addPathQueryParams({\n                  $regex: new RegExp(\"^\".concat((0, _utils.escapeRegExCharacters)(value), \"$\")),\n                  $options: 'i'\n                }, query, path);\n              }\n            } // FOR-213 - Pluck the unique location id\n            else if (_lodash.default.isPlainObject(value) && value.address && value.address['address_components'] && value.address['place_id']) {\n              addPathQueryParams({\n                $regex: new RegExp(\"^\".concat((0, _utils.escapeRegExCharacters)(value.address['place_id']), \"$\")),\n                $options: 'i'\n              }, query, \"\".concat(path, \".address.place_id\"));\n            } // Compare the contents of arrays vs the order.\n            else if (_lodash.default.isArray(value)) {\n              addPathQueryParams({\n                $all: value\n              }, query, path);\n            } else if (_lodash.default.isObject(value) || _lodash.default.isNumber(value)) {\n              addPathQueryParams({\n                $eq: value\n              }, query, path);\n            } // Only search for non-deleted items\n\n\n            query.deleted = {\n              $eq: null\n            }; // Try to find an existing value within the form\n\n            _this.config.db.findOne(query, function (err, result) {\n              if (err) {\n                return resolve(false);\n              } else if (result) {\n                // Only OK if it matches the current submission\n                if (submission._id && result._id.toString() === submission._id) {\n                  resolve(true);\n                } else {\n                  component.conflictId = result._id.toString();\n                  return resolve(false);\n                }\n              } else {\n                return resolve(true);\n              }\n            });\n          }).catch(function () {\n            return false;\n          });\n        }\n      },\n      multiple: {\n        key: 'validate.multiple',\n        hasLabel: true,\n        message: function message(component) {\n          var shouldBeArray = (0, _utils.boolValue)(component.component.multiple) || Array.isArray(component.emptyValue);\n          var isRequired = component.component.validate.required;\n          var messageKey = shouldBeArray ? isRequired ? 'array_nonempty' : 'array' : 'nonarray';\n          return component.t(component.errorMessage(messageKey), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          // Skip multiple validation if the component tells us to\n          if (!component.validateMultiple()) {\n            return true;\n          }\n\n          var shouldBeArray = (0, _utils.boolValue)(setting);\n          var canBeArray = Array.isArray(component.emptyValue);\n          var isArray = Array.isArray(value);\n          var isRequired = component.component.validate.required;\n\n          if (shouldBeArray) {\n            if (isArray) {\n              return isRequired ? !!value.length : true;\n            } else {\n              // Null/undefined is ok if this value isn't required; anything else should fail\n              return _lodash.default.isNil(value) ? !isRequired : false;\n            }\n          } else {\n            return canBeArray || !isArray;\n          }\n        }\n      },\n      select: {\n        key: 'validate.select',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('select'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value, data, index, row, async) {\n          // Skip if setting is falsy\n          if (!(0, _utils.boolValue)(setting)) {\n            return true;\n          } // Skip if value is empty\n\n\n          if (!value || _lodash.default.isEmpty(value)) {\n            return true;\n          } // Skip if we're not async-capable\n\n\n          if (!async) {\n            return true;\n          }\n\n          var schema = component.component; // Initialize the request options\n\n          var requestOptions = {\n            url: setting,\n            method: 'GET',\n            qs: {},\n            json: true,\n            headers: {}\n          }; // If the url is a boolean value\n\n          if (_lodash.default.isBoolean(requestOptions.url)) {\n            requestOptions.url = !!requestOptions.url;\n\n            if (!requestOptions.url || schema.dataSrc !== 'url' || !schema.data.url || !schema.searchField) {\n              return true;\n            } // Get the validation url\n\n\n            requestOptions.url = schema.data.url; // Add the search field\n\n            requestOptions.qs[schema.searchField] = value; // Add the filters\n\n            if (schema.filter) {\n              requestOptions.url += (!requestOptions.url.includes('?') ? '?' : '&') + schema.filter;\n            } // If they only wish to return certain fields.\n\n\n            if (schema.selectFields) {\n              requestOptions.qs.select = schema.selectFields;\n            }\n          }\n\n          if (!requestOptions.url) {\n            return true;\n          } // Make sure to interpolate.\n\n\n          requestOptions.url = (0, _utils.interpolate)(requestOptions.url, {\n            data: component.data\n          }); // Add query string to URL\n\n          requestOptions.url += (requestOptions.url.includes('?') ? '&' : '?') + _lodash.default.chain(requestOptions.qs).map(function (val, key) {\n            return \"\".concat(encodeURIComponent(key), \"=\").concat(encodeURIComponent(val));\n          }).join('&').value(); // Set custom headers.\n\n          if (schema.data && schema.data.headers) {\n            _lodash.default.each(schema.data.headers, function (header) {\n              if (header.key) {\n                requestOptions.headers[header.key] = header.value;\n              }\n            });\n          } // Set form.io authentication.\n\n\n          if (schema.authenticate && this.config.token) {\n            requestOptions.headers['x-jwt-token'] = this.config.token;\n          }\n\n          return fetch(new Request(requestOptions.url, {\n            headers: new Headers(requestOptions.headers)\n          })).then(function (response) {\n            if (!response.ok) {\n              return false;\n            }\n\n            return response.json();\n          }).then(function (results) {\n            return results && results.length;\n          }).catch(function () {\n            return false;\n          });\n        }\n      },\n      min: {\n        key: 'validate.min',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('min'), {\n            field: component.errorLabel,\n            min: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var min = parseFloat(setting);\n          var parsedValue = parseFloat(value);\n\n          if (Number.isNaN(min) || Number.isNaN(parsedValue)) {\n            return true;\n          }\n\n          return parsedValue >= min;\n        }\n      },\n      max: {\n        key: 'validate.max',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('max'), {\n            field: component.errorLabel,\n            max: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var max = parseFloat(setting);\n          var parsedValue = parseFloat(value);\n\n          if (Number.isNaN(max) || Number.isNaN(parsedValue)) {\n            return true;\n          }\n\n          return parsedValue <= max;\n        }\n      },\n      minSelectedCount: {\n        key: 'validate.minSelectedCount',\n        message: function message(component, setting) {\n          return component.component.minSelectedCountMessage ? component.component.minSelectedCountMessage : component.t(component.errorMessage('minSelectedCount'), {\n            minCount: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var min = parseFloat(setting);\n\n          if (!min) {\n            return true;\n          }\n\n          var count = Object.keys(value).reduce(function (total, key) {\n            if (value[key]) {\n              total++;\n            }\n\n            return total;\n          }, 0); // Should not be triggered if there is no options selected at all\n\n          return !count || count >= min;\n        }\n      },\n      maxSelectedCount: {\n        key: 'validate.maxSelectedCount',\n        message: function message(component, setting) {\n          return component.component.maxSelectedCountMessage ? component.component.maxSelectedCountMessage : component.t(component.errorMessage('maxSelectedCount'), {\n            minCount: parseFloat(setting),\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var max = parseFloat(setting);\n\n          if (!max) {\n            return true;\n          }\n\n          var count = Object.keys(value).reduce(function (total, key) {\n            if (value[key]) {\n              total++;\n            }\n\n            return total;\n          }, 0);\n          return count <= max;\n        }\n      },\n      minLength: {\n        key: 'validate.minLength',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('minLength'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var minLength = parseInt(setting, 10);\n\n          if (!value || !minLength || typeof value !== 'string' || component.isEmpty(value)) {\n            return true;\n          }\n\n          return value.length >= minLength;\n        }\n      },\n      maxLength: {\n        key: 'validate.maxLength',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('maxLength'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var maxLength = parseInt(setting, 10);\n\n          if (!maxLength || typeof value !== 'string') {\n            return true;\n          }\n\n          return value.length <= maxLength;\n        }\n      },\n      maxWords: {\n        key: 'validate.maxWords',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('maxWords'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var maxWords = parseInt(setting, 10);\n\n          if (!maxWords || typeof value !== 'string') {\n            return true;\n          }\n\n          return value.trim().split(/\\s+/).length <= maxWords;\n        }\n      },\n      minWords: {\n        key: 'validate.minWords',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('minWords'), {\n            field: component.errorLabel,\n            length: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var minWords = parseInt(setting, 10);\n\n          if (!minWords || !value || typeof value !== 'string') {\n            return true;\n          }\n\n          return value.trim().split(/\\s+/).length >= minWords;\n        }\n      },\n      email: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_email'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          /* eslint-disable max-len */\n          // From http://stackoverflow.com/questions/46155/validate-email-address-in-javascript\n          var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n          /* eslint-enable max-len */\n          // Allow emails to be valid if the component is pristine and no value is provided.\n\n          return !value || re.test(value);\n        }\n      },\n      url: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_url'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          /* eslint-disable max-len */\n          // From https://stackoverflow.com/questions/8667070/javascript-regular-expression-to-validate-url\n          var re = /^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i; // From http://stackoverflow.com/questions/46155/validate-email-address-in-javascript\n\n          var emailRe = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n          /* eslint-enable max-len */\n          // Allow urls to be valid if the component is pristine and no value is provided.\n\n          return !value || re.test(value) && !emailRe.test(value);\n        }\n      },\n      date: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_date'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          return value !== 'Invalid date';\n        }\n      },\n      day: {\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('invalid_day'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          if (!value) {\n            return true;\n          }\n\n          var _ref = component.dayFirst ? [0, 1, 2] : [1, 0, 2],\n              _ref2 = _slicedToArray(_ref, 3),\n              DAY = _ref2[0],\n              MONTH = _ref2[1],\n              YEAR = _ref2[2];\n\n          var values = value.split('/').map(function (x) {\n            return parseInt(x, 10);\n          }),\n              day = values[DAY],\n              month = values[MONTH],\n              year = values[YEAR],\n              maxDay = getDaysInMonthCount(month, year);\n\n          if (day < 0 || day > maxDay) {\n            return false;\n          }\n\n          if (month < 0 || month > 12) {\n            return false;\n          }\n\n          if (year < 0 || year > 9999) {\n            return false;\n          }\n\n          return true;\n\n          function isLeapYear(year) {\n            // Year is leap if it is evenly divisible by 400 or evenly divisible by 4 and not evenly divisible by 100.\n            return !(year % 400) || !!(year % 100) && !(year % 4);\n          }\n\n          function getDaysInMonthCount(month, year) {\n            switch (month) {\n              case 1: // January\n\n              case 3: // March\n\n              case 5: // May\n\n              case 7: // July\n\n              case 8: // August\n\n              case 10: // October\n\n              case 12:\n                // December\n                return 31;\n\n              case 4: // April\n\n              case 6: // June\n\n              case 9: // September\n\n              case 11:\n                // November\n                return 30;\n\n              case 2:\n                // February\n                return isLeapYear(year) ? 29 : 28;\n\n              default:\n                return 31;\n            }\n          }\n        }\n      },\n      pattern: {\n        key: 'validate.pattern',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(_lodash.default.get(component, 'component.validate.patternMessage', component.errorMessage('pattern')), {\n            field: component.errorLabel,\n            pattern: setting,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          if (component.isEmpty(value)) return true;\n          var pattern = setting;\n\n          if (!pattern) {\n            return true;\n          }\n\n          var regex = new RegExp(\"^\".concat(pattern, \"$\"));\n          return regex.test(value);\n        }\n      },\n      json: {\n        key: 'validate.json',\n        check: function check(component, setting, value, data, index, row) {\n          if (!setting) {\n            return true;\n          }\n\n          var valid = component.evaluate(setting, {\n            data: data,\n            row: row,\n            rowIndex: index,\n            input: value\n          });\n\n          if (valid === null) {\n            return true;\n          }\n\n          return valid;\n        }\n      },\n      mask: {\n        key: 'inputMask',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage('mask'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value) {\n          var inputMask;\n\n          if (component.isMultipleMasksField) {\n            var maskName = value ? value.maskName : undefined;\n            var formioInputMask = component.getMaskByName(maskName);\n\n            if (formioInputMask) {\n              inputMask = formioInputMask;\n            }\n\n            value = value ? value.value : value;\n          } else {\n            inputMask = setting;\n          }\n\n          inputMask = inputMask ? (0, _utils.getInputMask)(inputMask) : null;\n\n          if (value && inputMask && !component.skipMaskValidation) {\n            // If char which is used inside mask placeholder was used in the mask, replace it with space to prevent errors\n            inputMask = inputMask.map(function (char) {\n              return char === component.placeholderChar ? ' ' : char;\n            });\n            return (0, _utils.matchInputMask)(value, inputMask);\n          }\n\n          return true;\n        }\n      },\n      custom: {\n        key: 'validate.custom',\n        message: function message(component) {\n          return component.t(component.errorMessage('custom'), {\n            field: component.errorLabel,\n            data: component.data\n          });\n        },\n        check: function check(component, setting, value, data, index, row) {\n          if (!setting) {\n            return true;\n          }\n\n          var valid = component.evaluate(setting, {\n            valid: true,\n            data: data,\n            rowIndex: index,\n            row: row,\n            input: value\n          }, 'valid', true);\n\n          if (valid === null) {\n            return true;\n          }\n\n          return valid;\n        }\n      },\n      maxDate: {\n        key: 'maxDate',\n        hasLabel: true,\n        message: function message(component, setting) {\n          var date = (0, _utils.getDateSetting)(setting);\n          return component.t(component.errorMessage('maxDate'), {\n            field: component.errorLabel,\n            maxDate: (0, _moment.default)(date).format(component.format)\n          });\n        },\n        check: function check(component, setting, value) {\n          //if any parts of day are missing, skip maxDate validation\n          if (component.isPartialDay && component.isPartialDay(value)) {\n            return true;\n          }\n\n          var date = component.getValidationFormat ? (0, _moment.default)(value, component.getValidationFormat()) : (0, _moment.default)(value);\n          var maxDate = (0, _utils.getDateSetting)(setting);\n\n          if (_lodash.default.isNull(maxDate)) {\n            return true;\n          } else {\n            maxDate.setHours(0, 0, 0, 0);\n          }\n\n          return date.isBefore(maxDate) || date.isSame(maxDate);\n        }\n      },\n      minDate: {\n        key: 'minDate',\n        hasLabel: true,\n        message: function message(component, setting) {\n          var date = (0, _utils.getDateSetting)(setting);\n          return component.t(component.errorMessage('minDate'), {\n            field: component.errorLabel,\n            minDate: (0, _moment.default)(date).format(component.format)\n          });\n        },\n        check: function check(component, setting, value) {\n          //if any parts of day are missing, skip minDate validation\n          if (component.isPartialDay && component.isPartialDay(value)) {\n            return true;\n          }\n\n          var date = component.getValidationFormat ? (0, _moment.default)(value, component.getValidationFormat()) : (0, _moment.default)(value);\n          var minDate = (0, _utils.getDateSetting)(setting);\n\n          if (_lodash.default.isNull(minDate)) {\n            return true;\n          } else {\n            minDate.setHours(0, 0, 0, 0);\n          }\n\n          return date.isAfter(minDate) || date.isSame(minDate);\n        }\n      },\n      minYear: {\n        key: 'minYear',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('minYear'), {\n            field: component.errorLabel,\n            minYear: setting\n          });\n        },\n        check: function check(component, setting, value) {\n          var minYear = setting;\n          var year = /\\d{4}$/.exec(value);\n          year = year ? year[0] : null;\n\n          if (!+minYear || !+year) {\n            return true;\n          }\n\n          return +year >= +minYear;\n        }\n      },\n      maxYear: {\n        key: 'maxYear',\n        hasLabel: true,\n        message: function message(component, setting) {\n          return component.t(component.errorMessage('maxYear'), {\n            field: component.errorLabel,\n            maxYear: setting\n          });\n        },\n        check: function check(component, setting, value) {\n          var maxYear = setting;\n          var year = /\\d{4}$/.exec(value);\n          year = year ? year[0] : null;\n\n          if (!+maxYear || !+year) {\n            return true;\n          }\n\n          return +year <= +maxYear;\n        }\n      },\n      calendar: {\n        key: 'validate.calendar',\n        messageText: '',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage(this.validators.calendar.messageText), {\n            field: component.errorLabel,\n            maxDate: (0, _moment.default)(component.dataValue).format(component.format)\n          });\n        },\n        check: function check(component, setting, value, data, index) {\n          this.validators.calendar.messageText = '';\n          var widget = component.getWidget(index);\n\n          if (!widget) {\n            return true;\n          }\n\n          var settings = widget.settings,\n              enteredDate = widget.enteredDate;\n          var minDate = settings.minDate,\n              maxDate = settings.maxDate,\n              format = settings.format;\n          var momentFormat = [(0, _utils.convertFormatToMoment)(format)];\n\n          if (momentFormat[0].match(/M{3,}/g)) {\n            momentFormat.push(momentFormat[0].replace(/M{3,}/g, 'MM'));\n          }\n\n          if (!value && enteredDate) {\n            var _checkInvalidDate = (0, _calendarUtils.checkInvalidDate)(enteredDate, momentFormat, minDate, maxDate),\n                message = _checkInvalidDate.message,\n                result = _checkInvalidDate.result;\n\n            if (!result) {\n              this.validators.calendar.messageText = message;\n              return result;\n            }\n          }\n\n          if (value && enteredDate) {\n            if ((0, _moment.default)(value).format() !== (0, _moment.default)(enteredDate, momentFormat, true).format() && enteredDate.match(/_/gi)) {\n              this.validators.calendar.messageText = _calendarUtils.CALENDAR_ERROR_MESSAGES.INCOMPLETE;\n              return false;\n            } else {\n              widget.enteredDate = '';\n              return true;\n            }\n          }\n        }\n      },\n      time: {\n        key: 'validate.time',\n        messageText: 'Invalid time',\n        hasLabel: true,\n        message: function message(component) {\n          return component.t(component.errorMessage(this.validators.time.messageText), {\n            field: component.errorLabel\n          });\n        },\n        check: function check(component, setting, value) {\n          if (component.isEmpty(value)) return true;\n          return (0, _moment.default)(value, component.component.format).isValid();\n        }\n      }\n    };\n  }\n\n  _createClass(ValidationChecker, [{\n    key: \"checkValidator\",\n    value: function checkValidator(component, validator, setting, value, data, index, row, async) {\n      var _this2 = this;\n\n      var resultOrPromise = null; // Allow each component to override their own validators by implementing the validator.method\n\n      if (validator.method && typeof component[validator.method] === 'function') {\n        resultOrPromise = component[validator.method](setting, value, data, index, row, async);\n      } else {\n        resultOrPromise = validator.check.call(this, component, setting, value, data, index, row, async);\n      }\n\n      var processResult = function processResult(result) {\n        if (typeof result === 'string') {\n          return result;\n        }\n\n        if (!result && validator.message) {\n          return validator.message.call(_this2, component, setting, index, row);\n        }\n\n        return '';\n      };\n\n      if (async) {\n        return _nativePromiseOnly.default.resolve(resultOrPromise).then(processResult);\n      } else {\n        return processResult(resultOrPromise);\n      }\n    }\n  }, {\n    key: \"validate\",\n    value: function validate(component, validatorName, value, data, index, row, async, conditionallyVisible, validationObj) {\n      // Skip validation for conditionally hidden components\n      if (!conditionallyVisible) {\n        return false;\n      }\n\n      var validator = this.validators[validatorName];\n\n      var setting = _lodash.default.get(validationObj || component.component, validator.key, null);\n\n      var resultOrPromise = this.checkValidator(component, validator, setting, value, data, index, row, async);\n\n      var processResult = function processResult(result) {\n        if (result) {\n          var _component$refs$input;\n\n          var resultData = {\n            message: (0, _utils.unescapeHTML)(_lodash.default.get(result, 'message', result)),\n            level: _lodash.default.get(result, 'level') === 'warning' ? 'warning' : 'error',\n            path: (0, _utils.getArrayFromComponentPath)(component.path || ''),\n            context: {\n              validator: validatorName,\n              hasLabel: validator.hasLabel,\n              setting: setting,\n              key: component.key,\n              label: component.label,\n              value: value,\n              index: index,\n              input: (_component$refs$input = component.refs.input) === null || _component$refs$input === void 0 ? void 0 : _component$refs$input[index]\n            }\n          };\n\n          if (validatorName === 'unique' && component.conflictId) {\n            resultData.conflictId = component.conflictId;\n          }\n\n          return resultData;\n        } else {\n          return false;\n        }\n      };\n\n      if (async) {\n        return _nativePromiseOnly.default.resolve(resultOrPromise).then(processResult);\n      } else {\n        return processResult(resultOrPromise);\n      }\n    }\n  }, {\n    key: \"checkComponent\",\n    value: function checkComponent(component, data, row) {\n      var _component$addons,\n          _this3 = this;\n\n      var includeWarnings = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var async = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var isServerSidePersistent = typeof process !== 'undefined' && _lodash.default.get(process, 'release.name') === 'node' && !_lodash.default.defaultTo(component.component.persistent, true); // If we're server-side and it's not a persistent component, don't run validation at all\n\n      if (isServerSidePersistent || component.component.validate === false) {\n        return async ? _nativePromiseOnly.default.resolve([]) : [];\n      }\n\n      data = data || component.rootValue;\n      row = row || component.data;\n      var values = component.component.multiple && Array.isArray(component.validationValue) ? component.validationValue : [component.validationValue];\n      var conditionallyVisible = component.conditionallyVisible();\n      var addonsValidations = [];\n\n      if (component !== null && component !== void 0 && (_component$addons = component.addons) !== null && _component$addons !== void 0 && _component$addons.length) {\n        values.forEach(function (value) {\n          component.addons.forEach(function (addon) {\n            if (!addon.checkValidity(value)) {\n              addonsValidations.push.apply(addonsValidations, _toConsumableArray(addon.errors || []));\n            }\n          });\n        });\n      } // If this component has the new validation system enabled, use it instead.\n\n\n      var validations = _lodash.default.get(component, 'component.validations');\n\n      var nextGenResultsOrPromises = [];\n\n      if (validations && Array.isArray(validations) && validations.length) {\n        var validationsGroupedByMode = _lodash.default.chain(validations).groupBy(function (validation) {\n          return validation.mode;\n        }).value();\n\n        if (component.calculateCondition) {\n          includeWarnings = true;\n\n          var uiGroupedValidation = _lodash.default.chain(validationsGroupedByMode.ui).filter('active').groupBy(function (validation) {\n            return validation.group || null;\n          }).value();\n\n          var commonValidations = uiGroupedValidation.null || [];\n          delete uiGroupedValidation.null;\n          commonValidations.forEach(function (_ref3) {\n            var condition = _ref3.condition,\n                message = _ref3.message,\n                severity = _ref3.severity;\n\n            if (!component.calculateCondition(condition)) {\n              nextGenResultsOrPromises.push({\n                level: severity || 'error',\n                message: component.t(message),\n                componentInstance: component\n              });\n            }\n          });\n\n          _lodash.default.forEach(uiGroupedValidation, function (validationGroup) {\n            _lodash.default.forEach(validationGroup, function (_ref4) {\n              var condition = _ref4.condition,\n                  message = _ref4.message,\n                  severity = _ref4.severity;\n\n              if (!component.calculateCondition(condition)) {\n                nextGenResultsOrPromises.push({\n                  level: severity || 'error',\n                  message: component.t(message),\n                  componentInstance: component\n                });\n                return false;\n              }\n            });\n          });\n        } else {\n          nextGenResultsOrPromises = this.checkValidations(component, validations, data, row, values, async);\n        }\n\n        if (component.validators.includes('custom') && validationsGroupedByMode.js) {\n          _lodash.default.each(validationsGroupedByMode.js, function (validation) {\n            nextGenResultsOrPromises.push(_lodash.default.map(values, function (value, index) {\n              return _this3.validate(component, 'custom', value, data, index, row, async, conditionallyVisible, validation);\n            }));\n          });\n        }\n\n        if (component.validators.includes('json') && validationsGroupedByMode.json) {\n          _lodash.default.each(validationsGroupedByMode.json, function (validation) {\n            nextGenResultsOrPromises.push(_lodash.default.map(values, function (value, index) {\n              return _this3.validate(component, 'json', value, data, index, row, async, conditionallyVisible, validation);\n            }));\n          });\n        }\n      }\n\n      var validateCustom = _lodash.default.get(component, 'component.validate.custom');\n\n      var customErrorMessage = _lodash.default.get(component, 'component.validate.customMessage'); // Run primary validators\n\n\n      var resultsOrPromises = (0, _lodash.default)(component.validators).chain().map(function (validatorName) {\n        if (!_this3.validators.hasOwnProperty(validatorName)) {\n          return {\n            message: \"Validator for \\\"\".concat(validatorName, \"\\\" is not defined\"),\n            level: 'warning',\n            context: {\n              validator: validatorName,\n              key: component.key,\n              label: component.label\n            }\n          };\n        } // Handle the case when there is no values defined and it is required.\n\n\n        if (validatorName === 'required' && !values.length) {\n          return [_this3.validate(component, validatorName, null, data, 0, row, async, conditionallyVisible)];\n        }\n\n        return _lodash.default.map(values, function (value, index) {\n          return _this3.validate(component, validatorName, value, data, index, row, async, conditionallyVisible);\n        });\n      }).flatten().value(); // Run the \"unique\" pseudo-validator\n\n      component.component.validate = component.component.validate || {};\n      component.component.validate.unique = component.component.unique;\n      resultsOrPromises.push(this.validate(component, 'unique', component.validationValue, data, 0, data, async, conditionallyVisible)); // Run the \"multiple\" pseudo-validator\n\n      component.component.validate.multiple = component.component.multiple;\n      resultsOrPromises.push(this.validate(component, 'multiple', component.validationValue, data, 0, data, async, conditionallyVisible));\n      resultsOrPromises.push.apply(resultsOrPromises, addonsValidations);\n      resultsOrPromises.push.apply(resultsOrPromises, _toConsumableArray(nextGenResultsOrPromises)); // Define how results should be formatted\n\n      var formatResults = function formatResults(results) {\n        // Condense to a single flat array\n        results = (0, _lodash.default)(results).chain().flatten().compact().value();\n\n        if (customErrorMessage || validateCustom) {\n          _lodash.default.each(results, function (result) {\n            result.message = component.t(customErrorMessage || result.message, {\n              field: component.errorLabel,\n              data: data,\n              row: row,\n              error: result\n            });\n            result.context.hasLabel = false;\n          });\n        }\n\n        return includeWarnings ? results : _lodash.default.reject(results, function (result) {\n          return result.level === 'warning';\n        });\n      }; // Wait for results if using async mode, otherwise process and return immediately\n\n\n      if (async) {\n        return _nativePromiseOnly.default.all(resultsOrPromises).then(formatResults);\n      } else {\n        return formatResults(resultsOrPromises);\n      }\n    }\n    /**\n     * Use the new validations engine to evaluate any errors.\n     *\n     * @param component\n     * @param validations\n     * @param data\n     * @param row\n     * @param values\n     * @returns {any[]}\n     */\n\n  }, {\n    key: \"checkValidations\",\n    value: function checkValidations(component, validations, data, row, values, async) {\n      var _this4 = this;\n\n      // Get results.\n      var results = validations.map(function (validation) {\n        return _this4.checkRule(component, validation, data, row, values, async);\n      }); // Flatten array and filter out empty results.\n\n      var messages = results.reduce(function (prev, result) {\n        if (result) {\n          return [].concat(_toConsumableArray(prev), _toConsumableArray(result));\n        }\n\n        return prev;\n      }, []).filter(function (result) {\n        return result;\n      }); // Keep only the last error for each rule.\n\n      var rules = messages.reduce(function (prev, message) {\n        prev[message.context.validator] = message;\n        return prev;\n      }, {});\n      return Object.values(rules);\n    }\n  }, {\n    key: \"checkRule\",\n    value: function checkRule(component, validation, data, row, values, async) {\n      var Rule = _Rules.default.getRule(validation.rule);\n\n      var results = [];\n\n      if (Rule) {\n        var rule = new Rule(component, validation.settings, this.config);\n        values.map(function (value, index) {\n          var result = rule.check(value, data, row, async);\n\n          if (result !== true) {\n            results.push({\n              level: validation.level || 'error',\n              message: component.t(validation.message || rule.defaultMessage, {\n                settings: validation.settings,\n                field: component.errorLabel,\n                data: data,\n                row: row,\n                error: result\n              }),\n              context: {\n                key: component.key,\n                index: index,\n                label: component.label,\n                validator: validation.rule\n              }\n            });\n          }\n        });\n      } // If there are no results, return false so it is removed by filter.\n\n\n      return results.length === 0 ? false : results;\n    }\n  }, {\n    key: \"check\",\n    get: function get() {\n      return this.checkComponent;\n    }\n  }, {\n    key: \"get\",\n    value: function get() {\n      _lodash.default.get.call(this, arguments);\n    }\n  }, {\n    key: \"each\",\n    value: function each() {\n      _lodash.default.each.call(this, arguments);\n    }\n  }, {\n    key: \"has\",\n    value: function has() {\n      _lodash.default.has.call(this, arguments);\n    }\n  }]);\n\n  return ValidationChecker;\n}();\n\nexports.ValidationChecker = ValidationChecker;\nValidationChecker.config = {\n  db: null,\n  token: null,\n  form: null,\n  submission: null\n};\nvar instance = new ValidationChecker();\nexports.default = instance;"]},"metadata":{},"sourceType":"script"}