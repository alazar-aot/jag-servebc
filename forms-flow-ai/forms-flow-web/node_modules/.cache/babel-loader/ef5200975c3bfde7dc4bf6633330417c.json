{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.number.parse-int.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Component2 = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _ComponentModal = _interopRequireDefault(require(\"../_classes/componentModal/ComponentModal\"));\n\nvar _eventemitter = _interopRequireDefault(require(\"eventemitter3\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _Formio = require(\"../../Formio\");\n\nvar _Form = _interopRequireDefault(require(\"../../Form\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar FormComponent = /*#__PURE__*/function (_Component) {\n  _inherits(FormComponent, _Component);\n\n  var _super = _createSuper(FormComponent);\n\n  function FormComponent() {\n    _classCallCheck(this, FormComponent);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FormComponent, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"init\", this).call(this);\n\n      this.formObj = {\n        display: this.component.display,\n        settings: this.component.settings,\n        components: this.component.components\n      };\n      this.valueChanged = false;\n      this.subForm = null;\n      this.formSrc = '';\n\n      if (this.component.src) {\n        this.formSrc = this.component.src;\n      }\n\n      if (!this.component.src && !this.options.formio && (this.component.form || this.component.path)) {\n        if (this.component.project) {\n          this.formSrc = _Formio.GlobalFormio.getBaseUrl(); // Check to see if it is a MongoID.\n\n          if ((0, _utils.isMongoId)(this.component.project)) {\n            this.formSrc += '/project';\n          }\n\n          this.formSrc += \"/\".concat(this.component.project);\n          this.options.project = this.formSrc;\n        } else {\n          this.formSrc = _Formio.GlobalFormio.getProjectUrl();\n          this.options.project = this.formSrc;\n        }\n\n        if (this.component.form) {\n          if ((0, _utils.isMongoId)(this.component.form)) {\n            this.formSrc += \"/form/\".concat(this.component.form);\n          } else {\n            this.formSrc += \"/\".concat(this.component.form);\n          }\n        } else if (this.component.path) {\n          this.formSrc += \"/\".concat(this.component.path);\n        }\n      } // Build the source based on the root src path.\n\n\n      if (!this.formSrc && this.options.formio) {\n        var rootSrc = this.options.formio.formsUrl;\n\n        if (this.component.form && (0, _utils.isMongoId)(this.component.form)) {\n          this.formSrc = \"\".concat(rootSrc, \"/\").concat(this.component.form);\n        } else {\n          var formPath = this.component.path || this.component.form;\n          this.formSrc = \"\".concat(rootSrc.replace(/\\/form$/, ''), \"/\").concat(formPath);\n        }\n      }\n\n      if (this.builderMode && this.component.hasOwnProperty('formRevision')) {\n        this.component.revision = this.component.formRevision;\n        delete this.component.formRevision;\n      } // Add revision version if set.\n\n\n      if (this.component.revision || this.component.revision === 0 || this.component.formRevision || this.component.formRevision === 0) {\n        this.setFormRevision(this.component.revision || this.component.formRevision);\n      }\n\n      return this.createSubForm();\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      // Not not provide a default value unless the subform is ready so that it will initialize correctly.\n      return this.subForm ? _get(_getPrototypeOf(FormComponent.prototype), \"defaultValue\", this) : null;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return FormComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return {\n        data: {}\n      };\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"useOriginalRevision\",\n    get: function get() {\n      var _this$component, _this$formObj;\n\n      return ((_this$component = this.component) === null || _this$component === void 0 ? void 0 : _this$component.useOriginalRevision) && !!((_this$formObj = this.formObj) !== null && _this$formObj !== void 0 && _this$formObj.revisions);\n    }\n  }, {\n    key: \"setFormRevision\",\n    value: function setFormRevision(rev) {\n      // Remove current revisions from src if it is\n      this.formSrc = this.formSrc.replace(/\\/v\\/\\d*/, '');\n      var revNumber = Number.parseInt(rev);\n\n      if (!isNaN(revNumber)) {\n        this.subFormRevision = rev;\n        this.formSrc += \"/v/\".concat(rev);\n      } else {\n        this.subFormRevision = undefined;\n      }\n    }\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn) {\n      path = (0, _utils.getArrayFromComponentPath)(path);\n\n      if (path[0] === 'data') {\n        path.shift();\n      }\n\n      var originalPathStr = \"\".concat(this.path, \".data.\").concat((0, _utils.getStringFromComponentPath)(path));\n\n      if (this.subForm) {\n        return this.subForm.getComponent(path, fn, originalPathStr);\n      }\n    }\n  }, {\n    key: \"getSubOptions\",\n    value: function getSubOptions() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      options.parentPath = \"\".concat(this.path, \".data.\");\n      options.events = this.createEmitter(); // Make sure to not show the submit button in wizards in the nested forms.\n\n      _lodash.default.set(options, 'buttonSettings.showSubmit', false);\n\n      if (!this.options) {\n        return options;\n      }\n\n      if (this.options.base) {\n        options.base = this.options.base;\n      }\n\n      if (this.options.project) {\n        options.project = this.options.project;\n      }\n\n      if (this.options.readOnly || this.component.disabled) {\n        options.readOnly = this.options.readOnly || this.component.disabled;\n      }\n\n      if (this.options.breadcrumbSettings) {\n        options.breadcrumbSettings = this.options.breadcrumbSettings;\n      }\n\n      if (this.options.buttonSettings) {\n        options.buttonSettings = _lodash.default.clone(this.options.buttonSettings);\n      }\n\n      if (this.options.viewAsHtml) {\n        options.viewAsHtml = this.options.viewAsHtml;\n      }\n\n      if (this.options.language) {\n        options.language = this.options.language;\n      }\n\n      if (this.options.template) {\n        options.template = this.options.template;\n      }\n\n      if (this.options.templates) {\n        options.templates = this.options.templates;\n      }\n\n      if (this.options.renderMode) {\n        options.renderMode = this.options.renderMode;\n      }\n\n      if (this.options.attachMode) {\n        options.attachMode = this.options.attachMode;\n      }\n\n      if (this.options.iconset) {\n        options.iconset = this.options.iconset;\n      }\n\n      if (this.options.fileService) {\n        options.fileService = this.options.fileService;\n      }\n\n      if (this.options.onChange) {\n        options.onChange = this.options.onChange;\n      }\n\n      return options;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, this.component.label || 'Nested form');\n      }\n\n      var subform = this.subForm ? this.subForm.render() : this.renderTemplate('loading');\n      return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, subform);\n    }\n  }, {\n    key: \"asString\",\n    value: function asString(value) {\n      return this.getValueAsString(value);\n    }\n    /**\n     * Prints out the value of form components as a datagrid value.\n     */\n\n  }, {\n    key: \"getValueAsString\",\n    value: function getValueAsString(value) {\n      if (!value) {\n        return 'No data provided';\n      }\n\n      if (!value.data && value._id) {\n        return value._id;\n      }\n\n      if (!value.data || !Object.keys(value.data).length) {\n        return 'No data provided';\n      }\n\n      return '[Complex Data]';\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this = this; // Don't attach in builder.\n\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element).then(function () {\n        if (_this.isSubFormLazyLoad() && !_this.hasLoadedForm && !_this.subFormLoading) {\n          _this.createSubForm(true);\n        }\n\n        return _this.subFormReady.then(function () {\n          _this.empty(element);\n\n          if (_this.options.builder) {\n            _this.setContent(element, _this.ce('div', {\n              class: 'text-muted text-center p-2'\n            }, _this.text(_this.formObj.title)));\n\n            return;\n          }\n\n          _this.setContent(element, _this.render());\n\n          if (_this.subForm) {\n            if (_this.isNestedWizard) {\n              element = _this.root.element;\n            }\n\n            _this.subForm.attach(element);\n\n            _this.valueChanged = _this.hasSetValue;\n\n            if (!_this.valueChanged && _this.dataValue.state !== 'submitted') {\n              _this.setDefaultValue();\n            } else {\n              _this.restoreValue();\n            }\n          }\n\n          if (!_this.builderMode && _this.component.modalEdit) {\n            var modalShouldBeOpened = _this.componentModal ? _this.componentModal.isOpened : false;\n            var currentValue = modalShouldBeOpened ? _this.componentModal.currentValue : _this.dataValue;\n            _this.componentModal = new _ComponentModal.default(_this, element, modalShouldBeOpened, currentValue);\n\n            _this.setOpenModalElement();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.subForm) {\n        this.subForm.detach();\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return this._currentForm;\n    },\n    set: function set(instance) {\n      var _this2 = this;\n\n      this._currentForm = instance;\n\n      if (!this.subForm) {\n        return;\n      }\n\n      this.subForm.getComponents().forEach(function (component) {\n        component.currentForm = _this2;\n      });\n    }\n  }, {\n    key: \"hasLoadedForm\",\n    get: function get() {\n      return this.formObj && this.formObj.components && Array.isArray(this.formObj.components) && this.formObj.components.length;\n    }\n  }, {\n    key: \"isRevisionChanged\",\n    get: function get() {\n      return _lodash.default.isNumber(this.subFormRevision) && _lodash.default.isNumber(this.formObj._vid) && this.formObj._vid !== this.subFormRevision;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      if (this.subForm) {\n        this.subForm.destroy();\n        this.subForm = null;\n        this.subFormReady = null;\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      if (this.subForm) {\n        this.subForm.form = this.formObj;\n        this.setSubFormDisabled(this.subForm);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"redraw\", this).call(this);\n    }\n    /**\n     * Pass everyComponent to subform.\n     * @param args\n     * @returns {*|void}\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent() {\n      if (this.subForm) {\n        var _this$subForm;\n\n        (_this$subForm = this.subForm).everyComponent.apply(_this$subForm, arguments);\n      }\n    }\n  }, {\n    key: \"setSubFormDisabled\",\n    value: function setSubFormDisabled(subForm) {\n      subForm.disabled = this.disabled; // When the Nested Form is disabled make the subForm disabled\n    }\n  }, {\n    key: \"updateSubWizards\",\n    value: function updateSubWizards(subForm) {\n      var _this$root,\n          _subForm$_form,\n          _this3 = this;\n\n      if (this.isNestedWizard && (_this$root = this.root) !== null && _this$root !== void 0 && _this$root.subWizards && (subForm === null || subForm === void 0 ? void 0 : (_subForm$_form = subForm._form) === null || _subForm$_form === void 0 ? void 0 : _subForm$_form.display) === 'wizard') {\n        var existedForm = this.root.subWizards.findIndex(function (form) {\n          return form.component.form === _this3.component.form;\n        });\n\n        if (existedForm !== -1) {\n          this.root.subWizards[existedForm] = this;\n        } else {\n          this.root.subWizards.push(this);\n        }\n\n        this.emit('subWizardsUpdated', subForm);\n      }\n    }\n    /**\n     * Create a subform instance.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"createSubForm\",\n    value: function createSubForm(fromAttach) {\n      var _this4 = this;\n\n      this.subFormReady = this.loadSubForm(fromAttach).then(function (form) {\n        if (!form) {\n          return;\n        } // Iterate through every component and hide the submit button.\n\n\n        (0, _utils.eachComponent)(form.components, function (component) {\n          _this4.hideSubmitButton(component);\n        }); // If the subform is already created then destroy the old one.\n\n        if (_this4.subForm) {\n          _this4.subForm.destroy();\n        } // Render the form.\n\n\n        return new _Form.default(form, _this4.getSubOptions()).ready.then(function (instance) {\n          _this4.subForm = instance;\n          _this4.subForm.currentForm = _this4;\n          _this4.subForm.parent = _this4;\n          _this4.subForm.parentVisible = _this4.visible;\n\n          _this4.subForm.on('change', function () {\n            if (_this4.subForm) {\n              _this4.dataValue = _this4.subForm.getValue();\n\n              _this4.triggerChange({\n                noEmit: true\n              });\n            }\n          });\n\n          _this4.subForm.url = _this4.formSrc;\n          _this4.subForm.nosubmit = true;\n          _this4.subForm.root = _this4.root;\n          _this4.subForm.localRoot = _this4.isNestedWizard ? _this4.localRoot : _this4.subForm;\n\n          _this4.restoreValue();\n\n          _this4.valueChanged = _this4.hasSetValue;\n\n          _this4.onChange();\n\n          return _this4.subForm;\n        });\n      }).then(function (subForm) {\n        _this4.updateSubWizards(subForm);\n\n        return subForm;\n      });\n      return this.subFormReady;\n    }\n  }, {\n    key: \"hideSubmitButton\",\n    value: function hideSubmitButton(component) {\n      var isSubmitButton = component.type === 'button' && (component.action === 'submit' || !component.action);\n\n      if (isSubmitButton) {\n        component.hidden = true;\n      }\n    }\n    /**\n     * Load the subform.\n     */\n\n  }, {\n    key: \"loadSubForm\",\n    value: function loadSubForm(fromAttach) {\n      var _this5 = this;\n\n      if (this.builderMode || this.isHidden() || this.isSubFormLazyLoad() && !fromAttach) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (this.hasLoadedForm && !this.isRevisionChanged) {\n        // Pass config down to sub forms.\n        if (this.root && this.root.form && this.root.form.config && !this.formObj.config) {\n          this.formObj.config = this.root.form.config;\n        }\n\n        return _nativePromiseOnly.default.resolve(this.formObj);\n      } else if (this.formSrc) {\n        this.subFormLoading = true;\n        return new _Formio.GlobalFormio(this.formSrc).loadForm({\n          params: {\n            live: 1\n          }\n        }).then(function (formObj) {\n          _this5.formObj = formObj;\n          _this5.subFormLoading = false;\n          return formObj;\n        }).catch(function (err) {\n          console.log(err);\n          return null;\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"subFormData\",\n    get: function get() {\n      var _this$dataValue;\n\n      return ((_this$dataValue = this.dataValue) === null || _this$dataValue === void 0 ? void 0 : _this$dataValue.data) || {};\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row, options) {\n      options = options || {};\n      var silentCheck = options.silentCheck || false;\n\n      if (this.subForm) {\n        return this.subForm.checkValidity(this.subFormData, dirty, null, silentCheck);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options);\n    }\n  }, {\n    key: \"checkComponentConditions\",\n    value: function checkComponentConditions(data, flags, row) {\n      var _this6 = this;\n\n      var visible = _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentConditions\", this).call(this, data, flags, row); // Return if already hidden\n\n\n      if (!visible) {\n        return visible;\n      }\n\n      if (this.subForm) {\n        return this.subForm.checkConditions(this.subFormData);\n      } // There are few cases when subForm is not loaded when a change is triggered,\n      // so we need to perform checkConditions after it is ready, or some conditional fields might be hidden in View mode\n      else if (this.subFormReady) {\n        this.subFormReady.then(function () {\n          if (_this6.subForm) {\n            return _this6.subForm.checkConditions(_this6.subFormData);\n          }\n        });\n      }\n\n      return visible;\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      if (this.subForm) {\n        return this.subForm.calculateValue(this.subFormData, flags);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"calculateValue\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      if (this.subForm) {\n        this.subForm.setPristine(pristine);\n      }\n    }\n    /**\n     * Determine if the subform should be submitted.\n     * @return {*|boolean}\n     */\n\n  }, {\n    key: \"shouldSubmit\",\n    get: function get() {\n      return this.subFormReady && (!this.component.hasOwnProperty('reference') || this.component.reference) && !this.isHidden();\n    }\n    /**\n     * Returns the data for the subform.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getSubFormData\",\n    value: function getSubFormData() {\n      if (_lodash.default.get(this.subForm, 'form.display') === 'pdf') {\n        return this.subForm.getSubmission();\n      } else {\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n    }\n    /**\n     * Submit the subform if configured to do so.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"submitSubForm\",\n    value: function submitSubForm(rejectOnError) {\n      var _this7 = this; // If we wish to submit the form on next page, then do that here.\n\n\n      if (this.shouldSubmit) {\n        return this.subFormReady.then(function () {\n          if (!_this7.subForm) {\n            return _this7.dataValue;\n          }\n\n          _this7.subForm.nosubmit = false;\n          return _this7.subForm.submitForm().then(function (result) {\n            _this7.subForm.loading = false;\n            _this7.subForm.showAllErrors = false;\n            _this7.dataValue = result.submission;\n            return _this7.dataValue;\n          }).catch(function (err) {\n            _this7.subForm.showAllErrors = true;\n\n            if (rejectOnError) {\n              _this7.subForm.onSubmissionError(err);\n\n              return _nativePromiseOnly.default.reject(err);\n            } else {\n              return {};\n            }\n          });\n        });\n      }\n\n      return this.getSubFormData();\n    }\n    /**\n     * Submit the form before the next page is triggered.\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this8 = this; // Should not submit child forms if we are going to the previous page\n\n\n      if (!next) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", this).call(this, next);\n      }\n\n      return this.submitSubForm(true).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", _this8).call(_this8, next);\n      });\n    }\n    /**\n     * Submit the form before the whole form is triggered.\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var _this$subForm2,\n          _this9 = this;\n\n      var submission = this.dataValue;\n      var isAlreadySubmitted = submission && submission._id && submission.form; // This submission has already been submitted, so just return the reference data.\n\n      if (isAlreadySubmitted && !((_this$subForm2 = this.subForm) !== null && _this$subForm2 !== void 0 && _this$subForm2.wizard)) {\n        this.dataValue = submission;\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n\n      return this.submitSubForm(false).then(function () {\n        return _this9.dataValue;\n      }).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforeSubmit\", _this9).call(_this9);\n      });\n    }\n  }, {\n    key: \"isSubFormLazyLoad\",\n    value: function isSubFormLazyLoad() {\n      var _this$root2, _this$root2$_form;\n\n      return ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : (_this$root2$_form = _this$root2._form) === null || _this$root2$_form === void 0 ? void 0 : _this$root2$_form.display) === 'wizard' && this.component.lazyLoad;\n    }\n  }, {\n    key: \"isHidden\",\n    value: function isHidden() {\n      if (!this.visible) {\n        return true;\n      }\n\n      return !_get(_getPrototypeOf(FormComponent.prototype), \"checkConditions\", this).call(this, this.rootValue);\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this10 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var changed = _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, submission, flags);\n\n      this.valueChanged = true;\n\n      if (this.subForm) {\n        var _this$subForm$form;\n\n        var shouldLoadOriginalRevision = this.useOriginalRevision && _lodash.default.isNumber(submission._fvid) && _lodash.default.isNumber((_this$subForm$form = this.subForm.form) === null || _this$subForm$form === void 0 ? void 0 : _this$subForm$form._vid) && submission._fvid !== this.subForm.form._vid;\n\n        if (shouldLoadOriginalRevision) {\n          this.setFormRevision(submission._fvid);\n          this.createSubForm().then(function () {\n            _this10.attach(_this10.element);\n          });\n        } else {\n          this.setSubFormValue(submission, flags);\n        }\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"setSubFormValue\",\n    value: function setSubFormValue(submission, flags) {\n      var shouldLoadSubmissionById = submission && submission._id && this.subForm.formio && _lodash.default.isEmpty(submission.data);\n\n      if (shouldLoadSubmissionById) {\n        var formId = submission.form || this.formObj.form || this.component.form;\n        var submissionUrl = \"\".concat(this.subForm.formio.formsUrl, \"/\").concat(formId, \"/submission/\").concat(submission._id);\n        this.subForm.setUrl(submissionUrl, this.options);\n        this.subForm.loadSubmission();\n      } else {\n        this.subForm.setValue(submission, flags);\n      }\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      return value === null || _lodash.default.isEqual(value, this.emptyValue) || this.areAllComponentsEmpty(value.data) && !value._id;\n    }\n  }, {\n    key: \"areAllComponentsEmpty\",\n    value: function areAllComponentsEmpty(data) {\n      var res = true;\n\n      if (this.subForm) {\n        this.subForm.everyComponent(function (comp) {\n          var componentValue = _lodash.default.get(data, comp.key);\n\n          res &= comp.isEmpty(componentValue);\n        });\n      } else {\n        res = false;\n      }\n\n      return res;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (this.subForm) {\n        return this.subForm.getValue();\n      }\n\n      return this.dataValue;\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var errors = _get(_getPrototypeOf(FormComponent.prototype), \"errors\", this);\n\n      if (this.subForm) {\n        errors = errors.concat(this.subForm.errors);\n      }\n\n      return errors;\n    }\n  }, {\n    key: \"updateSubFormVisibility\",\n    value: function updateSubFormVisibility() {\n      if (this.subForm) {\n        this.subForm.parentVisible = this.visible;\n      }\n    }\n    /**\n     * Determines if this form is a Nested Wizard\n     * which means it should be a Wizard itself and should be a direct child of a Wizard's page\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"isNestedWizard\",\n    get: function get() {\n      var _this$subForm3, _this$subForm3$_form, _this$parent, _this$parent$parent, _this$parent$parent$_;\n\n      return ((_this$subForm3 = this.subForm) === null || _this$subForm3 === void 0 ? void 0 : (_this$subForm3$_form = _this$subForm3._form) === null || _this$subForm3$_form === void 0 ? void 0 : _this$subForm3$_form.display) === 'wizard' && ((_this$parent = this.parent) === null || _this$parent === void 0 ? void 0 : (_this$parent$parent = _this$parent.parent) === null || _this$parent$parent === void 0 ? void 0 : (_this$parent$parent$_ = _this$parent$parent._form) === null || _this$parent$parent$_ === void 0 ? void 0 : _this$parent$parent$_.display) === 'wizard';\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      var _this11 = this;\n\n      var isNestedWizard = this.isNestedWizard;\n\n      if (this._visible !== value) {\n        this._visible = value; // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this11.updateSubFormVisibility();\n\n            _this11.clearOnHide();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        this.clearOnHide();\n        isNestedWizard ? this.rebuild() : this.redraw();\n      }\n\n      if (!value && isNestedWizard) {\n        this.root.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this12 = this;\n\n      if (this._parentVisible !== value) {\n        this._parentVisible = value;\n        this.clearOnHide(); // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this12.updateSubFormVisibility();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"isInternalEvent\",\n    value: function isInternalEvent(event) {\n      switch (event) {\n        case 'focus':\n        case 'blur':\n        case 'componentChange':\n        case 'componentError':\n        case 'error':\n        case 'formLoad':\n        case 'languageChanged':\n        case 'render':\n        case 'checkValidity':\n        case 'initialized':\n        case 'submit':\n        case 'submitButton':\n        case 'nosubmit':\n        case 'updateComponent':\n        case 'submitDone':\n        case 'submissionDeleted':\n        case 'requestDone':\n        case 'nextPage':\n        case 'prevPage':\n        case 'wizardNavigationClicked':\n        case 'updateWizardNav':\n        case 'restoreDraft':\n        case 'saveDraft':\n        case 'saveComponent':\n        case 'pdfUploaded':\n          return true;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"createEmitter\",\n    value: function createEmitter() {\n      var emitter = new _eventemitter.default();\n      var nativeEmit = emitter.emit;\n      var that = this;\n\n      emitter.emit = function (event) {\n        var eventType = event.replace(\"\".concat(that.options.namespace, \".\"), '');\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        nativeEmit.call.apply(nativeEmit, [this, event].concat(args));\n\n        if (!that.isInternalEvent(eventType)) {\n          that.emit.apply(that, [eventType].concat(args));\n        }\n      };\n\n      return emitter;\n    }\n  }, {\n    key: \"deleteValue\",\n    value: function deleteValue() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, null, {\n        noUpdateEvent: true,\n        noDefault: true\n      });\n\n      this.unset();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _Component2.default.schema.apply(_Component2.default, [{\n        label: 'Form',\n        type: 'form',\n        key: 'form',\n        src: '',\n        reference: true,\n        form: '',\n        path: '',\n        tableView: true\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Nested Form',\n        icon: 'wpforms',\n        group: 'premium',\n        documentation: '/userguide/#form',\n        weight: 110,\n        schema: FormComponent.schema()\n      };\n    }\n  }]);\n\n  return FormComponent;\n}(_Component2.default);\n\nexports.default = FormComponent;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/jag-servebc/forms-flow-ai/forms-flow-web/node_modules/formiojs/components/form/Form.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","_Component2","_ComponentModal","_eventemitter","_nativePromiseOnly","_utils","_Formio","_Form","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","call","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","FormComponent","_Component","_super","init","formObj","display","component","settings","components","valueChanged","subForm","formSrc","src","options","formio","form","path","project","GlobalFormio","getBaseUrl","isMongoId","concat","getProjectUrl","rootSrc","formsUrl","formPath","replace","builderMode","revision","formRevision","setFormRevision","createSubForm","subFormReady","resolve","schema","data","_this$component","_this$formObj","useOriginalRevision","revisions","rev","revNumber","Number","parseInt","isNaN","subFormRevision","undefined","getComponent","fn","getArrayFromComponentPath","shift","originalPathStr","getStringFromComponentPath","getSubOptions","parentPath","events","createEmitter","set","readOnly","disabled","breadcrumbSettings","buttonSettings","clone","viewAsHtml","language","template","templates","renderMode","attachMode","iconset","fileService","onChange","render","label","subform","renderTemplate","asString","getValueAsString","_id","keys","attach","element","_this","then","isSubFormLazyLoad","hasLoadedForm","subFormLoading","empty","builder","setContent","ce","class","text","title","isNestedWizard","root","hasSetValue","dataValue","state","setDefaultValue","restoreValue","modalEdit","modalShouldBeOpened","componentModal","isOpened","currentValue","setOpenModalElement","detach","_currentForm","_this2","getComponents","forEach","currentForm","Array","isArray","isNumber","_vid","destroy","redraw","setSubFormDisabled","everyComponent","_this$subForm","updateSubWizards","_this$root","_subForm$_form","_this3","subWizards","_form","existedForm","findIndex","push","emit","fromAttach","_this4","loadSubForm","eachComponent","hideSubmitButton","ready","parent","parentVisible","visible","on","getValue","triggerChange","noEmit","url","nosubmit","localRoot","isSubmitButton","type","action","hidden","_this5","isHidden","isRevisionChanged","config","loadForm","params","live","catch","err","console","log","_this$dataValue","checkComponentValidity","dirty","row","silentCheck","checkValidity","subFormData","checkComponentConditions","flags","_this6","checkConditions","calculateValue","setPristine","pristine","reference","getSubFormData","getSubmission","submitSubForm","rejectOnError","_this7","shouldSubmit","submitForm","loading","showAllErrors","submission","onSubmissionError","reject","beforePage","next","_this8","beforeSubmit","_this$subForm2","_this9","isAlreadySubmitted","wizard","_this$root2","_this$root2$_form","lazyLoad","rootValue","setValue","_this10","changed","_this$subForm$form","shouldLoadOriginalRevision","_fvid","setSubFormValue","shouldLoadSubmissionById","isEmpty","formId","submissionUrl","setUrl","loadSubmission","isEqual","emptyValue","areAllComponentsEmpty","res","comp","componentValue","errors","updateSubFormVisibility","_this$subForm3","_this$subForm3$_form","_this$parent","_this$parent$parent","_this$parent$parent$_","_this11","_visible","clearOnHide","rebuild","_this12","_parentVisible","isInternalEvent","event","emitter","nativeEmit","that","eventType","namespace","_len","args","_key","deleteValue","noUpdateEvent","noDefault","unset","_len2","extend","_key2","tableView","icon","group","documentation","weight"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.number.parse-int.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Component2 = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _ComponentModal = _interopRequireDefault(require(\"../_classes/componentModal/ComponentModal\"));\n\nvar _eventemitter = _interopRequireDefault(require(\"eventemitter3\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _Formio = require(\"../../Formio\");\n\nvar _Form = _interopRequireDefault(require(\"../../Form\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar FormComponent = /*#__PURE__*/function (_Component) {\n  _inherits(FormComponent, _Component);\n\n  var _super = _createSuper(FormComponent);\n\n  function FormComponent() {\n    _classCallCheck(this, FormComponent);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FormComponent, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"init\", this).call(this);\n\n      this.formObj = {\n        display: this.component.display,\n        settings: this.component.settings,\n        components: this.component.components\n      };\n      this.valueChanged = false;\n      this.subForm = null;\n      this.formSrc = '';\n\n      if (this.component.src) {\n        this.formSrc = this.component.src;\n      }\n\n      if (!this.component.src && !this.options.formio && (this.component.form || this.component.path)) {\n        if (this.component.project) {\n          this.formSrc = _Formio.GlobalFormio.getBaseUrl(); // Check to see if it is a MongoID.\n\n          if ((0, _utils.isMongoId)(this.component.project)) {\n            this.formSrc += '/project';\n          }\n\n          this.formSrc += \"/\".concat(this.component.project);\n          this.options.project = this.formSrc;\n        } else {\n          this.formSrc = _Formio.GlobalFormio.getProjectUrl();\n          this.options.project = this.formSrc;\n        }\n\n        if (this.component.form) {\n          if ((0, _utils.isMongoId)(this.component.form)) {\n            this.formSrc += \"/form/\".concat(this.component.form);\n          } else {\n            this.formSrc += \"/\".concat(this.component.form);\n          }\n        } else if (this.component.path) {\n          this.formSrc += \"/\".concat(this.component.path);\n        }\n      } // Build the source based on the root src path.\n\n\n      if (!this.formSrc && this.options.formio) {\n        var rootSrc = this.options.formio.formsUrl;\n\n        if (this.component.form && (0, _utils.isMongoId)(this.component.form)) {\n          this.formSrc = \"\".concat(rootSrc, \"/\").concat(this.component.form);\n        } else {\n          var formPath = this.component.path || this.component.form;\n          this.formSrc = \"\".concat(rootSrc.replace(/\\/form$/, ''), \"/\").concat(formPath);\n        }\n      }\n\n      if (this.builderMode && this.component.hasOwnProperty('formRevision')) {\n        this.component.revision = this.component.formRevision;\n        delete this.component.formRevision;\n      } // Add revision version if set.\n\n\n      if (this.component.revision || this.component.revision === 0 || this.component.formRevision || this.component.formRevision === 0) {\n        this.setFormRevision(this.component.revision || this.component.formRevision);\n      }\n\n      return this.createSubForm();\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      // Not not provide a default value unless the subform is ready so that it will initialize correctly.\n      return this.subForm ? _get(_getPrototypeOf(FormComponent.prototype), \"defaultValue\", this) : null;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return FormComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return {\n        data: {}\n      };\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"useOriginalRevision\",\n    get: function get() {\n      var _this$component, _this$formObj;\n\n      return ((_this$component = this.component) === null || _this$component === void 0 ? void 0 : _this$component.useOriginalRevision) && !!((_this$formObj = this.formObj) !== null && _this$formObj !== void 0 && _this$formObj.revisions);\n    }\n  }, {\n    key: \"setFormRevision\",\n    value: function setFormRevision(rev) {\n      // Remove current revisions from src if it is\n      this.formSrc = this.formSrc.replace(/\\/v\\/\\d*/, '');\n      var revNumber = Number.parseInt(rev);\n\n      if (!isNaN(revNumber)) {\n        this.subFormRevision = rev;\n        this.formSrc += \"/v/\".concat(rev);\n      } else {\n        this.subFormRevision = undefined;\n      }\n    }\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn) {\n      path = (0, _utils.getArrayFromComponentPath)(path);\n\n      if (path[0] === 'data') {\n        path.shift();\n      }\n\n      var originalPathStr = \"\".concat(this.path, \".data.\").concat((0, _utils.getStringFromComponentPath)(path));\n\n      if (this.subForm) {\n        return this.subForm.getComponent(path, fn, originalPathStr);\n      }\n    }\n  }, {\n    key: \"getSubOptions\",\n    value: function getSubOptions() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      options.parentPath = \"\".concat(this.path, \".data.\");\n      options.events = this.createEmitter(); // Make sure to not show the submit button in wizards in the nested forms.\n\n      _lodash.default.set(options, 'buttonSettings.showSubmit', false);\n\n      if (!this.options) {\n        return options;\n      }\n\n      if (this.options.base) {\n        options.base = this.options.base;\n      }\n\n      if (this.options.project) {\n        options.project = this.options.project;\n      }\n\n      if (this.options.readOnly || this.component.disabled) {\n        options.readOnly = this.options.readOnly || this.component.disabled;\n      }\n\n      if (this.options.breadcrumbSettings) {\n        options.breadcrumbSettings = this.options.breadcrumbSettings;\n      }\n\n      if (this.options.buttonSettings) {\n        options.buttonSettings = _lodash.default.clone(this.options.buttonSettings);\n      }\n\n      if (this.options.viewAsHtml) {\n        options.viewAsHtml = this.options.viewAsHtml;\n      }\n\n      if (this.options.language) {\n        options.language = this.options.language;\n      }\n\n      if (this.options.template) {\n        options.template = this.options.template;\n      }\n\n      if (this.options.templates) {\n        options.templates = this.options.templates;\n      }\n\n      if (this.options.renderMode) {\n        options.renderMode = this.options.renderMode;\n      }\n\n      if (this.options.attachMode) {\n        options.attachMode = this.options.attachMode;\n      }\n\n      if (this.options.iconset) {\n        options.iconset = this.options.iconset;\n      }\n\n      if (this.options.fileService) {\n        options.fileService = this.options.fileService;\n      }\n\n      if (this.options.onChange) {\n        options.onChange = this.options.onChange;\n      }\n\n      return options;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, this.component.label || 'Nested form');\n      }\n\n      var subform = this.subForm ? this.subForm.render() : this.renderTemplate('loading');\n      return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, subform);\n    }\n  }, {\n    key: \"asString\",\n    value: function asString(value) {\n      return this.getValueAsString(value);\n    }\n    /**\n     * Prints out the value of form components as a datagrid value.\n     */\n\n  }, {\n    key: \"getValueAsString\",\n    value: function getValueAsString(value) {\n      if (!value) {\n        return 'No data provided';\n      }\n\n      if (!value.data && value._id) {\n        return value._id;\n      }\n\n      if (!value.data || !Object.keys(value.data).length) {\n        return 'No data provided';\n      }\n\n      return '[Complex Data]';\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this = this;\n\n      // Don't attach in builder.\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element).then(function () {\n        if (_this.isSubFormLazyLoad() && !_this.hasLoadedForm && !_this.subFormLoading) {\n          _this.createSubForm(true);\n        }\n\n        return _this.subFormReady.then(function () {\n          _this.empty(element);\n\n          if (_this.options.builder) {\n            _this.setContent(element, _this.ce('div', {\n              class: 'text-muted text-center p-2'\n            }, _this.text(_this.formObj.title)));\n\n            return;\n          }\n\n          _this.setContent(element, _this.render());\n\n          if (_this.subForm) {\n            if (_this.isNestedWizard) {\n              element = _this.root.element;\n            }\n\n            _this.subForm.attach(element);\n\n            _this.valueChanged = _this.hasSetValue;\n\n            if (!_this.valueChanged && _this.dataValue.state !== 'submitted') {\n              _this.setDefaultValue();\n            } else {\n              _this.restoreValue();\n            }\n          }\n\n          if (!_this.builderMode && _this.component.modalEdit) {\n            var modalShouldBeOpened = _this.componentModal ? _this.componentModal.isOpened : false;\n            var currentValue = modalShouldBeOpened ? _this.componentModal.currentValue : _this.dataValue;\n            _this.componentModal = new _ComponentModal.default(_this, element, modalShouldBeOpened, currentValue);\n\n            _this.setOpenModalElement();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.subForm) {\n        this.subForm.detach();\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return this._currentForm;\n    },\n    set: function set(instance) {\n      var _this2 = this;\n\n      this._currentForm = instance;\n\n      if (!this.subForm) {\n        return;\n      }\n\n      this.subForm.getComponents().forEach(function (component) {\n        component.currentForm = _this2;\n      });\n    }\n  }, {\n    key: \"hasLoadedForm\",\n    get: function get() {\n      return this.formObj && this.formObj.components && Array.isArray(this.formObj.components) && this.formObj.components.length;\n    }\n  }, {\n    key: \"isRevisionChanged\",\n    get: function get() {\n      return _lodash.default.isNumber(this.subFormRevision) && _lodash.default.isNumber(this.formObj._vid) && this.formObj._vid !== this.subFormRevision;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      if (this.subForm) {\n        this.subForm.destroy();\n        this.subForm = null;\n        this.subFormReady = null;\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      if (this.subForm) {\n        this.subForm.form = this.formObj;\n        this.setSubFormDisabled(this.subForm);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"redraw\", this).call(this);\n    }\n    /**\n     * Pass everyComponent to subform.\n     * @param args\n     * @returns {*|void}\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent() {\n      if (this.subForm) {\n        var _this$subForm;\n\n        (_this$subForm = this.subForm).everyComponent.apply(_this$subForm, arguments);\n      }\n    }\n  }, {\n    key: \"setSubFormDisabled\",\n    value: function setSubFormDisabled(subForm) {\n      subForm.disabled = this.disabled; // When the Nested Form is disabled make the subForm disabled\n    }\n  }, {\n    key: \"updateSubWizards\",\n    value: function updateSubWizards(subForm) {\n      var _this$root,\n          _subForm$_form,\n          _this3 = this;\n\n      if (this.isNestedWizard && (_this$root = this.root) !== null && _this$root !== void 0 && _this$root.subWizards && (subForm === null || subForm === void 0 ? void 0 : (_subForm$_form = subForm._form) === null || _subForm$_form === void 0 ? void 0 : _subForm$_form.display) === 'wizard') {\n        var existedForm = this.root.subWizards.findIndex(function (form) {\n          return form.component.form === _this3.component.form;\n        });\n\n        if (existedForm !== -1) {\n          this.root.subWizards[existedForm] = this;\n        } else {\n          this.root.subWizards.push(this);\n        }\n\n        this.emit('subWizardsUpdated', subForm);\n      }\n    }\n    /**\n     * Create a subform instance.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"createSubForm\",\n    value: function createSubForm(fromAttach) {\n      var _this4 = this;\n\n      this.subFormReady = this.loadSubForm(fromAttach).then(function (form) {\n        if (!form) {\n          return;\n        } // Iterate through every component and hide the submit button.\n\n\n        (0, _utils.eachComponent)(form.components, function (component) {\n          _this4.hideSubmitButton(component);\n        }); // If the subform is already created then destroy the old one.\n\n        if (_this4.subForm) {\n          _this4.subForm.destroy();\n        } // Render the form.\n\n\n        return new _Form.default(form, _this4.getSubOptions()).ready.then(function (instance) {\n          _this4.subForm = instance;\n          _this4.subForm.currentForm = _this4;\n          _this4.subForm.parent = _this4;\n          _this4.subForm.parentVisible = _this4.visible;\n\n          _this4.subForm.on('change', function () {\n            if (_this4.subForm) {\n              _this4.dataValue = _this4.subForm.getValue();\n\n              _this4.triggerChange({\n                noEmit: true\n              });\n            }\n          });\n\n          _this4.subForm.url = _this4.formSrc;\n          _this4.subForm.nosubmit = true;\n          _this4.subForm.root = _this4.root;\n          _this4.subForm.localRoot = _this4.isNestedWizard ? _this4.localRoot : _this4.subForm;\n\n          _this4.restoreValue();\n\n          _this4.valueChanged = _this4.hasSetValue;\n\n          _this4.onChange();\n\n          return _this4.subForm;\n        });\n      }).then(function (subForm) {\n        _this4.updateSubWizards(subForm);\n\n        return subForm;\n      });\n      return this.subFormReady;\n    }\n  }, {\n    key: \"hideSubmitButton\",\n    value: function hideSubmitButton(component) {\n      var isSubmitButton = component.type === 'button' && (component.action === 'submit' || !component.action);\n\n      if (isSubmitButton) {\n        component.hidden = true;\n      }\n    }\n    /**\n     * Load the subform.\n     */\n\n  }, {\n    key: \"loadSubForm\",\n    value: function loadSubForm(fromAttach) {\n      var _this5 = this;\n\n      if (this.builderMode || this.isHidden() || this.isSubFormLazyLoad() && !fromAttach) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (this.hasLoadedForm && !this.isRevisionChanged) {\n        // Pass config down to sub forms.\n        if (this.root && this.root.form && this.root.form.config && !this.formObj.config) {\n          this.formObj.config = this.root.form.config;\n        }\n\n        return _nativePromiseOnly.default.resolve(this.formObj);\n      } else if (this.formSrc) {\n        this.subFormLoading = true;\n        return new _Formio.GlobalFormio(this.formSrc).loadForm({\n          params: {\n            live: 1\n          }\n        }).then(function (formObj) {\n          _this5.formObj = formObj;\n          _this5.subFormLoading = false;\n          return formObj;\n        }).catch(function (err) {\n          console.log(err);\n          return null;\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"subFormData\",\n    get: function get() {\n      var _this$dataValue;\n\n      return ((_this$dataValue = this.dataValue) === null || _this$dataValue === void 0 ? void 0 : _this$dataValue.data) || {};\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row, options) {\n      options = options || {};\n      var silentCheck = options.silentCheck || false;\n\n      if (this.subForm) {\n        return this.subForm.checkValidity(this.subFormData, dirty, null, silentCheck);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options);\n    }\n  }, {\n    key: \"checkComponentConditions\",\n    value: function checkComponentConditions(data, flags, row) {\n      var _this6 = this;\n\n      var visible = _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentConditions\", this).call(this, data, flags, row); // Return if already hidden\n\n\n      if (!visible) {\n        return visible;\n      }\n\n      if (this.subForm) {\n        return this.subForm.checkConditions(this.subFormData);\n      } // There are few cases when subForm is not loaded when a change is triggered,\n      // so we need to perform checkConditions after it is ready, or some conditional fields might be hidden in View mode\n      else if (this.subFormReady) {\n        this.subFormReady.then(function () {\n          if (_this6.subForm) {\n            return _this6.subForm.checkConditions(_this6.subFormData);\n          }\n        });\n      }\n\n      return visible;\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      if (this.subForm) {\n        return this.subForm.calculateValue(this.subFormData, flags);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"calculateValue\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      if (this.subForm) {\n        this.subForm.setPristine(pristine);\n      }\n    }\n    /**\n     * Determine if the subform should be submitted.\n     * @return {*|boolean}\n     */\n\n  }, {\n    key: \"shouldSubmit\",\n    get: function get() {\n      return this.subFormReady && (!this.component.hasOwnProperty('reference') || this.component.reference) && !this.isHidden();\n    }\n    /**\n     * Returns the data for the subform.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getSubFormData\",\n    value: function getSubFormData() {\n      if (_lodash.default.get(this.subForm, 'form.display') === 'pdf') {\n        return this.subForm.getSubmission();\n      } else {\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n    }\n    /**\n     * Submit the subform if configured to do so.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"submitSubForm\",\n    value: function submitSubForm(rejectOnError) {\n      var _this7 = this;\n\n      // If we wish to submit the form on next page, then do that here.\n      if (this.shouldSubmit) {\n        return this.subFormReady.then(function () {\n          if (!_this7.subForm) {\n            return _this7.dataValue;\n          }\n\n          _this7.subForm.nosubmit = false;\n          return _this7.subForm.submitForm().then(function (result) {\n            _this7.subForm.loading = false;\n            _this7.subForm.showAllErrors = false;\n            _this7.dataValue = result.submission;\n            return _this7.dataValue;\n          }).catch(function (err) {\n            _this7.subForm.showAllErrors = true;\n\n            if (rejectOnError) {\n              _this7.subForm.onSubmissionError(err);\n\n              return _nativePromiseOnly.default.reject(err);\n            } else {\n              return {};\n            }\n          });\n        });\n      }\n\n      return this.getSubFormData();\n    }\n    /**\n     * Submit the form before the next page is triggered.\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this8 = this;\n\n      // Should not submit child forms if we are going to the previous page\n      if (!next) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", this).call(this, next);\n      }\n\n      return this.submitSubForm(true).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", _this8).call(_this8, next);\n      });\n    }\n    /**\n     * Submit the form before the whole form is triggered.\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var _this$subForm2,\n          _this9 = this;\n\n      var submission = this.dataValue;\n      var isAlreadySubmitted = submission && submission._id && submission.form; // This submission has already been submitted, so just return the reference data.\n\n      if (isAlreadySubmitted && !((_this$subForm2 = this.subForm) !== null && _this$subForm2 !== void 0 && _this$subForm2.wizard)) {\n        this.dataValue = submission;\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n\n      return this.submitSubForm(false).then(function () {\n        return _this9.dataValue;\n      }).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforeSubmit\", _this9).call(_this9);\n      });\n    }\n  }, {\n    key: \"isSubFormLazyLoad\",\n    value: function isSubFormLazyLoad() {\n      var _this$root2, _this$root2$_form;\n\n      return ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : (_this$root2$_form = _this$root2._form) === null || _this$root2$_form === void 0 ? void 0 : _this$root2$_form.display) === 'wizard' && this.component.lazyLoad;\n    }\n  }, {\n    key: \"isHidden\",\n    value: function isHidden() {\n      if (!this.visible) {\n        return true;\n      }\n\n      return !_get(_getPrototypeOf(FormComponent.prototype), \"checkConditions\", this).call(this, this.rootValue);\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this10 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var changed = _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, submission, flags);\n\n      this.valueChanged = true;\n\n      if (this.subForm) {\n        var _this$subForm$form;\n\n        var shouldLoadOriginalRevision = this.useOriginalRevision && _lodash.default.isNumber(submission._fvid) && _lodash.default.isNumber((_this$subForm$form = this.subForm.form) === null || _this$subForm$form === void 0 ? void 0 : _this$subForm$form._vid) && submission._fvid !== this.subForm.form._vid;\n\n        if (shouldLoadOriginalRevision) {\n          this.setFormRevision(submission._fvid);\n          this.createSubForm().then(function () {\n            _this10.attach(_this10.element);\n          });\n        } else {\n          this.setSubFormValue(submission, flags);\n        }\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"setSubFormValue\",\n    value: function setSubFormValue(submission, flags) {\n      var shouldLoadSubmissionById = submission && submission._id && this.subForm.formio && _lodash.default.isEmpty(submission.data);\n\n      if (shouldLoadSubmissionById) {\n        var formId = submission.form || this.formObj.form || this.component.form;\n        var submissionUrl = \"\".concat(this.subForm.formio.formsUrl, \"/\").concat(formId, \"/submission/\").concat(submission._id);\n        this.subForm.setUrl(submissionUrl, this.options);\n        this.subForm.loadSubmission();\n      } else {\n        this.subForm.setValue(submission, flags);\n      }\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      return value === null || _lodash.default.isEqual(value, this.emptyValue) || this.areAllComponentsEmpty(value.data) && !value._id;\n    }\n  }, {\n    key: \"areAllComponentsEmpty\",\n    value: function areAllComponentsEmpty(data) {\n      var res = true;\n\n      if (this.subForm) {\n        this.subForm.everyComponent(function (comp) {\n          var componentValue = _lodash.default.get(data, comp.key);\n\n          res &= comp.isEmpty(componentValue);\n        });\n      } else {\n        res = false;\n      }\n\n      return res;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (this.subForm) {\n        return this.subForm.getValue();\n      }\n\n      return this.dataValue;\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var errors = _get(_getPrototypeOf(FormComponent.prototype), \"errors\", this);\n\n      if (this.subForm) {\n        errors = errors.concat(this.subForm.errors);\n      }\n\n      return errors;\n    }\n  }, {\n    key: \"updateSubFormVisibility\",\n    value: function updateSubFormVisibility() {\n      if (this.subForm) {\n        this.subForm.parentVisible = this.visible;\n      }\n    }\n    /**\n     * Determines if this form is a Nested Wizard\n     * which means it should be a Wizard itself and should be a direct child of a Wizard's page\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"isNestedWizard\",\n    get: function get() {\n      var _this$subForm3, _this$subForm3$_form, _this$parent, _this$parent$parent, _this$parent$parent$_;\n\n      return ((_this$subForm3 = this.subForm) === null || _this$subForm3 === void 0 ? void 0 : (_this$subForm3$_form = _this$subForm3._form) === null || _this$subForm3$_form === void 0 ? void 0 : _this$subForm3$_form.display) === 'wizard' && ((_this$parent = this.parent) === null || _this$parent === void 0 ? void 0 : (_this$parent$parent = _this$parent.parent) === null || _this$parent$parent === void 0 ? void 0 : (_this$parent$parent$_ = _this$parent$parent._form) === null || _this$parent$parent$_ === void 0 ? void 0 : _this$parent$parent$_.display) === 'wizard';\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      var _this11 = this;\n\n      var isNestedWizard = this.isNestedWizard;\n\n      if (this._visible !== value) {\n        this._visible = value; // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this11.updateSubFormVisibility();\n\n            _this11.clearOnHide();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        this.clearOnHide();\n        isNestedWizard ? this.rebuild() : this.redraw();\n      }\n\n      if (!value && isNestedWizard) {\n        this.root.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this12 = this;\n\n      if (this._parentVisible !== value) {\n        this._parentVisible = value;\n        this.clearOnHide(); // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this12.updateSubFormVisibility();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"isInternalEvent\",\n    value: function isInternalEvent(event) {\n      switch (event) {\n        case 'focus':\n        case 'blur':\n        case 'componentChange':\n        case 'componentError':\n        case 'error':\n        case 'formLoad':\n        case 'languageChanged':\n        case 'render':\n        case 'checkValidity':\n        case 'initialized':\n        case 'submit':\n        case 'submitButton':\n        case 'nosubmit':\n        case 'updateComponent':\n        case 'submitDone':\n        case 'submissionDeleted':\n        case 'requestDone':\n        case 'nextPage':\n        case 'prevPage':\n        case 'wizardNavigationClicked':\n        case 'updateWizardNav':\n        case 'restoreDraft':\n        case 'saveDraft':\n        case 'saveComponent':\n        case 'pdfUploaded':\n          return true;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"createEmitter\",\n    value: function createEmitter() {\n      var emitter = new _eventemitter.default();\n      var nativeEmit = emitter.emit;\n      var that = this;\n\n      emitter.emit = function (event) {\n        var eventType = event.replace(\"\".concat(that.options.namespace, \".\"), '');\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        nativeEmit.call.apply(nativeEmit, [this, event].concat(args));\n\n        if (!that.isInternalEvent(eventType)) {\n          that.emit.apply(that, [eventType].concat(args));\n        }\n      };\n\n      return emitter;\n    }\n  }, {\n    key: \"deleteValue\",\n    value: function deleteValue() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, null, {\n        noUpdateEvent: true,\n        noDefault: true\n      });\n\n      this.unset();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _Component2.default.schema.apply(_Component2.default, [{\n        label: 'Form',\n        type: 'form',\n        key: 'form',\n        src: '',\n        reference: true,\n        form: '',\n        path: '',\n        tableView: true\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Nested Form',\n        icon: 'wpforms',\n        group: 'premium',\n        documentation: '/userguide/#form',\n        weight: 110,\n        schema: FormComponent.schema()\n      };\n    }\n  }]);\n\n  return FormComponent;\n}(_Component2.default);\n\nexports.default = FormComponent;"]},"metadata":{},"sourceType":"script"}