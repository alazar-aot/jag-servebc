{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _TextField = _interopRequireDefault(require(\"../textfield/TextField\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar TextAreaComponent = /*#__PURE__*/function (_TextFieldComponent) {\n  _inherits(TextAreaComponent, _TextFieldComponent);\n\n  var _super = _createSuper(TextAreaComponent);\n\n  function TextAreaComponent() {\n    _classCallCheck(this, TextAreaComponent);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(TextAreaComponent, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"init\", this).call(this);\n\n      this.editors = [];\n      this.editorsReady = [];\n      this.updateSizes = []; // Never submit on enter for text areas.\n\n      this.options.submitOnEnter = false;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return TextAreaComponent.schema();\n    }\n  }, {\n    key: \"inputInfo\",\n    get: function get() {\n      var info = _get(_getPrototypeOf(TextAreaComponent.prototype), \"inputInfo\", this);\n\n      info.type = this.component.wysiwyg ? 'div' : 'textarea';\n\n      if (this.component.rows) {\n        info.attr.rows = this.component.rows;\n      }\n\n      return info;\n    }\n  }, {\n    key: \"validateMultiple\",\n    value: function validateMultiple() {\n      return !this.isJsonValue;\n    }\n  }, {\n    key: \"renderElement\",\n    value: function renderElement(value, index) {\n      var info = this.inputInfo;\n      info.attr = info.attr || {};\n      info.content = value;\n\n      if ((this.options.readOnly || this.disabled) && !this.isHtmlRenderMode()) {\n        var elementStyle = this.info.attr.style || '';\n        var children = \"<div ref=\\\"input\\\" class=\\\"formio-editor-read-only-content\\\" \".concat(elementStyle ? \"style='\".concat(elementStyle, \"'\") : '', \"></div>\");\n        return this.renderTemplate('well', {\n          children: children,\n          nestedKey: this.key,\n          value: value\n        });\n      }\n\n      return this.renderTemplate('input', {\n        prefix: this.prefix,\n        suffix: this.suffix,\n        input: info,\n        value: value,\n        index: index\n      });\n    }\n  }, {\n    key: \"autoExpand\",\n    get: function get() {\n      return this.component.autoExpand;\n    }\n    /**\n     * Updates the editor value.\n     *\n     * @param newValue\n     */\n\n  }, {\n    key: \"updateEditorValue\",\n    value: function updateEditorValue(index, newValue) {\n      newValue = this.getConvertedValue(this.trimBlanks(newValue));\n      var dataValue = this.dataValue;\n\n      if (this.component.multiple && Array.isArray(dataValue)) {\n        var newArray = _lodash.default.clone(dataValue);\n\n        newArray[index] = newValue;\n        newValue = newArray;\n      }\n\n      if (!_lodash.default.isEqual(newValue, dataValue) && (!_lodash.default.isEmpty(newValue) || !_lodash.default.isEmpty(dataValue))) {\n        this.updateValue(newValue, {\n          modified: !this.autoModified\n        }, index);\n      }\n\n      this.autoModified = false;\n    }\n  }, {\n    key: \"attachElement\",\n    value: function attachElement(element, index) {\n      var _this2 = this;\n\n      if (this.autoExpand && (this.isPlain || this.options.readOnly || this.options.htmlView)) {\n        if (element.nodeName === 'TEXTAREA') {\n          this.addAutoExpanding(element, index);\n        }\n      }\n\n      if (this.options.readOnly) {\n        return element;\n      }\n\n      if (this.component.wysiwyg && !this.component.editor) {\n        this.component.editor = 'ckeditor';\n      }\n\n      var settings = _lodash.default.isEmpty(this.component.wysiwyg) ? this.wysiwygDefault[this.component.editor] || this.wysiwygDefault.default : this.component.wysiwyg; // Keep track of when this editor is ready.\n\n      this.editorsReady[index] = new _nativePromiseOnly.default(function (editorReady) {\n        // Attempt to add a wysiwyg editor. In order to add one, it must be included on the global scope.\n        switch (_this2.component.editor) {\n          case 'ace':\n            if (!settings) {\n              settings = {};\n            }\n\n            settings.mode = _this2.component.as ? \"ace/mode/\".concat(_this2.component.as) : 'ace/mode/javascript';\n\n            _this2.addAce(element, settings, function (newValue) {\n              return _this2.updateEditorValue(index, newValue);\n            }).then(function (ace) {\n              _this2.editors[index] = ace;\n              var dataValue = _this2.dataValue;\n              dataValue = _this2.component.multiple && Array.isArray(dataValue) ? dataValue[index] : dataValue;\n              ace.setValue(_this2.setConvertedValue(dataValue, index));\n              editorReady(ace);\n              return ace;\n            }).catch(function (err) {\n              return console.warn(err);\n            });\n\n            break;\n\n          case 'quill':\n            // Normalize the configurations for quill.\n            if (settings.hasOwnProperty('toolbarGroups') || settings.hasOwnProperty('toolbar')) {\n              console.warn('The WYSIWYG settings are configured for CKEditor. For this renderer, you will need to use configurations for the Quill Editor. See https://quilljs.com/docs/configuration for more information.');\n              settings = _this2.wysiwygDefault.quill;\n            } // Add the quill editor.\n\n\n            _this2.addQuill(element, settings, function () {\n              return _this2.updateEditorValue(index, _this2.editors[index].root.innerHTML);\n            }).then(function (quill) {\n              _this2.editors[index] = quill;\n\n              if (_this2.component.isUploadEnabled) {\n                var _this = _this2;\n\n                quill.getModule('uploader').options.handler = function () {\n                  var _this$imageHandler;\n\n                  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n                    args[_key] = arguments[_key];\n                  } //we need initial 'this' because quill calls this method with its own context and we need some inner quill methods exposed in it\n                  //we also need current component instance as we use some fields and methods from it as well\n\n\n                  (_this$imageHandler = _this.imageHandler).call.apply(_this$imageHandler, [_this, this].concat(args));\n                };\n              }\n\n              quill.root.spellcheck = _this2.component.spellcheck;\n\n              if (_this2.options.readOnly || _this2.disabled) {\n                quill.disable();\n              }\n\n              var dataValue = _this2.dataValue;\n              dataValue = _this2.component.multiple && Array.isArray(dataValue) ? dataValue[index] : dataValue;\n              quill.setContents(quill.clipboard.convert({\n                html: _this2.setConvertedValue(dataValue, index)\n              }));\n              editorReady(quill);\n              return quill;\n            }).catch(function (err) {\n              return console.warn(err);\n            });\n\n            break;\n\n          case 'ckeditor':\n            settings = settings || {};\n            settings.rows = _this2.component.rows;\n\n            _this2.addCKE(element, settings, function (newValue) {\n              return _this2.updateEditorValue(index, newValue);\n            }).then(function (editor) {\n              _this2.editors[index] = editor;\n              var dataValue = _this2.dataValue;\n              dataValue = _this2.component.multiple && Array.isArray(dataValue) ? dataValue[index] : dataValue;\n\n              var value = _this2.setConvertedValue(dataValue, index);\n\n              var isReadOnly = _this2.options.readOnly || _this2.disabled; // Use ckeditor 4 in IE browser\n\n              if ((0, _utils.getBrowserInfo)().ie) {\n                editor.on('instanceReady', function () {\n                  editor.setReadOnly(isReadOnly);\n                  editor.setData(value);\n                });\n              } else {\n                var numRows = parseInt(_this2.component.rows, 10);\n\n                if (_lodash.default.isFinite(numRows) && _lodash.default.has(editor, 'ui.view.editable.editableElement')) {\n                  // Default height is 21px with 10px margin + a 14px top margin.\n                  var editorHeight = numRows * 31 + 14;\n                  editor.ui.view.editable.editableElement.style.height = \"\".concat(editorHeight, \"px\");\n                }\n\n                editor.isReadOnly = isReadOnly;\n                editor.data.set(value);\n              }\n\n              editorReady(editor);\n              return editor;\n            });\n\n            break;\n\n          default:\n            _get(_getPrototypeOf(TextAreaComponent.prototype), \"attachElement\", _this2).call(_this2, element, index);\n\n            break;\n        }\n      });\n      return element;\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var attached = _get(_getPrototypeOf(TextAreaComponent.prototype), \"attach\", this).call(this, element); // Make sure we restore the value after attaching since wysiwygs and readonly texts need an additional set.\n\n\n      this.restoreValue();\n      return attached;\n    }\n  }, {\n    key: \"imageHandler\",\n    value: function imageHandler(moduleInstance, range, files) {\n      var _this3 = this;\n\n      var quillInstance = moduleInstance.quill;\n\n      if (!files || !files.length) {\n        console.warn('No files selected');\n        return;\n      }\n\n      quillInstance.enable(false);\n      var _this$component = this.component,\n          uploadStorage = _this$component.uploadStorage,\n          uploadUrl = _this$component.uploadUrl,\n          uploadOptions = _this$component.uploadOptions,\n          uploadDir = _this$component.uploadDir,\n          fileKey = _this$component.fileKey;\n      var requestData;\n      this.fileService.uploadFile(uploadStorage, files[0], (0, _utils.uniqueName)(files[0].name), uploadDir || '', //should pass empty string if undefined\n      null, uploadUrl, uploadOptions, fileKey).then(function (result) {\n        requestData = result;\n        return _this3.fileService.downloadFile(result);\n      }).then(function (result) {\n        quillInstance.enable(true);\n        var Delta = Quill.import('delta');\n        quillInstance.updateContents(new Delta().retain(range.index).delete(range.length).insert({\n          image: result.url\n        }, {\n          alt: JSON.stringify(requestData)\n        }), Quill.sources.USER);\n      }).catch(function (error) {\n        console.warn('Quill image upload failed');\n        console.warn(error);\n        quillInstance.enable(true);\n      });\n    }\n  }, {\n    key: \"isPlain\",\n    get: function get() {\n      return !this.component.wysiwyg && !this.component.editor;\n    }\n  }, {\n    key: \"htmlView\",\n    get: function get() {\n      return this.options.readOnly && (this.component.editor || this.component.wysiwyg);\n    }\n  }, {\n    key: \"setValueAt\",\n    value: function setValueAt(index, value) {\n      var _this4 = this;\n\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"setValueAt\", this).call(this, index, value, flags);\n\n      if (this.editorsReady[index]) {\n        var setEditorsValue = function setEditorsValue(flags) {\n          return function (editor) {\n            if (!flags.skipWysiwyg) {\n              _this4.autoModified = true;\n\n              switch (_this4.component.editor) {\n                case 'ace':\n                  editor.setValue(_this4.setConvertedValue(value, index));\n                  break;\n\n                case 'quill':\n                  if (_this4.component.isUploadEnabled) {\n                    _this4.setAsyncConvertedValue(value).then(function (result) {\n                      var content = editor.clipboard.convert({\n                        html: result\n                      });\n                      editor.setContents(content);\n                    });\n                  } else {\n                    var convertedValue = _this4.setConvertedValue(value, index);\n\n                    var content = editor.clipboard.convert({\n                      html: convertedValue\n                    });\n                    editor.setContents(content);\n                  }\n\n                  break;\n\n                case 'ckeditor':\n                  editor.data.set(_this4.setConvertedValue(value, index));\n                  break;\n              }\n            }\n          };\n        };\n\n        this.editorsReady[index].then(setEditorsValue(_lodash.default.clone(flags)));\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this5 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (this.isPlain || this.options.readOnly || this.disabled) {\n        value = this.component.multiple && Array.isArray(value) ? value.map(function (val, index) {\n          return _this5.setConvertedValue(val, index);\n        }) : this.setConvertedValue(value);\n        return _get(_getPrototypeOf(TextAreaComponent.prototype), \"setValue\", this).call(this, value, flags);\n      }\n\n      flags.skipWysiwyg = _lodash.default.isEqual(value, this.getValue());\n      return _get(_getPrototypeOf(TextAreaComponent.prototype), \"setValue\", this).call(this, value, flags);\n    }\n  }, {\n    key: \"setReadOnlyValue\",\n    value: function setReadOnlyValue(value, index) {\n      index = index || 0;\n\n      if (this.options.readOnly || this.disabled) {\n        if (this.refs.input && this.refs.input[index]) {\n          if (this.component.inputFormat === 'plain') {\n            this.refs.input[index].innerText = this.interpolate(value);\n          } else {\n            this.setContent(this.refs.input[index], this.interpolate(value), this.shouldSanitizeValue);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"isJsonValue\",\n    get: function get() {\n      return this.component.as && this.component.as === 'json';\n    }\n  }, {\n    key: \"setConvertedValue\",\n    value: function setConvertedValue(value, index) {\n      if (this.isJsonValue && !_lodash.default.isNil(value)) {\n        try {\n          value = JSON.stringify(value, null, 2);\n        } catch (err) {\n          console.warn(err);\n        }\n      }\n\n      if (!_lodash.default.isString(value)) {\n        value = '';\n      }\n\n      this.setReadOnlyValue(value, index);\n      return value;\n    }\n  }, {\n    key: \"setAsyncConvertedValue\",\n    value: function setAsyncConvertedValue(value) {\n      if (this.isJsonValue && value) {\n        try {\n          value = JSON.stringify(value, null, 2);\n        } catch (err) {\n          console.warn(err);\n        }\n      }\n\n      if (!_lodash.default.isString(value)) {\n        value = '';\n      }\n\n      var htmlDoc = new DOMParser().parseFromString(value, 'text/html');\n      var images = htmlDoc.getElementsByTagName('img');\n\n      if (images.length) {\n        return this.setImagesUrl(images).then(function () {\n          value = htmlDoc.getElementsByTagName('body')[0].innerHTML;\n          return value;\n        });\n      } else {\n        return _nativePromiseOnly.default.resolve(value);\n      }\n    }\n  }, {\n    key: \"setImagesUrl\",\n    value: function setImagesUrl(images) {\n      var _this6 = this;\n\n      return _nativePromiseOnly.default.all(_lodash.default.map(images, function (image) {\n        var requestData;\n\n        try {\n          requestData = JSON.parse(image.getAttribute('alt'));\n        } catch (error) {\n          console.warn(error);\n        }\n\n        return _this6.fileService.downloadFile(requestData).then(function (result) {\n          image.setAttribute('src', result.url);\n        });\n      }));\n    }\n  }, {\n    key: \"addAutoExpanding\",\n    value: function addAutoExpanding(textarea, index) {\n      var heightOffset = null;\n      var previousHeight = null;\n\n      var changeOverflow = function changeOverflow(value) {\n        var width = textarea.style.width;\n        textarea.style.width = '0px';\n        textarea.offsetWidth;\n        textarea.style.width = width;\n        textarea.style.overflowY = value;\n      };\n\n      var preventParentScroll = function preventParentScroll(element, changeSize) {\n        var nodeScrolls = [];\n\n        while (element && element.parentNode && element.parentNode instanceof Element) {\n          if (element.parentNode.scrollTop) {\n            nodeScrolls.push({\n              node: element.parentNode,\n              scrollTop: element.parentNode.scrollTop\n            });\n          }\n\n          element = element.parentNode;\n        }\n\n        changeSize();\n        nodeScrolls.forEach(function (nodeScroll) {\n          nodeScroll.node.scrollTop = nodeScroll.scrollTop;\n        });\n      };\n\n      var resize = function resize() {\n        if (textarea.scrollHeight === 0) {\n          return;\n        }\n\n        preventParentScroll(textarea, function () {\n          textarea.style.height = '';\n          textarea.style.height = \"\".concat(textarea.scrollHeight + heightOffset, \"px\");\n        });\n      };\n\n      var update = _lodash.default.debounce(function () {\n        resize();\n        var styleHeight = Math.round(parseFloat(textarea.style.height));\n        var computed = window.getComputedStyle(textarea, null);\n        var currentHeight = textarea.offsetHeight;\n\n        if (currentHeight < styleHeight && computed.overflowY === 'hidden') {\n          changeOverflow('scroll');\n        } else if (computed.overflowY !== 'hidden') {\n          changeOverflow('hidden');\n        }\n\n        resize();\n        currentHeight = textarea.offsetHeight;\n\n        if (previousHeight !== currentHeight) {\n          previousHeight = currentHeight;\n          update();\n        }\n      }, 200);\n\n      var computedStyle = window.getComputedStyle(textarea, null);\n      textarea.style.resize = 'none';\n      heightOffset = parseFloat(computedStyle.borderTopWidth) + parseFloat(computedStyle.borderBottomWidth) || 0;\n\n      if (window) {\n        this.addEventListener(window, 'resize', update);\n      }\n\n      this.addEventListener(textarea, 'input', update);\n      this.on('initialized', update);\n      this.updateSizes[index] = update;\n      update();\n    }\n  }, {\n    key: \"trimBlanks\",\n    value: function trimBlanks(value) {\n      if (!value || this.isPlain) {\n        return value;\n      }\n\n      var trimBlanks = function trimBlanks(value) {\n        var nbsp = '<p>&nbsp;</p>';\n        var br = '<p><br></p>';\n        var brNbsp = '<p><br>&nbsp;</p>';\n        var regExp = new RegExp(\"^\".concat(nbsp, \"|\").concat(nbsp, \"$|^\").concat(br, \"|\").concat(br, \"$|^\").concat(brNbsp, \"|\").concat(brNbsp, \"$\"), 'g');\n        return typeof value === 'string' ? value.replace(regExp, '') : value;\n      };\n\n      if (Array.isArray(value)) {\n        value.forEach(function (input, index) {\n          value[index] = trimBlanks(input);\n        });\n      } else {\n        value = trimBlanks(value);\n      }\n\n      return value;\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, fromRoot) {\n      var changed = _get(_getPrototypeOf(TextAreaComponent.prototype), \"onChange\", this).call(this, flags, fromRoot);\n\n      this.updateSizes.forEach(function (updateSize) {\n        return updateSize();\n      });\n      return changed;\n    }\n  }, {\n    key: \"hasChanged\",\n    value: function hasChanged(newValue, oldValue) {\n      return _get(_getPrototypeOf(TextAreaComponent.prototype), \"hasChanged\", this).call(this, this.trimBlanks(newValue), this.trimBlanks(oldValue));\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      return _get(_getPrototypeOf(TextAreaComponent.prototype), \"isEmpty\", this).call(this, this.trimBlanks(value));\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var defaultValue = _get(_getPrototypeOf(TextAreaComponent.prototype), \"defaultValue\", this);\n\n      if (this.component.editor === 'quill' && !defaultValue) {\n        defaultValue = '<p><br></p>';\n      }\n\n      return defaultValue;\n    }\n  }, {\n    key: \"getConvertedValue\",\n    value: function getConvertedValue(value) {\n      if (this.isJsonValue && value) {\n        try {\n          value = JSON.parse(value);\n        } catch (err) {// console.warn(err);\n        }\n      }\n\n      return value;\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      var _this7 = this; // Destroy all editors.\n\n\n      this.editors.forEach(function (editor) {\n        if (editor.destroy) {\n          editor.destroy();\n        }\n      });\n      this.editors = [];\n      this.editorsReady = [];\n      this.updateSizes.forEach(function (updateSize) {\n        return _this7.removeEventListener(window, 'resize', updateSize);\n      });\n      this.updateSizes = [];\n\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (this.isPlain) {\n        return this.getConvertedValue(_get(_getPrototypeOf(TextAreaComponent.prototype), \"getValue\", this).call(this));\n      }\n\n      return this.dataValue;\n    }\n  }, {\n    key: \"focus\",\n    value: function focus() {\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"focus\", this).call(this);\n\n      switch (this.component.editor) {\n        case 'ckeditor':\n          {\n            var _this$editors$0$editi, _this$editors$0$editi2;\n\n            if ((_this$editors$0$editi = this.editors[0].editing) !== null && _this$editors$0$editi !== void 0 && (_this$editors$0$editi2 = _this$editors$0$editi.view) !== null && _this$editors$0$editi2 !== void 0 && _this$editors$0$editi2.focus) {\n              this.editors[0].editing.view.focus();\n            }\n\n            this.element.scrollIntoView();\n            break;\n          }\n\n        case 'ace':\n          {\n            this.editors[0].focus();\n            this.element.scrollIntoView();\n            break;\n          }\n\n        case 'quill':\n          {\n            this.editors[0].focus();\n            break;\n          }\n      }\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _TextField.default.schema.apply(_TextField.default, [{\n        type: 'textarea',\n        label: 'Text Area',\n        key: 'textArea',\n        rows: 3,\n        wysiwyg: false,\n        editor: '',\n        fixedSize: true,\n        inputFormat: 'html',\n        validate: {\n          minWords: '',\n          maxWords: ''\n        }\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Text Area',\n        group: 'basic',\n        icon: 'font',\n        documentation: '/userguide/#textarea',\n        weight: 20,\n        schema: TextAreaComponent.schema()\n      };\n    }\n  }]);\n\n  return TextAreaComponent;\n}(_TextField.default);\n\nexports.default = TextAreaComponent;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/forms-flow-master/forms-flow-ai/forms-flow-web/node_modules/formiojs/components/textarea/TextArea.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_TextField","_interopRequireDefault","_lodash","_nativePromiseOnly","_utils","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","call","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","TextAreaComponent","_TextFieldComponent","_super","init","editors","editorsReady","updateSizes","options","submitOnEnter","schema","info","type","component","wysiwyg","rows","attr","validateMultiple","isJsonValue","renderElement","index","inputInfo","content","readOnly","disabled","isHtmlRenderMode","elementStyle","style","children","concat","renderTemplate","nestedKey","prefix","suffix","input","autoExpand","updateEditorValue","newValue","getConvertedValue","trimBlanks","dataValue","multiple","Array","isArray","newArray","clone","isEqual","isEmpty","updateValue","modified","autoModified","attachElement","element","_this2","isPlain","htmlView","nodeName","addAutoExpanding","editor","settings","wysiwygDefault","editorReady","mode","as","addAce","then","ace","setValue","setConvertedValue","catch","err","console","warn","quill","addQuill","root","innerHTML","isUploadEnabled","_this","getModule","handler","_this$imageHandler","_len","args","_key","imageHandler","spellcheck","disable","setContents","clipboard","convert","html","addCKE","isReadOnly","getBrowserInfo","ie","on","setReadOnly","setData","numRows","parseInt","isFinite","has","editorHeight","ui","view","editable","editableElement","height","data","set","attach","attached","restoreValue","moduleInstance","range","files","_this3","quillInstance","enable","_this$component","uploadStorage","uploadUrl","uploadOptions","uploadDir","fileKey","requestData","fileService","uploadFile","uniqueName","name","downloadFile","Delta","Quill","import","updateContents","retain","delete","insert","image","url","alt","JSON","stringify","sources","USER","error","setValueAt","_this4","flags","undefined","setEditorsValue","skipWysiwyg","setAsyncConvertedValue","convertedValue","_this5","map","val","getValue","setReadOnlyValue","refs","inputFormat","innerText","interpolate","setContent","shouldSanitizeValue","isNil","isString","htmlDoc","DOMParser","parseFromString","images","getElementsByTagName","setImagesUrl","resolve","_this6","all","parse","getAttribute","setAttribute","textarea","heightOffset","previousHeight","changeOverflow","width","offsetWidth","overflowY","preventParentScroll","changeSize","nodeScrolls","parentNode","Element","scrollTop","push","node","forEach","nodeScroll","resize","scrollHeight","update","debounce","styleHeight","Math","round","parseFloat","computed","window","getComputedStyle","currentHeight","offsetHeight","computedStyle","borderTopWidth","borderBottomWidth","addEventListener","nbsp","br","brNbsp","regExp","RegExp","replace","onChange","fromRoot","changed","updateSize","hasChanged","oldValue","defaultValue","detach","_this7","destroy","removeEventListener","focus","_this$editors$0$editi","_this$editors$0$editi2","editing","scrollIntoView","_len2","extend","_key2","label","fixedSize","validate","minWords","maxWords","title","group","icon","documentation","weight"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _TextField = _interopRequireDefault(require(\"../textfield/TextField\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar TextAreaComponent = /*#__PURE__*/function (_TextFieldComponent) {\n  _inherits(TextAreaComponent, _TextFieldComponent);\n\n  var _super = _createSuper(TextAreaComponent);\n\n  function TextAreaComponent() {\n    _classCallCheck(this, TextAreaComponent);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(TextAreaComponent, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"init\", this).call(this);\n\n      this.editors = [];\n      this.editorsReady = [];\n      this.updateSizes = []; // Never submit on enter for text areas.\n\n      this.options.submitOnEnter = false;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return TextAreaComponent.schema();\n    }\n  }, {\n    key: \"inputInfo\",\n    get: function get() {\n      var info = _get(_getPrototypeOf(TextAreaComponent.prototype), \"inputInfo\", this);\n\n      info.type = this.component.wysiwyg ? 'div' : 'textarea';\n\n      if (this.component.rows) {\n        info.attr.rows = this.component.rows;\n      }\n\n      return info;\n    }\n  }, {\n    key: \"validateMultiple\",\n    value: function validateMultiple() {\n      return !this.isJsonValue;\n    }\n  }, {\n    key: \"renderElement\",\n    value: function renderElement(value, index) {\n      var info = this.inputInfo;\n      info.attr = info.attr || {};\n      info.content = value;\n\n      if ((this.options.readOnly || this.disabled) && !this.isHtmlRenderMode()) {\n        var elementStyle = this.info.attr.style || '';\n        var children = \"<div ref=\\\"input\\\" class=\\\"formio-editor-read-only-content\\\" \".concat(elementStyle ? \"style='\".concat(elementStyle, \"'\") : '', \"></div>\");\n        return this.renderTemplate('well', {\n          children: children,\n          nestedKey: this.key,\n          value: value\n        });\n      }\n\n      return this.renderTemplate('input', {\n        prefix: this.prefix,\n        suffix: this.suffix,\n        input: info,\n        value: value,\n        index: index\n      });\n    }\n  }, {\n    key: \"autoExpand\",\n    get: function get() {\n      return this.component.autoExpand;\n    }\n    /**\n     * Updates the editor value.\n     *\n     * @param newValue\n     */\n\n  }, {\n    key: \"updateEditorValue\",\n    value: function updateEditorValue(index, newValue) {\n      newValue = this.getConvertedValue(this.trimBlanks(newValue));\n      var dataValue = this.dataValue;\n\n      if (this.component.multiple && Array.isArray(dataValue)) {\n        var newArray = _lodash.default.clone(dataValue);\n\n        newArray[index] = newValue;\n        newValue = newArray;\n      }\n\n      if (!_lodash.default.isEqual(newValue, dataValue) && (!_lodash.default.isEmpty(newValue) || !_lodash.default.isEmpty(dataValue))) {\n        this.updateValue(newValue, {\n          modified: !this.autoModified\n        }, index);\n      }\n\n      this.autoModified = false;\n    }\n  }, {\n    key: \"attachElement\",\n    value: function attachElement(element, index) {\n      var _this2 = this;\n\n      if (this.autoExpand && (this.isPlain || this.options.readOnly || this.options.htmlView)) {\n        if (element.nodeName === 'TEXTAREA') {\n          this.addAutoExpanding(element, index);\n        }\n      }\n\n      if (this.options.readOnly) {\n        return element;\n      }\n\n      if (this.component.wysiwyg && !this.component.editor) {\n        this.component.editor = 'ckeditor';\n      }\n\n      var settings = _lodash.default.isEmpty(this.component.wysiwyg) ? this.wysiwygDefault[this.component.editor] || this.wysiwygDefault.default : this.component.wysiwyg; // Keep track of when this editor is ready.\n\n      this.editorsReady[index] = new _nativePromiseOnly.default(function (editorReady) {\n        // Attempt to add a wysiwyg editor. In order to add one, it must be included on the global scope.\n        switch (_this2.component.editor) {\n          case 'ace':\n            if (!settings) {\n              settings = {};\n            }\n\n            settings.mode = _this2.component.as ? \"ace/mode/\".concat(_this2.component.as) : 'ace/mode/javascript';\n\n            _this2.addAce(element, settings, function (newValue) {\n              return _this2.updateEditorValue(index, newValue);\n            }).then(function (ace) {\n              _this2.editors[index] = ace;\n              var dataValue = _this2.dataValue;\n              dataValue = _this2.component.multiple && Array.isArray(dataValue) ? dataValue[index] : dataValue;\n              ace.setValue(_this2.setConvertedValue(dataValue, index));\n              editorReady(ace);\n              return ace;\n            }).catch(function (err) {\n              return console.warn(err);\n            });\n\n            break;\n\n          case 'quill':\n            // Normalize the configurations for quill.\n            if (settings.hasOwnProperty('toolbarGroups') || settings.hasOwnProperty('toolbar')) {\n              console.warn('The WYSIWYG settings are configured for CKEditor. For this renderer, you will need to use configurations for the Quill Editor. See https://quilljs.com/docs/configuration for more information.');\n              settings = _this2.wysiwygDefault.quill;\n            } // Add the quill editor.\n\n\n            _this2.addQuill(element, settings, function () {\n              return _this2.updateEditorValue(index, _this2.editors[index].root.innerHTML);\n            }).then(function (quill) {\n              _this2.editors[index] = quill;\n\n              if (_this2.component.isUploadEnabled) {\n                var _this = _this2;\n\n                quill.getModule('uploader').options.handler = function () {\n                  var _this$imageHandler;\n\n                  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n                    args[_key] = arguments[_key];\n                  }\n\n                  //we need initial 'this' because quill calls this method with its own context and we need some inner quill methods exposed in it\n                  //we also need current component instance as we use some fields and methods from it as well\n                  (_this$imageHandler = _this.imageHandler).call.apply(_this$imageHandler, [_this, this].concat(args));\n                };\n              }\n\n              quill.root.spellcheck = _this2.component.spellcheck;\n\n              if (_this2.options.readOnly || _this2.disabled) {\n                quill.disable();\n              }\n\n              var dataValue = _this2.dataValue;\n              dataValue = _this2.component.multiple && Array.isArray(dataValue) ? dataValue[index] : dataValue;\n              quill.setContents(quill.clipboard.convert({\n                html: _this2.setConvertedValue(dataValue, index)\n              }));\n              editorReady(quill);\n              return quill;\n            }).catch(function (err) {\n              return console.warn(err);\n            });\n\n            break;\n\n          case 'ckeditor':\n            settings = settings || {};\n            settings.rows = _this2.component.rows;\n\n            _this2.addCKE(element, settings, function (newValue) {\n              return _this2.updateEditorValue(index, newValue);\n            }).then(function (editor) {\n              _this2.editors[index] = editor;\n              var dataValue = _this2.dataValue;\n              dataValue = _this2.component.multiple && Array.isArray(dataValue) ? dataValue[index] : dataValue;\n\n              var value = _this2.setConvertedValue(dataValue, index);\n\n              var isReadOnly = _this2.options.readOnly || _this2.disabled; // Use ckeditor 4 in IE browser\n\n              if ((0, _utils.getBrowserInfo)().ie) {\n                editor.on('instanceReady', function () {\n                  editor.setReadOnly(isReadOnly);\n                  editor.setData(value);\n                });\n              } else {\n                var numRows = parseInt(_this2.component.rows, 10);\n\n                if (_lodash.default.isFinite(numRows) && _lodash.default.has(editor, 'ui.view.editable.editableElement')) {\n                  // Default height is 21px with 10px margin + a 14px top margin.\n                  var editorHeight = numRows * 31 + 14;\n                  editor.ui.view.editable.editableElement.style.height = \"\".concat(editorHeight, \"px\");\n                }\n\n                editor.isReadOnly = isReadOnly;\n                editor.data.set(value);\n              }\n\n              editorReady(editor);\n              return editor;\n            });\n\n            break;\n\n          default:\n            _get(_getPrototypeOf(TextAreaComponent.prototype), \"attachElement\", _this2).call(_this2, element, index);\n\n            break;\n        }\n      });\n      return element;\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var attached = _get(_getPrototypeOf(TextAreaComponent.prototype), \"attach\", this).call(this, element); // Make sure we restore the value after attaching since wysiwygs and readonly texts need an additional set.\n\n\n      this.restoreValue();\n      return attached;\n    }\n  }, {\n    key: \"imageHandler\",\n    value: function imageHandler(moduleInstance, range, files) {\n      var _this3 = this;\n\n      var quillInstance = moduleInstance.quill;\n\n      if (!files || !files.length) {\n        console.warn('No files selected');\n        return;\n      }\n\n      quillInstance.enable(false);\n      var _this$component = this.component,\n          uploadStorage = _this$component.uploadStorage,\n          uploadUrl = _this$component.uploadUrl,\n          uploadOptions = _this$component.uploadOptions,\n          uploadDir = _this$component.uploadDir,\n          fileKey = _this$component.fileKey;\n      var requestData;\n      this.fileService.uploadFile(uploadStorage, files[0], (0, _utils.uniqueName)(files[0].name), uploadDir || '', //should pass empty string if undefined\n      null, uploadUrl, uploadOptions, fileKey).then(function (result) {\n        requestData = result;\n        return _this3.fileService.downloadFile(result);\n      }).then(function (result) {\n        quillInstance.enable(true);\n        var Delta = Quill.import('delta');\n        quillInstance.updateContents(new Delta().retain(range.index).delete(range.length).insert({\n          image: result.url\n        }, {\n          alt: JSON.stringify(requestData)\n        }), Quill.sources.USER);\n      }).catch(function (error) {\n        console.warn('Quill image upload failed');\n        console.warn(error);\n        quillInstance.enable(true);\n      });\n    }\n  }, {\n    key: \"isPlain\",\n    get: function get() {\n      return !this.component.wysiwyg && !this.component.editor;\n    }\n  }, {\n    key: \"htmlView\",\n    get: function get() {\n      return this.options.readOnly && (this.component.editor || this.component.wysiwyg);\n    }\n  }, {\n    key: \"setValueAt\",\n    value: function setValueAt(index, value) {\n      var _this4 = this;\n\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"setValueAt\", this).call(this, index, value, flags);\n\n      if (this.editorsReady[index]) {\n        var setEditorsValue = function setEditorsValue(flags) {\n          return function (editor) {\n            if (!flags.skipWysiwyg) {\n              _this4.autoModified = true;\n\n              switch (_this4.component.editor) {\n                case 'ace':\n                  editor.setValue(_this4.setConvertedValue(value, index));\n                  break;\n\n                case 'quill':\n                  if (_this4.component.isUploadEnabled) {\n                    _this4.setAsyncConvertedValue(value).then(function (result) {\n                      var content = editor.clipboard.convert({\n                        html: result\n                      });\n                      editor.setContents(content);\n                    });\n                  } else {\n                    var convertedValue = _this4.setConvertedValue(value, index);\n\n                    var content = editor.clipboard.convert({\n                      html: convertedValue\n                    });\n                    editor.setContents(content);\n                  }\n\n                  break;\n\n                case 'ckeditor':\n                  editor.data.set(_this4.setConvertedValue(value, index));\n                  break;\n              }\n            }\n          };\n        };\n\n        this.editorsReady[index].then(setEditorsValue(_lodash.default.clone(flags)));\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this5 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (this.isPlain || this.options.readOnly || this.disabled) {\n        value = this.component.multiple && Array.isArray(value) ? value.map(function (val, index) {\n          return _this5.setConvertedValue(val, index);\n        }) : this.setConvertedValue(value);\n        return _get(_getPrototypeOf(TextAreaComponent.prototype), \"setValue\", this).call(this, value, flags);\n      }\n\n      flags.skipWysiwyg = _lodash.default.isEqual(value, this.getValue());\n      return _get(_getPrototypeOf(TextAreaComponent.prototype), \"setValue\", this).call(this, value, flags);\n    }\n  }, {\n    key: \"setReadOnlyValue\",\n    value: function setReadOnlyValue(value, index) {\n      index = index || 0;\n\n      if (this.options.readOnly || this.disabled) {\n        if (this.refs.input && this.refs.input[index]) {\n          if (this.component.inputFormat === 'plain') {\n            this.refs.input[index].innerText = this.interpolate(value);\n          } else {\n            this.setContent(this.refs.input[index], this.interpolate(value), this.shouldSanitizeValue);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"isJsonValue\",\n    get: function get() {\n      return this.component.as && this.component.as === 'json';\n    }\n  }, {\n    key: \"setConvertedValue\",\n    value: function setConvertedValue(value, index) {\n      if (this.isJsonValue && !_lodash.default.isNil(value)) {\n        try {\n          value = JSON.stringify(value, null, 2);\n        } catch (err) {\n          console.warn(err);\n        }\n      }\n\n      if (!_lodash.default.isString(value)) {\n        value = '';\n      }\n\n      this.setReadOnlyValue(value, index);\n      return value;\n    }\n  }, {\n    key: \"setAsyncConvertedValue\",\n    value: function setAsyncConvertedValue(value) {\n      if (this.isJsonValue && value) {\n        try {\n          value = JSON.stringify(value, null, 2);\n        } catch (err) {\n          console.warn(err);\n        }\n      }\n\n      if (!_lodash.default.isString(value)) {\n        value = '';\n      }\n\n      var htmlDoc = new DOMParser().parseFromString(value, 'text/html');\n      var images = htmlDoc.getElementsByTagName('img');\n\n      if (images.length) {\n        return this.setImagesUrl(images).then(function () {\n          value = htmlDoc.getElementsByTagName('body')[0].innerHTML;\n          return value;\n        });\n      } else {\n        return _nativePromiseOnly.default.resolve(value);\n      }\n    }\n  }, {\n    key: \"setImagesUrl\",\n    value: function setImagesUrl(images) {\n      var _this6 = this;\n\n      return _nativePromiseOnly.default.all(_lodash.default.map(images, function (image) {\n        var requestData;\n\n        try {\n          requestData = JSON.parse(image.getAttribute('alt'));\n        } catch (error) {\n          console.warn(error);\n        }\n\n        return _this6.fileService.downloadFile(requestData).then(function (result) {\n          image.setAttribute('src', result.url);\n        });\n      }));\n    }\n  }, {\n    key: \"addAutoExpanding\",\n    value: function addAutoExpanding(textarea, index) {\n      var heightOffset = null;\n      var previousHeight = null;\n\n      var changeOverflow = function changeOverflow(value) {\n        var width = textarea.style.width;\n        textarea.style.width = '0px';\n        textarea.offsetWidth;\n        textarea.style.width = width;\n        textarea.style.overflowY = value;\n      };\n\n      var preventParentScroll = function preventParentScroll(element, changeSize) {\n        var nodeScrolls = [];\n\n        while (element && element.parentNode && element.parentNode instanceof Element) {\n          if (element.parentNode.scrollTop) {\n            nodeScrolls.push({\n              node: element.parentNode,\n              scrollTop: element.parentNode.scrollTop\n            });\n          }\n\n          element = element.parentNode;\n        }\n\n        changeSize();\n        nodeScrolls.forEach(function (nodeScroll) {\n          nodeScroll.node.scrollTop = nodeScroll.scrollTop;\n        });\n      };\n\n      var resize = function resize() {\n        if (textarea.scrollHeight === 0) {\n          return;\n        }\n\n        preventParentScroll(textarea, function () {\n          textarea.style.height = '';\n          textarea.style.height = \"\".concat(textarea.scrollHeight + heightOffset, \"px\");\n        });\n      };\n\n      var update = _lodash.default.debounce(function () {\n        resize();\n        var styleHeight = Math.round(parseFloat(textarea.style.height));\n        var computed = window.getComputedStyle(textarea, null);\n        var currentHeight = textarea.offsetHeight;\n\n        if (currentHeight < styleHeight && computed.overflowY === 'hidden') {\n          changeOverflow('scroll');\n        } else if (computed.overflowY !== 'hidden') {\n          changeOverflow('hidden');\n        }\n\n        resize();\n        currentHeight = textarea.offsetHeight;\n\n        if (previousHeight !== currentHeight) {\n          previousHeight = currentHeight;\n          update();\n        }\n      }, 200);\n\n      var computedStyle = window.getComputedStyle(textarea, null);\n      textarea.style.resize = 'none';\n      heightOffset = parseFloat(computedStyle.borderTopWidth) + parseFloat(computedStyle.borderBottomWidth) || 0;\n\n      if (window) {\n        this.addEventListener(window, 'resize', update);\n      }\n\n      this.addEventListener(textarea, 'input', update);\n      this.on('initialized', update);\n      this.updateSizes[index] = update;\n      update();\n    }\n  }, {\n    key: \"trimBlanks\",\n    value: function trimBlanks(value) {\n      if (!value || this.isPlain) {\n        return value;\n      }\n\n      var trimBlanks = function trimBlanks(value) {\n        var nbsp = '<p>&nbsp;</p>';\n        var br = '<p><br></p>';\n        var brNbsp = '<p><br>&nbsp;</p>';\n        var regExp = new RegExp(\"^\".concat(nbsp, \"|\").concat(nbsp, \"$|^\").concat(br, \"|\").concat(br, \"$|^\").concat(brNbsp, \"|\").concat(brNbsp, \"$\"), 'g');\n        return typeof value === 'string' ? value.replace(regExp, '') : value;\n      };\n\n      if (Array.isArray(value)) {\n        value.forEach(function (input, index) {\n          value[index] = trimBlanks(input);\n        });\n      } else {\n        value = trimBlanks(value);\n      }\n\n      return value;\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, fromRoot) {\n      var changed = _get(_getPrototypeOf(TextAreaComponent.prototype), \"onChange\", this).call(this, flags, fromRoot);\n\n      this.updateSizes.forEach(function (updateSize) {\n        return updateSize();\n      });\n      return changed;\n    }\n  }, {\n    key: \"hasChanged\",\n    value: function hasChanged(newValue, oldValue) {\n      return _get(_getPrototypeOf(TextAreaComponent.prototype), \"hasChanged\", this).call(this, this.trimBlanks(newValue), this.trimBlanks(oldValue));\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      return _get(_getPrototypeOf(TextAreaComponent.prototype), \"isEmpty\", this).call(this, this.trimBlanks(value));\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var defaultValue = _get(_getPrototypeOf(TextAreaComponent.prototype), \"defaultValue\", this);\n\n      if (this.component.editor === 'quill' && !defaultValue) {\n        defaultValue = '<p><br></p>';\n      }\n\n      return defaultValue;\n    }\n  }, {\n    key: \"getConvertedValue\",\n    value: function getConvertedValue(value) {\n      if (this.isJsonValue && value) {\n        try {\n          value = JSON.parse(value);\n        } catch (err) {// console.warn(err);\n        }\n      }\n\n      return value;\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      var _this7 = this;\n\n      // Destroy all editors.\n      this.editors.forEach(function (editor) {\n        if (editor.destroy) {\n          editor.destroy();\n        }\n      });\n      this.editors = [];\n      this.editorsReady = [];\n      this.updateSizes.forEach(function (updateSize) {\n        return _this7.removeEventListener(window, 'resize', updateSize);\n      });\n      this.updateSizes = [];\n\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (this.isPlain) {\n        return this.getConvertedValue(_get(_getPrototypeOf(TextAreaComponent.prototype), \"getValue\", this).call(this));\n      }\n\n      return this.dataValue;\n    }\n  }, {\n    key: \"focus\",\n    value: function focus() {\n      _get(_getPrototypeOf(TextAreaComponent.prototype), \"focus\", this).call(this);\n\n      switch (this.component.editor) {\n        case 'ckeditor':\n          {\n            var _this$editors$0$editi, _this$editors$0$editi2;\n\n            if ((_this$editors$0$editi = this.editors[0].editing) !== null && _this$editors$0$editi !== void 0 && (_this$editors$0$editi2 = _this$editors$0$editi.view) !== null && _this$editors$0$editi2 !== void 0 && _this$editors$0$editi2.focus) {\n              this.editors[0].editing.view.focus();\n            }\n\n            this.element.scrollIntoView();\n            break;\n          }\n\n        case 'ace':\n          {\n            this.editors[0].focus();\n            this.element.scrollIntoView();\n            break;\n          }\n\n        case 'quill':\n          {\n            this.editors[0].focus();\n            break;\n          }\n      }\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _TextField.default.schema.apply(_TextField.default, [{\n        type: 'textarea',\n        label: 'Text Area',\n        key: 'textArea',\n        rows: 3,\n        wysiwyg: false,\n        editor: '',\n        fixedSize: true,\n        inputFormat: 'html',\n        validate: {\n          minWords: '',\n          maxWords: ''\n        }\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Text Area',\n        group: 'basic',\n        icon: 'font',\n        documentation: '/userguide/#textarea',\n        weight: 20,\n        schema: TextAreaComponent.schema()\n      };\n    }\n  }]);\n\n  return TextAreaComponent;\n}(_TextField.default);\n\nexports.default = TextAreaComponent;"]},"metadata":{},"sourceType":"script"}