{"ast":null,"code":"'use strict';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.reflect.set.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.number.parse-int.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Field2 = _interopRequireDefault(require(\"../field/Field\"));\n\nvar _Components = _interopRequireDefault(require(\"../../Components\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../../utils/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction set(target, property, value, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.set) {\n    set = Reflect.set;\n  } else {\n    set = function set(target, property, value, receiver) {\n      var base = _superPropBase(target, property);\n\n      var desc;\n\n      if (base) {\n        desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.set) {\n          desc.set.call(receiver, value);\n          return true;\n        } else if (!desc.writable) {\n          return false;\n        }\n      }\n\n      desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n      if (desc) {\n        if (!desc.writable) {\n          return false;\n        }\n\n        desc.value = value;\n        Object.defineProperty(receiver, property, desc);\n      } else {\n        _defineProperty(receiver, property, value);\n      }\n\n      return true;\n    };\n  }\n\n  return set(target, property, value, receiver);\n}\n\nfunction _set(target, property, value, receiver, isStrict) {\n  var s = set(target, property, value, receiver || target);\n\n  if (!s && isStrict) {\n    throw new Error('failed to set property');\n  }\n\n  return value;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar NestedComponent = /*#__PURE__*/function (_Field) {\n  _inherits(NestedComponent, _Field);\n\n  var _super = _createSuper(NestedComponent);\n\n  function NestedComponent(component, options, data) {\n    var _this;\n\n    _classCallCheck(this, NestedComponent);\n\n    _this = _super.call(this, component, options, data);\n    _this.type = 'components';\n    _this._collapsed = !!_this.component.collapsed;\n    return _this;\n  }\n\n  _createClass(NestedComponent, [{\n    key: \"defaultSchema\",\n    get: function get() {\n      return NestedComponent.schema();\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      var schema = _get(_getPrototypeOf(NestedComponent.prototype), \"schema\", this);\n\n      var components = _lodash.default.uniqBy(this.getComponents(), 'component.key');\n\n      schema.components = _lodash.default.map(components, 'schema');\n      return schema;\n    }\n  }, {\n    key: \"collapsed\",\n    get: function get() {\n      return this._collapsed;\n    },\n    set: function set(value) {\n      this._collapsed = value;\n      this.collapse(value);\n    }\n  }, {\n    key: \"collapse\",\n    value: function collapse(value) {\n      var promise = this.redraw();\n\n      if (!value && !this.pristine) {\n        this.checkValidity(this.data, true);\n      }\n\n      return promise;\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      // DO NOT CALL super here.  There is an issue where clearOnHide was getting triggered with\n      // subcomponents because the \"parentVisible\" flag was set to false when it should really be\n      // set to true.\n      var visibilityChanged = this._visible !== value;\n      this._visible = value;\n      var isVisible = this.visible;\n      var forceShow = this.options.show && this.options.show[this.component.key];\n      var forceHide = this.options.hide && this.options.hide[this.component.key];\n      this.components.forEach(function (component) {\n        // Set the parent visibility first since we may have nested components within nested components\n        // and they need to be able to determine their visibility based on the parent visibility.\n        component.parentVisible = isVisible;\n        var conditionallyVisible = component.conditionallyVisible();\n\n        if (forceShow || conditionallyVisible) {\n          component.visible = true;\n        } else if (forceHide || !isVisible || !conditionallyVisible) {\n          component.visible = false;\n        } // If hiding a nested component, clear all errors below.\n\n\n        if (!component.visible) {\n          component.error = '';\n        }\n      });\n\n      if (visibilityChanged) {\n        this.clearOnHide();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this2 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", value, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentVisible = _this2.visible;\n      });\n    }\n  }, {\n    key: \"disabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"disabled\", this);\n    },\n    set: function set(disabled) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"disabled\", disabled, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentDisabled = disabled;\n      });\n    }\n  }, {\n    key: \"parentDisabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", value, this, true);\n\n      this.components.forEach(function (component) {\n        component.parentDisabled = _this3.disabled;\n      });\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.ready;\n      }));\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", this);\n    },\n    set: function set(instance) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", instance, this, true);\n\n      this.getComponents().forEach(function (component) {\n        component.currentForm = instance;\n      });\n    }\n  }, {\n    key: \"rowIndex\",\n    get: function get() {\n      return this._rowIndex;\n    },\n    set: function set(value) {\n      this._rowIndex = value;\n      this.eachComponent(function (component) {\n        component.rowIndex = value;\n      });\n    }\n  }, {\n    key: \"componentContext\",\n    value: function componentContext() {\n      return this._data;\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      var _this4 = this;\n\n      this._data = value;\n      this.eachComponent(function (component) {\n        component.data = _this4.componentContext(component);\n      });\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.components || [];\n    }\n    /**\n     * Perform a deep iteration over every component, including those\n     * within other container based components.\n     *\n     * @param {function} fn - Called for every component.\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent(fn, options) {\n      var components = this.getComponents();\n\n      _lodash.default.each(components, function (component, index) {\n        if (fn(component, components, index) === false) {\n          return false;\n        }\n\n        if (typeof component.everyComponent === 'function') {\n          if (component.everyComponent(fn, options) === false) {\n            return false;\n          }\n        }\n      });\n    }\n  }, {\n    key: \"hasComponent\",\n    value: function hasComponent(component) {\n      var result = false;\n      this.everyComponent(function (comp) {\n        if (comp === component) {\n          result = true;\n          return false;\n        }\n      });\n      return result;\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents() {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      });\n      return result;\n    }\n    /**\n     * Perform an iteration over each component within this container component.\n     *\n     * @param {function} fn - Called for each component\n     */\n\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn) {\n      _lodash.default.each(this.getComponents(), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n    /**\n     * Returns a component provided a key. This performs a deep search within the\n     * component tree.\n     *\n     * @param {string} key - The key of the component to retrieve.\n     * @param {function} fn - Called with the component once found.\n     * @return {Object} - The component that is located.\n     */\n\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn, originalPath) {\n      originalPath = originalPath || (0, _utils.getStringFromComponentPath)(path);\n      path = (0, _utils.getArrayFromComponentPath)(path);\n      var pathStr = originalPath;\n\n      var newPath = _lodash.default.clone(path);\n\n      var key = newPath.shift();\n      var remainingPath = newPath;\n      var comp = null;\n      var possibleComp = null;\n\n      if (_lodash.default.isNumber(key)) {\n        key = remainingPath.shift();\n      }\n\n      if (!_lodash.default.isString(key)) {\n        return comp;\n      }\n\n      this.everyComponent(function (component, components) {\n        var matchPath = component.hasInput && component.path ? pathStr.includes(component.path) : true;\n\n        if (component.component.key === key) {\n          possibleComp = component;\n\n          if (matchPath) {\n            comp = component;\n\n            if (remainingPath.length > 0 && 'getComponent' in component) {\n              comp = component.getComponent(remainingPath, fn, originalPath);\n            } else if (fn) {\n              fn(component, components);\n            }\n\n            return false;\n          }\n        }\n      });\n\n      if (!comp) {\n        comp = possibleComp;\n      }\n\n      return comp;\n    }\n    /**\n     * Return a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component.\n     * @param {function} fn - Called with the component once it is retrieved.\n     * @return {Object} - The component retrieved.\n     */\n\n  }, {\n    key: \"getComponentById\",\n    value: function getComponentById(id, fn) {\n      var comp = null;\n      this.everyComponent(function (component, components) {\n        if (component.id === id) {\n          comp = component;\n\n          if (fn) {\n            fn(component, components);\n          }\n\n          return false;\n        }\n      });\n      return comp;\n    }\n    /**\n     * Return a path of component's value.\n     *\n     * @param {Object} component - The component instance.\n     * @return {string} - The component's value path.\n     */\n\n  }, {\n    key: \"calculateComponentPath\",\n    value: function calculateComponentPath(component) {\n      var path = '';\n\n      if (component.component.key) {\n        var thisPath = this;\n\n        while (thisPath && !thisPath.allowData && thisPath.parent) {\n          thisPath = thisPath.parent;\n        }\n\n        var rowIndex = component.row ? \"[\".concat(Number.parseInt(component.row), \"]\") : '';\n        path = thisPath.path ? \"\".concat(thisPath.path).concat(rowIndex, \".\") : '';\n        path += component._parentPath && component.component.shouldIncludeSubFormPath ? component._parentPath : '';\n        path += component.component.key;\n        return path;\n      }\n    }\n    /**\n     * Create a new component and add it to the components array.\n     *\n     * @param component\n     * @param data\n     */\n\n  }, {\n    key: \"createComponent\",\n    value: function createComponent(component, options, data, before) {\n      var _options;\n\n      if (!component) {\n        return;\n      }\n\n      options = options || this.options;\n      data = data || this.data;\n      options.parent = this;\n      options.parentVisible = this.visible;\n      options.root = ((_options = options) === null || _options === void 0 ? void 0 : _options.root) || this.root || this;\n      options.localRoot = this.localRoot;\n      options.skipInit = true;\n\n      if (!this.isInputComponent && this.component.shouldIncludeSubFormPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      var comp = _Components.default.create(component, options, data, true);\n\n      var path = this.calculateComponentPath(comp);\n\n      if (path) {\n        comp.path = path;\n      }\n\n      comp.init();\n\n      if (component.internal) {\n        return comp;\n      }\n\n      if (before) {\n        var index = _lodash.default.findIndex(this.components, {\n          id: before.id\n        });\n\n        if (index !== -1) {\n          this.components.splice(index, 0, comp);\n        } else {\n          this.components.push(comp);\n        }\n      } else {\n        this.components.push(comp);\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.element;\n    }\n  }, {\n    key: \"componentComponents\",\n    get: function get() {\n      return this.component.components || [];\n    }\n  }, {\n    key: \"nestedKey\",\n    get: function get() {\n      return \"nested-\".concat(this.key);\n    }\n  }, {\n    key: \"templateName\",\n    get: function get() {\n      return 'container';\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.components = this.components || [];\n      this.addComponents();\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"init\", this).call(this);\n    }\n    /**\n     *\n     * @param element\n     * @param data\n     */\n\n  }, {\n    key: \"addComponents\",\n    value: function addComponents(data, options) {\n      var _this5 = this;\n\n      data = data || this.data;\n      options = options || this.options;\n\n      if (options.components) {\n        this.components = options.components;\n      } else {\n        var components = this.hook('addComponents', this.componentComponents, this) || [];\n        components.forEach(function (component) {\n          return _this5.addComponent(component, data);\n        });\n      }\n    }\n    /**\n     * Add a new component to the components array.\n     *\n     * @param {Object} component - The component JSON schema to add.\n     * @param {Object} data - The submission data object to house the data for this component.\n     * @param {HTMLElement} before - A DOM element to insert this element before.\n     * @return {Component} - The created component instance.\n     */\n\n  }, {\n    key: \"addComponent\",\n    value: function addComponent(component, data, before, noAdd) {\n      data = data || this.data;\n\n      if (this.options.parentPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      component = this.hook('addComponent', component, data, before, noAdd);\n      var comp = this.createComponent(component, this.options, data, before ? before : null);\n\n      if (noAdd) {\n        return comp;\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus() {\n      if (this.parent && 'beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      // If already rendering, don't re-render.\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"render\", this).call(this, children || this.renderTemplate(this.templateName, {\n        children: !this.visible ? '' : this.renderComponents(),\n        nestedKey: this.nestedKey,\n        collapsed: this.options.pdf ? false : this.collapsed\n      }));\n    }\n  }, {\n    key: \"renderComponents\",\n    value: function renderComponents(components) {\n      components = components || this.getComponents();\n      var children = components.map(function (component) {\n        return component.render();\n      });\n      return this.renderTemplate('components', {\n        children: children,\n        components: components\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this6 = this;\n\n      var superPromise = _get(_getPrototypeOf(NestedComponent.prototype), \"attach\", this).call(this, element);\n\n      this.loadRefs(element, _defineProperty({\n        header: 'single',\n        collapsed: this.collapsed\n      }, this.nestedKey, 'single'));\n\n      var childPromise = _nativePromiseOnly.default.resolve();\n\n      if (this.refs[this.nestedKey]) {\n        childPromise = this.attachComponents(this.refs[this.nestedKey]);\n      }\n\n      if (this.component.collapsible && this.refs.header) {\n        this.addEventListener(this.refs.header, 'click', function () {\n          _this6.collapsed = !_this6.collapsed;\n        });\n        this.addEventListener(this.refs.header, 'keydown', function (e) {\n          if (e.keyCode === 13 || e.keyCode === 32) {\n            e.preventDefault();\n            _this6.collapsed = !_this6.collapsed;\n          }\n        });\n      }\n\n      return _nativePromiseOnly.default.all([superPromise, childPromise]);\n    }\n  }, {\n    key: \"attachComponents\",\n    value: function attachComponents(element, components, container) {\n      components = components || this.components;\n      container = container || this.component.components;\n      element = this.hook('attachComponents', element, components, container, this);\n\n      if (!element) {\n        // Return a non-resolving promise.\n        return new _nativePromiseOnly.default(function () {});\n      }\n\n      var index = 0;\n      var promises = [];\n      Array.prototype.slice.call(element.children).forEach(function (child) {\n        if (!child.getAttribute('data-noattach') && components[index]) {\n          promises.push(components[index].attach(child));\n          index++;\n        }\n      });\n      return _nativePromiseOnly.default.all(promises);\n    }\n    /**\n     * Remove a component from the components array.\n     *\n     * @param {Component} component - The component to remove from the components.\n     * @param {Array<Component>} components - An array of components to remove this component from.\n     */\n\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, components) {\n      components = components || this.components;\n      component.destroy();\n\n      _lodash.default.remove(components, {\n        id: component.id\n      });\n    }\n    /**\n     * Removes a component provided the API key of that component.\n     *\n     * @param {string} key - The API key of the component to remove.\n     * @param {function} fn - Called once the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentByKey\",\n    value: function removeComponentByKey(key, fn) {\n      var _this7 = this;\n\n      var comp = this.getComponent(key, function (component, components) {\n        _this7.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n    /**\n     * Removes a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component to remove.\n     * @param {function} fn - Called when the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentById\",\n    value: function removeComponentById(id, fn) {\n      var _this8 = this;\n\n      var comp = this.getComponentById(id, function (component, components) {\n        _this8.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n  }, {\n    key: \"updateValue\",\n    value: function updateValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.components.reduce(function (changed, comp) {\n        return comp.updateValue(null, flags) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"updateValue\", this).call(this, value, flags));\n    }\n  }, {\n    key: \"shouldSkipValidation\",\n    value: function shouldSkipValidation(data, dirty, row) {\n      // Nested components with no input should not be validated.\n      if (!this.component.input) {\n        return true;\n      } else {\n        return _get(_getPrototypeOf(NestedComponent.prototype), \"shouldSkipValidation\", this).call(this, data, dirty, row);\n      }\n    }\n  }, {\n    key: \"checkData\",\n    value: function checkData(data, flags, row, components) {\n      if (this.builderMode) {\n        return true;\n      }\n\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      components = components && _lodash.default.isArray(components) ? components : this.getComponents();\n      var isValid = components.reduce(function (valid, comp) {\n        return comp.checkData(data, flags, row) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkData\", this).call(this, data, flags, row));\n      this.checkModal(isValid, this.isDirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      // check conditions of parent component first, because it may influence on visibility of it's children\n      var check = _get(_getPrototypeOf(NestedComponent.prototype), \"checkConditions\", this).call(this, data, flags, row); //row data of parent component not always corresponds to row of nested components, use comp.data as row data for children instead\n\n\n      this.getComponents().forEach(function (comp) {\n        return comp.checkConditions(data, flags, comp.data);\n      });\n      return check;\n    }\n  }, {\n    key: \"clearOnHide\",\n    value: function clearOnHide(show) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clearOnHide\", this).call(this, show);\n\n      if (this.component.clearOnHide) {\n        if (this.allowData && !this.hasValue()) {\n          this.dataValue = this.defaultValue;\n        }\n\n        if (this.hasValue()) {\n          this.restoreComponentsContext();\n        }\n      }\n\n      this.getComponents().forEach(function (component) {\n        return component.clearOnHide(show);\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this9 = this;\n\n      this.getComponents().forEach(function (component) {\n        return component.data = _this9.dataValue;\n      });\n    }\n    /**\n     * Allow components to hook into the next page trigger to perform their own logic.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforePage(next);\n      }));\n    }\n    /**\n     * Allow components to hook into the submission to provide their own async data.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      // Do not iterate into children and calculateValues if this nested component is conditionally hidden.\n      if (!this.conditionallyVisible()) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, comp) {\n        return comp.calculateValue(data, flags, row) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"calculateValue\", this).call(this, data, flags, row));\n    }\n  }, {\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      return this.pages.length - 1 === this.page;\n    }\n  }, {\n    key: \"isValid\",\n    value: function isValid(data, dirty) {\n      return this.getComponents().reduce(function (valid, comp) {\n        return comp.isValid(data, dirty) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"isValid\", this).call(this, data, dirty));\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      var isValid = this.getComponents().reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row, silentCheck) && check;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkValidity\", this).call(this, data, dirty, row, silentCheck));\n      this.checkModal(isValid, dirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkAsyncValidity\",\n    value: function checkAsyncValidity(data, dirty, row, silentCheck) {\n      var _this10 = this;\n\n      return this.ready.then(function () {\n        var promises = [_get(_getPrototypeOf(NestedComponent.prototype), \"checkAsyncValidity\", _this10).call(_this10, data, dirty, row, silentCheck)];\n\n        _this10.eachComponent(function (component) {\n          return promises.push(component.checkAsyncValidity(data, dirty, row, silentCheck));\n        });\n\n        return _nativePromiseOnly.default.all(promises).then(function (results) {\n          return results.reduce(function (valid, result) {\n            return valid && result;\n          }, true);\n        });\n      });\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.setPristine(pristine);\n      });\n    }\n  }, {\n    key: \"isPristine\",\n    get: function get() {\n      return this.pristine && this.getComponents().every(function (c) {\n        return c.isPristine;\n      });\n    }\n  }, {\n    key: \"isDirty\",\n    get: function get() {\n      return this.dirty && this.getComponents().every(function (c) {\n        return c.isDirty;\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.components.forEach(function (component) {\n        component.detach();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.components.forEach(function (component) {\n        component.clear();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clear\", this).call(this);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.destroyComponents();\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents() {\n      var _this11 = this;\n\n      var components = this.getComponents().slice();\n      components.forEach(function (comp) {\n        return _this11.removeComponent(comp, _this11.components);\n      });\n      this.components = [];\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var thisErrors = this.error ? [this.error] : [];\n      return this.getComponents().reduce(function (errors, comp) {\n        return errors.concat(comp.errors || []);\n      }, thisErrors).filter(function (err) {\n        return err.level !== 'hidden';\n      });\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      return this.data;\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"resetValue\", this).call(this);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.dataReady;\n      }));\n    }\n  }, {\n    key: \"setNestedValue\",\n    value: function setNestedValue(component, value) {\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      component._data = this.componentContext(component);\n\n      if (component.type === 'button') {\n        return false;\n      }\n\n      if (component.type === 'components') {\n        return component.setValue(value, flags);\n      } else if (value && component.hasValue(value)) {\n        return component.setValue(_lodash.default.get(value, component.key), flags);\n      } else if ((!this.rootPristine || component.visible) && component.shouldAddDefaultValue) {\n        flags.noValidate = !flags.dirty;\n        flags.resetValue = true;\n        return component.setValue(component.defaultValue, flags);\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this12 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, component) {\n        return _this12.setNestedValue(component, value, flags, changed) || changed;\n      }, false);\n    }\n  }, {\n    key: \"lazyLoad\",\n    get: function get() {\n      var _this$component$lazyL;\n\n      return (_this$component$lazyL = this.component.lazyLoad) !== null && _this$component$lazyL !== void 0 ? _this$component$lazyL : false;\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len = arguments.length, extend = new Array(_len), _key = 0; _key < _len; _key++) {\n        extend[_key] = arguments[_key];\n      }\n\n      return _Field2.default.schema.apply(_Field2.default, [{\n        tree: false,\n        lazyLoad: false\n      }].concat(extend));\n    }\n  }]);\n\n  return NestedComponent;\n}(_Field2.default);\n\nexports.default = NestedComponent;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/jag-servebc/forms-flow-ai/forms-flow-web/node_modules/formiojs/components/_classes/nested/NestedComponent.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","_Field2","_Components","_nativePromiseOnly","_utils","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","set","property","receiver","Reflect","base","_superPropBase","desc","getOwnPropertyDescriptor","call","_defineProperty","_set","isStrict","s","Error","_get","get","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","NestedComponent","_Field","_super","component","options","data","_this","type","_collapsed","collapsed","schema","components","uniqBy","getComponents","map","collapse","promise","redraw","pristine","checkValidity","visibilityChanged","_visible","isVisible","visible","forceShow","show","forceHide","hide","forEach","parentVisible","conditionallyVisible","error","clearOnHide","_this2","disabled","parentDisabled","_this3","all","ready","currentForm","_rowIndex","eachComponent","rowIndex","componentContext","_data","_this4","everyComponent","fn","each","index","hasComponent","comp","flattenComponents","flattenAs","getComponent","path","originalPath","getStringFromComponentPath","getArrayFromComponentPath","pathStr","newPath","clone","shift","remainingPath","possibleComp","isNumber","isString","matchPath","hasInput","includes","getComponentById","id","calculateComponentPath","thisPath","allowData","parent","row","concat","Number","parseInt","_parentPath","shouldIncludeSubFormPath","createComponent","before","_options","root","localRoot","skipInit","isInputComponent","init","internal","findIndex","splice","push","getContainer","element","addComponents","_this5","hook","componentComponents","addComponent","noAdd","parentPath","beforeFocus","render","children","renderTemplate","templateName","renderComponents","nestedKey","pdf","attach","_this6","superPromise","loadRefs","header","childPromise","resolve","refs","attachComponents","collapsible","addEventListener","keyCode","preventDefault","container","promises","Array","slice","child","getAttribute","removeComponent","destroy","remove","removeComponentByKey","_this7","removeComponentById","_this8","updateValue","flags","undefined","reduce","changed","shouldSkipValidation","dirty","input","checkData","builderMode","rootValue","isArray","isValid","valid","checkModal","isDirty","checkConditions","check","hasValue","dataValue","defaultValue","restoreComponentsContext","_this9","beforePage","next","beforeSubmit","calculateValue","isLastPage","pages","page","silentCheck","checkCondition","setCustomValidity","checkAsyncValidity","_this10","then","results","setPristine","every","c","isPristine","detach","clear","destroyComponents","_this11","thisErrors","errors","filter","err","level","getValue","resetValue","dataReady","setNestedValue","setValue","rootPristine","shouldAddDefaultValue","noValidate","_this12","_this$component$lazyL","lazyLoad","_len","extend","_key","tree"],"mappings":"AAAA;;AAEA,SAASA,OAAT,CAAiBC,GAAjB,EAAsB;AAAE;;AAA2B,MAAI,OAAOC,MAAP,KAAkB,UAAlB,IAAgC,OAAOA,MAAM,CAACC,QAAd,KAA2B,QAA/D,EAAyE;AAAEH,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiBC,GAAjB,EAAsB;AAAE,aAAO,OAAOA,GAAd;AAAoB,KAAtD;AAAyD,GAApI,MAA0I;AAAED,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiBC,GAAjB,EAAsB;AAAE,aAAOA,GAAG,IAAI,OAAOC,MAAP,KAAkB,UAAzB,IAAuCD,GAAG,CAACG,WAAJ,KAAoBF,MAA3D,IAAqED,GAAG,KAAKC,MAAM,CAACG,SAApF,GAAgG,QAAhG,GAA2G,OAAOJ,GAAzH;AAA+H,KAAjK;AAAoK;;AAAC,SAAOD,OAAO,CAACC,GAAD,CAAd;AAAsB;;AAE1XK,OAAO,CAAC,yCAAD,CAAP;;AAEAA,OAAO,CAAC,mCAAD,CAAP;;AAEAA,OAAO,CAAC,0DAAD,CAAP;;AAEAA,OAAO,CAAC,mCAAD,CAAP;;AAEAA,OAAO,CAAC,8BAAD,CAAP;;AAEAA,OAAO,CAAC,0CAAD,CAAP;;AAEAA,OAAO,CAAC,wCAAD,CAAP;;AAEAA,OAAO,CAAC,uCAAD,CAAP;;AAEAA,OAAO,CAAC,sCAAD,CAAP;;AAEAA,OAAO,CAAC,uCAAD,CAAP;;AAEAA,OAAO,CAAC,iDAAD,CAAP;;AAEAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,OAAR,GAAkB,KAAK,CAAvB;;AAEAL,OAAO,CAAC,iCAAD,CAAP;;AAEAA,OAAO,CAAC,iDAAD,CAAP;;AAEAA,OAAO,CAAC,sCAAD,CAAP;;AAEAA,OAAO,CAAC,uCAAD,CAAP;;AAEAA,OAAO,CAAC,wCAAD,CAAP;;AAEAA,OAAO,CAAC,0CAAD,CAAP;;AAEAA,OAAO,CAAC,oCAAD,CAAP;;AAEAA,OAAO,CAAC,wCAAD,CAAP;;AAEAA,OAAO,CAAC,oCAAD,CAAP;;AAEAA,OAAO,CAAC,mCAAD,CAAP;;AAEAA,OAAO,CAAC,oCAAD,CAAP;;AAEAA,OAAO,CAAC,+CAAD,CAAP;;AAEA,IAAIM,OAAO,GAAGC,sBAAsB,CAACP,OAAO,CAAC,QAAD,CAAR,CAApC;;AAEA,IAAIQ,OAAO,GAAGD,sBAAsB,CAACP,OAAO,CAAC,gBAAD,CAAR,CAApC;;AAEA,IAAIS,WAAW,GAAGF,sBAAsB,CAACP,OAAO,CAAC,kBAAD,CAAR,CAAxC;;AAEA,IAAIU,kBAAkB,GAAGH,sBAAsB,CAACP,OAAO,CAAC,qBAAD,CAAR,CAA/C;;AAEA,IAAIW,MAAM,GAAGX,OAAO,CAAC,sBAAD,CAApB;;AAEA,SAASO,sBAAT,CAAgCZ,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACiB,UAAX,GAAwBjB,GAAxB,GAA8B;AAAEU,IAAAA,OAAO,EAAEV;AAAX,GAArC;AAAwD;;AAE/F,SAASkB,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAAE,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIC,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASC,iBAAT,CAA2BC,MAA3B,EAAmCC,KAAnC,EAA0C;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAAK,CAACE,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AAAE,QAAIE,UAAU,GAAGH,KAAK,CAACC,CAAD,CAAtB;AAA2BE,IAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,IAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,QAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4BxB,IAAAA,MAAM,CAACC,cAAP,CAAsBgB,MAAtB,EAA8BI,UAAU,CAACI,GAAzC,EAA8CJ,UAA9C;AAA4D;AAAE;;AAE7T,SAASK,YAAT,CAAsBZ,WAAtB,EAAmCa,UAAnC,EAA+CC,WAA/C,EAA4D;AAAE,MAAID,UAAJ,EAAgBX,iBAAiB,CAACF,WAAW,CAAChB,SAAb,EAAwB6B,UAAxB,CAAjB;AAAsD,MAAIC,WAAJ,EAAiBZ,iBAAiB,CAACF,WAAD,EAAcc,WAAd,CAAjB;AAA6C,SAAOd,WAAP;AAAqB;;AAEvN,SAASe,GAAT,CAAaZ,MAAb,EAAqBa,QAArB,EAA+B3B,KAA/B,EAAsC4B,QAAtC,EAAgD;AAAE,MAAI,OAAOC,OAAP,KAAmB,WAAnB,IAAkCA,OAAO,CAACH,GAA9C,EAAmD;AAAEA,IAAAA,GAAG,GAAGG,OAAO,CAACH,GAAd;AAAoB,GAAzE,MAA+E;AAAEA,IAAAA,GAAG,GAAG,SAASA,GAAT,CAAaZ,MAAb,EAAqBa,QAArB,EAA+B3B,KAA/B,EAAsC4B,QAAtC,EAAgD;AAAE,UAAIE,IAAI,GAAGC,cAAc,CAACjB,MAAD,EAASa,QAAT,CAAzB;;AAA6C,UAAIK,IAAJ;;AAAU,UAAIF,IAAJ,EAAU;AAAEE,QAAAA,IAAI,GAAGnC,MAAM,CAACoC,wBAAP,CAAgCH,IAAhC,EAAsCH,QAAtC,CAAP;;AAAwD,YAAIK,IAAI,CAACN,GAAT,EAAc;AAAEM,UAAAA,IAAI,CAACN,GAAL,CAASQ,IAAT,CAAcN,QAAd,EAAwB5B,KAAxB;AAAgC,iBAAO,IAAP;AAAc,SAA9D,MAAoE,IAAI,CAACgC,IAAI,CAACX,QAAV,EAAoB;AAAE,iBAAO,KAAP;AAAe;AAAE;;AAACW,MAAAA,IAAI,GAAGnC,MAAM,CAACoC,wBAAP,CAAgCL,QAAhC,EAA0CD,QAA1C,CAAP;;AAA4D,UAAIK,IAAJ,EAAU;AAAE,YAAI,CAACA,IAAI,CAACX,QAAV,EAAoB;AAAE,iBAAO,KAAP;AAAe;;AAACW,QAAAA,IAAI,CAAChC,KAAL,GAAaA,KAAb;AAAoBH,QAAAA,MAAM,CAACC,cAAP,CAAsB8B,QAAtB,EAAgCD,QAAhC,EAA0CK,IAA1C;AAAkD,OAAxH,MAA8H;AAAEG,QAAAA,eAAe,CAACP,QAAD,EAAWD,QAAX,EAAqB3B,KAArB,CAAf;AAA6C;;AAAC,aAAO,IAAP;AAAc,KAAvhB;AAA0hB;;AAAC,SAAO0B,GAAG,CAACZ,MAAD,EAASa,QAAT,EAAmB3B,KAAnB,EAA0B4B,QAA1B,CAAV;AAAgD;;AAE9sB,SAASQ,IAAT,CAActB,MAAd,EAAsBa,QAAtB,EAAgC3B,KAAhC,EAAuC4B,QAAvC,EAAiDS,QAAjD,EAA2D;AAAE,MAAIC,CAAC,GAAGZ,GAAG,CAACZ,MAAD,EAASa,QAAT,EAAmB3B,KAAnB,EAA0B4B,QAAQ,IAAId,MAAtC,CAAX;;AAA0D,MAAI,CAACwB,CAAD,IAAMD,QAAV,EAAoB;AAAE,UAAM,IAAIE,KAAJ,CAAU,wBAAV,CAAN;AAA4C;;AAAC,SAAOvC,KAAP;AAAe;;AAEzM,SAASmC,eAAT,CAAyB5C,GAAzB,EAA8B+B,GAA9B,EAAmCtB,KAAnC,EAA0C;AAAE,MAAIsB,GAAG,IAAI/B,GAAX,EAAgB;AAAEM,IAAAA,MAAM,CAACC,cAAP,CAAsBP,GAAtB,EAA2B+B,GAA3B,EAAgC;AAAEtB,MAAAA,KAAK,EAAEA,KAAT;AAAgBmB,MAAAA,UAAU,EAAE,IAA5B;AAAkCC,MAAAA,YAAY,EAAE,IAAhD;AAAsDC,MAAAA,QAAQ,EAAE;AAAhE,KAAhC;AAA0G,GAA5H,MAAkI;AAAE9B,IAAAA,GAAG,CAAC+B,GAAD,CAAH,GAAWtB,KAAX;AAAmB;;AAAC,SAAOT,GAAP;AAAa;;AAEjN,SAASiD,IAAT,CAAc1B,MAAd,EAAsBa,QAAtB,EAAgCC,QAAhC,EAA0C;AAAE,MAAI,OAAOC,OAAP,KAAmB,WAAnB,IAAkCA,OAAO,CAACY,GAA9C,EAAmD;AAAED,IAAAA,IAAI,GAAGX,OAAO,CAACY,GAAf;AAAqB,GAA1E,MAAgF;AAAED,IAAAA,IAAI,GAAG,SAASA,IAAT,CAAc1B,MAAd,EAAsBa,QAAtB,EAAgCC,QAAhC,EAA0C;AAAE,UAAIE,IAAI,GAAGC,cAAc,CAACjB,MAAD,EAASa,QAAT,CAAzB;;AAA6C,UAAI,CAACG,IAAL,EAAW;AAAQ,UAAIE,IAAI,GAAGnC,MAAM,CAACoC,wBAAP,CAAgCH,IAAhC,EAAsCH,QAAtC,CAAX;;AAA4D,UAAIK,IAAI,CAACS,GAAT,EAAc;AAAE,eAAOT,IAAI,CAACS,GAAL,CAASP,IAAT,CAAcN,QAAd,CAAP;AAAiC;;AAAC,aAAOI,IAAI,CAAChC,KAAZ;AAAoB,KAArP;AAAwP;;AAAC,SAAOwC,IAAI,CAAC1B,MAAD,EAASa,QAAT,EAAmBC,QAAQ,IAAId,MAA/B,CAAX;AAAoD;;AAE3a,SAASiB,cAAT,CAAwBW,MAAxB,EAAgCf,QAAhC,EAA0C;AAAE,SAAO,CAAC9B,MAAM,CAACF,SAAP,CAAiBgD,cAAjB,CAAgCT,IAAhC,CAAqCQ,MAArC,EAA6Cf,QAA7C,CAAR,EAAgE;AAAEe,IAAAA,MAAM,GAAGE,eAAe,CAACF,MAAD,CAAxB;AAAkC,QAAIA,MAAM,KAAK,IAAf,EAAqB;AAAQ;;AAAC,SAAOA,MAAP;AAAgB;;AAE9L,SAASG,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAInC,SAAJ,CAAc,oDAAd,CAAN;AAA4E;;AAACkC,EAAAA,QAAQ,CAACnD,SAAT,GAAqBE,MAAM,CAACmD,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAACpD,SAAvC,EAAkD;AAAED,IAAAA,WAAW,EAAE;AAAEM,MAAAA,KAAK,EAAE8C,QAAT;AAAmBzB,MAAAA,QAAQ,EAAE,IAA7B;AAAmCD,MAAAA,YAAY,EAAE;AAAjD;AAAf,GAAlD,CAArB;AAAkJ,MAAI2B,UAAJ,EAAgBE,eAAe,CAACH,QAAD,EAAWC,UAAX,CAAf;AAAwC;;AAEjY,SAASE,eAAT,CAAyBC,CAAzB,EAA4BC,CAA5B,EAA+B;AAAEF,EAAAA,eAAe,GAAGpD,MAAM,CAACuD,cAAP,IAAyB,SAASH,eAAT,CAAyBC,CAAzB,EAA4BC,CAA5B,EAA+B;AAAED,IAAAA,CAAC,CAACG,SAAF,GAAcF,CAAd;AAAiB,WAAOD,CAAP;AAAW,GAAxG;;AAA0G,SAAOD,eAAe,CAACC,CAAD,EAAIC,CAAJ,CAAtB;AAA+B;;AAE1K,SAASG,YAAT,CAAsBC,OAAtB,EAA+B;AAAE,MAAIC,yBAAyB,GAAGC,yBAAyB,EAAzD;;AAA6D,SAAO,SAASC,oBAAT,GAAgC;AAAE,QAAIC,KAAK,GAAGf,eAAe,CAACW,OAAD,CAA3B;AAAA,QAAsCK,MAAtC;;AAA8C,QAAIJ,yBAAJ,EAA+B;AAAE,UAAIK,SAAS,GAAGjB,eAAe,CAAC,IAAD,CAAf,CAAsBlD,WAAtC;;AAAmDkE,MAAAA,MAAM,GAAG/B,OAAO,CAACiC,SAAR,CAAkBH,KAAlB,EAAyBI,SAAzB,EAAoCF,SAApC,CAAT;AAA0D,KAA9I,MAAoJ;AAAED,MAAAA,MAAM,GAAGD,KAAK,CAACK,KAAN,CAAY,IAAZ,EAAkBD,SAAlB,CAAT;AAAwC;;AAAC,WAAOE,0BAA0B,CAAC,IAAD,EAAOL,MAAP,CAAjC;AAAkD,GAAxU;AAA2U;;AAEza,SAASK,0BAAT,CAAoCC,IAApC,EAA0ChC,IAA1C,EAAgD;AAAE,MAAIA,IAAI,KAAK5C,OAAO,CAAC4C,IAAD,CAAP,KAAkB,QAAlB,IAA8B,OAAOA,IAAP,KAAgB,UAAnD,CAAR,EAAwE;AAAE,WAAOA,IAAP;AAAc,GAAxF,MAA8F,IAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAE,UAAM,IAAItB,SAAJ,CAAc,0DAAd,CAAN;AAAkF;;AAAC,SAAOuD,sBAAsB,CAACD,IAAD,CAA7B;AAAsC;;AAEhS,SAASC,sBAAT,CAAgCD,IAAhC,EAAsC;AAAE,MAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAE,UAAM,IAAIE,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOF,IAAP;AAAc;;AAEtK,SAAST,yBAAT,GAAqC;AAAE,MAAI,OAAO5B,OAAP,KAAmB,WAAnB,IAAkC,CAACA,OAAO,CAACiC,SAA/C,EAA0D,OAAO,KAAP;AAAc,MAAIjC,OAAO,CAACiC,SAAR,CAAkBO,IAAtB,EAA4B,OAAO,KAAP;AAAc,MAAI,OAAOC,KAAP,KAAiB,UAArB,EAAiC,OAAO,IAAP;;AAAa,MAAI;AAAEC,IAAAA,OAAO,CAAC5E,SAAR,CAAkB6E,OAAlB,CAA0BtC,IAA1B,CAA+BL,OAAO,CAACiC,SAAR,CAAkBS,OAAlB,EAA2B,EAA3B,EAA+B,YAAY,CAAE,CAA7C,CAA/B;AAAgF,WAAO,IAAP;AAAc,GAApG,CAAqG,OAAOE,CAAP,EAAU;AAAE,WAAO,KAAP;AAAe;AAAE;;AAEzU,SAAS7B,eAAT,CAAyBM,CAAzB,EAA4B;AAAEN,EAAAA,eAAe,GAAG/C,MAAM,CAACuD,cAAP,GAAwBvD,MAAM,CAAC6E,cAA/B,GAAgD,SAAS9B,eAAT,CAAyBM,CAAzB,EAA4B;AAAE,WAAOA,CAAC,CAACG,SAAF,IAAexD,MAAM,CAAC6E,cAAP,CAAsBxB,CAAtB,CAAtB;AAAiD,GAAjJ;AAAmJ,SAAON,eAAe,CAACM,CAAD,CAAtB;AAA4B;;AAE7M,IAAIyB,eAAe,GAAG,aAAa,UAAUC,MAAV,EAAkB;AACnD/B,EAAAA,SAAS,CAAC8B,eAAD,EAAkBC,MAAlB,CAAT;;AAEA,MAAIC,MAAM,GAAGvB,YAAY,CAACqB,eAAD,CAAzB;;AAEA,WAASA,eAAT,CAAyBG,SAAzB,EAAoCC,OAApC,EAA6CC,IAA7C,EAAmD;AACjD,QAAIC,KAAJ;;AAEAxE,IAAAA,eAAe,CAAC,IAAD,EAAOkE,eAAP,CAAf;;AAEAM,IAAAA,KAAK,GAAGJ,MAAM,CAAC3C,IAAP,CAAY,IAAZ,EAAkB4C,SAAlB,EAA6BC,OAA7B,EAAsCC,IAAtC,CAAR;AACAC,IAAAA,KAAK,CAACC,IAAN,GAAa,YAAb;AACAD,IAAAA,KAAK,CAACE,UAAN,GAAmB,CAAC,CAACF,KAAK,CAACH,SAAN,CAAgBM,SAArC;AACA,WAAOH,KAAP;AACD;;AAED1D,EAAAA,YAAY,CAACoD,eAAD,EAAkB,CAAC;AAC7BrD,IAAAA,GAAG,EAAE,eADwB;AAE7BmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOkC,eAAe,CAACU,MAAhB,EAAP;AACD;AAJ4B,GAAD,EAK3B;AACD/D,IAAAA,GAAG,EAAE,QADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,UAAI4C,MAAM,GAAG7C,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,QAA7C,EAAuD,IAAvD,CAAjB;;AAEA,UAAI2F,UAAU,GAAGpF,OAAO,CAACD,OAAR,CAAgBsF,MAAhB,CAAuB,KAAKC,aAAL,EAAvB,EAA6C,eAA7C,CAAjB;;AAEAH,MAAAA,MAAM,CAACC,UAAP,GAAoBpF,OAAO,CAACD,OAAR,CAAgBwF,GAAhB,CAAoBH,UAApB,EAAgC,QAAhC,CAApB;AACA,aAAOD,MAAP;AACD;AATA,GAL2B,EAe3B;AACD/D,IAAAA,GAAG,EAAE,WADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAK0C,UAAZ;AACD,KAJA;AAKDzD,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAa1B,KAAb,EAAoB;AACvB,WAAKmF,UAAL,GAAkBnF,KAAlB;AACA,WAAK0F,QAAL,CAAc1F,KAAd;AACD;AARA,GAf2B,EAwB3B;AACDsB,IAAAA,GAAG,EAAE,UADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS0F,QAAT,CAAkB1F,KAAlB,EAAyB;AAC9B,UAAI2F,OAAO,GAAG,KAAKC,MAAL,EAAd;;AAEA,UAAI,CAAC5F,KAAD,IAAU,CAAC,KAAK6F,QAApB,EAA8B;AAC5B,aAAKC,aAAL,CAAmB,KAAKd,IAAxB,EAA8B,IAA9B;AACD;;AAED,aAAOW,OAAP;AACD;AAVA,GAxB2B,EAmC3B;AACDrE,IAAAA,GAAG,EAAE,SADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOD,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,SAA7C,EAAwD,IAAxD,CAAX;AACD,KAJA;AAKD+B,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAa1B,KAAb,EAAoB;AACvB;AACA;AACA;AACA,UAAI+F,iBAAiB,GAAG,KAAKC,QAAL,KAAkBhG,KAA1C;AACA,WAAKgG,QAAL,GAAgBhG,KAAhB;AACA,UAAIiG,SAAS,GAAG,KAAKC,OAArB;AACA,UAAIC,SAAS,GAAG,KAAKpB,OAAL,CAAaqB,IAAb,IAAqB,KAAKrB,OAAL,CAAaqB,IAAb,CAAkB,KAAKtB,SAAL,CAAexD,GAAjC,CAArC;AACA,UAAI+E,SAAS,GAAG,KAAKtB,OAAL,CAAauB,IAAb,IAAqB,KAAKvB,OAAL,CAAauB,IAAb,CAAkB,KAAKxB,SAAL,CAAexD,GAAjC,CAArC;AACA,WAAKgE,UAAL,CAAgBiB,OAAhB,CAAwB,UAAUzB,SAAV,EAAqB;AAC3C;AACA;AACAA,QAAAA,SAAS,CAAC0B,aAAV,GAA0BP,SAA1B;AACA,YAAIQ,oBAAoB,GAAG3B,SAAS,CAAC2B,oBAAV,EAA3B;;AAEA,YAAIN,SAAS,IAAIM,oBAAjB,EAAuC;AACrC3B,UAAAA,SAAS,CAACoB,OAAV,GAAoB,IAApB;AACD,SAFD,MAEO,IAAIG,SAAS,IAAI,CAACJ,SAAd,IAA2B,CAACQ,oBAAhC,EAAsD;AAC3D3B,UAAAA,SAAS,CAACoB,OAAV,GAAoB,KAApB;AACD,SAV0C,CAUzC;;;AAGF,YAAI,CAACpB,SAAS,CAACoB,OAAf,EAAwB;AACtBpB,UAAAA,SAAS,CAAC4B,KAAV,GAAkB,EAAlB;AACD;AACF,OAhBD;;AAkBA,UAAIX,iBAAJ,EAAuB;AACrB,aAAKY,WAAL;AACA,aAAKf,MAAL;AACD;AACF;AApCA,GAnC2B,EAwE3B;AACDtE,IAAAA,GAAG,EAAE,eADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOD,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,eAA7C,EAA8D,IAA9D,CAAX;AACD,KAJA;AAKD+B,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAa1B,KAAb,EAAoB;AACvB,UAAI4G,MAAM,GAAG,IAAb;;AAEAxE,MAAAA,IAAI,CAACQ,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,eAA7C,EAA8DK,KAA9D,EAAqE,IAArE,EAA2E,IAA3E,CAAJ;;AAEA,WAAKsF,UAAL,CAAgBiB,OAAhB,CAAwB,UAAUzB,SAAV,EAAqB;AAC3C,eAAOA,SAAS,CAAC0B,aAAV,GAA0BI,MAAM,CAACV,OAAxC;AACD,OAFD;AAGD;AAbA,GAxE2B,EAsF3B;AACD5E,IAAAA,GAAG,EAAE,UADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOD,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,UAA7C,EAAyD,IAAzD,CAAX;AACD,KAJA;AAKD+B,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAamF,QAAb,EAAuB;AAC1BzE,MAAAA,IAAI,CAACQ,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,UAA7C,EAAyDkH,QAAzD,EAAmE,IAAnE,EAAyE,IAAzE,CAAJ;;AAEA,WAAKvB,UAAL,CAAgBiB,OAAhB,CAAwB,UAAUzB,SAAV,EAAqB;AAC3C,eAAOA,SAAS,CAACgC,cAAV,GAA2BD,QAAlC;AACD,OAFD;AAGD;AAXA,GAtF2B,EAkG3B;AACDvF,IAAAA,GAAG,EAAE,gBADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOD,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,gBAA7C,EAA+D,IAA/D,CAAX;AACD,KAJA;AAKD+B,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAa1B,KAAb,EAAoB;AACvB,UAAI+G,MAAM,GAAG,IAAb;;AAEA3E,MAAAA,IAAI,CAACQ,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,gBAA7C,EAA+DK,KAA/D,EAAsE,IAAtE,EAA4E,IAA5E,CAAJ;;AAEA,WAAKsF,UAAL,CAAgBiB,OAAhB,CAAwB,UAAUzB,SAAV,EAAqB;AAC3CA,QAAAA,SAAS,CAACgC,cAAV,GAA2BC,MAAM,CAACF,QAAlC;AACD,OAFD;AAGD;AAbA,GAlG2B,EAgH3B;AACDvF,IAAAA,GAAG,EAAE,OADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOnC,kBAAkB,CAACL,OAAnB,CAA2B+G,GAA3B,CAA+B,KAAKxB,aAAL,GAAqBC,GAArB,CAAyB,UAAUX,SAAV,EAAqB;AAClF,eAAOA,SAAS,CAACmC,KAAjB;AACD,OAFqC,CAA/B,CAAP;AAGD;AANA,GAhH2B,EAuH3B;AACD3F,IAAAA,GAAG,EAAE,aADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOD,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,aAA7C,EAA4D,IAA5D,CAAX;AACD,KAJA;AAKD+B,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAahB,QAAb,EAAuB;AAC1B0B,MAAAA,IAAI,CAACQ,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,aAA7C,EAA4De,QAA5D,EAAsE,IAAtE,EAA4E,IAA5E,CAAJ;;AAEA,WAAK8E,aAAL,GAAqBe,OAArB,CAA6B,UAAUzB,SAAV,EAAqB;AAChDA,QAAAA,SAAS,CAACoC,WAAV,GAAwBxG,QAAxB;AACD,OAFD;AAGD;AAXA,GAvH2B,EAmI3B;AACDY,IAAAA,GAAG,EAAE,UADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAK0E,SAAZ;AACD,KAJA;AAKDzF,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAa1B,KAAb,EAAoB;AACvB,WAAKmH,SAAL,GAAiBnH,KAAjB;AACA,WAAKoH,aAAL,CAAmB,UAAUtC,SAAV,EAAqB;AACtCA,QAAAA,SAAS,CAACuC,QAAV,GAAqBrH,KAArB;AACD,OAFD;AAGD;AAVA,GAnI2B,EA8I3B;AACDsB,IAAAA,GAAG,EAAE,kBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASsH,gBAAT,GAA4B;AACjC,aAAO,KAAKC,KAAZ;AACD;AAJA,GA9I2B,EAmJ3B;AACDjG,IAAAA,GAAG,EAAE,MADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAK8E,KAAZ;AACD,KAJA;AAKD7F,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAa1B,KAAb,EAAoB;AACvB,UAAIwH,MAAM,GAAG,IAAb;;AAEA,WAAKD,KAAL,GAAavH,KAAb;AACA,WAAKoH,aAAL,CAAmB,UAAUtC,SAAV,EAAqB;AACtCA,QAAAA,SAAS,CAACE,IAAV,GAAiBwC,MAAM,CAACF,gBAAP,CAAwBxC,SAAxB,CAAjB;AACD,OAFD;AAGD;AAZA,GAnJ2B,EAgK3B;AACDxD,IAAAA,GAAG,EAAE,eADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASwF,aAAT,GAAyB;AAC9B,aAAO,KAAKF,UAAL,IAAmB,EAA1B;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;AAVK,GAhK2B,EA4K3B;AACDhE,IAAAA,GAAG,EAAE,gBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASyH,cAAT,CAAwBC,EAAxB,EAA4B3C,OAA5B,EAAqC;AAC1C,UAAIO,UAAU,GAAG,KAAKE,aAAL,EAAjB;;AAEAtF,MAAAA,OAAO,CAACD,OAAR,CAAgB0H,IAAhB,CAAqBrC,UAArB,EAAiC,UAAUR,SAAV,EAAqB8C,KAArB,EAA4B;AAC3D,YAAIF,EAAE,CAAC5C,SAAD,EAAYQ,UAAZ,EAAwBsC,KAAxB,CAAF,KAAqC,KAAzC,EAAgD;AAC9C,iBAAO,KAAP;AACD;;AAED,YAAI,OAAO9C,SAAS,CAAC2C,cAAjB,KAAoC,UAAxC,EAAoD;AAClD,cAAI3C,SAAS,CAAC2C,cAAV,CAAyBC,EAAzB,EAA6B3C,OAA7B,MAA0C,KAA9C,EAAqD;AACnD,mBAAO,KAAP;AACD;AACF;AACF,OAVD;AAWD;AAhBA,GA5K2B,EA6L3B;AACDzD,IAAAA,GAAG,EAAE,cADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS6H,YAAT,CAAsB/C,SAAtB,EAAiC;AACtC,UAAIlB,MAAM,GAAG,KAAb;AACA,WAAK6D,cAAL,CAAoB,UAAUK,IAAV,EAAgB;AAClC,YAAIA,IAAI,KAAKhD,SAAb,EAAwB;AACtBlB,UAAAA,MAAM,GAAG,IAAT;AACA,iBAAO,KAAP;AACD;AACF,OALD;AAMA,aAAOA,MAAP;AACD;AAXA,GA7L2B,EAyM3B;AACDtC,IAAAA,GAAG,EAAE,mBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS+H,iBAAT,GAA6B;AAClC,UAAInE,MAAM,GAAG,EAAb;AACA,WAAK6D,cAAL,CAAoB,UAAU3C,SAAV,EAAqB;AACvClB,QAAAA,MAAM,CAACkB,SAAS,CAACA,SAAV,CAAoBkD,SAApB,IAAiClD,SAAS,CAACxD,GAA5C,CAAN,GAAyDwD,SAAzD;AACD,OAFD;AAGA,aAAOlB,MAAP;AACD;AACD;AACJ;AACA;AACA;AACA;;AAbK,GAzM2B,EAwN3B;AACDtC,IAAAA,GAAG,EAAE,eADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASoH,aAAT,CAAuBM,EAAvB,EAA2B;AAChCxH,MAAAA,OAAO,CAACD,OAAR,CAAgB0H,IAAhB,CAAqB,KAAKnC,aAAL,EAArB,EAA2C,UAAUV,SAAV,EAAqB8C,KAArB,EAA4B;AACrE,YAAIF,EAAE,CAAC5C,SAAD,EAAY8C,KAAZ,CAAF,KAAyB,KAA7B,EAAoC;AAClC,iBAAO,KAAP;AACD;AACF,OAJD;AAKD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAhBK,GAxN2B,EA0O3B;AACDtG,IAAAA,GAAG,EAAE,cADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASiI,YAAT,CAAsBC,IAAtB,EAA4BR,EAA5B,EAAgCS,YAAhC,EAA8C;AACnDA,MAAAA,YAAY,GAAGA,YAAY,IAAI,CAAC,GAAG5H,MAAM,CAAC6H,0BAAX,EAAuCF,IAAvC,CAA/B;AACAA,MAAAA,IAAI,GAAG,CAAC,GAAG3H,MAAM,CAAC8H,yBAAX,EAAsCH,IAAtC,CAAP;AACA,UAAII,OAAO,GAAGH,YAAd;;AAEA,UAAII,OAAO,GAAGrI,OAAO,CAACD,OAAR,CAAgBuI,KAAhB,CAAsBN,IAAtB,CAAd;;AAEA,UAAI5G,GAAG,GAAGiH,OAAO,CAACE,KAAR,EAAV;AACA,UAAIC,aAAa,GAAGH,OAApB;AACA,UAAIT,IAAI,GAAG,IAAX;AACA,UAAIa,YAAY,GAAG,IAAnB;;AAEA,UAAIzI,OAAO,CAACD,OAAR,CAAgB2I,QAAhB,CAAyBtH,GAAzB,CAAJ,EAAmC;AACjCA,QAAAA,GAAG,GAAGoH,aAAa,CAACD,KAAd,EAAN;AACD;;AAED,UAAI,CAACvI,OAAO,CAACD,OAAR,CAAgB4I,QAAhB,CAAyBvH,GAAzB,CAAL,EAAoC;AAClC,eAAOwG,IAAP;AACD;;AAED,WAAKL,cAAL,CAAoB,UAAU3C,SAAV,EAAqBQ,UAArB,EAAiC;AACnD,YAAIwD,SAAS,GAAGhE,SAAS,CAACiE,QAAV,IAAsBjE,SAAS,CAACoD,IAAhC,GAAuCI,OAAO,CAACU,QAAR,CAAiBlE,SAAS,CAACoD,IAA3B,CAAvC,GAA0E,IAA1F;;AAEA,YAAIpD,SAAS,CAACA,SAAV,CAAoBxD,GAApB,KAA4BA,GAAhC,EAAqC;AACnCqH,UAAAA,YAAY,GAAG7D,SAAf;;AAEA,cAAIgE,SAAJ,EAAe;AACbhB,YAAAA,IAAI,GAAGhD,SAAP;;AAEA,gBAAI4D,aAAa,CAACzH,MAAd,GAAuB,CAAvB,IAA4B,kBAAkB6D,SAAlD,EAA6D;AAC3DgD,cAAAA,IAAI,GAAGhD,SAAS,CAACmD,YAAV,CAAuBS,aAAvB,EAAsChB,EAAtC,EAA0CS,YAA1C,CAAP;AACD,aAFD,MAEO,IAAIT,EAAJ,EAAQ;AACbA,cAAAA,EAAE,CAAC5C,SAAD,EAAYQ,UAAZ,CAAF;AACD;;AAED,mBAAO,KAAP;AACD;AACF;AACF,OAlBD;;AAoBA,UAAI,CAACwC,IAAL,EAAW;AACTA,QAAAA,IAAI,GAAGa,YAAP;AACD;;AAED,aAAOb,IAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;AAtDK,GA1O2B,EAkS3B;AACDxG,IAAAA,GAAG,EAAE,kBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASiJ,gBAAT,CAA0BC,EAA1B,EAA8BxB,EAA9B,EAAkC;AACvC,UAAII,IAAI,GAAG,IAAX;AACA,WAAKL,cAAL,CAAoB,UAAU3C,SAAV,EAAqBQ,UAArB,EAAiC;AACnD,YAAIR,SAAS,CAACoE,EAAV,KAAiBA,EAArB,EAAyB;AACvBpB,UAAAA,IAAI,GAAGhD,SAAP;;AAEA,cAAI4C,EAAJ,EAAQ;AACNA,YAAAA,EAAE,CAAC5C,SAAD,EAAYQ,UAAZ,CAAF;AACD;;AAED,iBAAO,KAAP;AACD;AACF,OAVD;AAWA,aAAOwC,IAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;AAtBK,GAlS2B,EA0T3B;AACDxG,IAAAA,GAAG,EAAE,wBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASmJ,sBAAT,CAAgCrE,SAAhC,EAA2C;AAChD,UAAIoD,IAAI,GAAG,EAAX;;AAEA,UAAIpD,SAAS,CAACA,SAAV,CAAoBxD,GAAxB,EAA6B;AAC3B,YAAI8H,QAAQ,GAAG,IAAf;;AAEA,eAAOA,QAAQ,IAAI,CAACA,QAAQ,CAACC,SAAtB,IAAmCD,QAAQ,CAACE,MAAnD,EAA2D;AACzDF,UAAAA,QAAQ,GAAGA,QAAQ,CAACE,MAApB;AACD;;AAED,YAAIjC,QAAQ,GAAGvC,SAAS,CAACyE,GAAV,GAAgB,IAAIC,MAAJ,CAAWC,MAAM,CAACC,QAAP,CAAgB5E,SAAS,CAACyE,GAA1B,CAAX,EAA2C,GAA3C,CAAhB,GAAkE,EAAjF;AACArB,QAAAA,IAAI,GAAGkB,QAAQ,CAAClB,IAAT,GAAgB,GAAGsB,MAAH,CAAUJ,QAAQ,CAAClB,IAAnB,EAAyBsB,MAAzB,CAAgCnC,QAAhC,EAA0C,GAA1C,CAAhB,GAAiE,EAAxE;AACAa,QAAAA,IAAI,IAAIpD,SAAS,CAAC6E,WAAV,IAAyB7E,SAAS,CAACA,SAAV,CAAoB8E,wBAA7C,GAAwE9E,SAAS,CAAC6E,WAAlF,GAAgG,EAAxG;AACAzB,QAAAA,IAAI,IAAIpD,SAAS,CAACA,SAAV,CAAoBxD,GAA5B;AACA,eAAO4G,IAAP;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;;AAxBK,GA1T2B,EAoV3B;AACD5G,IAAAA,GAAG,EAAE,iBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS6J,eAAT,CAAyB/E,SAAzB,EAAoCC,OAApC,EAA6CC,IAA7C,EAAmD8E,MAAnD,EAA2D;AAChE,UAAIC,QAAJ;;AAEA,UAAI,CAACjF,SAAL,EAAgB;AACd;AACD;;AAEDC,MAAAA,OAAO,GAAGA,OAAO,IAAI,KAAKA,OAA1B;AACAC,MAAAA,IAAI,GAAGA,IAAI,IAAI,KAAKA,IAApB;AACAD,MAAAA,OAAO,CAACuE,MAAR,GAAiB,IAAjB;AACAvE,MAAAA,OAAO,CAACyB,aAAR,GAAwB,KAAKN,OAA7B;AACAnB,MAAAA,OAAO,CAACiF,IAAR,GAAe,CAAC,CAACD,QAAQ,GAAGhF,OAAZ,MAAyB,IAAzB,IAAiCgF,QAAQ,KAAK,KAAK,CAAnD,GAAuD,KAAK,CAA5D,GAAgEA,QAAQ,CAACC,IAA1E,KAAmF,KAAKA,IAAxF,IAAgG,IAA/G;AACAjF,MAAAA,OAAO,CAACkF,SAAR,GAAoB,KAAKA,SAAzB;AACAlF,MAAAA,OAAO,CAACmF,QAAR,GAAmB,IAAnB;;AAEA,UAAI,CAAC,KAAKC,gBAAN,IAA0B,KAAKrF,SAAL,CAAe8E,wBAA7C,EAAuE;AACrE9E,QAAAA,SAAS,CAAC8E,wBAAV,GAAqC,IAArC;AACD;;AAED,UAAI9B,IAAI,GAAGzH,WAAW,CAACJ,OAAZ,CAAoB+C,MAApB,CAA2B8B,SAA3B,EAAsCC,OAAtC,EAA+CC,IAA/C,EAAqD,IAArD,CAAX;;AAEA,UAAIkD,IAAI,GAAG,KAAKiB,sBAAL,CAA4BrB,IAA5B,CAAX;;AAEA,UAAII,IAAJ,EAAU;AACRJ,QAAAA,IAAI,CAACI,IAAL,GAAYA,IAAZ;AACD;;AAEDJ,MAAAA,IAAI,CAACsC,IAAL;;AAEA,UAAItF,SAAS,CAACuF,QAAd,EAAwB;AACtB,eAAOvC,IAAP;AACD;;AAED,UAAIgC,MAAJ,EAAY;AACV,YAAIlC,KAAK,GAAG1H,OAAO,CAACD,OAAR,CAAgBqK,SAAhB,CAA0B,KAAKhF,UAA/B,EAA2C;AACrD4D,UAAAA,EAAE,EAAEY,MAAM,CAACZ;AAD0C,SAA3C,CAAZ;;AAIA,YAAItB,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChB,eAAKtC,UAAL,CAAgBiF,MAAhB,CAAuB3C,KAAvB,EAA8B,CAA9B,EAAiCE,IAAjC;AACD,SAFD,MAEO;AACL,eAAKxC,UAAL,CAAgBkF,IAAhB,CAAqB1C,IAArB;AACD;AACF,OAVD,MAUO;AACL,aAAKxC,UAAL,CAAgBkF,IAAhB,CAAqB1C,IAArB;AACD;;AAED,aAAOA,IAAP;AACD;AAlDA,GApV2B,EAuY3B;AACDxG,IAAAA,GAAG,EAAE,cADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASyK,YAAT,GAAwB;AAC7B,aAAO,KAAKC,OAAZ;AACD;AAJA,GAvY2B,EA4Y3B;AACDpJ,IAAAA,GAAG,EAAE,qBADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAKqC,SAAL,CAAeQ,UAAf,IAA6B,EAApC;AACD;AAJA,GA5Y2B,EAiZ3B;AACDhE,IAAAA,GAAG,EAAE,WADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,UAAU+G,MAAV,CAAiB,KAAKlI,GAAtB,CAAP;AACD;AAJA,GAjZ2B,EAsZ3B;AACDA,IAAAA,GAAG,EAAE,cADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,WAAP;AACD;AAJA,GAtZ2B,EA2Z3B;AACDnB,IAAAA,GAAG,EAAE,MADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASoK,IAAT,GAAgB;AACrB,WAAK9E,UAAL,GAAkB,KAAKA,UAAL,IAAmB,EAArC;AACA,WAAKqF,aAAL;AACA,aAAOnI,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,MAA7C,EAAqD,IAArD,CAAJ,CAA+DuC,IAA/D,CAAoE,IAApE,CAAP;AACD;AACD;AACJ;AACA;AACA;AACA;;AAXK,GA3Z2B,EAwa3B;AACDZ,IAAAA,GAAG,EAAE,eADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS2K,aAAT,CAAuB3F,IAAvB,EAA6BD,OAA7B,EAAsC;AAC3C,UAAI6F,MAAM,GAAG,IAAb;;AAEA5F,MAAAA,IAAI,GAAGA,IAAI,IAAI,KAAKA,IAApB;AACAD,MAAAA,OAAO,GAAGA,OAAO,IAAI,KAAKA,OAA1B;;AAEA,UAAIA,OAAO,CAACO,UAAZ,EAAwB;AACtB,aAAKA,UAAL,GAAkBP,OAAO,CAACO,UAA1B;AACD,OAFD,MAEO;AACL,YAAIA,UAAU,GAAG,KAAKuF,IAAL,CAAU,eAAV,EAA2B,KAAKC,mBAAhC,EAAqD,IAArD,KAA8D,EAA/E;AACAxF,QAAAA,UAAU,CAACiB,OAAX,CAAmB,UAAUzB,SAAV,EAAqB;AACtC,iBAAO8F,MAAM,CAACG,YAAP,CAAoBjG,SAApB,EAA+BE,IAA/B,CAAP;AACD,SAFD;AAGD;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAxBK,GAxa2B,EAkc3B;AACD1D,IAAAA,GAAG,EAAE,cADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS+K,YAAT,CAAsBjG,SAAtB,EAAiCE,IAAjC,EAAuC8E,MAAvC,EAA+CkB,KAA/C,EAAsD;AAC3DhG,MAAAA,IAAI,GAAGA,IAAI,IAAI,KAAKA,IAApB;;AAEA,UAAI,KAAKD,OAAL,CAAakG,UAAjB,EAA6B;AAC3BnG,QAAAA,SAAS,CAAC8E,wBAAV,GAAqC,IAArC;AACD;;AAED9E,MAAAA,SAAS,GAAG,KAAK+F,IAAL,CAAU,cAAV,EAA0B/F,SAA1B,EAAqCE,IAArC,EAA2C8E,MAA3C,EAAmDkB,KAAnD,CAAZ;AACA,UAAIlD,IAAI,GAAG,KAAK+B,eAAL,CAAqB/E,SAArB,EAAgC,KAAKC,OAArC,EAA8CC,IAA9C,EAAoD8E,MAAM,GAAGA,MAAH,GAAY,IAAtE,CAAX;;AAEA,UAAIkB,KAAJ,EAAW;AACT,eAAOlD,IAAP;AACD;;AAED,aAAOA,IAAP;AACD;AAjBA,GAlc2B,EAod3B;AACDxG,IAAAA,GAAG,EAAE,aADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASkL,WAAT,GAAuB;AAC5B,UAAI,KAAK5B,MAAL,IAAe,iBAAiB,KAAKA,MAAzC,EAAiD;AAC/C,aAAKA,MAAL,CAAY4B,WAAZ,CAAwB,IAAxB;AACD;AACF;AANA,GApd2B,EA2d3B;AACD5J,IAAAA,GAAG,EAAE,QADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASmL,MAAT,CAAgBC,QAAhB,EAA0B;AAC/B;AACA,aAAO5I,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,QAA7C,EAAuD,IAAvD,CAAJ,CAAiEuC,IAAjE,CAAsE,IAAtE,EAA4EkJ,QAAQ,IAAI,KAAKC,cAAL,CAAoB,KAAKC,YAAzB,EAAuC;AACpIF,QAAAA,QAAQ,EAAE,CAAC,KAAKlF,OAAN,GAAgB,EAAhB,GAAqB,KAAKqF,gBAAL,EADqG;AAEpIC,QAAAA,SAAS,EAAE,KAAKA,SAFoH;AAGpIpG,QAAAA,SAAS,EAAE,KAAKL,OAAL,CAAa0G,GAAb,GAAmB,KAAnB,GAA2B,KAAKrG;AAHyF,OAAvC,CAAxF,CAAP;AAKD;AATA,GA3d2B,EAqe3B;AACD9D,IAAAA,GAAG,EAAE,kBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASuL,gBAAT,CAA0BjG,UAA1B,EAAsC;AAC3CA,MAAAA,UAAU,GAAGA,UAAU,IAAI,KAAKE,aAAL,EAA3B;AACA,UAAI4F,QAAQ,GAAG9F,UAAU,CAACG,GAAX,CAAe,UAAUX,SAAV,EAAqB;AACjD,eAAOA,SAAS,CAACqG,MAAV,EAAP;AACD,OAFc,CAAf;AAGA,aAAO,KAAKE,cAAL,CAAoB,YAApB,EAAkC;AACvCD,QAAAA,QAAQ,EAAEA,QAD6B;AAEvC9F,QAAAA,UAAU,EAAEA;AAF2B,OAAlC,CAAP;AAID;AAXA,GAre2B,EAif3B;AACDhE,IAAAA,GAAG,EAAE,QADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS0L,MAAT,CAAgBhB,OAAhB,EAAyB;AAC9B,UAAIiB,MAAM,GAAG,IAAb;;AAEA,UAAIC,YAAY,GAAGpJ,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,QAA7C,EAAuD,IAAvD,CAAJ,CAAiEuC,IAAjE,CAAsE,IAAtE,EAA4EwI,OAA5E,CAAnB;;AAEA,WAAKmB,QAAL,CAAcnB,OAAd,EAAuBvI,eAAe,CAAC;AACrC2J,QAAAA,MAAM,EAAE,QAD6B;AAErC1G,QAAAA,SAAS,EAAE,KAAKA;AAFqB,OAAD,EAGnC,KAAKoG,SAH8B,EAGnB,QAHmB,CAAtC;;AAKA,UAAIO,YAAY,GAAGzL,kBAAkB,CAACL,OAAnB,CAA2B+L,OAA3B,EAAnB;;AAEA,UAAI,KAAKC,IAAL,CAAU,KAAKT,SAAf,CAAJ,EAA+B;AAC7BO,QAAAA,YAAY,GAAG,KAAKG,gBAAL,CAAsB,KAAKD,IAAL,CAAU,KAAKT,SAAf,CAAtB,CAAf;AACD;;AAED,UAAI,KAAK1G,SAAL,CAAeqH,WAAf,IAA8B,KAAKF,IAAL,CAAUH,MAA5C,EAAoD;AAClD,aAAKM,gBAAL,CAAsB,KAAKH,IAAL,CAAUH,MAAhC,EAAwC,OAAxC,EAAiD,YAAY;AAC3DH,UAAAA,MAAM,CAACvG,SAAP,GAAmB,CAACuG,MAAM,CAACvG,SAA3B;AACD,SAFD;AAGA,aAAKgH,gBAAL,CAAsB,KAAKH,IAAL,CAAUH,MAAhC,EAAwC,SAAxC,EAAmD,UAAUrH,CAAV,EAAa;AAC9D,cAAIA,CAAC,CAAC4H,OAAF,KAAc,EAAd,IAAoB5H,CAAC,CAAC4H,OAAF,KAAc,EAAtC,EAA0C;AACxC5H,YAAAA,CAAC,CAAC6H,cAAF;AACAX,YAAAA,MAAM,CAACvG,SAAP,GAAmB,CAACuG,MAAM,CAACvG,SAA3B;AACD;AACF,SALD;AAMD;;AAED,aAAO9E,kBAAkB,CAACL,OAAnB,CAA2B+G,GAA3B,CAA+B,CAAC4E,YAAD,EAAeG,YAAf,CAA/B,CAAP;AACD;AA/BA,GAjf2B,EAihB3B;AACDzK,IAAAA,GAAG,EAAE,kBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASkM,gBAAT,CAA0BxB,OAA1B,EAAmCpF,UAAnC,EAA+CiH,SAA/C,EAA0D;AAC/DjH,MAAAA,UAAU,GAAGA,UAAU,IAAI,KAAKA,UAAhC;AACAiH,MAAAA,SAAS,GAAGA,SAAS,IAAI,KAAKzH,SAAL,CAAeQ,UAAxC;AACAoF,MAAAA,OAAO,GAAG,KAAKG,IAAL,CAAU,kBAAV,EAA8BH,OAA9B,EAAuCpF,UAAvC,EAAmDiH,SAAnD,EAA8D,IAA9D,CAAV;;AAEA,UAAI,CAAC7B,OAAL,EAAc;AACZ;AACA,eAAO,IAAIpK,kBAAkB,CAACL,OAAvB,CAA+B,YAAY,CAAE,CAA7C,CAAP;AACD;;AAED,UAAI2H,KAAK,GAAG,CAAZ;AACA,UAAI4E,QAAQ,GAAG,EAAf;AACAC,MAAAA,KAAK,CAAC9M,SAAN,CAAgB+M,KAAhB,CAAsBxK,IAAtB,CAA2BwI,OAAO,CAACU,QAAnC,EAA6C7E,OAA7C,CAAqD,UAAUoG,KAAV,EAAiB;AACpE,YAAI,CAACA,KAAK,CAACC,YAAN,CAAmB,eAAnB,CAAD,IAAwCtH,UAAU,CAACsC,KAAD,CAAtD,EAA+D;AAC7D4E,UAAAA,QAAQ,CAAChC,IAAT,CAAclF,UAAU,CAACsC,KAAD,CAAV,CAAkB8D,MAAlB,CAAyBiB,KAAzB,CAAd;AACA/E,UAAAA,KAAK;AACN;AACF,OALD;AAMA,aAAOtH,kBAAkB,CAACL,OAAnB,CAA2B+G,GAA3B,CAA+BwF,QAA/B,CAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;AA3BK,GAjhB2B,EA8iB3B;AACDlL,IAAAA,GAAG,EAAE,iBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS6M,eAAT,CAAyB/H,SAAzB,EAAoCQ,UAApC,EAAgD;AACrDA,MAAAA,UAAU,GAAGA,UAAU,IAAI,KAAKA,UAAhC;AACAR,MAAAA,SAAS,CAACgI,OAAV;;AAEA5M,MAAAA,OAAO,CAACD,OAAR,CAAgB8M,MAAhB,CAAuBzH,UAAvB,EAAmC;AACjC4D,QAAAA,EAAE,EAAEpE,SAAS,CAACoE;AADmB,OAAnC;AAGD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;AAhBK,GA9iB2B,EAgkB3B;AACD5H,IAAAA,GAAG,EAAE,sBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASgN,oBAAT,CAA8B1L,GAA9B,EAAmCoG,EAAnC,EAAuC;AAC5C,UAAIuF,MAAM,GAAG,IAAb;;AAEA,UAAInF,IAAI,GAAG,KAAKG,YAAL,CAAkB3G,GAAlB,EAAuB,UAAUwD,SAAV,EAAqBQ,UAArB,EAAiC;AACjE2H,QAAAA,MAAM,CAACJ,eAAP,CAAuB/H,SAAvB,EAAkCQ,UAAlC;;AAEA,YAAIoC,EAAJ,EAAQ;AACNA,UAAAA,EAAE,CAAC5C,SAAD,EAAYQ,UAAZ,CAAF;AACD;AACF,OANU,CAAX;;AAQA,UAAI,CAACwC,IAAL,EAAW;AACT,YAAIJ,EAAJ,EAAQ;AACNA,UAAAA,EAAE,CAAC,IAAD,CAAF;AACD;;AAED,eAAO,IAAP;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;AA3BK,GAhkB2B,EA6lB3B;AACDpG,IAAAA,GAAG,EAAE,qBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASkN,mBAAT,CAA6BhE,EAA7B,EAAiCxB,EAAjC,EAAqC;AAC1C,UAAIyF,MAAM,GAAG,IAAb;;AAEA,UAAIrF,IAAI,GAAG,KAAKmB,gBAAL,CAAsBC,EAAtB,EAA0B,UAAUpE,SAAV,EAAqBQ,UAArB,EAAiC;AACpE6H,QAAAA,MAAM,CAACN,eAAP,CAAuB/H,SAAvB,EAAkCQ,UAAlC;;AAEA,YAAIoC,EAAJ,EAAQ;AACNA,UAAAA,EAAE,CAAC5C,SAAD,EAAYQ,UAAZ,CAAF;AACD;AACF,OANU,CAAX;;AAQA,UAAI,CAACwC,IAAL,EAAW;AACT,YAAIJ,EAAJ,EAAQ;AACNA,UAAAA,EAAE,CAAC,IAAD,CAAF;AACD;;AAED,eAAO,IAAP;AACD;AACF;AApBA,GA7lB2B,EAknB3B;AACDpG,IAAAA,GAAG,EAAE,aADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASoN,WAAT,CAAqBpN,KAArB,EAA4B;AACjC,UAAIqN,KAAK,GAAGtJ,SAAS,CAAC9C,MAAV,GAAmB,CAAnB,IAAwB8C,SAAS,CAAC,CAAD,CAAT,KAAiBuJ,SAAzC,GAAqDvJ,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAhF;AACA,aAAO,KAAKuB,UAAL,CAAgBiI,MAAhB,CAAuB,UAAUC,OAAV,EAAmB1F,IAAnB,EAAyB;AACrD,eAAOA,IAAI,CAACsF,WAAL,CAAiB,IAAjB,EAAuBC,KAAvB,KAAiCG,OAAxC;AACD,OAFM,EAEJhL,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,aAA7C,EAA4D,IAA5D,CAAJ,CAAsEuC,IAAtE,CAA2E,IAA3E,EAAiFlC,KAAjF,EAAwFqN,KAAxF,CAFI,CAAP;AAGD;AAPA,GAlnB2B,EA0nB3B;AACD/L,IAAAA,GAAG,EAAE,sBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASyN,oBAAT,CAA8BzI,IAA9B,EAAoC0I,KAApC,EAA2CnE,GAA3C,EAAgD;AACrD;AACA,UAAI,CAAC,KAAKzE,SAAL,CAAe6I,KAApB,EAA2B;AACzB,eAAO,IAAP;AACD,OAFD,MAEO;AACL,eAAOnL,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,sBAA7C,EAAqE,IAArE,CAAJ,CAA+EuC,IAA/E,CAAoF,IAApF,EAA0F8C,IAA1F,EAAgG0I,KAAhG,EAAuGnE,GAAvG,CAAP;AACD;AACF;AATA,GA1nB2B,EAooB3B;AACDjI,IAAAA,GAAG,EAAE,WADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS4N,SAAT,CAAmB5I,IAAnB,EAAyBqI,KAAzB,EAAgC9D,GAAhC,EAAqCjE,UAArC,EAAiD;AACtD,UAAI,KAAKuI,WAAT,EAAsB;AACpB,eAAO,IAAP;AACD;;AAED7I,MAAAA,IAAI,GAAGA,IAAI,IAAI,KAAK8I,SAApB;AACAT,MAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;AACA9D,MAAAA,GAAG,GAAGA,GAAG,IAAI,KAAKvE,IAAlB;AACAM,MAAAA,UAAU,GAAGA,UAAU,IAAIpF,OAAO,CAACD,OAAR,CAAgB8N,OAAhB,CAAwBzI,UAAxB,CAAd,GAAoDA,UAApD,GAAiE,KAAKE,aAAL,EAA9E;AACA,UAAIwI,OAAO,GAAG1I,UAAU,CAACiI,MAAX,CAAkB,UAAUU,KAAV,EAAiBnG,IAAjB,EAAuB;AACrD,eAAOA,IAAI,CAAC8F,SAAL,CAAe5I,IAAf,EAAqBqI,KAArB,EAA4B9D,GAA5B,KAAoC0E,KAA3C;AACD,OAFa,EAEXzL,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,WAA7C,EAA0D,IAA1D,CAAJ,CAAoEuC,IAApE,CAAyE,IAAzE,EAA+E8C,IAA/E,EAAqFqI,KAArF,EAA4F9D,GAA5F,CAFW,CAAd;AAGA,WAAK2E,UAAL,CAAgBF,OAAhB,EAAyB,KAAKG,OAA9B;AACA,aAAOH,OAAP;AACD;AAhBA,GApoB2B,EAqpB3B;AACD1M,IAAAA,GAAG,EAAE,iBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASoO,eAAT,CAAyBpJ,IAAzB,EAA+BqI,KAA/B,EAAsC9D,GAAtC,EAA2C;AAChD;AACA,UAAI8E,KAAK,GAAG7L,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,iBAA7C,EAAgE,IAAhE,CAAJ,CAA0EuC,IAA1E,CAA+E,IAA/E,EAAqF8C,IAArF,EAA2FqI,KAA3F,EAAkG9D,GAAlG,CAAZ,CAFgD,CAEoE;;;AAGpH,WAAK/D,aAAL,GAAqBe,OAArB,CAA6B,UAAUuB,IAAV,EAAgB;AAC3C,eAAOA,IAAI,CAACsG,eAAL,CAAqBpJ,IAArB,EAA2BqI,KAA3B,EAAkCvF,IAAI,CAAC9C,IAAvC,CAAP;AACD,OAFD;AAGA,aAAOqJ,KAAP;AACD;AAXA,GArpB2B,EAiqB3B;AACD/M,IAAAA,GAAG,EAAE,aADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS2G,WAAT,CAAqBP,IAArB,EAA2B;AAChC5D,MAAAA,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,aAA7C,EAA4D,IAA5D,CAAJ,CAAsEuC,IAAtE,CAA2E,IAA3E,EAAiFkE,IAAjF;;AAEA,UAAI,KAAKtB,SAAL,CAAe6B,WAAnB,EAAgC;AAC9B,YAAI,KAAK0C,SAAL,IAAkB,CAAC,KAAKiF,QAAL,EAAvB,EAAwC;AACtC,eAAKC,SAAL,GAAiB,KAAKC,YAAtB;AACD;;AAED,YAAI,KAAKF,QAAL,EAAJ,EAAqB;AACnB,eAAKG,wBAAL;AACD;AACF;;AAED,WAAKjJ,aAAL,GAAqBe,OAArB,CAA6B,UAAUzB,SAAV,EAAqB;AAChD,eAAOA,SAAS,CAAC6B,WAAV,CAAsBP,IAAtB,CAAP;AACD,OAFD;AAGD;AAlBA,GAjqB2B,EAorB3B;AACD9E,IAAAA,GAAG,EAAE,0BADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASyO,wBAAT,GAAoC;AACzC,UAAIC,MAAM,GAAG,IAAb;;AAEA,WAAKlJ,aAAL,GAAqBe,OAArB,CAA6B,UAAUzB,SAAV,EAAqB;AAChD,eAAOA,SAAS,CAACE,IAAV,GAAiB0J,MAAM,CAACH,SAA/B;AACD,OAFD;AAGD;AACD;AACJ;AACA;AACA;AACA;;AAbK,GAprB2B,EAmsB3B;AACDjN,IAAAA,GAAG,EAAE,YADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS2O,UAAT,CAAoBC,IAApB,EAA0B;AAC/B,aAAOtO,kBAAkB,CAACL,OAAnB,CAA2B+G,GAA3B,CAA+B,KAAKxB,aAAL,GAAqBC,GAArB,CAAyB,UAAUqC,IAAV,EAAgB;AAC7E,eAAOA,IAAI,CAAC6G,UAAL,CAAgBC,IAAhB,CAAP;AACD,OAFqC,CAA/B,CAAP;AAGD;AACD;AACJ;AACA;AACA;AACA;;AAXK,GAnsB2B,EAgtB3B;AACDtN,IAAAA,GAAG,EAAE,cADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS6O,YAAT,GAAwB;AAC7B,aAAOvO,kBAAkB,CAACL,OAAnB,CAA2B+G,GAA3B,CAA+B,KAAKxB,aAAL,GAAqBC,GAArB,CAAyB,UAAUqC,IAAV,EAAgB;AAC7E,eAAOA,IAAI,CAAC+G,YAAL,EAAP;AACD,OAFqC,CAA/B,CAAP;AAGD;AANA,GAhtB2B,EAutB3B;AACDvN,IAAAA,GAAG,EAAE,gBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS8O,cAAT,CAAwB9J,IAAxB,EAA8BqI,KAA9B,EAAqC9D,GAArC,EAA0C;AAC/C;AACA,UAAI,CAAC,KAAK9C,oBAAL,EAAL,EAAkC;AAChC,eAAO,KAAP;AACD;;AAED,aAAO,KAAKjB,aAAL,GAAqB+H,MAArB,CAA4B,UAAUC,OAAV,EAAmB1F,IAAnB,EAAyB;AAC1D,eAAOA,IAAI,CAACgH,cAAL,CAAoB9J,IAApB,EAA0BqI,KAA1B,EAAiC9D,GAAjC,KAAyCiE,OAAhD;AACD,OAFM,EAEJhL,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,gBAA7C,EAA+D,IAA/D,CAAJ,CAAyEuC,IAAzE,CAA8E,IAA9E,EAAoF8C,IAApF,EAA0FqI,KAA1F,EAAiG9D,GAAjG,CAFI,CAAP;AAGD;AAXA,GAvtB2B,EAmuB3B;AACDjI,IAAAA,GAAG,EAAE,YADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS+O,UAAT,GAAsB;AAC3B,aAAO,KAAKC,KAAL,CAAW/N,MAAX,GAAoB,CAApB,KAA0B,KAAKgO,IAAtC;AACD;AAJA,GAnuB2B,EAwuB3B;AACD3N,IAAAA,GAAG,EAAE,SADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASgO,OAAT,CAAiBhJ,IAAjB,EAAuB0I,KAAvB,EAA8B;AACnC,aAAO,KAAKlI,aAAL,GAAqB+H,MAArB,CAA4B,UAAUU,KAAV,EAAiBnG,IAAjB,EAAuB;AACxD,eAAOA,IAAI,CAACkG,OAAL,CAAahJ,IAAb,EAAmB0I,KAAnB,KAA6BO,KAApC;AACD,OAFM,EAEJzL,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,SAA7C,EAAwD,IAAxD,CAAJ,CAAkEuC,IAAlE,CAAuE,IAAvE,EAA6E8C,IAA7E,EAAmF0I,KAAnF,CAFI,CAAP;AAGD;AANA,GAxuB2B,EA+uB3B;AACDpM,IAAAA,GAAG,EAAE,eADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS8F,aAAT,CAAuBd,IAAvB,EAA6B0I,KAA7B,EAAoCnE,GAApC,EAAyC2F,WAAzC,EAAsD;AAC3D,UAAI,CAAC,KAAKC,cAAL,CAAoB5F,GAApB,EAAyBvE,IAAzB,CAAL,EAAqC;AACnC,aAAKoK,iBAAL,CAAuB,EAAvB;AACA,eAAO,IAAP;AACD;;AAED,UAAIpB,OAAO,GAAG,KAAKxI,aAAL,GAAqB+H,MAArB,CAA4B,UAAUc,KAAV,EAAiBvG,IAAjB,EAAuB;AAC/D,eAAOA,IAAI,CAAChC,aAAL,CAAmBd,IAAnB,EAAyB0I,KAAzB,EAAgCnE,GAAhC,EAAqC2F,WAArC,KAAqDb,KAA5D;AACD,OAFa,EAEX7L,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,eAA7C,EAA8D,IAA9D,CAAJ,CAAwEuC,IAAxE,CAA6E,IAA7E,EAAmF8C,IAAnF,EAAyF0I,KAAzF,EAAgGnE,GAAhG,EAAqG2F,WAArG,CAFW,CAAd;AAGA,WAAKhB,UAAL,CAAgBF,OAAhB,EAAyBN,KAAzB;AACA,aAAOM,OAAP;AACD;AAbA,GA/uB2B,EA6vB3B;AACD1M,IAAAA,GAAG,EAAE,oBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASqP,kBAAT,CAA4BrK,IAA5B,EAAkC0I,KAAlC,EAAyCnE,GAAzC,EAA8C2F,WAA9C,EAA2D;AAChE,UAAII,OAAO,GAAG,IAAd;;AAEA,aAAO,KAAKrI,KAAL,CAAWsI,IAAX,CAAgB,YAAY;AACjC,YAAI/C,QAAQ,GAAG,CAAChK,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,oBAA7C,EAAmE2P,OAAnE,CAAJ,CAAgFpN,IAAhF,CAAqFoN,OAArF,EAA8FtK,IAA9F,EAAoG0I,KAApG,EAA2GnE,GAA3G,EAAgH2F,WAAhH,CAAD,CAAf;;AAEAI,QAAAA,OAAO,CAAClI,aAAR,CAAsB,UAAUtC,SAAV,EAAqB;AACzC,iBAAO0H,QAAQ,CAAChC,IAAT,CAAc1F,SAAS,CAACuK,kBAAV,CAA6BrK,IAA7B,EAAmC0I,KAAnC,EAA0CnE,GAA1C,EAA+C2F,WAA/C,CAAd,CAAP;AACD,SAFD;;AAIA,eAAO5O,kBAAkB,CAACL,OAAnB,CAA2B+G,GAA3B,CAA+BwF,QAA/B,EAAyC+C,IAAzC,CAA8C,UAAUC,OAAV,EAAmB;AACtE,iBAAOA,OAAO,CAACjC,MAAR,CAAe,UAAUU,KAAV,EAAiBrK,MAAjB,EAAyB;AAC7C,mBAAOqK,KAAK,IAAIrK,MAAhB;AACD,WAFM,EAEJ,IAFI,CAAP;AAGD,SAJM,CAAP;AAKD,OAZM,CAAP;AAaD;AAlBA,GA7vB2B,EAgxB3B;AACDtC,IAAAA,GAAG,EAAE,aADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASyP,WAAT,CAAqB5J,QAArB,EAA+B;AACpCrD,MAAAA,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,aAA7C,EAA4D,IAA5D,CAAJ,CAAsEuC,IAAtE,CAA2E,IAA3E,EAAiF2D,QAAjF;;AAEA,WAAKL,aAAL,GAAqBe,OAArB,CAA6B,UAAUuB,IAAV,EAAgB;AAC3C,eAAOA,IAAI,CAAC2H,WAAL,CAAiB5J,QAAjB,CAAP;AACD,OAFD;AAGD;AARA,GAhxB2B,EAyxB3B;AACDvE,IAAAA,GAAG,EAAE,YADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAKoD,QAAL,IAAiB,KAAKL,aAAL,GAAqBkK,KAArB,CAA2B,UAAUC,CAAV,EAAa;AAC9D,eAAOA,CAAC,CAACC,UAAT;AACD,OAFuB,CAAxB;AAGD;AANA,GAzxB2B,EAgyB3B;AACDtO,IAAAA,GAAG,EAAE,SADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAKiL,KAAL,IAAc,KAAKlI,aAAL,GAAqBkK,KAArB,CAA2B,UAAUC,CAAV,EAAa;AAC3D,eAAOA,CAAC,CAACxB,OAAT;AACD,OAFoB,CAArB;AAGD;AANA,GAhyB2B,EAuyB3B;AACD7M,IAAAA,GAAG,EAAE,QADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS6P,MAAT,GAAkB;AACvB,WAAKvK,UAAL,CAAgBiB,OAAhB,CAAwB,UAAUzB,SAAV,EAAqB;AAC3CA,QAAAA,SAAS,CAAC+K,MAAV;AACD,OAFD;;AAIArN,MAAAA,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,QAA7C,EAAuD,IAAvD,CAAJ,CAAiEuC,IAAjE,CAAsE,IAAtE;AACD;AARA,GAvyB2B,EAgzB3B;AACDZ,IAAAA,GAAG,EAAE,OADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS8P,KAAT,GAAiB;AACtB,WAAKxK,UAAL,CAAgBiB,OAAhB,CAAwB,UAAUzB,SAAV,EAAqB;AAC3CA,QAAAA,SAAS,CAACgL,KAAV;AACD,OAFD;;AAIAtN,MAAAA,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,OAA7C,EAAsD,IAAtD,CAAJ,CAAgEuC,IAAhE,CAAqE,IAArE;AACD;AARA,GAhzB2B,EAyzB3B;AACDZ,IAAAA,GAAG,EAAE,SADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS8M,OAAT,GAAmB;AACxB,WAAKiD,iBAAL;;AAEAvN,MAAAA,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,SAA7C,EAAwD,IAAxD,CAAJ,CAAkEuC,IAAlE,CAAuE,IAAvE;AACD;AANA,GAzzB2B,EAg0B3B;AACDZ,IAAAA,GAAG,EAAE,mBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS+P,iBAAT,GAA6B;AAClC,UAAIC,OAAO,GAAG,IAAd;;AAEA,UAAI1K,UAAU,GAAG,KAAKE,aAAL,GAAqBkH,KAArB,EAAjB;AACApH,MAAAA,UAAU,CAACiB,OAAX,CAAmB,UAAUuB,IAAV,EAAgB;AACjC,eAAOkI,OAAO,CAACnD,eAAR,CAAwB/E,IAAxB,EAA8BkI,OAAO,CAAC1K,UAAtC,CAAP;AACD,OAFD;AAGA,WAAKA,UAAL,GAAkB,EAAlB;AACD;AAVA,GAh0B2B,EA20B3B;AACDhE,IAAAA,GAAG,EAAE,QADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,UAAIwN,UAAU,GAAG,KAAKvJ,KAAL,GAAa,CAAC,KAAKA,KAAN,CAAb,GAA4B,EAA7C;AACA,aAAO,KAAKlB,aAAL,GAAqB+H,MAArB,CAA4B,UAAU2C,MAAV,EAAkBpI,IAAlB,EAAwB;AACzD,eAAOoI,MAAM,CAAC1G,MAAP,CAAc1B,IAAI,CAACoI,MAAL,IAAe,EAA7B,CAAP;AACD,OAFM,EAEJD,UAFI,EAEQE,MAFR,CAEe,UAAUC,GAAV,EAAe;AACnC,eAAOA,GAAG,CAACC,KAAJ,KAAc,QAArB;AACD,OAJM,CAAP;AAKD;AATA,GA30B2B,EAq1B3B;AACD/O,IAAAA,GAAG,EAAE,UADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASsQ,QAAT,GAAoB;AACzB,aAAO,KAAKtL,IAAZ;AACD;AAJA,GAr1B2B,EA01B3B;AACD1D,IAAAA,GAAG,EAAE,YADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASuQ,UAAT,GAAsB;AAC3B/N,MAAAA,IAAI,CAACI,eAAe,CAAC+B,eAAe,CAAChF,SAAjB,CAAhB,EAA6C,YAA7C,EAA2D,IAA3D,CAAJ,CAAqEuC,IAArE,CAA0E,IAA1E;;AAEA,WAAKsD,aAAL,GAAqBe,OAArB,CAA6B,UAAUuB,IAAV,EAAgB;AAC3C,eAAOA,IAAI,CAACyI,UAAL,EAAP;AACD,OAFD;AAGA,WAAKd,WAAL,CAAiB,IAAjB;AACD;AATA,GA11B2B,EAo2B3B;AACDnO,IAAAA,GAAG,EAAE,WADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAOnC,kBAAkB,CAACL,OAAnB,CAA2B+G,GAA3B,CAA+B,KAAKxB,aAAL,GAAqBC,GAArB,CAAyB,UAAUX,SAAV,EAAqB;AAClF,eAAOA,SAAS,CAAC0L,SAAjB;AACD,OAFqC,CAA/B,CAAP;AAGD;AANA,GAp2B2B,EA22B3B;AACDlP,IAAAA,GAAG,EAAE,gBADJ;AAEDtB,IAAAA,KAAK,EAAE,SAASyQ,cAAT,CAAwB3L,SAAxB,EAAmC9E,KAAnC,EAA0C;AAC/C,UAAIqN,KAAK,GAAGtJ,SAAS,CAAC9C,MAAV,GAAmB,CAAnB,IAAwB8C,SAAS,CAAC,CAAD,CAAT,KAAiBuJ,SAAzC,GAAqDvJ,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAhF;AACAe,MAAAA,SAAS,CAACyC,KAAV,GAAkB,KAAKD,gBAAL,CAAsBxC,SAAtB,CAAlB;;AAEA,UAAIA,SAAS,CAACI,IAAV,KAAmB,QAAvB,EAAiC;AAC/B,eAAO,KAAP;AACD;;AAED,UAAIJ,SAAS,CAACI,IAAV,KAAmB,YAAvB,EAAqC;AACnC,eAAOJ,SAAS,CAAC4L,QAAV,CAAmB1Q,KAAnB,EAA0BqN,KAA1B,CAAP;AACD,OAFD,MAEO,IAAIrN,KAAK,IAAI8E,SAAS,CAACwJ,QAAV,CAAmBtO,KAAnB,CAAb,EAAwC;AAC7C,eAAO8E,SAAS,CAAC4L,QAAV,CAAmBxQ,OAAO,CAACD,OAAR,CAAgBwC,GAAhB,CAAoBzC,KAApB,EAA2B8E,SAAS,CAACxD,GAArC,CAAnB,EAA8D+L,KAA9D,CAAP;AACD,OAFM,MAEA,IAAI,CAAC,CAAC,KAAKsD,YAAN,IAAsB7L,SAAS,CAACoB,OAAjC,KAA6CpB,SAAS,CAAC8L,qBAA3D,EAAkF;AACvFvD,QAAAA,KAAK,CAACwD,UAAN,GAAmB,CAACxD,KAAK,CAACK,KAA1B;AACAL,QAAAA,KAAK,CAACkD,UAAN,GAAmB,IAAnB;AACA,eAAOzL,SAAS,CAAC4L,QAAV,CAAmB5L,SAAS,CAAC0J,YAA7B,EAA2CnB,KAA3C,CAAP;AACD;AACF;AAnBA,GA32B2B,EA+3B3B;AACD/L,IAAAA,GAAG,EAAE,UADJ;AAEDtB,IAAAA,KAAK,EAAE,SAAS0Q,QAAT,CAAkB1Q,KAAlB,EAAyB;AAC9B,UAAI8Q,OAAO,GAAG,IAAd;;AAEA,UAAIzD,KAAK,GAAGtJ,SAAS,CAAC9C,MAAV,GAAmB,CAAnB,IAAwB8C,SAAS,CAAC,CAAD,CAAT,KAAiBuJ,SAAzC,GAAqDvJ,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAhF;;AAEA,UAAI,CAAC/D,KAAL,EAAY;AACV,eAAO,KAAP;AACD;;AAED,aAAO,KAAKwF,aAAL,GAAqB+H,MAArB,CAA4B,UAAUC,OAAV,EAAmB1I,SAAnB,EAA8B;AAC/D,eAAOgM,OAAO,CAACL,cAAR,CAAuB3L,SAAvB,EAAkC9E,KAAlC,EAAyCqN,KAAzC,EAAgDG,OAAhD,KAA4DA,OAAnE;AACD,OAFM,EAEJ,KAFI,CAAP;AAGD;AAdA,GA/3B2B,EA84B3B;AACDlM,IAAAA,GAAG,EAAE,UADJ;AAEDmB,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,UAAIsO,qBAAJ;;AAEA,aAAO,CAACA,qBAAqB,GAAG,KAAKjM,SAAL,CAAekM,QAAxC,MAAsD,IAAtD,IAA8DD,qBAAqB,KAAK,KAAK,CAA7F,GAAiGA,qBAAjG,GAAyH,KAAhI;AACD;AANA,GA94B2B,CAAlB,EAq5BR,CAAC;AACHzP,IAAAA,GAAG,EAAE,QADF;AAEHtB,IAAAA,KAAK,EAAE,SAASqF,MAAT,GAAkB;AACvB,WAAK,IAAI4L,IAAI,GAAGlN,SAAS,CAAC9C,MAArB,EAA6BiQ,MAAM,GAAG,IAAIzE,KAAJ,CAAUwE,IAAV,CAAtC,EAAuDE,IAAI,GAAG,CAAnE,EAAsEA,IAAI,GAAGF,IAA7E,EAAmFE,IAAI,EAAvF,EAA2F;AACzFD,QAAAA,MAAM,CAACC,IAAD,CAAN,GAAepN,SAAS,CAACoN,IAAD,CAAxB;AACD;;AAED,aAAO/Q,OAAO,CAACH,OAAR,CAAgBoF,MAAhB,CAAuBrB,KAAvB,CAA6B5D,OAAO,CAACH,OAArC,EAA8C,CAAC;AACpDmR,QAAAA,IAAI,EAAE,KAD8C;AAEpDJ,QAAAA,QAAQ,EAAE;AAF0C,OAAD,EAGlDxH,MAHkD,CAG3C0H,MAH2C,CAA9C,CAAP;AAID;AAXE,GAAD,CAr5BQ,CAAZ;;AAm6BA,SAAOvM,eAAP;AACD,CAp7BkC,CAo7BjCvE,OAAO,CAACH,OAp7ByB,CAAnC;;AAs7BAF,OAAO,CAACE,OAAR,GAAkB0E,eAAlB","sourcesContent":["'use strict';\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.reflect.set.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.number.parse-int.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Field2 = _interopRequireDefault(require(\"../field/Field\"));\n\nvar _Components = _interopRequireDefault(require(\"../../Components\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../../utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction set(target, property, value, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.set) { set = Reflect.set; } else { set = function set(target, property, value, receiver) { var base = _superPropBase(target, property); var desc; if (base) { desc = Object.getOwnPropertyDescriptor(base, property); if (desc.set) { desc.set.call(receiver, value); return true; } else if (!desc.writable) { return false; } } desc = Object.getOwnPropertyDescriptor(receiver, property); if (desc) { if (!desc.writable) { return false; } desc.value = value; Object.defineProperty(receiver, property, desc); } else { _defineProperty(receiver, property, value); } return true; }; } return set(target, property, value, receiver); }\n\nfunction _set(target, property, value, receiver, isStrict) { var s = set(target, property, value, receiver || target); if (!s && isStrict) { throw new Error('failed to set property'); } return value; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar NestedComponent = /*#__PURE__*/function (_Field) {\n  _inherits(NestedComponent, _Field);\n\n  var _super = _createSuper(NestedComponent);\n\n  function NestedComponent(component, options, data) {\n    var _this;\n\n    _classCallCheck(this, NestedComponent);\n\n    _this = _super.call(this, component, options, data);\n    _this.type = 'components';\n    _this._collapsed = !!_this.component.collapsed;\n    return _this;\n  }\n\n  _createClass(NestedComponent, [{\n    key: \"defaultSchema\",\n    get: function get() {\n      return NestedComponent.schema();\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      var schema = _get(_getPrototypeOf(NestedComponent.prototype), \"schema\", this);\n\n      var components = _lodash.default.uniqBy(this.getComponents(), 'component.key');\n\n      schema.components = _lodash.default.map(components, 'schema');\n      return schema;\n    }\n  }, {\n    key: \"collapsed\",\n    get: function get() {\n      return this._collapsed;\n    },\n    set: function set(value) {\n      this._collapsed = value;\n      this.collapse(value);\n    }\n  }, {\n    key: \"collapse\",\n    value: function collapse(value) {\n      var promise = this.redraw();\n\n      if (!value && !this.pristine) {\n        this.checkValidity(this.data, true);\n      }\n\n      return promise;\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      // DO NOT CALL super here.  There is an issue where clearOnHide was getting triggered with\n      // subcomponents because the \"parentVisible\" flag was set to false when it should really be\n      // set to true.\n      var visibilityChanged = this._visible !== value;\n      this._visible = value;\n      var isVisible = this.visible;\n      var forceShow = this.options.show && this.options.show[this.component.key];\n      var forceHide = this.options.hide && this.options.hide[this.component.key];\n      this.components.forEach(function (component) {\n        // Set the parent visibility first since we may have nested components within nested components\n        // and they need to be able to determine their visibility based on the parent visibility.\n        component.parentVisible = isVisible;\n        var conditionallyVisible = component.conditionallyVisible();\n\n        if (forceShow || conditionallyVisible) {\n          component.visible = true;\n        } else if (forceHide || !isVisible || !conditionallyVisible) {\n          component.visible = false;\n        } // If hiding a nested component, clear all errors below.\n\n\n        if (!component.visible) {\n          component.error = '';\n        }\n      });\n\n      if (visibilityChanged) {\n        this.clearOnHide();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this2 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", value, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentVisible = _this2.visible;\n      });\n    }\n  }, {\n    key: \"disabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"disabled\", this);\n    },\n    set: function set(disabled) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"disabled\", disabled, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentDisabled = disabled;\n      });\n    }\n  }, {\n    key: \"parentDisabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", value, this, true);\n\n      this.components.forEach(function (component) {\n        component.parentDisabled = _this3.disabled;\n      });\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.ready;\n      }));\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", this);\n    },\n    set: function set(instance) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", instance, this, true);\n\n      this.getComponents().forEach(function (component) {\n        component.currentForm = instance;\n      });\n    }\n  }, {\n    key: \"rowIndex\",\n    get: function get() {\n      return this._rowIndex;\n    },\n    set: function set(value) {\n      this._rowIndex = value;\n      this.eachComponent(function (component) {\n        component.rowIndex = value;\n      });\n    }\n  }, {\n    key: \"componentContext\",\n    value: function componentContext() {\n      return this._data;\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      var _this4 = this;\n\n      this._data = value;\n      this.eachComponent(function (component) {\n        component.data = _this4.componentContext(component);\n      });\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.components || [];\n    }\n    /**\n     * Perform a deep iteration over every component, including those\n     * within other container based components.\n     *\n     * @param {function} fn - Called for every component.\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent(fn, options) {\n      var components = this.getComponents();\n\n      _lodash.default.each(components, function (component, index) {\n        if (fn(component, components, index) === false) {\n          return false;\n        }\n\n        if (typeof component.everyComponent === 'function') {\n          if (component.everyComponent(fn, options) === false) {\n            return false;\n          }\n        }\n      });\n    }\n  }, {\n    key: \"hasComponent\",\n    value: function hasComponent(component) {\n      var result = false;\n      this.everyComponent(function (comp) {\n        if (comp === component) {\n          result = true;\n          return false;\n        }\n      });\n      return result;\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents() {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      });\n      return result;\n    }\n    /**\n     * Perform an iteration over each component within this container component.\n     *\n     * @param {function} fn - Called for each component\n     */\n\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn) {\n      _lodash.default.each(this.getComponents(), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n    /**\n     * Returns a component provided a key. This performs a deep search within the\n     * component tree.\n     *\n     * @param {string} key - The key of the component to retrieve.\n     * @param {function} fn - Called with the component once found.\n     * @return {Object} - The component that is located.\n     */\n\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn, originalPath) {\n      originalPath = originalPath || (0, _utils.getStringFromComponentPath)(path);\n      path = (0, _utils.getArrayFromComponentPath)(path);\n      var pathStr = originalPath;\n\n      var newPath = _lodash.default.clone(path);\n\n      var key = newPath.shift();\n      var remainingPath = newPath;\n      var comp = null;\n      var possibleComp = null;\n\n      if (_lodash.default.isNumber(key)) {\n        key = remainingPath.shift();\n      }\n\n      if (!_lodash.default.isString(key)) {\n        return comp;\n      }\n\n      this.everyComponent(function (component, components) {\n        var matchPath = component.hasInput && component.path ? pathStr.includes(component.path) : true;\n\n        if (component.component.key === key) {\n          possibleComp = component;\n\n          if (matchPath) {\n            comp = component;\n\n            if (remainingPath.length > 0 && 'getComponent' in component) {\n              comp = component.getComponent(remainingPath, fn, originalPath);\n            } else if (fn) {\n              fn(component, components);\n            }\n\n            return false;\n          }\n        }\n      });\n\n      if (!comp) {\n        comp = possibleComp;\n      }\n\n      return comp;\n    }\n    /**\n     * Return a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component.\n     * @param {function} fn - Called with the component once it is retrieved.\n     * @return {Object} - The component retrieved.\n     */\n\n  }, {\n    key: \"getComponentById\",\n    value: function getComponentById(id, fn) {\n      var comp = null;\n      this.everyComponent(function (component, components) {\n        if (component.id === id) {\n          comp = component;\n\n          if (fn) {\n            fn(component, components);\n          }\n\n          return false;\n        }\n      });\n      return comp;\n    }\n    /**\n     * Return a path of component's value.\n     *\n     * @param {Object} component - The component instance.\n     * @return {string} - The component's value path.\n     */\n\n  }, {\n    key: \"calculateComponentPath\",\n    value: function calculateComponentPath(component) {\n      var path = '';\n\n      if (component.component.key) {\n        var thisPath = this;\n\n        while (thisPath && !thisPath.allowData && thisPath.parent) {\n          thisPath = thisPath.parent;\n        }\n\n        var rowIndex = component.row ? \"[\".concat(Number.parseInt(component.row), \"]\") : '';\n        path = thisPath.path ? \"\".concat(thisPath.path).concat(rowIndex, \".\") : '';\n        path += component._parentPath && component.component.shouldIncludeSubFormPath ? component._parentPath : '';\n        path += component.component.key;\n        return path;\n      }\n    }\n    /**\n     * Create a new component and add it to the components array.\n     *\n     * @param component\n     * @param data\n     */\n\n  }, {\n    key: \"createComponent\",\n    value: function createComponent(component, options, data, before) {\n      var _options;\n\n      if (!component) {\n        return;\n      }\n\n      options = options || this.options;\n      data = data || this.data;\n      options.parent = this;\n      options.parentVisible = this.visible;\n      options.root = ((_options = options) === null || _options === void 0 ? void 0 : _options.root) || this.root || this;\n      options.localRoot = this.localRoot;\n      options.skipInit = true;\n\n      if (!this.isInputComponent && this.component.shouldIncludeSubFormPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      var comp = _Components.default.create(component, options, data, true);\n\n      var path = this.calculateComponentPath(comp);\n\n      if (path) {\n        comp.path = path;\n      }\n\n      comp.init();\n\n      if (component.internal) {\n        return comp;\n      }\n\n      if (before) {\n        var index = _lodash.default.findIndex(this.components, {\n          id: before.id\n        });\n\n        if (index !== -1) {\n          this.components.splice(index, 0, comp);\n        } else {\n          this.components.push(comp);\n        }\n      } else {\n        this.components.push(comp);\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.element;\n    }\n  }, {\n    key: \"componentComponents\",\n    get: function get() {\n      return this.component.components || [];\n    }\n  }, {\n    key: \"nestedKey\",\n    get: function get() {\n      return \"nested-\".concat(this.key);\n    }\n  }, {\n    key: \"templateName\",\n    get: function get() {\n      return 'container';\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.components = this.components || [];\n      this.addComponents();\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"init\", this).call(this);\n    }\n    /**\n     *\n     * @param element\n     * @param data\n     */\n\n  }, {\n    key: \"addComponents\",\n    value: function addComponents(data, options) {\n      var _this5 = this;\n\n      data = data || this.data;\n      options = options || this.options;\n\n      if (options.components) {\n        this.components = options.components;\n      } else {\n        var components = this.hook('addComponents', this.componentComponents, this) || [];\n        components.forEach(function (component) {\n          return _this5.addComponent(component, data);\n        });\n      }\n    }\n    /**\n     * Add a new component to the components array.\n     *\n     * @param {Object} component - The component JSON schema to add.\n     * @param {Object} data - The submission data object to house the data for this component.\n     * @param {HTMLElement} before - A DOM element to insert this element before.\n     * @return {Component} - The created component instance.\n     */\n\n  }, {\n    key: \"addComponent\",\n    value: function addComponent(component, data, before, noAdd) {\n      data = data || this.data;\n\n      if (this.options.parentPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      component = this.hook('addComponent', component, data, before, noAdd);\n      var comp = this.createComponent(component, this.options, data, before ? before : null);\n\n      if (noAdd) {\n        return comp;\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus() {\n      if (this.parent && 'beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      // If already rendering, don't re-render.\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"render\", this).call(this, children || this.renderTemplate(this.templateName, {\n        children: !this.visible ? '' : this.renderComponents(),\n        nestedKey: this.nestedKey,\n        collapsed: this.options.pdf ? false : this.collapsed\n      }));\n    }\n  }, {\n    key: \"renderComponents\",\n    value: function renderComponents(components) {\n      components = components || this.getComponents();\n      var children = components.map(function (component) {\n        return component.render();\n      });\n      return this.renderTemplate('components', {\n        children: children,\n        components: components\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this6 = this;\n\n      var superPromise = _get(_getPrototypeOf(NestedComponent.prototype), \"attach\", this).call(this, element);\n\n      this.loadRefs(element, _defineProperty({\n        header: 'single',\n        collapsed: this.collapsed\n      }, this.nestedKey, 'single'));\n\n      var childPromise = _nativePromiseOnly.default.resolve();\n\n      if (this.refs[this.nestedKey]) {\n        childPromise = this.attachComponents(this.refs[this.nestedKey]);\n      }\n\n      if (this.component.collapsible && this.refs.header) {\n        this.addEventListener(this.refs.header, 'click', function () {\n          _this6.collapsed = !_this6.collapsed;\n        });\n        this.addEventListener(this.refs.header, 'keydown', function (e) {\n          if (e.keyCode === 13 || e.keyCode === 32) {\n            e.preventDefault();\n            _this6.collapsed = !_this6.collapsed;\n          }\n        });\n      }\n\n      return _nativePromiseOnly.default.all([superPromise, childPromise]);\n    }\n  }, {\n    key: \"attachComponents\",\n    value: function attachComponents(element, components, container) {\n      components = components || this.components;\n      container = container || this.component.components;\n      element = this.hook('attachComponents', element, components, container, this);\n\n      if (!element) {\n        // Return a non-resolving promise.\n        return new _nativePromiseOnly.default(function () {});\n      }\n\n      var index = 0;\n      var promises = [];\n      Array.prototype.slice.call(element.children).forEach(function (child) {\n        if (!child.getAttribute('data-noattach') && components[index]) {\n          promises.push(components[index].attach(child));\n          index++;\n        }\n      });\n      return _nativePromiseOnly.default.all(promises);\n    }\n    /**\n     * Remove a component from the components array.\n     *\n     * @param {Component} component - The component to remove from the components.\n     * @param {Array<Component>} components - An array of components to remove this component from.\n     */\n\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, components) {\n      components = components || this.components;\n      component.destroy();\n\n      _lodash.default.remove(components, {\n        id: component.id\n      });\n    }\n    /**\n     * Removes a component provided the API key of that component.\n     *\n     * @param {string} key - The API key of the component to remove.\n     * @param {function} fn - Called once the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentByKey\",\n    value: function removeComponentByKey(key, fn) {\n      var _this7 = this;\n\n      var comp = this.getComponent(key, function (component, components) {\n        _this7.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n    /**\n     * Removes a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component to remove.\n     * @param {function} fn - Called when the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentById\",\n    value: function removeComponentById(id, fn) {\n      var _this8 = this;\n\n      var comp = this.getComponentById(id, function (component, components) {\n        _this8.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n  }, {\n    key: \"updateValue\",\n    value: function updateValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.components.reduce(function (changed, comp) {\n        return comp.updateValue(null, flags) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"updateValue\", this).call(this, value, flags));\n    }\n  }, {\n    key: \"shouldSkipValidation\",\n    value: function shouldSkipValidation(data, dirty, row) {\n      // Nested components with no input should not be validated.\n      if (!this.component.input) {\n        return true;\n      } else {\n        return _get(_getPrototypeOf(NestedComponent.prototype), \"shouldSkipValidation\", this).call(this, data, dirty, row);\n      }\n    }\n  }, {\n    key: \"checkData\",\n    value: function checkData(data, flags, row, components) {\n      if (this.builderMode) {\n        return true;\n      }\n\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      components = components && _lodash.default.isArray(components) ? components : this.getComponents();\n      var isValid = components.reduce(function (valid, comp) {\n        return comp.checkData(data, flags, row) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkData\", this).call(this, data, flags, row));\n      this.checkModal(isValid, this.isDirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      // check conditions of parent component first, because it may influence on visibility of it's children\n      var check = _get(_getPrototypeOf(NestedComponent.prototype), \"checkConditions\", this).call(this, data, flags, row); //row data of parent component not always corresponds to row of nested components, use comp.data as row data for children instead\n\n\n      this.getComponents().forEach(function (comp) {\n        return comp.checkConditions(data, flags, comp.data);\n      });\n      return check;\n    }\n  }, {\n    key: \"clearOnHide\",\n    value: function clearOnHide(show) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clearOnHide\", this).call(this, show);\n\n      if (this.component.clearOnHide) {\n        if (this.allowData && !this.hasValue()) {\n          this.dataValue = this.defaultValue;\n        }\n\n        if (this.hasValue()) {\n          this.restoreComponentsContext();\n        }\n      }\n\n      this.getComponents().forEach(function (component) {\n        return component.clearOnHide(show);\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this9 = this;\n\n      this.getComponents().forEach(function (component) {\n        return component.data = _this9.dataValue;\n      });\n    }\n    /**\n     * Allow components to hook into the next page trigger to perform their own logic.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforePage(next);\n      }));\n    }\n    /**\n     * Allow components to hook into the submission to provide their own async data.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      // Do not iterate into children and calculateValues if this nested component is conditionally hidden.\n      if (!this.conditionallyVisible()) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, comp) {\n        return comp.calculateValue(data, flags, row) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"calculateValue\", this).call(this, data, flags, row));\n    }\n  }, {\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      return this.pages.length - 1 === this.page;\n    }\n  }, {\n    key: \"isValid\",\n    value: function isValid(data, dirty) {\n      return this.getComponents().reduce(function (valid, comp) {\n        return comp.isValid(data, dirty) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"isValid\", this).call(this, data, dirty));\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      var isValid = this.getComponents().reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row, silentCheck) && check;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkValidity\", this).call(this, data, dirty, row, silentCheck));\n      this.checkModal(isValid, dirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkAsyncValidity\",\n    value: function checkAsyncValidity(data, dirty, row, silentCheck) {\n      var _this10 = this;\n\n      return this.ready.then(function () {\n        var promises = [_get(_getPrototypeOf(NestedComponent.prototype), \"checkAsyncValidity\", _this10).call(_this10, data, dirty, row, silentCheck)];\n\n        _this10.eachComponent(function (component) {\n          return promises.push(component.checkAsyncValidity(data, dirty, row, silentCheck));\n        });\n\n        return _nativePromiseOnly.default.all(promises).then(function (results) {\n          return results.reduce(function (valid, result) {\n            return valid && result;\n          }, true);\n        });\n      });\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.setPristine(pristine);\n      });\n    }\n  }, {\n    key: \"isPristine\",\n    get: function get() {\n      return this.pristine && this.getComponents().every(function (c) {\n        return c.isPristine;\n      });\n    }\n  }, {\n    key: \"isDirty\",\n    get: function get() {\n      return this.dirty && this.getComponents().every(function (c) {\n        return c.isDirty;\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.components.forEach(function (component) {\n        component.detach();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.components.forEach(function (component) {\n        component.clear();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clear\", this).call(this);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.destroyComponents();\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents() {\n      var _this11 = this;\n\n      var components = this.getComponents().slice();\n      components.forEach(function (comp) {\n        return _this11.removeComponent(comp, _this11.components);\n      });\n      this.components = [];\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var thisErrors = this.error ? [this.error] : [];\n      return this.getComponents().reduce(function (errors, comp) {\n        return errors.concat(comp.errors || []);\n      }, thisErrors).filter(function (err) {\n        return err.level !== 'hidden';\n      });\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      return this.data;\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"resetValue\", this).call(this);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.dataReady;\n      }));\n    }\n  }, {\n    key: \"setNestedValue\",\n    value: function setNestedValue(component, value) {\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      component._data = this.componentContext(component);\n\n      if (component.type === 'button') {\n        return false;\n      }\n\n      if (component.type === 'components') {\n        return component.setValue(value, flags);\n      } else if (value && component.hasValue(value)) {\n        return component.setValue(_lodash.default.get(value, component.key), flags);\n      } else if ((!this.rootPristine || component.visible) && component.shouldAddDefaultValue) {\n        flags.noValidate = !flags.dirty;\n        flags.resetValue = true;\n        return component.setValue(component.defaultValue, flags);\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this12 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, component) {\n        return _this12.setNestedValue(component, value, flags, changed) || changed;\n      }, false);\n    }\n  }, {\n    key: \"lazyLoad\",\n    get: function get() {\n      var _this$component$lazyL;\n\n      return (_this$component$lazyL = this.component.lazyLoad) !== null && _this$component$lazyL !== void 0 ? _this$component$lazyL : false;\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len = arguments.length, extend = new Array(_len), _key = 0; _key < _len; _key++) {\n        extend[_key] = arguments[_key];\n      }\n\n      return _Field2.default.schema.apply(_Field2.default, [{\n        tree: false,\n        lazyLoad: false\n      }].concat(extend));\n    }\n  }]);\n\n  return NestedComponent;\n}(_Field2.default);\n\nexports.default = NestedComponent;"]},"metadata":{},"sourceType":"script"}