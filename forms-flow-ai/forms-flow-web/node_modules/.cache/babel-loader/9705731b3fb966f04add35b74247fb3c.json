{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.sort.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.map.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.string.starts-with.js\");\n\nrequire(\"core-js/modules/es.regexp.flags.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _Webform = _interopRequireDefault(require(\"./Webform\"));\n\nvar _Component2 = _interopRequireDefault(require(\"./components/_classes/component/Component\"));\n\nvar _tooltip = _interopRequireDefault(require(\"tooltip.js\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _Components = _interopRequireDefault(require(\"./components/Components\"));\n\nvar _Formio = require(\"./Formio\");\n\nvar _utils = require(\"./utils/utils\");\n\nvar _formUtils = require(\"./utils/formUtils\");\n\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nrequire('./components/builder');\n\nvar Templates = _Formio.GlobalFormio.Templates;\n\nif (!Templates) {\n  Templates = require('./templates/Templates').default;\n}\n\nvar dragula;\n\nif (typeof window !== 'undefined') {\n  // Import from \"dist\" because it would require and \"global\" would not be defined in Angular apps.\n  dragula = require('dragula/dist/dragula');\n}\n\nvar WebformBuilder = /*#__PURE__*/function (_Component) {\n  _inherits(WebformBuilder, _Component);\n\n  var _super = _createSuper(WebformBuilder); // eslint-disable-next-line max-statements\n\n\n  function WebformBuilder() {\n    var _this;\n\n    _classCallCheck(this, WebformBuilder);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Reset skipInit in case PDFBuilder has set it.\n\n\n    options.skipInit = false;\n    options.display = options.display || 'form';\n    _this = _super.call(this, null, options);\n    _this.element = element;\n    _this.builderHeight = 0;\n    _this.schemas = {};\n    _this.repeatablePaths = [];\n    _this.sideBarScroll = _lodash.default.get(_this.options, 'sideBarScroll', true);\n    _this.sideBarScrollOffset = _lodash.default.get(_this.options, 'sideBarScrollOffset', 0);\n    _this.dragDropEnabled = true; // Setup the builder options.\n\n    _this.builder = _lodash.default.defaultsDeep({}, _this.options.builder, _this.defaultGroups); // Turn off if explicitely said to do so...\n\n    _lodash.default.each(_this.defaultGroups, function (config, key) {\n      if (config === false) {\n        _this.builder[key] = false;\n      }\n    }); // Add the groups.\n\n\n    _this.groups = {};\n    _this.groupOrder = [];\n\n    var _loop = function _loop(group) {\n      if (_this.builder[group]) {\n        _this.builder[group].key = group;\n        _this.groups[group] = _this.builder[group];\n        _this.groups[group].components = _this.groups[group].components || {};\n        _this.groups[group].componentOrder = _this.groups[group].componentOrder || [];\n        _this.groups[group].subgroups = Object.keys(_this.groups[group].groups || {}).map(function (groupKey) {\n          _this.groups[group].groups[groupKey].componentOrder = Object.keys(_this.groups[group].groups[groupKey].components).map(function (key) {\n            return key;\n          });\n          return _this.groups[group].groups[groupKey];\n        });\n\n        _this.groupOrder.push(_this.groups[group]);\n      }\n    };\n\n    for (var group in _this.builder) {\n      _loop(group);\n    }\n\n    _this.groupOrder = _this.groupOrder.filter(function (group) {\n      return group && !group.ignore;\n    }).sort(function (a, b) {\n      return a.weight - b.weight;\n    }).map(function (group) {\n      return group.key;\n    });\n\n    for (var type in _Components.default.components) {\n      var component = _Components.default.components[type];\n\n      if (component.builderInfo && component.builderInfo.schema) {\n        _this.schemas[type] = component.builderInfo.schema;\n        component.type = type;\n        var builderInfo = component.builderInfo;\n        builderInfo.key = component.type;\n\n        _this.addBuilderComponentInfo(builderInfo);\n      }\n    } // Filter out any extra components.\n    // Add the components in each group.\n\n\n    for (var _group in _this.groups) {\n      var info = _this.groups[_group];\n\n      for (var key in info.components) {\n        var comp = info.components[key];\n\n        if (comp === true && _Components.default.components[key] && _Components.default.components[key].builderInfo) {\n          comp = _Components.default.components[key].builderInfo;\n        }\n\n        if (comp && comp.schema) {\n          _this.schemas[key] = comp.schema;\n          info.components[key] = comp;\n          info.components[key].key = key;\n        } else {\n          // Do not include this component in the components array.\n          delete info.components[key];\n        }\n      } // Order the components.\n\n\n      _this.orderComponents(info);\n    }\n\n    _this.options.hooks = _this.options.hooks || {};\n\n    _this.options.hooks.renderComponent = function (html, _ref) {\n      var _self$component;\n\n      var component = _ref.component,\n          self = _ref.self;\n\n      if (self.type === 'form' && !self.key) {\n        var template = _this.hook('renderComponentFormTemplate', html.replace('formio-component-form', '')); // The main webform shouldn't have this class as it adds extra styles.\n\n\n        return template;\n      }\n\n      if (_this.options.disabled && _this.options.disabled.includes(self.key) || self.parent.noDragDrop) {\n        return html;\n      }\n\n      return _this.renderTemplate('builderComponent', {\n        html: html,\n        disableBuilderActions: self === null || self === void 0 ? void 0 : (_self$component = self.component) === null || _self$component === void 0 ? void 0 : _self$component.disableBuilderActions,\n        childComponent: component\n      });\n    };\n\n    _this.options.hooks.renderComponents = function (html, _ref2) {\n      var components = _ref2.components,\n          self = _ref2.self; // if Datagrid and already has a component, don't make it droppable.\n\n      if (self.type === 'datagrid' && components.length > 0 || self.noDragDrop) {\n        return html;\n      }\n\n      if (!components || !components.length && !components.nodrop || self.type === 'form' && components.length <= 1 && (components.length === 0 || components[0].type === 'button')) {\n        html = _this.renderTemplate('builderPlaceholder', {\n          position: 0\n        }) + html;\n      }\n\n      return _this.renderTemplate('builderComponents', {\n        key: self.key,\n        type: self.type,\n        html: html\n      });\n    };\n\n    _this.options.hooks.renderInput = function (html, _ref3) {\n      var self = _ref3.self;\n\n      if (self.type === 'hidden') {\n        return html + self.name;\n      }\n\n      return html;\n    };\n\n    _this.options.hooks.renderLoading = function (html, _ref4) {\n      var self = _ref4.self;\n\n      if (self.type === 'form' && self.key) {\n        return self.name;\n      }\n\n      return html;\n    };\n\n    _this.options.hooks.attachComponents = function (element, components, container, component) {\n      // Don't attach if no element was found or component doesn't participate in drag'n'drop.\n      if (!element) {\n        return;\n      }\n\n      if (component.noDragDrop) {\n        return element;\n      } // Attach container and component to element for later reference.\n\n\n      var containerElement = element.querySelector(\"[ref=\\\"\".concat(component.component.key, \"-container\\\"]\")) || element;\n      containerElement.formioContainer = container;\n      containerElement.formioComponent = component; // Add container to draggable list.\n\n      if (_this.dragula && _this.allowDrop(element)) {\n        _this.dragula.containers.push(containerElement);\n      } // If this is an existing datagrid element, don't make it draggable.\n\n\n      if ((component.type === 'datagrid' || component.type === 'datamap') && components.length > 0) {\n        return element;\n      } // Since we added a wrapper, need to return the original element so that we can find the components inside it.\n\n\n      return element.children[0];\n    };\n\n    _this.options.hooks.attachDatagrid = function (element, component) {\n      component.loadRefs(element, _defineProperty({}, \"\".concat(component.key, \"-container\"), 'single'));\n      var dataGridContainer = component.refs[\"\".concat(component.key, \"-container\")];\n\n      if (dataGridContainer) {\n        component.attachComponents(dataGridContainer.parentNode, [], component.component.components);\n      } // Need to set up horizontal rearrangement of fields.\n\n    };\n\n    _this.options.hooks.attachComponent = _this.attachComponent.bind(_assertThisInitialized(_this)); // Load resources tagged as 'builder'\n\n    var query = {\n      params: {\n        type: 'resource',\n        limit: 4294967295,\n        select: '_id,title,name,components'\n      }\n    };\n\n    if (_this.options && _this.options.resourceTag) {\n      query.params.tags = [_this.options.resourceTag];\n    } else if (!_this.options || !_this.options.hasOwnProperty('resourceTag')) {\n      query.params.tags = ['builder'];\n    }\n\n    var formio = new _Formio.GlobalFormio(_Formio.GlobalFormio.projectUrl);\n    var isResourcesDisabled = _this.options.builder && _this.options.builder.resource === false;\n    formio.loadProject().then(function (project) {\n      if (project && (_lodash.default.get(project, 'settings.addConfigToForms', false) || _lodash.default.get(project, 'addConfigToForms', false))) {\n        var config = project.config || {};\n        _this.options.formConfig = config;\n        var pathToFormConfig = 'webform._form.config';\n\n        var webformConfig = _lodash.default.get(_assertThisInitialized(_this), pathToFormConfig);\n\n        if (_this.webform && !webformConfig) {\n          _lodash.default.set(_assertThisInitialized(_this), pathToFormConfig, config);\n        }\n      }\n    }).catch(function (err) {\n      console.warn(\"Could not load project settings: \".concat(err.message || err));\n    });\n\n    if (!formio.noProject && !isResourcesDisabled) {\n      var resourceOptions = _this.options.builder && _this.options.builder.resource;\n      formio.loadForms(query).then(function (resources) {\n        if (resources.length) {\n          _this.builder.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n          _this.groups.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n\n          if (!_this.groupOrder.includes('resource')) {\n            _this.groupOrder.push('resource');\n          }\n\n          _this.addExistingResourceFields(resources);\n        }\n      });\n    } // Notify components if they need to modify their render.\n\n\n    _this.options.attachMode = 'builder';\n    _this.webform = _this.webform || _this.createForm(_this.options);\n    _this.pathComponentsMapping = {};\n    _this.arrayDataComponentPaths = [];\n    _this.nestedDataComponents = [];\n    _this.arrayDataComponents = [];\n    return _this;\n  }\n\n  _createClass(WebformBuilder, [{\n    key: \"allowDrop\",\n    value: function allowDrop() {\n      return true;\n    }\n  }, {\n    key: \"addExistingResourceFields\",\n    value: function addExistingResourceFields(resources) {\n      var _this2 = this;\n\n      _lodash.default.each(resources, function (resource, index) {\n        var resourceKey = \"resource-\".concat(resource.name);\n        var subgroup = {\n          key: resourceKey,\n          title: resource.title,\n          components: [],\n          componentOrder: [],\n          default: index === 0\n        };\n        (0, _formUtils.eachComponent)(resource.components, function (component) {\n          if (component.type === 'button') return;\n          if (_this2.options && _this2.options.resourceFilter && (!component.tags || component.tags.indexOf(_this2.options.resourceFilter) === -1)) return;\n          var componentName = component.label;\n\n          if (!componentName && component.key) {\n            componentName = _lodash.default.upperFirst(component.key);\n          }\n\n          subgroup.componentOrder.push(component.key);\n          subgroup.components[component.key] = _lodash.default.merge((0, _utils.fastCloneDeep)(_Components.default.components[component.type] ? _Components.default.components[component.type].builderInfo : _Components.default.components['unknown'].builderInfo), {\n            key: component.key,\n            title: componentName,\n            group: 'resource',\n            subgroup: resourceKey\n          }, {\n            schema: _objectSpread(_objectSpread({}, component), {}, {\n              label: component.label,\n              key: component.key,\n              lockKey: true,\n              source: !_this2.options.noSource ? resource._id : undefined,\n              isNew: true\n            })\n          });\n        }, true);\n\n        _this2.groups.resource.subgroups.push(subgroup);\n      });\n\n      this.triggerRedraw();\n    }\n  }, {\n    key: \"attachTooltip\",\n    value: function attachTooltip(component, title) {\n      return new _tooltip.default(component, {\n        trigger: 'hover focus',\n        placement: 'top',\n        title: title\n      });\n    }\n  }, {\n    key: \"attachComponent\",\n    value: function attachComponent(element, component) {\n      var _this3 = this; // Add component to element for later reference.\n\n\n      element.formioComponent = component;\n      component.loadRefs(element, {\n        removeComponent: 'single',\n        editComponent: 'single',\n        moveComponent: 'single',\n        copyComponent: 'single',\n        pasteComponent: 'single',\n        editJson: 'single'\n      });\n\n      if (component.refs.copyComponent) {\n        this.attachTooltip(component.refs.copyComponent, this.t('Copy'));\n        component.addEventListener(component.refs.copyComponent, 'click', function () {\n          return _this3.copyComponent(component);\n        });\n      }\n\n      if (component.refs.pasteComponent) {\n        var pasteToolTip = this.attachTooltip(component.refs.pasteComponent, this.t('Paste below'));\n        component.addEventListener(component.refs.pasteComponent, 'click', function () {\n          pasteToolTip.hide();\n\n          _this3.pasteComponent(component);\n        });\n      }\n\n      if (component.refs.moveComponent) {\n        this.attachTooltip(component.refs.moveComponent, this.t('Move'));\n      }\n\n      var parent = this.getParentElement(element);\n\n      if (component.refs.editComponent) {\n        this.attachTooltip(component.refs.editComponent, this.t('Edit'));\n        component.addEventListener(component.refs.editComponent, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, false, component.component, {\n            inDataGrid: component.isInDataGrid\n          });\n        });\n      }\n\n      if (component.refs.editJson) {\n        this.attachTooltip(component.refs.editJson, this.t('Edit JSON'));\n        component.addEventListener(component.refs.editJson, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, true, component.component);\n        });\n      }\n\n      if (component.refs.removeComponent) {\n        this.attachTooltip(component.refs.removeComponent, this.t('Remove'));\n        component.addEventListener(component.refs.removeComponent, 'click', function () {\n          return _this3.removeComponent(component.schema, parent, component.component);\n        });\n      }\n\n      return element;\n    }\n  }, {\n    key: \"createForm\",\n    value: function createForm(options) {\n      this.webform = new _Webform.default(this.element, options);\n\n      if (this.element) {\n        this.loadRefs(this.element, {\n          form: 'single'\n        });\n\n        if (this.refs.form) {\n          this.webform.element = this.refs.form;\n        }\n      }\n\n      return this.webform;\n    }\n    /**\n     * Called when everything is ready.\n     *\n     * @returns {Promise} - Wait for webform to be ready.\n     */\n\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.webform.ready;\n    }\n  }, {\n    key: \"defaultGroups\",\n    get: function get() {\n      return {\n        basic: {\n          title: 'Basic',\n          weight: 0,\n          default: true\n        },\n        advanced: {\n          title: 'Advanced',\n          weight: 10\n        },\n        layout: {\n          title: 'Layout',\n          weight: 20\n        },\n        data: {\n          title: 'Data',\n          weight: 30\n        },\n        premium: {\n          title: 'Premium',\n          weight: 40\n        }\n      };\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      return _Webform.default.prototype.redraw.call(this);\n    }\n  }, {\n    key: \"form\",\n    get: function get() {\n      return this.webform.form;\n    },\n    set: function set(value) {\n      this.setForm(value);\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.webform.schema;\n    }\n  }, {\n    key: \"container\",\n    get: function get() {\n      return this.webform.form.components;\n    }\n    /**\n     * When a component sets its api key, we need to check if it is unique within its namespace. Find the namespace root\n     * so we can calculate this correctly.\n     * @param component\n     */\n\n  }, {\n    key: \"findNamespaceRoot\",\n    value: function findNamespaceRoot(component) {\n      var path = (0, _utils.getArrayFromComponentPath)(component.path); // First get the component with nested parents.\n\n      var comp = this.webform.getComponent(path);\n      comp = Array.isArray(comp) ? comp[0] : comp;\n      var namespaceKey = this.recurseNamespace(comp); // If there is no key, it is the root form.\n\n      if (!namespaceKey || this.form.key === namespaceKey) {\n        return this.form.components;\n      }\n\n      var componentSchema = component.component; // If the current component is the namespace, we don't need to find it again.\n\n      if (namespaceKey === component.key) {\n        return [].concat(_toConsumableArray(componentSchema.components), [componentSchema]);\n      } // Get the namespace component so we have the original object.\n\n\n      var namespaceComponent = (0, _formUtils.getComponent)(this.form.components, namespaceKey, true);\n      return namespaceComponent ? namespaceComponent.components : comp.components;\n    }\n  }, {\n    key: \"recurseNamespace\",\n    value: function recurseNamespace(component) {\n      // If there is no parent, we are at the root level.\n      if (!component) {\n        return null;\n      } // Some components are their own namespace.\n\n\n      if (['address', 'container', 'datagrid', 'editgrid', 'dynamicWizard', 'tree'].includes(component.type) || component.tree || component.arrayTree) {\n        return component.key;\n      } // Anything else, keep going up.\n\n\n      return this.recurseNamespace(component.parent);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return this.renderTemplate('builder', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this4.renderTemplate('builderSidebarGroup', {\n              group: _this4.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this4.id),\n              subgroups: _this4.groups[groupKey].subgroups.map(function (group) {\n                return _this4.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        form: this.webform.render()\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this5 = this;\n\n      this.on('change', function (form) {\n        _this5.populateRecaptchaSettings(form);\n      });\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"attach\", this).call(this, element).then(function () {\n        _this5.loadRefs(element, {\n          form: 'single',\n          sidebar: 'single',\n          'sidebar-search': 'single',\n          'sidebar-groups': 'single',\n          'container': 'multiple',\n          'sidebar-anchor': 'multiple',\n          'sidebar-group': 'multiple',\n          'sidebar-container': 'multiple'\n        });\n\n        if (_this5.sideBarScroll && Templates.current.handleBuilderSidebarScroll) {\n          Templates.current.handleBuilderSidebarScroll.call(_this5, _this5);\n        } // Add the paste status in form\n\n\n        if (typeof window !== 'undefined' && window.sessionStorage) {\n          var data = window.sessionStorage.getItem('formio.clipboard');\n\n          if (data) {\n            _this5.addClass(_this5.refs.form, 'builder-paste-mode');\n          }\n        }\n\n        if (!(0, _utils.bootstrapVersion)(_this5.options)) {\n          // Initialize\n          _this5.refs['sidebar-group'].forEach(function (group) {\n            group.style.display = group.getAttribute('data-default') === 'true' ? 'inherit' : 'none';\n          }); // Click event\n\n\n          _this5.refs['sidebar-anchor'].forEach(function (anchor, index) {\n            _this5.addEventListener(anchor, 'click', function () {\n              var clickedParentId = anchor.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n              var clickedId = anchor.getAttribute('data-target').slice('#group-'.length);\n\n              _this5.refs['sidebar-group'].forEach(function (group, groupIndex) {\n                var openByDefault = group.getAttribute('data-default') === 'true';\n                var groupId = group.getAttribute('id').slice('group-'.length);\n                var groupParent = group.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n                group.style.display = openByDefault && groupParent === clickedId || groupId === clickedParentId || groupIndex === index ? 'inherit' : 'none';\n              });\n            }, true);\n          });\n        }\n\n        _this5.addEventListener(_this5.refs['sidebar-search'], 'input', _lodash.default.debounce(function (e) {\n          var searchString = e.target.value;\n\n          _this5.searchFields(searchString);\n        }, 300));\n\n        if (_this5.dragDropEnabled) {\n          _this5.initDragula();\n        }\n\n        if (_this5.refs.form) {\n          return _this5.webform.attach(_this5.refs.form);\n        }\n      });\n    }\n  }, {\n    key: \"searchFields\",\n    value: function searchFields() {\n      var _this6 = this;\n\n      var searchString = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var searchValue = searchString.toLowerCase();\n      var sidebar = this.refs['sidebar'];\n      var sidebarGroups = this.refs['sidebar-groups'];\n\n      if (!sidebar || !sidebarGroups) {\n        return;\n      }\n\n      var filterGroupBy = function filterGroupBy(group) {\n        var searchValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n        var result = _lodash.default.toPlainObject(group);\n\n        var _result$subgroups = result.subgroups,\n            subgroups = _result$subgroups === void 0 ? [] : _result$subgroups,\n            components = result.components;\n        var filteredComponents = [];\n\n        for (var key in components) {\n          var isMatchedToTitle = components[key].title.toLowerCase().match(searchValue);\n          var isMatchedToKey = components[key].key.toLowerCase().match(searchValue);\n\n          if (isMatchedToTitle || isMatchedToKey) {\n            filteredComponents.push(components[key]);\n          }\n        }\n\n        _this6.orderComponents(result, filteredComponents);\n\n        if (searchValue) {\n          result.default = true;\n        }\n\n        if (result.componentOrder.length || subgroups.length) {\n          return result;\n        }\n\n        return null;\n      };\n\n      var filterGroupOrder = function filterGroupOrder(groupOrder, searchValue) {\n        var result = _lodash.default.cloneDeep(groupOrder);\n\n        return result.filter(function (key) {\n          return filterGroupBy(_this6.groups[key], searchValue);\n        });\n      };\n\n      var filterSubgroups = function filterSubgroups(groups, searchValue) {\n        var result = _lodash.default.clone(groups);\n\n        return result.map(function (subgroup) {\n          return filterGroupBy(subgroup, searchValue);\n        }).filter(function (subgroup) {\n          return !_lodash.default.isNull(subgroup);\n        });\n      };\n\n      var toTemplate = function toTemplate(groupKey) {\n        return {\n          group: filterGroupBy(_this6.groups[groupKey], searchValue),\n          groupKey: groupKey,\n          groupId: sidebar.id || sidebarGroups.id,\n          subgroups: filterSubgroups(_this6.groups[groupKey].subgroups, searchValue).map(function (group) {\n            return _this6.renderTemplate('builderSidebarGroup', {\n              group: group,\n              groupKey: group.key,\n              groupId: \"group-container-\".concat(groupKey),\n              subgroups: []\n            });\n          })\n        };\n      };\n\n      sidebarGroups.innerHTML = filterGroupOrder(this.groupOrder, searchValue).map(function (groupKey) {\n        return _this6.renderTemplate('builderSidebarGroup', toTemplate(groupKey));\n      }).join('');\n      this.loadRefs(this.element, {\n        'sidebar-groups': 'single',\n        'sidebar-anchor': 'multiple',\n        'sidebar-group': 'multiple',\n        'sidebar-container': 'multiple'\n      });\n      this.updateDragAndDrop();\n    }\n  }, {\n    key: \"orderComponents\",\n    value: function orderComponents(groupInfo, foundComponents) {\n      var components = foundComponents || groupInfo.components;\n\n      if (components) {\n        groupInfo.componentOrder = Object.keys(components).map(function (key) {\n          return components[key];\n        }).filter(function (component) {\n          return component && !component.ignore && !component.ignoreForForm;\n        }).sort(function (a, b) {\n          return a.weight - b.weight;\n        }).map(function (component) {\n          return component.key;\n        });\n      }\n    }\n  }, {\n    key: \"updateDragAndDrop\",\n    value: function updateDragAndDrop() {\n      if (this.dragDropEnabled) {\n        this.initDragula();\n      }\n\n      if (this.refs.form) {\n        return this.webform.attach(this.refs.form);\n      }\n    }\n  }, {\n    key: \"initDragula\",\n    value: function initDragula() {\n      var _this7 = this;\n\n      var options = this.options;\n\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n\n      var containersArray = Array.prototype.slice.call(this.refs['sidebar-container']).filter(function (item) {\n        return item.id !== 'group-container-resource';\n      });\n\n      if (!dragula) {\n        return;\n      }\n\n      this.dragula = dragula(containersArray, {\n        moves: function moves(el) {\n          var moves = true;\n          var list = Array.from(el.classList).filter(function (item) {\n            return item.indexOf('formio-component-') === 0;\n          });\n          list.forEach(function (item) {\n            var key = item.slice('formio-component-'.length);\n\n            if (options.disabled && options.disabled.includes(key)) {\n              moves = false;\n            }\n          });\n\n          if (el.classList.contains('no-drag')) {\n            moves = false;\n          }\n\n          return moves;\n        },\n        copy: function copy(el) {\n          return el.classList.contains('drag-copy');\n        },\n        accepts: function accepts(el, target) {\n          return !el.contains(target) && !target.classList.contains('no-drop');\n        }\n      }).on('drop', function (element, target, source, sibling) {\n        return _this7.onDrop(element, target, source, sibling);\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n\n      this.dragula = null;\n\n      if (this.sideBarScroll && Templates.current.clearBuilderSidebarScroll) {\n        Templates.current.clearBuilderSidebarScroll.call(this, this);\n      }\n\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"getComponentInfo\",\n    value: function getComponentInfo(key, group) {\n      var info; // This is a new component\n\n      if (this.schemas.hasOwnProperty(key)) {\n        info = (0, _utils.fastCloneDeep)(this.schemas[key]);\n      } else if (this.groups.hasOwnProperty(group)) {\n        var groupComponents = this.groups[group].components;\n\n        if (groupComponents.hasOwnProperty(key)) {\n          info = (0, _utils.fastCloneDeep)(groupComponents[key].schema);\n        }\n      } else if (group.slice(0, group.indexOf('-')) === 'resource') {\n        // This is an existing resource field.\n        var resourceGroups = this.groups.resource.subgroups;\n\n        var resourceGroup = _lodash.default.find(resourceGroups, {\n          key: group\n        });\n\n        if (resourceGroup && resourceGroup.components.hasOwnProperty(key)) {\n          info = (0, _utils.fastCloneDeep)(resourceGroup.components[key].schema);\n        }\n      } else if (group === 'searchFields') {\n        //Search components go into this group\n        var _resourceGroups = this.groups.resource.subgroups;\n\n        for (var ix = 0; ix < _resourceGroups.length; ix++) {\n          var _resourceGroup = _resourceGroups[ix];\n\n          if (_resourceGroup.components.hasOwnProperty(key)) {\n            info = (0, _utils.fastCloneDeep)(_resourceGroup.components[key].schema);\n            break;\n          }\n        }\n      }\n\n      if (info) {\n        if (!info.key) {\n          info.key = this.generateKey(info);\n        }\n      }\n\n      return info;\n    }\n  }, {\n    key: \"getComponentsPath\",\n    value: function getComponentsPath(component, parent) {\n      // Get path to the component in the parent component.\n      var path = 'components';\n      var columnIndex = 0;\n      var tableRowIndex = 0;\n      var tableColumnIndex = 0;\n      var tabIndex = 0;\n\n      switch (parent.type) {\n        case 'table':\n          tableRowIndex = _lodash.default.findIndex(parent.rows, function (row) {\n            return row.some(function (column) {\n              return column.components.some(function (comp) {\n                return comp.key === component.key;\n              });\n            });\n          });\n          tableColumnIndex = _lodash.default.findIndex(parent.rows[tableRowIndex], function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"rows[\".concat(tableRowIndex, \"][\").concat(tableColumnIndex, \"].components\");\n          break;\n\n        case 'columns':\n          columnIndex = _lodash.default.findIndex(parent.columns, function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"columns[\".concat(columnIndex, \"].components\");\n          break;\n\n        case 'tabs':\n          tabIndex = _lodash.default.findIndex(parent.components, function (tab) {\n            return tab.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"components[\".concat(tabIndex, \"].components\");\n          break;\n      }\n\n      return path;\n    }\n    /* eslint-disable max-statements */\n\n  }, {\n    key: \"onDrop\",\n    value: function onDrop(element, target, source, sibling) {\n      var _this$groups$group,\n          _this8 = this;\n\n      if (!target) {\n        return;\n      } // If you try to drop within itself.\n\n\n      if (element.contains(target)) {\n        return;\n      }\n\n      var key = element.getAttribute('data-key');\n      var type = element.getAttribute('data-type');\n      var group = element.getAttribute('data-group');\n      var info, isNew, path, index;\n\n      if (key) {\n        // This is a new component.\n        info = this.getComponentInfo(key, group);\n\n        if (!info && type) {\n          info = this.getComponentInfo(type, group);\n        }\n\n        isNew = true;\n      } else if (source.formioContainer) {\n        index = _lodash.default.findIndex(source.formioContainer, {\n          key: element.formioComponent.component.key\n        });\n\n        if (index !== -1) {\n          // Grab and remove the component from the source container.\n          info = source.formioContainer.splice(_lodash.default.findIndex(source.formioContainer, {\n            key: element.formioComponent.component.key\n          }), 1); // Since splice returns an array of one object, we need to destructure it.\n\n          info = info[0];\n        }\n      } // If we haven't found the component, stop.\n\n\n      if (!info) {\n        return;\n      } // Show an error if siblings are disabled for a component and such a component already exists.\n\n\n      var draggableComponent = ((_this$groups$group = this.groups[group]) === null || _this$groups$group === void 0 ? void 0 : _this$groups$group.components[key]) || {};\n\n      if (draggableComponent.disableSiblings) {\n        var isCompAlreadyExists = false;\n        (0, _formUtils.eachComponent)(this.webform.components, function (component) {\n          if (component.type === draggableComponent.schema.type) {\n            isCompAlreadyExists = true;\n            return;\n          }\n        }, true);\n\n        if (isCompAlreadyExists) {\n          this.webform.redraw();\n          this.webform.setAlert('danger', \"You cannot add more than one \".concat(draggableComponent.key, \" component to one page.\"));\n          return;\n        }\n      }\n\n      if (target !== source) {\n        // Ensure the key remains unique in its new container.\n        _builder.default.uniquify(this.findNamespaceRoot(target.formioComponent), info);\n      }\n\n      var parent = target.formioComponent; // Insert in the new container.\n\n      if (target.formioContainer) {\n        if (sibling) {\n          if (!sibling.getAttribute('data-noattach')) {\n            index = _lodash.default.findIndex(target.formioContainer, {\n              key: _lodash.default.get(sibling, 'formioComponent.component.key')\n            });\n            index = index === -1 ? 0 : index;\n          } else {\n            index = sibling.getAttribute('data-position');\n          }\n\n          if (index !== -1) {\n            target.formioContainer.splice(index, 0, info);\n          }\n        } else {\n          target.formioContainer.push(info);\n        }\n\n        path = this.getComponentsPath(info, parent.component);\n        index = _lodash.default.findIndex(_lodash.default.get(parent.schema, path), {\n          key: info.key\n        });\n\n        if (index === -1) {\n          index = 0;\n        }\n      }\n\n      if (parent && parent.addChildComponent) {\n        parent.addChildComponent(info, element, target, source, sibling);\n      }\n\n      var componentInDataGrid = parent.type === 'datagrid';\n\n      if (isNew && !this.options.noNewEdit && !info.noNewEdit) {\n        this.editComponent(info, target, isNew, null, null, {\n          inDataGrid: componentInDataGrid\n        });\n      } // Only rebuild the parts needing to be rebuilt.\n\n\n      var rebuild;\n\n      if (target !== source) {\n        if (source.formioContainer && source.contains(target)) {\n          rebuild = source.formioComponent.rebuild();\n        } else if (target.contains(source)) {\n          rebuild = target.formioComponent.rebuild();\n        } else {\n          if (source.formioContainer) {\n            rebuild = source.formioComponent.rebuild();\n          }\n\n          rebuild = target.formioComponent.rebuild();\n        }\n      } else {\n        // If they are the same, only rebuild one.\n        rebuild = target.formioComponent.rebuild();\n      }\n\n      if (!rebuild) {\n        rebuild = _nativePromiseOnly.default.resolve();\n      }\n\n      return rebuild.then(function () {\n        _this8.emit('addComponent', info, parent, path, index, isNew && !_this8.options.noNewEdit && !info.noNewEdit);\n\n        if (!isNew || _this8.options.noNewEdit || info.noNewEdit) {\n          _this8.emit('change', _this8.form);\n        }\n      });\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form) {\n      var _this9 = this;\n\n      if (!form.components) {\n        form.components = [];\n      }\n\n      var isShowSubmitButton = !this.options.noDefaultSubmitButton && !form.components.length; // Ensure there is at least a submit button.\n\n      if (isShowSubmitButton) {\n        form.components.push({\n          type: 'button',\n          label: 'Submit',\n          key: 'submit',\n          size: 'md',\n          block: false,\n          action: 'submit',\n          disableOnInvalid: true,\n          theme: 'primary'\n        });\n      }\n\n      if (this.webform) {\n        var shouldRebuild = !this.webform.form.components || form.components.length !== this.webform.form.components.length;\n        return this.webform.setForm(form, {\n          keepAsReference: true\n        }).then(function () {\n          if (_this9.refs.form) {\n            _this9.builderHeight = _this9.refs.form.offsetHeight;\n          }\n\n          if (!shouldRebuild) {\n            return _this9.form;\n          }\n\n          return _this9.rebuild().then(function () {\n            return _this9.form;\n          });\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve(form);\n    }\n  }, {\n    key: \"populateRecaptchaSettings\",\n    value: function populateRecaptchaSettings(form) {\n      //populate isEnabled for recaptcha form settings\n      var isRecaptchaEnabled = false;\n\n      if (this.form.components) {\n        (0, _formUtils.eachComponent)(form.components, function (component) {\n          if (isRecaptchaEnabled) {\n            return;\n          }\n\n          if (component.type === 'recaptcha') {\n            isRecaptchaEnabled = true;\n            return false;\n          }\n        });\n\n        if (isRecaptchaEnabled) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', true);\n        } else if (_lodash.default.get(form, 'settings.recaptcha.isEnabled')) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', false);\n        }\n      }\n    }\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, parent, original) {\n      var _this10 = this;\n\n      if (!parent) {\n        return;\n      }\n\n      var remove = true;\n      var removingComponentsGroup = !component.skipRemoveConfirm && (Array.isArray(component.components) && component.components.length || Array.isArray(component.rows) && component.rows.length || Array.isArray(component.columns) && component.columns.length);\n\n      if (this.options.alwaysConfirmComponentRemoval || removingComponentsGroup) {\n        var message = removingComponentsGroup ? 'Removing this component will also remove all of its children. Are you sure you want to do this?' : 'Are you sure you want to remove this component?';\n        remove = window.confirm(this.t(message));\n      }\n\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n\n      var index = parent.formioContainer ? parent.formioContainer.indexOf(original) : 0;\n\n      if (remove && index !== -1) {\n        var path = this.getComponentsPath(component, parent.formioComponent.component);\n\n        if (parent.formioContainer) {\n          parent.formioContainer.splice(index, 1);\n        } else if (parent.formioComponent && parent.formioComponent.removeChildComponent) {\n          parent.formioComponent.removeChildComponent(component);\n        }\n\n        var rebuild = parent.formioComponent.rebuild() || _nativePromiseOnly.default.resolve();\n\n        rebuild.then(function () {\n          _this10.emit('removeComponent', component, parent.formioComponent.schema, path, index);\n\n          _this10.emit('change', _this10.form);\n        });\n      }\n\n      return remove;\n    }\n  }, {\n    key: \"updateComponent\",\n    value: function updateComponent(component, changed) {\n      // Update the preview.\n      if (this.preview) {\n        this.preview.form = {\n          components: [_lodash.default.omit(_objectSpread({}, component), ['hidden', 'conditional', 'calculateValue', 'logic', 'autofocus', 'customConditional'])],\n          config: this.options.formConfig || {}\n        };\n        var previewElement = this.componentEdit.querySelector('[ref=\"preview\"]');\n\n        if (previewElement) {\n          this.setContent(previewElement, this.preview.render());\n          this.preview.attach(previewElement);\n        }\n      } // Change the \"default value\" field to be reflective of this component.\n\n\n      var defaultValueComponent = (0, _formUtils.getComponent)(this.editForm.components, 'defaultValue', true);\n\n      if (defaultValueComponent && component.type !== 'hidden') {\n        var defaultChanged = changed && (changed.component && changed.component.key === 'defaultValue' || changed.instance && defaultValueComponent.hasComponent && defaultValueComponent.hasComponent(changed.instance));\n\n        if (!defaultChanged) {\n          _lodash.default.assign(defaultValueComponent.component, _lodash.default.omit(_objectSpread({}, component), ['key', 'label', 'placeholder', 'tooltip', 'hidden', 'autofocus', 'validate', 'disabled', 'defaultValue', 'customDefaultValue', 'calculateValue', 'conditional', 'customConditional', 'id']));\n\n          var parentComponent = defaultValueComponent.parent;\n          var tabIndex = -1;\n          var index = -1;\n          parentComponent.tabs.some(function (tab, tIndex) {\n            tab.some(function (comp, compIndex) {\n              if (comp.id === defaultValueComponent.id) {\n                tabIndex = tIndex;\n                index = compIndex;\n                return true;\n              }\n\n              return false;\n            });\n          });\n\n          if (tabIndex !== -1 && index !== -1 && changed && changed.value) {\n            var sibling = parentComponent.tabs[tabIndex][index + 1];\n            parentComponent.removeComponent(defaultValueComponent);\n            var newComp = parentComponent.addComponent(defaultValueComponent.component, defaultValueComponent.data, sibling);\n\n            _lodash.default.pull(newComp.validators, 'required');\n\n            parentComponent.tabs[tabIndex].splice(index, 1, newComp);\n\n            newComp.checkValidity = function () {\n              return true;\n            };\n\n            newComp.build(defaultValueComponent.element);\n          }\n        } else {\n          var dataPath = changed.instance._data.key;\n          var path = (0, _utils.getArrayFromComponentPath)(changed.instance.path);\n          path.shift();\n\n          if (path.length) {\n            path.unshift(component.key);\n            dataPath = (0, _utils.getStringFromComponentPath)(path);\n          }\n\n          _lodash.default.set(this.preview._data, dataPath, changed.value);\n\n          _lodash.default.set(this.webform._data, dataPath, changed.value);\n        }\n      } // Called when we update a component.\n\n\n      this.emit('updateComponent', component);\n    }\n  }, {\n    key: \"findRepeatablePaths\",\n    value: function findRepeatablePaths() {\n      var repeatablePaths = [];\n      var keys = new Map();\n      (0, _formUtils.eachComponent)(this.form.components, function (comp, path) {\n        if (!comp.key) {\n          return;\n        }\n\n        if (keys.has(comp.key)) {\n          if (keys.get(comp.key).includes(path)) {\n            repeatablePaths.push(path);\n          } else {\n            keys.set(comp.key, [].concat(_toConsumableArray(keys.get(comp.key)), [path]));\n          }\n        } else {\n          keys.set(comp.key, [path]);\n        }\n      }, true);\n      return repeatablePaths;\n    }\n  }, {\n    key: \"highlightInvalidComponents\",\n    value: function highlightInvalidComponents() {\n      var repeatablePaths = this.findRepeatablePaths();\n      var hasInvalidComponents = false;\n      this.webform.everyComponent(function (comp) {\n        var _comp$error, _comp$error$message;\n\n        var path = comp.path;\n\n        if (repeatablePaths.includes(path)) {\n          comp.setCustomValidity(\"API Key is not unique: \".concat(comp.key));\n          hasInvalidComponents = true;\n        } else if ((_comp$error = comp.error) !== null && _comp$error !== void 0 && (_comp$error$message = _comp$error.message) !== null && _comp$error$message !== void 0 && _comp$error$message.startsWith('API Key is not unique')) {\n          comp.setCustomValidity('');\n        }\n      });\n      this.emit('builderFormValidityChange', hasInvalidComponents);\n    }\n    /**\n     * Called when a new component is saved.\n     *\n     * @param parent\n     * @param component\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"saveComponent\",\n    value: function saveComponent(component, parent, isNew, original) {\n      var _this11 = this;\n\n      this.editForm.detach();\n      var parentContainer = parent ? parent.formioContainer : this.container;\n      var parentComponent = parent ? parent.formioComponent : this;\n      this.dialog.close();\n      var path = parentContainer ? this.getComponentsPath(component, parentComponent.component) : '';\n\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n\n      var index = parentContainer ? parentContainer.indexOf(original) : 0;\n\n      if (index !== -1) {\n        var submissionData = this.editForm.submission.data;\n        submissionData = submissionData.componentJson || submissionData;\n        var fieldsToRemoveDoubleQuotes = ['label', 'tooltip', 'placeholder'];\n\n        if (submissionData) {\n          fieldsToRemoveDoubleQuotes.forEach(function (key) {\n            if (submissionData[key]) {\n              submissionData[key] = submissionData[key].replace(/\"/g, \"'\");\n            }\n          });\n        }\n\n        this.hook('beforeSaveComponentSettings', submissionData);\n        var comp = null;\n        parentComponent.getComponents().forEach(function (component) {\n          if (component.component.key === original.key) {\n            comp = component;\n          }\n        });\n        var originalComp = comp.component;\n        var originalComponentSchema = comp.schema;\n        var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n\n        if (parentContainer && !isParentSaveChildMethod) {\n          parentContainer[index] = submissionData;\n\n          if (comp) {\n            comp.component = submissionData;\n          }\n        } else if (isParentSaveChildMethod) {\n          parent.formioComponent.saveChildComponent(submissionData);\n        }\n\n        var rebuild = parentComponent.rebuild() || _nativePromiseOnly.default.resolve();\n\n        return rebuild.then(function () {\n          var schema = parentContainer ? parentContainer[index] : comp ? comp.schema : [];\n\n          _this11.emitSaveComponentEvent(schema, originalComp, parentComponent.schema, path, index, isNew, originalComponentSchema);\n\n          _this11.emit('change', _this11.form);\n\n          _this11.highlightInvalidComponents();\n        });\n      }\n\n      this.highlightInvalidComponents();\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"emitSaveComponentEvent\",\n    value: function emitSaveComponentEvent(schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema) {\n      this.emit('saveComponent', schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema);\n    }\n  }, {\n    key: \"editComponent\",\n    value: function editComponent(component, parent, isNew, isJsonEdit, original) {\n      var _this12 = this;\n\n      var flags = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n\n      if (!component.key) {\n        return;\n      }\n\n      var saved = false;\n      var componentCopy = (0, _utils.fastCloneDeep)(component);\n      var ComponentClass = _Components.default.components[componentCopy.type];\n      var isCustom = ComponentClass === undefined;\n      isJsonEdit = isJsonEdit || isCustom;\n      ComponentClass = isCustom ? _Components.default.components.unknown : ComponentClass; // Make sure we only have one dialog open at a time.\n\n      if (this.dialog) {\n        this.dialog.close();\n        this.highlightInvalidComponents();\n      } // This is the render step.\n\n\n      var editFormOptions = _lodash.default.clone(_lodash.default.get(this, 'options.editForm', {}));\n\n      if (this.editForm) {\n        this.editForm.destroy();\n      } // Allow editForm overrides per component.\n\n\n      var overrides = _lodash.default.get(this.options, \"editForm.\".concat(componentCopy.type), {}); // Pass along the form being edited.\n\n\n      editFormOptions.editForm = this.form;\n      editFormOptions.editComponent = component;\n      editFormOptions.flags = flags;\n      this.hook('editComponentParentInstance', editFormOptions, parent);\n      this.editForm = new _Webform.default(_objectSpread(_objectSpread({}, _lodash.default.omit(this.options, ['hooks', 'builder', 'events', 'attachMode', 'skipInit'])), {}, {\n        language: this.options.language\n      }, editFormOptions));\n      this.hook('editFormProperties', parent);\n      this.editForm.form = isJsonEdit && !isCustom ? {\n        components: [{\n          type: 'textarea',\n          as: 'json',\n          editor: 'ace',\n          weight: 10,\n          input: true,\n          key: 'componentJson',\n          label: 'Component JSON',\n          tooltip: 'Edit the JSON for this component.'\n        }, {\n          type: 'checkbox',\n          key: 'showFullSchema',\n          label: 'Full Schema'\n        }]\n      } : ComponentClass.editForm(_lodash.default.cloneDeep(overrides));\n      var instanceOptions = {};\n      this.hook('instanceOptionsPreview', instanceOptions);\n      var instance = new ComponentClass(componentCopy, instanceOptions);\n      var schema = this.hook('builderComponentSchema', component, instance);\n      this.editForm.submission = isJsonEdit ? {\n        data: {\n          componentJson: schema,\n          showFullSchema: this.options.showFullJsonSchema\n        }\n      } : {\n        data: instance.component\n      };\n\n      if (this.preview) {\n        this.preview.destroy();\n      }\n\n      if (!ComponentClass.builderInfo.hasOwnProperty('preview') || ComponentClass.builderInfo.preview) {\n        this.preview = new _Webform.default(_lodash.default.omit(_objectSpread(_objectSpread({}, this.options), {}, {\n          preview: true\n        }), ['hooks', 'builder', 'events', 'attachMode', 'calculateValue']));\n        this.hook('previewFormSettitngs', schema, isJsonEdit);\n      }\n\n      this.componentEdit = this.ce('div', {\n        'class': 'component-edit-container'\n      });\n      this.setContent(this.componentEdit, this.renderTemplate('builderEditForm', {\n        componentInfo: ComponentClass.builderInfo,\n        editForm: this.editForm.render(),\n        preview: this.preview ? this.preview.render() : false,\n        helplinks: this.helplinks\n      }));\n      this.dialog = this.createModal(this.componentEdit, _lodash.default.get(this.options, 'dialogAttr', {})); // This is the attach step.\n\n      this.editForm.attach(this.componentEdit.querySelector('[ref=\"editForm\"]'));\n      this.hook('editFormWrapper');\n      this.updateComponent(componentCopy);\n      this.editForm.on('change', function (event) {\n        if (event.changed) {\n          if (event.changed.component && event.changed.component.key === 'showFullSchema') {\n            var value = event.changed.value;\n            _this12.editForm.submission = {\n              data: {\n                componentJson: value ? instance.component : component,\n                showFullSchema: value\n              }\n            };\n            return;\n          } // See if this is a manually modified key. Treat custom component keys as manually modified\n\n\n          if (event.changed.component && event.changed.component.key === 'key' || isJsonEdit) {\n            componentCopy.keyModified = true;\n          }\n\n          if (event.changed.component && ['label', 'title'].includes(event.changed.component.key)) {\n            // Ensure this component has a key.\n            if (isNew) {\n              if (!event.data.keyModified) {\n                _this12.editForm.everyComponent(function (component) {\n                  if (component.key === 'key' && component.parent.component.key === 'tabs') {\n                    component.setValue(_this12.updateComponentKey(event.data));\n                    return false;\n                  }\n                });\n              }\n\n              if (_this12.form) {\n                var formComponents = _this12.findNamespaceRoot(parent.formioComponent); // excluding component which key uniqueness is to be checked to prevent the comparing of the same keys\n\n\n                formComponents = formComponents.filter(function (comp) {\n                  return editFormOptions.editComponent.id !== comp.id;\n                }); // Set a unique key for this component.\n\n                _builder.default.uniquify(formComponents, event.data);\n              }\n            }\n          } // Update the component.\n\n\n          _this12.updateComponent(event.data.componentJson || event.data, event.changed);\n        }\n      });\n      var cancelButtons = this.componentEdit.querySelectorAll('[ref=\"cancelButton\"]');\n      cancelButtons.forEach(function (cancelButton) {\n        _this12.addEventListener(cancelButton, 'click', function (event) {\n          event.preventDefault();\n\n          _this12.editForm.detach();\n\n          _this12.emit('cancelComponent', component);\n\n          _this12.dialog.close();\n\n          _this12.highlightInvalidComponents();\n        });\n      });\n      var removeButtons = this.componentEdit.querySelectorAll('[ref=\"removeButton\"]');\n      removeButtons.forEach(function (removeButton) {\n        _this12.addEventListener(removeButton, 'click', function (event) {\n          event.preventDefault(); // Since we are already removing the component, don't trigger another remove.\n\n          saved = true;\n\n          _this12.editForm.detach();\n\n          _this12.removeComponent(component, parent, original);\n\n          _this12.dialog.close();\n\n          _this12.highlightInvalidComponents();\n        });\n      });\n      var saveButtons = this.componentEdit.querySelectorAll('[ref=\"saveButton\"]');\n      saveButtons.forEach(function (saveButton) {\n        _this12.addEventListener(saveButton, 'click', function (event) {\n          event.preventDefault();\n\n          if (!_this12.editForm.checkValidity(_this12.editForm.data, true, _this12.editForm.data)) {\n            _this12.editForm.setPristine(false);\n\n            _this12.editForm.showErrors();\n\n            return false;\n          }\n\n          saved = true;\n\n          _this12.saveComponent(component, parent, isNew, original);\n        });\n      });\n\n      var dialogClose = function dialogClose() {\n        _this12.editForm.destroy(true);\n\n        if (_this12.preview) {\n          _this12.preview.destroy(true);\n\n          _this12.preview = null;\n        }\n\n        if (isNew && !saved) {\n          _this12.removeComponent(component, parent, original);\n\n          _this12.highlightInvalidComponents();\n        } // Clean up.\n\n\n        _this12.removeEventListener(_this12.dialog, 'close', dialogClose);\n\n        _this12.dialog = null;\n      };\n\n      this.addEventListener(this.dialog, 'close', dialogClose); // Called when we edit a component.\n\n      this.emit('editComponent', component);\n    }\n  }, {\n    key: \"updateComponentKey\",\n    value: function updateComponentKey(data) {\n      return _lodash.default.camelCase(data.title || data.label || data.placeholder || data.type).replace(/^[0-9]*/, '');\n    }\n    /**\n     * Creates copy of component schema and stores it under sessionStorage.\n     * @param {Component} component\n     * @return {*}\n     */\n\n  }, {\n    key: \"copyComponent\",\n    value: function copyComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n\n      this.addClass(this.refs.form, 'builder-paste-mode');\n      window.sessionStorage.setItem('formio.clipboard', JSON.stringify(component.schema));\n    }\n    /**\n     * Paste copied component after the current component.\n     * @param {Component} component\n     * @return {*}\n     */\n\n  }, {\n    key: \"pasteComponent\",\n    value: function pasteComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n\n      this.removeClass(this.refs.form, 'builder-paste-mode');\n\n      if (window.sessionStorage) {\n        var data = window.sessionStorage.getItem('formio.clipboard');\n\n        if (data) {\n          var schema = JSON.parse(data);\n          var parent = this.getParentElement(component.element);\n\n          if (parent) {\n            _builder.default.uniquify(this.findNamespaceRoot(parent.formioComponent), schema);\n\n            var path = '';\n            var index = 0;\n            var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n\n            if (parent.formioContainer && !isParentSaveChildMethod) {\n              index = parent.formioContainer.indexOf(component.component);\n              path = this.getComponentsPath(schema, parent.formioComponent.component);\n              parent.formioContainer.splice(index + 1, 0, schema);\n            } else if (isParentSaveChildMethod) {\n              parent.formioComponent.saveChildComponent(schema, false);\n            }\n\n            parent.formioComponent.rebuild();\n            this.emitSaveComponentEvent(schema, schema, parent.formioComponent.component, path, index + 1, true, schema);\n          }\n\n          this.emit('change', this.form);\n        }\n      }\n    }\n  }, {\n    key: \"isParentSaveChildMethod\",\n    value: function isParentSaveChildMethod(parentComp) {\n      return !!(parentComp && parentComp.saveChildComponent);\n    }\n  }, {\n    key: \"getParentElement\",\n    value: function getParentElement(element) {\n      var container = element;\n\n      do {\n        container = container.parentNode;\n      } while (container && !container.formioComponent);\n\n      return container;\n    }\n  }, {\n    key: \"addBuilderComponentInfo\",\n    value: function addBuilderComponentInfo(component) {\n      if (!component || !component.group || !this.groups[component.group]) {\n        return;\n      }\n\n      component = _lodash.default.clone(component);\n      var groupInfo = this.groups[component.group];\n\n      if (!groupInfo.components.hasOwnProperty(component.key)) {\n        groupInfo.components[component.key] = component;\n      }\n\n      return component;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      if (this.webform) {\n        this.webform.init();\n      }\n\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"init\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      if (this.webform.initialized) {\n        this.webform.clear();\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(deleteFromGlobal) {\n      if (this.webform.initialized) {\n        this.webform.destroy(deleteFromGlobal);\n      }\n\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"destroy\", this).call(this, deleteFromGlobal);\n    }\n  }, {\n    key: \"addBuilderGroup\",\n    value: function addBuilderGroup(name, group) {\n      if (!this.groups[name]) {\n        this.groups[name] = group;\n        this.groupOrder.push(name);\n        this.triggerRedraw();\n      } else {\n        this.updateBuilderGroup(name, group);\n      }\n    }\n  }, {\n    key: \"updateBuilderGroup\",\n    value: function updateBuilderGroup(name, group) {\n      if (this.groups[name]) {\n        this.groups[name] = group;\n        this.triggerRedraw();\n      }\n    }\n  }, {\n    key: \"generateKey\",\n    value: function generateKey(info) {\n      return _lodash.default.camelCase(info.key || info.title || info.label || info.placeholder || info.type);\n    }\n  }]);\n\n  return WebformBuilder;\n}(_Component2.default);\n\nexports.default = WebformBuilder;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/forms-flow-master/forms-flow-ai/forms-flow-web/node_modules/formiojs/WebformBuilder.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_Webform","_interopRequireDefault","_Component2","_tooltip","_nativePromiseOnly","_Components","_Formio","_utils","_formUtils","_builder","_lodash","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","Array","from","test","iter","isArray","len","length","i","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","Templates","GlobalFormio","dragula","window","WebformBuilder","_Component","_super","_this","element","options","HTMLElement","skipInit","display","builderHeight","schemas","repeatablePaths","sideBarScroll","sideBarScrollOffset","dragDropEnabled","builder","defaultsDeep","defaultGroups","each","config","groups","groupOrder","_loop","group","components","componentOrder","subgroups","map","groupKey","ignore","sort","a","b","weight","type","component","builderInfo","schema","addBuilderComponentInfo","_group","info","comp","orderComponents","hooks","renderComponent","html","_ref","_self$component","template","hook","replace","disabled","includes","parent","noDragDrop","renderTemplate","disableBuilderActions","childComponent","renderComponents","_ref2","nodrop","position","renderInput","_ref3","renderLoading","_ref4","attachComponents","container","containerElement","querySelector","concat","formioContainer","formioComponent","allowDrop","containers","children","attachDatagrid","loadRefs","dataGridContainer","refs","parentNode","attachComponent","bind","query","params","limit","select","resourceTag","tags","formio","projectUrl","isResourcesDisabled","resource","loadProject","then","project","formConfig","pathToFormConfig","webformConfig","webform","set","catch","err","console","warn","message","noProject","resourceOptions","loadForms","resources","title","addExistingResourceFields","attachMode","createForm","pathComponentsMapping","arrayDataComponentPaths","nestedDataComponents","arrayDataComponents","_this2","index","resourceKey","subgroup","eachComponent","resourceFilter","indexOf","componentName","label","upperFirst","merge","fastCloneDeep","lockKey","noSource","_id","undefined","isNew","triggerRedraw","attachTooltip","trigger","placement","_this3","removeComponent","editComponent","moveComponent","copyComponent","pasteComponent","editJson","t","addEventListener","pasteToolTip","hide","getParentElement","inDataGrid","isInDataGrid","form","ready","basic","advanced","layout","data","premium","redraw","setForm","findNamespaceRoot","path","getArrayFromComponentPath","getComponent","namespaceKey","recurseNamespace","componentSchema","namespaceComponent","tree","arrayTree","render","_this4","sidebar","scrollEnabled","groupId","id","attach","_this5","on","populateRecaptchaSettings","current","handleBuilderSidebarScroll","sessionStorage","getItem","addClass","bootstrapVersion","style","getAttribute","anchor","clickedParentId","clickedId","groupIndex","openByDefault","groupParent","debounce","searchString","searchFields","initDragula","_this6","searchValue","toLowerCase","sidebarGroups","filterGroupBy","toPlainObject","_result$subgroups","filteredComponents","isMatchedToTitle","match","isMatchedToKey","filterGroupOrder","cloneDeep","filterSubgroups","clone","isNull","toTemplate","innerHTML","join","updateDragAndDrop","groupInfo","foundComponents","ignoreForForm","_this7","destroy","containersArray","item","moves","el","list","classList","contains","copy","accepts","sibling","onDrop","detach","clearBuilderSidebarScroll","getComponentInfo","groupComponents","resourceGroups","resourceGroup","find","_resourceGroups","ix","_resourceGroup","generateKey","getComponentsPath","columnIndex","tableRowIndex","tableColumnIndex","tabIndex","findIndex","rows","row","some","column","columns","tab","_this$groups$group","_this8","splice","draggableComponent","disableSiblings","isCompAlreadyExists","setAlert","uniquify","addChildComponent","componentInDataGrid","noNewEdit","rebuild","resolve","emit","_this9","isShowSubmitButton","noDefaultSubmitButton","size","block","action","disableOnInvalid","theme","shouldRebuild","keepAsReference","offsetHeight","isRecaptchaEnabled","original","_this10","remove","removingComponentsGroup","skipRemoveConfirm","alwaysConfirmComponentRemoval","confirm","removeChildComponent","updateComponent","changed","preview","omit","previewElement","componentEdit","setContent","defaultValueComponent","editForm","defaultChanged","hasComponent","assign","parentComponent","tabs","tIndex","compIndex","newComp","addComponent","pull","validators","checkValidity","build","dataPath","_data","shift","unshift","getStringFromComponentPath","findRepeatablePaths","Map","has","highlightInvalidComponents","hasInvalidComponents","everyComponent","_comp$error","_comp$error$message","setCustomValidity","error","startsWith","saveComponent","_this11","parentContainer","dialog","close","submissionData","submission","componentJson","fieldsToRemoveDoubleQuotes","getComponents","originalComp","originalComponentSchema","isParentSaveChildMethod","saveChildComponent","emitSaveComponentEvent","parentComponentSchema","isJsonEdit","_this12","flags","saved","componentCopy","ComponentClass","isCustom","unknown","editFormOptions","overrides","language","as","editor","input","tooltip","instanceOptions","showFullSchema","showFullJsonSchema","ce","componentInfo","helplinks","createModal","event","keyModified","setValue","updateComponentKey","formComponents","cancelButtons","querySelectorAll","cancelButton","preventDefault","removeButtons","removeButton","saveButtons","saveButton","setPristine","showErrors","dialogClose","removeEventListener","camelCase","placeholder","setItem","JSON","stringify","removeClass","parse","parentComp","init","clear","initialized","deleteFromGlobal","addBuilderGroup","updateBuilderGroup"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.sort.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.map.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.string.starts-with.js\");\n\nrequire(\"core-js/modules/es.regexp.flags.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _Webform = _interopRequireDefault(require(\"./Webform\"));\n\nvar _Component2 = _interopRequireDefault(require(\"./components/_classes/component/Component\"));\n\nvar _tooltip = _interopRequireDefault(require(\"tooltip.js\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _Components = _interopRequireDefault(require(\"./components/Components\"));\n\nvar _Formio = require(\"./Formio\");\n\nvar _utils = require(\"./utils/utils\");\n\nvar _formUtils = require(\"./utils/formUtils\");\n\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nrequire('./components/builder');\n\nvar Templates = _Formio.GlobalFormio.Templates;\n\nif (!Templates) {\n  Templates = require('./templates/Templates').default;\n}\n\nvar dragula;\n\nif (typeof window !== 'undefined') {\n  // Import from \"dist\" because it would require and \"global\" would not be defined in Angular apps.\n  dragula = require('dragula/dist/dragula');\n}\n\nvar WebformBuilder = /*#__PURE__*/function (_Component) {\n  _inherits(WebformBuilder, _Component);\n\n  var _super = _createSuper(WebformBuilder);\n\n  // eslint-disable-next-line max-statements\n  function WebformBuilder() {\n    var _this;\n\n    _classCallCheck(this, WebformBuilder);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Reset skipInit in case PDFBuilder has set it.\n\n\n    options.skipInit = false;\n    options.display = options.display || 'form';\n    _this = _super.call(this, null, options);\n    _this.element = element;\n    _this.builderHeight = 0;\n    _this.schemas = {};\n    _this.repeatablePaths = [];\n    _this.sideBarScroll = _lodash.default.get(_this.options, 'sideBarScroll', true);\n    _this.sideBarScrollOffset = _lodash.default.get(_this.options, 'sideBarScrollOffset', 0);\n    _this.dragDropEnabled = true; // Setup the builder options.\n\n    _this.builder = _lodash.default.defaultsDeep({}, _this.options.builder, _this.defaultGroups); // Turn off if explicitely said to do so...\n\n    _lodash.default.each(_this.defaultGroups, function (config, key) {\n      if (config === false) {\n        _this.builder[key] = false;\n      }\n    }); // Add the groups.\n\n\n    _this.groups = {};\n    _this.groupOrder = [];\n\n    var _loop = function _loop(group) {\n      if (_this.builder[group]) {\n        _this.builder[group].key = group;\n        _this.groups[group] = _this.builder[group];\n        _this.groups[group].components = _this.groups[group].components || {};\n        _this.groups[group].componentOrder = _this.groups[group].componentOrder || [];\n        _this.groups[group].subgroups = Object.keys(_this.groups[group].groups || {}).map(function (groupKey) {\n          _this.groups[group].groups[groupKey].componentOrder = Object.keys(_this.groups[group].groups[groupKey].components).map(function (key) {\n            return key;\n          });\n          return _this.groups[group].groups[groupKey];\n        });\n\n        _this.groupOrder.push(_this.groups[group]);\n      }\n    };\n\n    for (var group in _this.builder) {\n      _loop(group);\n    }\n\n    _this.groupOrder = _this.groupOrder.filter(function (group) {\n      return group && !group.ignore;\n    }).sort(function (a, b) {\n      return a.weight - b.weight;\n    }).map(function (group) {\n      return group.key;\n    });\n\n    for (var type in _Components.default.components) {\n      var component = _Components.default.components[type];\n\n      if (component.builderInfo && component.builderInfo.schema) {\n        _this.schemas[type] = component.builderInfo.schema;\n        component.type = type;\n        var builderInfo = component.builderInfo;\n        builderInfo.key = component.type;\n\n        _this.addBuilderComponentInfo(builderInfo);\n      }\n    } // Filter out any extra components.\n    // Add the components in each group.\n\n\n    for (var _group in _this.groups) {\n      var info = _this.groups[_group];\n\n      for (var key in info.components) {\n        var comp = info.components[key];\n\n        if (comp === true && _Components.default.components[key] && _Components.default.components[key].builderInfo) {\n          comp = _Components.default.components[key].builderInfo;\n        }\n\n        if (comp && comp.schema) {\n          _this.schemas[key] = comp.schema;\n          info.components[key] = comp;\n          info.components[key].key = key;\n        } else {\n          // Do not include this component in the components array.\n          delete info.components[key];\n        }\n      } // Order the components.\n\n\n      _this.orderComponents(info);\n    }\n\n    _this.options.hooks = _this.options.hooks || {};\n\n    _this.options.hooks.renderComponent = function (html, _ref) {\n      var _self$component;\n\n      var component = _ref.component,\n          self = _ref.self;\n\n      if (self.type === 'form' && !self.key) {\n        var template = _this.hook('renderComponentFormTemplate', html.replace('formio-component-form', '')); // The main webform shouldn't have this class as it adds extra styles.\n\n\n        return template;\n      }\n\n      if (_this.options.disabled && _this.options.disabled.includes(self.key) || self.parent.noDragDrop) {\n        return html;\n      }\n\n      return _this.renderTemplate('builderComponent', {\n        html: html,\n        disableBuilderActions: self === null || self === void 0 ? void 0 : (_self$component = self.component) === null || _self$component === void 0 ? void 0 : _self$component.disableBuilderActions,\n        childComponent: component\n      });\n    };\n\n    _this.options.hooks.renderComponents = function (html, _ref2) {\n      var components = _ref2.components,\n          self = _ref2.self;\n\n      // if Datagrid and already has a component, don't make it droppable.\n      if (self.type === 'datagrid' && components.length > 0 || self.noDragDrop) {\n        return html;\n      }\n\n      if (!components || !components.length && !components.nodrop || self.type === 'form' && components.length <= 1 && (components.length === 0 || components[0].type === 'button')) {\n        html = _this.renderTemplate('builderPlaceholder', {\n          position: 0\n        }) + html;\n      }\n\n      return _this.renderTemplate('builderComponents', {\n        key: self.key,\n        type: self.type,\n        html: html\n      });\n    };\n\n    _this.options.hooks.renderInput = function (html, _ref3) {\n      var self = _ref3.self;\n\n      if (self.type === 'hidden') {\n        return html + self.name;\n      }\n\n      return html;\n    };\n\n    _this.options.hooks.renderLoading = function (html, _ref4) {\n      var self = _ref4.self;\n\n      if (self.type === 'form' && self.key) {\n        return self.name;\n      }\n\n      return html;\n    };\n\n    _this.options.hooks.attachComponents = function (element, components, container, component) {\n      // Don't attach if no element was found or component doesn't participate in drag'n'drop.\n      if (!element) {\n        return;\n      }\n\n      if (component.noDragDrop) {\n        return element;\n      } // Attach container and component to element for later reference.\n\n\n      var containerElement = element.querySelector(\"[ref=\\\"\".concat(component.component.key, \"-container\\\"]\")) || element;\n      containerElement.formioContainer = container;\n      containerElement.formioComponent = component; // Add container to draggable list.\n\n      if (_this.dragula && _this.allowDrop(element)) {\n        _this.dragula.containers.push(containerElement);\n      } // If this is an existing datagrid element, don't make it draggable.\n\n\n      if ((component.type === 'datagrid' || component.type === 'datamap') && components.length > 0) {\n        return element;\n      } // Since we added a wrapper, need to return the original element so that we can find the components inside it.\n\n\n      return element.children[0];\n    };\n\n    _this.options.hooks.attachDatagrid = function (element, component) {\n      component.loadRefs(element, _defineProperty({}, \"\".concat(component.key, \"-container\"), 'single'));\n      var dataGridContainer = component.refs[\"\".concat(component.key, \"-container\")];\n\n      if (dataGridContainer) {\n        component.attachComponents(dataGridContainer.parentNode, [], component.component.components);\n      } // Need to set up horizontal rearrangement of fields.\n\n    };\n\n    _this.options.hooks.attachComponent = _this.attachComponent.bind(_assertThisInitialized(_this)); // Load resources tagged as 'builder'\n\n    var query = {\n      params: {\n        type: 'resource',\n        limit: 4294967295,\n        select: '_id,title,name,components'\n      }\n    };\n\n    if (_this.options && _this.options.resourceTag) {\n      query.params.tags = [_this.options.resourceTag];\n    } else if (!_this.options || !_this.options.hasOwnProperty('resourceTag')) {\n      query.params.tags = ['builder'];\n    }\n\n    var formio = new _Formio.GlobalFormio(_Formio.GlobalFormio.projectUrl);\n    var isResourcesDisabled = _this.options.builder && _this.options.builder.resource === false;\n    formio.loadProject().then(function (project) {\n      if (project && (_lodash.default.get(project, 'settings.addConfigToForms', false) || _lodash.default.get(project, 'addConfigToForms', false))) {\n        var config = project.config || {};\n        _this.options.formConfig = config;\n        var pathToFormConfig = 'webform._form.config';\n\n        var webformConfig = _lodash.default.get(_assertThisInitialized(_this), pathToFormConfig);\n\n        if (_this.webform && !webformConfig) {\n          _lodash.default.set(_assertThisInitialized(_this), pathToFormConfig, config);\n        }\n      }\n    }).catch(function (err) {\n      console.warn(\"Could not load project settings: \".concat(err.message || err));\n    });\n\n    if (!formio.noProject && !isResourcesDisabled) {\n      var resourceOptions = _this.options.builder && _this.options.builder.resource;\n      formio.loadForms(query).then(function (resources) {\n        if (resources.length) {\n          _this.builder.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n          _this.groups.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n\n          if (!_this.groupOrder.includes('resource')) {\n            _this.groupOrder.push('resource');\n          }\n\n          _this.addExistingResourceFields(resources);\n        }\n      });\n    } // Notify components if they need to modify their render.\n\n\n    _this.options.attachMode = 'builder';\n    _this.webform = _this.webform || _this.createForm(_this.options);\n    _this.pathComponentsMapping = {};\n    _this.arrayDataComponentPaths = [];\n    _this.nestedDataComponents = [];\n    _this.arrayDataComponents = [];\n    return _this;\n  }\n\n  _createClass(WebformBuilder, [{\n    key: \"allowDrop\",\n    value: function allowDrop() {\n      return true;\n    }\n  }, {\n    key: \"addExistingResourceFields\",\n    value: function addExistingResourceFields(resources) {\n      var _this2 = this;\n\n      _lodash.default.each(resources, function (resource, index) {\n        var resourceKey = \"resource-\".concat(resource.name);\n        var subgroup = {\n          key: resourceKey,\n          title: resource.title,\n          components: [],\n          componentOrder: [],\n          default: index === 0\n        };\n        (0, _formUtils.eachComponent)(resource.components, function (component) {\n          if (component.type === 'button') return;\n          if (_this2.options && _this2.options.resourceFilter && (!component.tags || component.tags.indexOf(_this2.options.resourceFilter) === -1)) return;\n          var componentName = component.label;\n\n          if (!componentName && component.key) {\n            componentName = _lodash.default.upperFirst(component.key);\n          }\n\n          subgroup.componentOrder.push(component.key);\n          subgroup.components[component.key] = _lodash.default.merge((0, _utils.fastCloneDeep)(_Components.default.components[component.type] ? _Components.default.components[component.type].builderInfo : _Components.default.components['unknown'].builderInfo), {\n            key: component.key,\n            title: componentName,\n            group: 'resource',\n            subgroup: resourceKey\n          }, {\n            schema: _objectSpread(_objectSpread({}, component), {}, {\n              label: component.label,\n              key: component.key,\n              lockKey: true,\n              source: !_this2.options.noSource ? resource._id : undefined,\n              isNew: true\n            })\n          });\n        }, true);\n\n        _this2.groups.resource.subgroups.push(subgroup);\n      });\n\n      this.triggerRedraw();\n    }\n  }, {\n    key: \"attachTooltip\",\n    value: function attachTooltip(component, title) {\n      return new _tooltip.default(component, {\n        trigger: 'hover focus',\n        placement: 'top',\n        title: title\n      });\n    }\n  }, {\n    key: \"attachComponent\",\n    value: function attachComponent(element, component) {\n      var _this3 = this;\n\n      // Add component to element for later reference.\n      element.formioComponent = component;\n      component.loadRefs(element, {\n        removeComponent: 'single',\n        editComponent: 'single',\n        moveComponent: 'single',\n        copyComponent: 'single',\n        pasteComponent: 'single',\n        editJson: 'single'\n      });\n\n      if (component.refs.copyComponent) {\n        this.attachTooltip(component.refs.copyComponent, this.t('Copy'));\n        component.addEventListener(component.refs.copyComponent, 'click', function () {\n          return _this3.copyComponent(component);\n        });\n      }\n\n      if (component.refs.pasteComponent) {\n        var pasteToolTip = this.attachTooltip(component.refs.pasteComponent, this.t('Paste below'));\n        component.addEventListener(component.refs.pasteComponent, 'click', function () {\n          pasteToolTip.hide();\n\n          _this3.pasteComponent(component);\n        });\n      }\n\n      if (component.refs.moveComponent) {\n        this.attachTooltip(component.refs.moveComponent, this.t('Move'));\n      }\n\n      var parent = this.getParentElement(element);\n\n      if (component.refs.editComponent) {\n        this.attachTooltip(component.refs.editComponent, this.t('Edit'));\n        component.addEventListener(component.refs.editComponent, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, false, component.component, {\n            inDataGrid: component.isInDataGrid\n          });\n        });\n      }\n\n      if (component.refs.editJson) {\n        this.attachTooltip(component.refs.editJson, this.t('Edit JSON'));\n        component.addEventListener(component.refs.editJson, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, true, component.component);\n        });\n      }\n\n      if (component.refs.removeComponent) {\n        this.attachTooltip(component.refs.removeComponent, this.t('Remove'));\n        component.addEventListener(component.refs.removeComponent, 'click', function () {\n          return _this3.removeComponent(component.schema, parent, component.component);\n        });\n      }\n\n      return element;\n    }\n  }, {\n    key: \"createForm\",\n    value: function createForm(options) {\n      this.webform = new _Webform.default(this.element, options);\n\n      if (this.element) {\n        this.loadRefs(this.element, {\n          form: 'single'\n        });\n\n        if (this.refs.form) {\n          this.webform.element = this.refs.form;\n        }\n      }\n\n      return this.webform;\n    }\n    /**\n     * Called when everything is ready.\n     *\n     * @returns {Promise} - Wait for webform to be ready.\n     */\n\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.webform.ready;\n    }\n  }, {\n    key: \"defaultGroups\",\n    get: function get() {\n      return {\n        basic: {\n          title: 'Basic',\n          weight: 0,\n          default: true\n        },\n        advanced: {\n          title: 'Advanced',\n          weight: 10\n        },\n        layout: {\n          title: 'Layout',\n          weight: 20\n        },\n        data: {\n          title: 'Data',\n          weight: 30\n        },\n        premium: {\n          title: 'Premium',\n          weight: 40\n        }\n      };\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      return _Webform.default.prototype.redraw.call(this);\n    }\n  }, {\n    key: \"form\",\n    get: function get() {\n      return this.webform.form;\n    },\n    set: function set(value) {\n      this.setForm(value);\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.webform.schema;\n    }\n  }, {\n    key: \"container\",\n    get: function get() {\n      return this.webform.form.components;\n    }\n    /**\n     * When a component sets its api key, we need to check if it is unique within its namespace. Find the namespace root\n     * so we can calculate this correctly.\n     * @param component\n     */\n\n  }, {\n    key: \"findNamespaceRoot\",\n    value: function findNamespaceRoot(component) {\n      var path = (0, _utils.getArrayFromComponentPath)(component.path); // First get the component with nested parents.\n\n      var comp = this.webform.getComponent(path);\n      comp = Array.isArray(comp) ? comp[0] : comp;\n      var namespaceKey = this.recurseNamespace(comp); // If there is no key, it is the root form.\n\n      if (!namespaceKey || this.form.key === namespaceKey) {\n        return this.form.components;\n      }\n\n      var componentSchema = component.component; // If the current component is the namespace, we don't need to find it again.\n\n      if (namespaceKey === component.key) {\n        return [].concat(_toConsumableArray(componentSchema.components), [componentSchema]);\n      } // Get the namespace component so we have the original object.\n\n\n      var namespaceComponent = (0, _formUtils.getComponent)(this.form.components, namespaceKey, true);\n      return namespaceComponent ? namespaceComponent.components : comp.components;\n    }\n  }, {\n    key: \"recurseNamespace\",\n    value: function recurseNamespace(component) {\n      // If there is no parent, we are at the root level.\n      if (!component) {\n        return null;\n      } // Some components are their own namespace.\n\n\n      if (['address', 'container', 'datagrid', 'editgrid', 'dynamicWizard', 'tree'].includes(component.type) || component.tree || component.arrayTree) {\n        return component.key;\n      } // Anything else, keep going up.\n\n\n      return this.recurseNamespace(component.parent);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return this.renderTemplate('builder', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this4.renderTemplate('builderSidebarGroup', {\n              group: _this4.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this4.id),\n              subgroups: _this4.groups[groupKey].subgroups.map(function (group) {\n                return _this4.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        form: this.webform.render()\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this5 = this;\n\n      this.on('change', function (form) {\n        _this5.populateRecaptchaSettings(form);\n      });\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"attach\", this).call(this, element).then(function () {\n        _this5.loadRefs(element, {\n          form: 'single',\n          sidebar: 'single',\n          'sidebar-search': 'single',\n          'sidebar-groups': 'single',\n          'container': 'multiple',\n          'sidebar-anchor': 'multiple',\n          'sidebar-group': 'multiple',\n          'sidebar-container': 'multiple'\n        });\n\n        if (_this5.sideBarScroll && Templates.current.handleBuilderSidebarScroll) {\n          Templates.current.handleBuilderSidebarScroll.call(_this5, _this5);\n        } // Add the paste status in form\n\n\n        if (typeof window !== 'undefined' && window.sessionStorage) {\n          var data = window.sessionStorage.getItem('formio.clipboard');\n\n          if (data) {\n            _this5.addClass(_this5.refs.form, 'builder-paste-mode');\n          }\n        }\n\n        if (!(0, _utils.bootstrapVersion)(_this5.options)) {\n          // Initialize\n          _this5.refs['sidebar-group'].forEach(function (group) {\n            group.style.display = group.getAttribute('data-default') === 'true' ? 'inherit' : 'none';\n          }); // Click event\n\n\n          _this5.refs['sidebar-anchor'].forEach(function (anchor, index) {\n            _this5.addEventListener(anchor, 'click', function () {\n              var clickedParentId = anchor.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n              var clickedId = anchor.getAttribute('data-target').slice('#group-'.length);\n\n              _this5.refs['sidebar-group'].forEach(function (group, groupIndex) {\n                var openByDefault = group.getAttribute('data-default') === 'true';\n                var groupId = group.getAttribute('id').slice('group-'.length);\n                var groupParent = group.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n                group.style.display = openByDefault && groupParent === clickedId || groupId === clickedParentId || groupIndex === index ? 'inherit' : 'none';\n              });\n            }, true);\n          });\n        }\n\n        _this5.addEventListener(_this5.refs['sidebar-search'], 'input', _lodash.default.debounce(function (e) {\n          var searchString = e.target.value;\n\n          _this5.searchFields(searchString);\n        }, 300));\n\n        if (_this5.dragDropEnabled) {\n          _this5.initDragula();\n        }\n\n        if (_this5.refs.form) {\n          return _this5.webform.attach(_this5.refs.form);\n        }\n      });\n    }\n  }, {\n    key: \"searchFields\",\n    value: function searchFields() {\n      var _this6 = this;\n\n      var searchString = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var searchValue = searchString.toLowerCase();\n      var sidebar = this.refs['sidebar'];\n      var sidebarGroups = this.refs['sidebar-groups'];\n\n      if (!sidebar || !sidebarGroups) {\n        return;\n      }\n\n      var filterGroupBy = function filterGroupBy(group) {\n        var searchValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n        var result = _lodash.default.toPlainObject(group);\n\n        var _result$subgroups = result.subgroups,\n            subgroups = _result$subgroups === void 0 ? [] : _result$subgroups,\n            components = result.components;\n        var filteredComponents = [];\n\n        for (var key in components) {\n          var isMatchedToTitle = components[key].title.toLowerCase().match(searchValue);\n          var isMatchedToKey = components[key].key.toLowerCase().match(searchValue);\n\n          if (isMatchedToTitle || isMatchedToKey) {\n            filteredComponents.push(components[key]);\n          }\n        }\n\n        _this6.orderComponents(result, filteredComponents);\n\n        if (searchValue) {\n          result.default = true;\n        }\n\n        if (result.componentOrder.length || subgroups.length) {\n          return result;\n        }\n\n        return null;\n      };\n\n      var filterGroupOrder = function filterGroupOrder(groupOrder, searchValue) {\n        var result = _lodash.default.cloneDeep(groupOrder);\n\n        return result.filter(function (key) {\n          return filterGroupBy(_this6.groups[key], searchValue);\n        });\n      };\n\n      var filterSubgroups = function filterSubgroups(groups, searchValue) {\n        var result = _lodash.default.clone(groups);\n\n        return result.map(function (subgroup) {\n          return filterGroupBy(subgroup, searchValue);\n        }).filter(function (subgroup) {\n          return !_lodash.default.isNull(subgroup);\n        });\n      };\n\n      var toTemplate = function toTemplate(groupKey) {\n        return {\n          group: filterGroupBy(_this6.groups[groupKey], searchValue),\n          groupKey: groupKey,\n          groupId: sidebar.id || sidebarGroups.id,\n          subgroups: filterSubgroups(_this6.groups[groupKey].subgroups, searchValue).map(function (group) {\n            return _this6.renderTemplate('builderSidebarGroup', {\n              group: group,\n              groupKey: group.key,\n              groupId: \"group-container-\".concat(groupKey),\n              subgroups: []\n            });\n          })\n        };\n      };\n\n      sidebarGroups.innerHTML = filterGroupOrder(this.groupOrder, searchValue).map(function (groupKey) {\n        return _this6.renderTemplate('builderSidebarGroup', toTemplate(groupKey));\n      }).join('');\n      this.loadRefs(this.element, {\n        'sidebar-groups': 'single',\n        'sidebar-anchor': 'multiple',\n        'sidebar-group': 'multiple',\n        'sidebar-container': 'multiple'\n      });\n      this.updateDragAndDrop();\n    }\n  }, {\n    key: \"orderComponents\",\n    value: function orderComponents(groupInfo, foundComponents) {\n      var components = foundComponents || groupInfo.components;\n\n      if (components) {\n        groupInfo.componentOrder = Object.keys(components).map(function (key) {\n          return components[key];\n        }).filter(function (component) {\n          return component && !component.ignore && !component.ignoreForForm;\n        }).sort(function (a, b) {\n          return a.weight - b.weight;\n        }).map(function (component) {\n          return component.key;\n        });\n      }\n    }\n  }, {\n    key: \"updateDragAndDrop\",\n    value: function updateDragAndDrop() {\n      if (this.dragDropEnabled) {\n        this.initDragula();\n      }\n\n      if (this.refs.form) {\n        return this.webform.attach(this.refs.form);\n      }\n    }\n  }, {\n    key: \"initDragula\",\n    value: function initDragula() {\n      var _this7 = this;\n\n      var options = this.options;\n\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n\n      var containersArray = Array.prototype.slice.call(this.refs['sidebar-container']).filter(function (item) {\n        return item.id !== 'group-container-resource';\n      });\n\n      if (!dragula) {\n        return;\n      }\n\n      this.dragula = dragula(containersArray, {\n        moves: function moves(el) {\n          var moves = true;\n          var list = Array.from(el.classList).filter(function (item) {\n            return item.indexOf('formio-component-') === 0;\n          });\n          list.forEach(function (item) {\n            var key = item.slice('formio-component-'.length);\n\n            if (options.disabled && options.disabled.includes(key)) {\n              moves = false;\n            }\n          });\n\n          if (el.classList.contains('no-drag')) {\n            moves = false;\n          }\n\n          return moves;\n        },\n        copy: function copy(el) {\n          return el.classList.contains('drag-copy');\n        },\n        accepts: function accepts(el, target) {\n          return !el.contains(target) && !target.classList.contains('no-drop');\n        }\n      }).on('drop', function (element, target, source, sibling) {\n        return _this7.onDrop(element, target, source, sibling);\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n\n      this.dragula = null;\n\n      if (this.sideBarScroll && Templates.current.clearBuilderSidebarScroll) {\n        Templates.current.clearBuilderSidebarScroll.call(this, this);\n      }\n\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"getComponentInfo\",\n    value: function getComponentInfo(key, group) {\n      var info; // This is a new component\n\n      if (this.schemas.hasOwnProperty(key)) {\n        info = (0, _utils.fastCloneDeep)(this.schemas[key]);\n      } else if (this.groups.hasOwnProperty(group)) {\n        var groupComponents = this.groups[group].components;\n\n        if (groupComponents.hasOwnProperty(key)) {\n          info = (0, _utils.fastCloneDeep)(groupComponents[key].schema);\n        }\n      } else if (group.slice(0, group.indexOf('-')) === 'resource') {\n        // This is an existing resource field.\n        var resourceGroups = this.groups.resource.subgroups;\n\n        var resourceGroup = _lodash.default.find(resourceGroups, {\n          key: group\n        });\n\n        if (resourceGroup && resourceGroup.components.hasOwnProperty(key)) {\n          info = (0, _utils.fastCloneDeep)(resourceGroup.components[key].schema);\n        }\n      } else if (group === 'searchFields') {\n        //Search components go into this group\n        var _resourceGroups = this.groups.resource.subgroups;\n\n        for (var ix = 0; ix < _resourceGroups.length; ix++) {\n          var _resourceGroup = _resourceGroups[ix];\n\n          if (_resourceGroup.components.hasOwnProperty(key)) {\n            info = (0, _utils.fastCloneDeep)(_resourceGroup.components[key].schema);\n            break;\n          }\n        }\n      }\n\n      if (info) {\n        if (!info.key) {\n          info.key = this.generateKey(info);\n        }\n      }\n\n      return info;\n    }\n  }, {\n    key: \"getComponentsPath\",\n    value: function getComponentsPath(component, parent) {\n      // Get path to the component in the parent component.\n      var path = 'components';\n      var columnIndex = 0;\n      var tableRowIndex = 0;\n      var tableColumnIndex = 0;\n      var tabIndex = 0;\n\n      switch (parent.type) {\n        case 'table':\n          tableRowIndex = _lodash.default.findIndex(parent.rows, function (row) {\n            return row.some(function (column) {\n              return column.components.some(function (comp) {\n                return comp.key === component.key;\n              });\n            });\n          });\n          tableColumnIndex = _lodash.default.findIndex(parent.rows[tableRowIndex], function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"rows[\".concat(tableRowIndex, \"][\").concat(tableColumnIndex, \"].components\");\n          break;\n\n        case 'columns':\n          columnIndex = _lodash.default.findIndex(parent.columns, function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"columns[\".concat(columnIndex, \"].components\");\n          break;\n\n        case 'tabs':\n          tabIndex = _lodash.default.findIndex(parent.components, function (tab) {\n            return tab.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"components[\".concat(tabIndex, \"].components\");\n          break;\n      }\n\n      return path;\n    }\n    /* eslint-disable max-statements */\n\n  }, {\n    key: \"onDrop\",\n    value: function onDrop(element, target, source, sibling) {\n      var _this$groups$group,\n          _this8 = this;\n\n      if (!target) {\n        return;\n      } // If you try to drop within itself.\n\n\n      if (element.contains(target)) {\n        return;\n      }\n\n      var key = element.getAttribute('data-key');\n      var type = element.getAttribute('data-type');\n      var group = element.getAttribute('data-group');\n      var info, isNew, path, index;\n\n      if (key) {\n        // This is a new component.\n        info = this.getComponentInfo(key, group);\n\n        if (!info && type) {\n          info = this.getComponentInfo(type, group);\n        }\n\n        isNew = true;\n      } else if (source.formioContainer) {\n        index = _lodash.default.findIndex(source.formioContainer, {\n          key: element.formioComponent.component.key\n        });\n\n        if (index !== -1) {\n          // Grab and remove the component from the source container.\n          info = source.formioContainer.splice(_lodash.default.findIndex(source.formioContainer, {\n            key: element.formioComponent.component.key\n          }), 1); // Since splice returns an array of one object, we need to destructure it.\n\n          info = info[0];\n        }\n      } // If we haven't found the component, stop.\n\n\n      if (!info) {\n        return;\n      } // Show an error if siblings are disabled for a component and such a component already exists.\n\n\n      var draggableComponent = ((_this$groups$group = this.groups[group]) === null || _this$groups$group === void 0 ? void 0 : _this$groups$group.components[key]) || {};\n\n      if (draggableComponent.disableSiblings) {\n        var isCompAlreadyExists = false;\n        (0, _formUtils.eachComponent)(this.webform.components, function (component) {\n          if (component.type === draggableComponent.schema.type) {\n            isCompAlreadyExists = true;\n            return;\n          }\n        }, true);\n\n        if (isCompAlreadyExists) {\n          this.webform.redraw();\n          this.webform.setAlert('danger', \"You cannot add more than one \".concat(draggableComponent.key, \" component to one page.\"));\n          return;\n        }\n      }\n\n      if (target !== source) {\n        // Ensure the key remains unique in its new container.\n        _builder.default.uniquify(this.findNamespaceRoot(target.formioComponent), info);\n      }\n\n      var parent = target.formioComponent; // Insert in the new container.\n\n      if (target.formioContainer) {\n        if (sibling) {\n          if (!sibling.getAttribute('data-noattach')) {\n            index = _lodash.default.findIndex(target.formioContainer, {\n              key: _lodash.default.get(sibling, 'formioComponent.component.key')\n            });\n            index = index === -1 ? 0 : index;\n          } else {\n            index = sibling.getAttribute('data-position');\n          }\n\n          if (index !== -1) {\n            target.formioContainer.splice(index, 0, info);\n          }\n        } else {\n          target.formioContainer.push(info);\n        }\n\n        path = this.getComponentsPath(info, parent.component);\n        index = _lodash.default.findIndex(_lodash.default.get(parent.schema, path), {\n          key: info.key\n        });\n\n        if (index === -1) {\n          index = 0;\n        }\n      }\n\n      if (parent && parent.addChildComponent) {\n        parent.addChildComponent(info, element, target, source, sibling);\n      }\n\n      var componentInDataGrid = parent.type === 'datagrid';\n\n      if (isNew && !this.options.noNewEdit && !info.noNewEdit) {\n        this.editComponent(info, target, isNew, null, null, {\n          inDataGrid: componentInDataGrid\n        });\n      } // Only rebuild the parts needing to be rebuilt.\n\n\n      var rebuild;\n\n      if (target !== source) {\n        if (source.formioContainer && source.contains(target)) {\n          rebuild = source.formioComponent.rebuild();\n        } else if (target.contains(source)) {\n          rebuild = target.formioComponent.rebuild();\n        } else {\n          if (source.formioContainer) {\n            rebuild = source.formioComponent.rebuild();\n          }\n\n          rebuild = target.formioComponent.rebuild();\n        }\n      } else {\n        // If they are the same, only rebuild one.\n        rebuild = target.formioComponent.rebuild();\n      }\n\n      if (!rebuild) {\n        rebuild = _nativePromiseOnly.default.resolve();\n      }\n\n      return rebuild.then(function () {\n        _this8.emit('addComponent', info, parent, path, index, isNew && !_this8.options.noNewEdit && !info.noNewEdit);\n\n        if (!isNew || _this8.options.noNewEdit || info.noNewEdit) {\n          _this8.emit('change', _this8.form);\n        }\n      });\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form) {\n      var _this9 = this;\n\n      if (!form.components) {\n        form.components = [];\n      }\n\n      var isShowSubmitButton = !this.options.noDefaultSubmitButton && !form.components.length; // Ensure there is at least a submit button.\n\n      if (isShowSubmitButton) {\n        form.components.push({\n          type: 'button',\n          label: 'Submit',\n          key: 'submit',\n          size: 'md',\n          block: false,\n          action: 'submit',\n          disableOnInvalid: true,\n          theme: 'primary'\n        });\n      }\n\n      if (this.webform) {\n        var shouldRebuild = !this.webform.form.components || form.components.length !== this.webform.form.components.length;\n        return this.webform.setForm(form, {\n          keepAsReference: true\n        }).then(function () {\n          if (_this9.refs.form) {\n            _this9.builderHeight = _this9.refs.form.offsetHeight;\n          }\n\n          if (!shouldRebuild) {\n            return _this9.form;\n          }\n\n          return _this9.rebuild().then(function () {\n            return _this9.form;\n          });\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve(form);\n    }\n  }, {\n    key: \"populateRecaptchaSettings\",\n    value: function populateRecaptchaSettings(form) {\n      //populate isEnabled for recaptcha form settings\n      var isRecaptchaEnabled = false;\n\n      if (this.form.components) {\n        (0, _formUtils.eachComponent)(form.components, function (component) {\n          if (isRecaptchaEnabled) {\n            return;\n          }\n\n          if (component.type === 'recaptcha') {\n            isRecaptchaEnabled = true;\n            return false;\n          }\n        });\n\n        if (isRecaptchaEnabled) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', true);\n        } else if (_lodash.default.get(form, 'settings.recaptcha.isEnabled')) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', false);\n        }\n      }\n    }\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, parent, original) {\n      var _this10 = this;\n\n      if (!parent) {\n        return;\n      }\n\n      var remove = true;\n      var removingComponentsGroup = !component.skipRemoveConfirm && (Array.isArray(component.components) && component.components.length || Array.isArray(component.rows) && component.rows.length || Array.isArray(component.columns) && component.columns.length);\n\n      if (this.options.alwaysConfirmComponentRemoval || removingComponentsGroup) {\n        var message = removingComponentsGroup ? 'Removing this component will also remove all of its children. Are you sure you want to do this?' : 'Are you sure you want to remove this component?';\n        remove = window.confirm(this.t(message));\n      }\n\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n\n      var index = parent.formioContainer ? parent.formioContainer.indexOf(original) : 0;\n\n      if (remove && index !== -1) {\n        var path = this.getComponentsPath(component, parent.formioComponent.component);\n\n        if (parent.formioContainer) {\n          parent.formioContainer.splice(index, 1);\n        } else if (parent.formioComponent && parent.formioComponent.removeChildComponent) {\n          parent.formioComponent.removeChildComponent(component);\n        }\n\n        var rebuild = parent.formioComponent.rebuild() || _nativePromiseOnly.default.resolve();\n\n        rebuild.then(function () {\n          _this10.emit('removeComponent', component, parent.formioComponent.schema, path, index);\n\n          _this10.emit('change', _this10.form);\n        });\n      }\n\n      return remove;\n    }\n  }, {\n    key: \"updateComponent\",\n    value: function updateComponent(component, changed) {\n      // Update the preview.\n      if (this.preview) {\n        this.preview.form = {\n          components: [_lodash.default.omit(_objectSpread({}, component), ['hidden', 'conditional', 'calculateValue', 'logic', 'autofocus', 'customConditional'])],\n          config: this.options.formConfig || {}\n        };\n        var previewElement = this.componentEdit.querySelector('[ref=\"preview\"]');\n\n        if (previewElement) {\n          this.setContent(previewElement, this.preview.render());\n          this.preview.attach(previewElement);\n        }\n      } // Change the \"default value\" field to be reflective of this component.\n\n\n      var defaultValueComponent = (0, _formUtils.getComponent)(this.editForm.components, 'defaultValue', true);\n\n      if (defaultValueComponent && component.type !== 'hidden') {\n        var defaultChanged = changed && (changed.component && changed.component.key === 'defaultValue' || changed.instance && defaultValueComponent.hasComponent && defaultValueComponent.hasComponent(changed.instance));\n\n        if (!defaultChanged) {\n          _lodash.default.assign(defaultValueComponent.component, _lodash.default.omit(_objectSpread({}, component), ['key', 'label', 'placeholder', 'tooltip', 'hidden', 'autofocus', 'validate', 'disabled', 'defaultValue', 'customDefaultValue', 'calculateValue', 'conditional', 'customConditional', 'id']));\n\n          var parentComponent = defaultValueComponent.parent;\n          var tabIndex = -1;\n          var index = -1;\n          parentComponent.tabs.some(function (tab, tIndex) {\n            tab.some(function (comp, compIndex) {\n              if (comp.id === defaultValueComponent.id) {\n                tabIndex = tIndex;\n                index = compIndex;\n                return true;\n              }\n\n              return false;\n            });\n          });\n\n          if (tabIndex !== -1 && index !== -1 && changed && changed.value) {\n            var sibling = parentComponent.tabs[tabIndex][index + 1];\n            parentComponent.removeComponent(defaultValueComponent);\n            var newComp = parentComponent.addComponent(defaultValueComponent.component, defaultValueComponent.data, sibling);\n\n            _lodash.default.pull(newComp.validators, 'required');\n\n            parentComponent.tabs[tabIndex].splice(index, 1, newComp);\n\n            newComp.checkValidity = function () {\n              return true;\n            };\n\n            newComp.build(defaultValueComponent.element);\n          }\n        } else {\n          var dataPath = changed.instance._data.key;\n          var path = (0, _utils.getArrayFromComponentPath)(changed.instance.path);\n          path.shift();\n\n          if (path.length) {\n            path.unshift(component.key);\n            dataPath = (0, _utils.getStringFromComponentPath)(path);\n          }\n\n          _lodash.default.set(this.preview._data, dataPath, changed.value);\n\n          _lodash.default.set(this.webform._data, dataPath, changed.value);\n        }\n      } // Called when we update a component.\n\n\n      this.emit('updateComponent', component);\n    }\n  }, {\n    key: \"findRepeatablePaths\",\n    value: function findRepeatablePaths() {\n      var repeatablePaths = [];\n      var keys = new Map();\n      (0, _formUtils.eachComponent)(this.form.components, function (comp, path) {\n        if (!comp.key) {\n          return;\n        }\n\n        if (keys.has(comp.key)) {\n          if (keys.get(comp.key).includes(path)) {\n            repeatablePaths.push(path);\n          } else {\n            keys.set(comp.key, [].concat(_toConsumableArray(keys.get(comp.key)), [path]));\n          }\n        } else {\n          keys.set(comp.key, [path]);\n        }\n      }, true);\n      return repeatablePaths;\n    }\n  }, {\n    key: \"highlightInvalidComponents\",\n    value: function highlightInvalidComponents() {\n      var repeatablePaths = this.findRepeatablePaths();\n      var hasInvalidComponents = false;\n      this.webform.everyComponent(function (comp) {\n        var _comp$error, _comp$error$message;\n\n        var path = comp.path;\n\n        if (repeatablePaths.includes(path)) {\n          comp.setCustomValidity(\"API Key is not unique: \".concat(comp.key));\n          hasInvalidComponents = true;\n        } else if ((_comp$error = comp.error) !== null && _comp$error !== void 0 && (_comp$error$message = _comp$error.message) !== null && _comp$error$message !== void 0 && _comp$error$message.startsWith('API Key is not unique')) {\n          comp.setCustomValidity('');\n        }\n      });\n      this.emit('builderFormValidityChange', hasInvalidComponents);\n    }\n    /**\n     * Called when a new component is saved.\n     *\n     * @param parent\n     * @param component\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"saveComponent\",\n    value: function saveComponent(component, parent, isNew, original) {\n      var _this11 = this;\n\n      this.editForm.detach();\n      var parentContainer = parent ? parent.formioContainer : this.container;\n      var parentComponent = parent ? parent.formioComponent : this;\n      this.dialog.close();\n      var path = parentContainer ? this.getComponentsPath(component, parentComponent.component) : '';\n\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n\n      var index = parentContainer ? parentContainer.indexOf(original) : 0;\n\n      if (index !== -1) {\n        var submissionData = this.editForm.submission.data;\n        submissionData = submissionData.componentJson || submissionData;\n        var fieldsToRemoveDoubleQuotes = ['label', 'tooltip', 'placeholder'];\n\n        if (submissionData) {\n          fieldsToRemoveDoubleQuotes.forEach(function (key) {\n            if (submissionData[key]) {\n              submissionData[key] = submissionData[key].replace(/\"/g, \"'\");\n            }\n          });\n        }\n\n        this.hook('beforeSaveComponentSettings', submissionData);\n        var comp = null;\n        parentComponent.getComponents().forEach(function (component) {\n          if (component.component.key === original.key) {\n            comp = component;\n          }\n        });\n        var originalComp = comp.component;\n        var originalComponentSchema = comp.schema;\n        var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n\n        if (parentContainer && !isParentSaveChildMethod) {\n          parentContainer[index] = submissionData;\n\n          if (comp) {\n            comp.component = submissionData;\n          }\n        } else if (isParentSaveChildMethod) {\n          parent.formioComponent.saveChildComponent(submissionData);\n        }\n\n        var rebuild = parentComponent.rebuild() || _nativePromiseOnly.default.resolve();\n\n        return rebuild.then(function () {\n          var schema = parentContainer ? parentContainer[index] : comp ? comp.schema : [];\n\n          _this11.emitSaveComponentEvent(schema, originalComp, parentComponent.schema, path, index, isNew, originalComponentSchema);\n\n          _this11.emit('change', _this11.form);\n\n          _this11.highlightInvalidComponents();\n        });\n      }\n\n      this.highlightInvalidComponents();\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"emitSaveComponentEvent\",\n    value: function emitSaveComponentEvent(schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema) {\n      this.emit('saveComponent', schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema);\n    }\n  }, {\n    key: \"editComponent\",\n    value: function editComponent(component, parent, isNew, isJsonEdit, original) {\n      var _this12 = this;\n\n      var flags = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n\n      if (!component.key) {\n        return;\n      }\n\n      var saved = false;\n      var componentCopy = (0, _utils.fastCloneDeep)(component);\n      var ComponentClass = _Components.default.components[componentCopy.type];\n      var isCustom = ComponentClass === undefined;\n      isJsonEdit = isJsonEdit || isCustom;\n      ComponentClass = isCustom ? _Components.default.components.unknown : ComponentClass; // Make sure we only have one dialog open at a time.\n\n      if (this.dialog) {\n        this.dialog.close();\n        this.highlightInvalidComponents();\n      } // This is the render step.\n\n\n      var editFormOptions = _lodash.default.clone(_lodash.default.get(this, 'options.editForm', {}));\n\n      if (this.editForm) {\n        this.editForm.destroy();\n      } // Allow editForm overrides per component.\n\n\n      var overrides = _lodash.default.get(this.options, \"editForm.\".concat(componentCopy.type), {}); // Pass along the form being edited.\n\n\n      editFormOptions.editForm = this.form;\n      editFormOptions.editComponent = component;\n      editFormOptions.flags = flags;\n      this.hook('editComponentParentInstance', editFormOptions, parent);\n      this.editForm = new _Webform.default(_objectSpread(_objectSpread({}, _lodash.default.omit(this.options, ['hooks', 'builder', 'events', 'attachMode', 'skipInit'])), {}, {\n        language: this.options.language\n      }, editFormOptions));\n      this.hook('editFormProperties', parent);\n      this.editForm.form = isJsonEdit && !isCustom ? {\n        components: [{\n          type: 'textarea',\n          as: 'json',\n          editor: 'ace',\n          weight: 10,\n          input: true,\n          key: 'componentJson',\n          label: 'Component JSON',\n          tooltip: 'Edit the JSON for this component.'\n        }, {\n          type: 'checkbox',\n          key: 'showFullSchema',\n          label: 'Full Schema'\n        }]\n      } : ComponentClass.editForm(_lodash.default.cloneDeep(overrides));\n      var instanceOptions = {};\n      this.hook('instanceOptionsPreview', instanceOptions);\n      var instance = new ComponentClass(componentCopy, instanceOptions);\n      var schema = this.hook('builderComponentSchema', component, instance);\n      this.editForm.submission = isJsonEdit ? {\n        data: {\n          componentJson: schema,\n          showFullSchema: this.options.showFullJsonSchema\n        }\n      } : {\n        data: instance.component\n      };\n\n      if (this.preview) {\n        this.preview.destroy();\n      }\n\n      if (!ComponentClass.builderInfo.hasOwnProperty('preview') || ComponentClass.builderInfo.preview) {\n        this.preview = new _Webform.default(_lodash.default.omit(_objectSpread(_objectSpread({}, this.options), {}, {\n          preview: true\n        }), ['hooks', 'builder', 'events', 'attachMode', 'calculateValue']));\n        this.hook('previewFormSettitngs', schema, isJsonEdit);\n      }\n\n      this.componentEdit = this.ce('div', {\n        'class': 'component-edit-container'\n      });\n      this.setContent(this.componentEdit, this.renderTemplate('builderEditForm', {\n        componentInfo: ComponentClass.builderInfo,\n        editForm: this.editForm.render(),\n        preview: this.preview ? this.preview.render() : false,\n        helplinks: this.helplinks\n      }));\n      this.dialog = this.createModal(this.componentEdit, _lodash.default.get(this.options, 'dialogAttr', {})); // This is the attach step.\n\n      this.editForm.attach(this.componentEdit.querySelector('[ref=\"editForm\"]'));\n      this.hook('editFormWrapper');\n      this.updateComponent(componentCopy);\n      this.editForm.on('change', function (event) {\n        if (event.changed) {\n          if (event.changed.component && event.changed.component.key === 'showFullSchema') {\n            var value = event.changed.value;\n            _this12.editForm.submission = {\n              data: {\n                componentJson: value ? instance.component : component,\n                showFullSchema: value\n              }\n            };\n            return;\n          } // See if this is a manually modified key. Treat custom component keys as manually modified\n\n\n          if (event.changed.component && event.changed.component.key === 'key' || isJsonEdit) {\n            componentCopy.keyModified = true;\n          }\n\n          if (event.changed.component && ['label', 'title'].includes(event.changed.component.key)) {\n            // Ensure this component has a key.\n            if (isNew) {\n              if (!event.data.keyModified) {\n                _this12.editForm.everyComponent(function (component) {\n                  if (component.key === 'key' && component.parent.component.key === 'tabs') {\n                    component.setValue(_this12.updateComponentKey(event.data));\n                    return false;\n                  }\n                });\n              }\n\n              if (_this12.form) {\n                var formComponents = _this12.findNamespaceRoot(parent.formioComponent); // excluding component which key uniqueness is to be checked to prevent the comparing of the same keys\n\n\n                formComponents = formComponents.filter(function (comp) {\n                  return editFormOptions.editComponent.id !== comp.id;\n                }); // Set a unique key for this component.\n\n                _builder.default.uniquify(formComponents, event.data);\n              }\n            }\n          } // Update the component.\n\n\n          _this12.updateComponent(event.data.componentJson || event.data, event.changed);\n        }\n      });\n      var cancelButtons = this.componentEdit.querySelectorAll('[ref=\"cancelButton\"]');\n      cancelButtons.forEach(function (cancelButton) {\n        _this12.addEventListener(cancelButton, 'click', function (event) {\n          event.preventDefault();\n\n          _this12.editForm.detach();\n\n          _this12.emit('cancelComponent', component);\n\n          _this12.dialog.close();\n\n          _this12.highlightInvalidComponents();\n        });\n      });\n      var removeButtons = this.componentEdit.querySelectorAll('[ref=\"removeButton\"]');\n      removeButtons.forEach(function (removeButton) {\n        _this12.addEventListener(removeButton, 'click', function (event) {\n          event.preventDefault(); // Since we are already removing the component, don't trigger another remove.\n\n          saved = true;\n\n          _this12.editForm.detach();\n\n          _this12.removeComponent(component, parent, original);\n\n          _this12.dialog.close();\n\n          _this12.highlightInvalidComponents();\n        });\n      });\n      var saveButtons = this.componentEdit.querySelectorAll('[ref=\"saveButton\"]');\n      saveButtons.forEach(function (saveButton) {\n        _this12.addEventListener(saveButton, 'click', function (event) {\n          event.preventDefault();\n\n          if (!_this12.editForm.checkValidity(_this12.editForm.data, true, _this12.editForm.data)) {\n            _this12.editForm.setPristine(false);\n\n            _this12.editForm.showErrors();\n\n            return false;\n          }\n\n          saved = true;\n\n          _this12.saveComponent(component, parent, isNew, original);\n        });\n      });\n\n      var dialogClose = function dialogClose() {\n        _this12.editForm.destroy(true);\n\n        if (_this12.preview) {\n          _this12.preview.destroy(true);\n\n          _this12.preview = null;\n        }\n\n        if (isNew && !saved) {\n          _this12.removeComponent(component, parent, original);\n\n          _this12.highlightInvalidComponents();\n        } // Clean up.\n\n\n        _this12.removeEventListener(_this12.dialog, 'close', dialogClose);\n\n        _this12.dialog = null;\n      };\n\n      this.addEventListener(this.dialog, 'close', dialogClose); // Called when we edit a component.\n\n      this.emit('editComponent', component);\n    }\n  }, {\n    key: \"updateComponentKey\",\n    value: function updateComponentKey(data) {\n      return _lodash.default.camelCase(data.title || data.label || data.placeholder || data.type).replace(/^[0-9]*/, '');\n    }\n    /**\n     * Creates copy of component schema and stores it under sessionStorage.\n     * @param {Component} component\n     * @return {*}\n     */\n\n  }, {\n    key: \"copyComponent\",\n    value: function copyComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n\n      this.addClass(this.refs.form, 'builder-paste-mode');\n      window.sessionStorage.setItem('formio.clipboard', JSON.stringify(component.schema));\n    }\n    /**\n     * Paste copied component after the current component.\n     * @param {Component} component\n     * @return {*}\n     */\n\n  }, {\n    key: \"pasteComponent\",\n    value: function pasteComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n\n      this.removeClass(this.refs.form, 'builder-paste-mode');\n\n      if (window.sessionStorage) {\n        var data = window.sessionStorage.getItem('formio.clipboard');\n\n        if (data) {\n          var schema = JSON.parse(data);\n          var parent = this.getParentElement(component.element);\n\n          if (parent) {\n            _builder.default.uniquify(this.findNamespaceRoot(parent.formioComponent), schema);\n\n            var path = '';\n            var index = 0;\n            var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n\n            if (parent.formioContainer && !isParentSaveChildMethod) {\n              index = parent.formioContainer.indexOf(component.component);\n              path = this.getComponentsPath(schema, parent.formioComponent.component);\n              parent.formioContainer.splice(index + 1, 0, schema);\n            } else if (isParentSaveChildMethod) {\n              parent.formioComponent.saveChildComponent(schema, false);\n            }\n\n            parent.formioComponent.rebuild();\n            this.emitSaveComponentEvent(schema, schema, parent.formioComponent.component, path, index + 1, true, schema);\n          }\n\n          this.emit('change', this.form);\n        }\n      }\n    }\n  }, {\n    key: \"isParentSaveChildMethod\",\n    value: function isParentSaveChildMethod(parentComp) {\n      return !!(parentComp && parentComp.saveChildComponent);\n    }\n  }, {\n    key: \"getParentElement\",\n    value: function getParentElement(element) {\n      var container = element;\n\n      do {\n        container = container.parentNode;\n      } while (container && !container.formioComponent);\n\n      return container;\n    }\n  }, {\n    key: \"addBuilderComponentInfo\",\n    value: function addBuilderComponentInfo(component) {\n      if (!component || !component.group || !this.groups[component.group]) {\n        return;\n      }\n\n      component = _lodash.default.clone(component);\n      var groupInfo = this.groups[component.group];\n\n      if (!groupInfo.components.hasOwnProperty(component.key)) {\n        groupInfo.components[component.key] = component;\n      }\n\n      return component;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      if (this.webform) {\n        this.webform.init();\n      }\n\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"init\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      if (this.webform.initialized) {\n        this.webform.clear();\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(deleteFromGlobal) {\n      if (this.webform.initialized) {\n        this.webform.destroy(deleteFromGlobal);\n      }\n\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"destroy\", this).call(this, deleteFromGlobal);\n    }\n  }, {\n    key: \"addBuilderGroup\",\n    value: function addBuilderGroup(name, group) {\n      if (!this.groups[name]) {\n        this.groups[name] = group;\n        this.groupOrder.push(name);\n        this.triggerRedraw();\n      } else {\n        this.updateBuilderGroup(name, group);\n      }\n    }\n  }, {\n    key: \"updateBuilderGroup\",\n    value: function updateBuilderGroup(name, group) {\n      if (this.groups[name]) {\n        this.groups[name] = group;\n        this.triggerRedraw();\n      }\n    }\n  }, {\n    key: \"generateKey\",\n    value: function generateKey(info) {\n      return _lodash.default.camelCase(info.key || info.title || info.label || info.placeholder || info.type);\n    }\n  }]);\n\n  return WebformBuilder;\n}(_Component2.default);\n\nexports.default = WebformBuilder;"]},"metadata":{},"sourceType":"script"}