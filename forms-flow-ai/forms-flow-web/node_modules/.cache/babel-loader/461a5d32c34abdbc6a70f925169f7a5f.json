{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _Formio = require(\"./Formio\");\n\nvar _WebformBuilder2 = _interopRequireDefault(require(\"./WebformBuilder\"));\n\nvar _utils = require(\"./utils/utils\");\n\nvar _formUtils = require(\"./utils/formUtils\");\n\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\n\nvar _PDF = _interopRequireDefault(require(\"./PDF\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar PDFBuilder = /*#__PURE__*/function (_WebformBuilder) {\n  _inherits(PDFBuilder, _WebformBuilder);\n\n  var _super = _createSuper(PDFBuilder);\n\n  function PDFBuilder() {\n    var _this;\n\n    _classCallCheck(this, PDFBuilder);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Force superclass to skip the automatic init; we'll trigger it manually\n\n\n    options.skipInit = true;\n    options.display = 'pdf';\n\n    if (element) {\n      _this = _super.call(this, element, options);\n    } else {\n      _this = _super.call(this, options);\n    }\n\n    _this.dragDropEnabled = false;\n    return _possibleConstructorReturn(_this);\n  }\n\n  _createClass(PDFBuilder, [{\n    key: \"defaultGroups\",\n    get: function get() {\n      return {\n        pdf: {\n          title: 'PDF Fields',\n          weight: 0,\n          default: true,\n          components: {\n            textfield: true,\n            number: true,\n            password: true,\n            email: true,\n            phoneNumber: true,\n            currency: true,\n            checkbox: true,\n            signature: true,\n            select: true,\n            textarea: true,\n            datetime: true,\n            file: true,\n            htmlelement: true,\n            signrequestsignature: true\n          }\n        },\n        basic: false,\n        advanced: false,\n        layout: false,\n        data: false,\n        premium: false,\n        resource: false\n      };\n    }\n  }, {\n    key: \"hasPDF\",\n    get: function get() {\n      return _lodash.default.has(this.webform.form, 'settings.pdf');\n    }\n  }, {\n    key: \"projectUrl\",\n    get: function get() {\n      return this.options.projectUrl || _Formio.GlobalFormio.getProjectUrl();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.options.attachMode = 'builder';\n      this.webform = this.webform || this.createForm(this.options);\n      this.webform.init();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var result = this.renderTemplate('pdfBuilder', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this2.renderTemplate('builderSidebarGroup', {\n              group: _this2.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this2.id),\n              subgroups: _this2.groups[groupKey].subgroups.map(function (group) {\n                return _this2.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        form: this.hasPDF ? this.webform.render() : this.renderTemplate('pdfBuilderUpload', {})\n      });\n      return result;\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this3 = this; // PDF Upload\n\n\n      if (!this.hasPDF) {\n        this.loadRefs(element, {\n          'fileDrop': 'single',\n          'fileBrowse': 'single',\n          'hiddenFileInputElement': 'single',\n          'uploadError': 'single',\n          'uploadProgress': 'single',\n          'uploadProgressWrapper': 'single',\n          'dragDropText': 'single'\n        });\n        this.addEventListener(this.refs['pdf-upload-button'], 'click', function (event) {\n          event.preventDefault();\n        }); // Init the upload error.\n\n        if (!this.projectUrl) {\n          this.setUploadError('Form options.projectUrl not set. Please set the \"projectUrl\" property of the options for this form or use Formio.setProjectUrl(). This setting is necessary to upload a pdf background.');\n        } else {\n          this.setUploadError();\n        }\n\n        if (this.refs.fileDrop) {\n          var _element = this;\n\n          this.addEventListener(this.refs.fileDrop, 'dragover', function (event) {\n            this.className = 'fileSelector fileDragOver';\n            event.preventDefault();\n          });\n          this.addEventListener(this.refs.fileDrop, 'dragleave', function (event) {\n            this.className = 'fileSelector';\n            event.preventDefault();\n          });\n          this.addEventListener(this.refs.fileDrop, 'drop', function (event) {\n            this.className = 'fileSelector';\n            event.preventDefault();\n\n            _element.upload(event.dataTransfer.files[0]);\n\n            return false;\n          });\n        }\n\n        if (this.refs.fileBrowse && this.refs.hiddenFileInputElement) {\n          this.addEventListener(this.refs.fileBrowse, 'click', function (event) {\n            event.preventDefault(); // There is no direct way to trigger a file dialog. To work around this, create an input of type file and trigger\n            // a click event on it.\n\n            if (typeof _this3.refs.hiddenFileInputElement.trigger === 'function') {\n              _this3.refs.hiddenFileInputElement.trigger('click');\n            } else {\n              _this3.refs.hiddenFileInputElement.click();\n            }\n          });\n          this.addEventListener(this.refs.hiddenFileInputElement, 'change', function () {\n            if (!_this3.refs.hiddenFileInputElement.value) {\n              return;\n            }\n\n            _this3.upload(_this3.refs.hiddenFileInputElement.files[0]);\n\n            _this3.refs.hiddenFileInputElement.value = '';\n          });\n        }\n\n        return _nativePromiseOnly.default.resolve();\n      } // Normal PDF Builder\n\n\n      return _get(_getPrototypeOf(PDFBuilder.prototype), \"attach\", this).call(this, element).then(function () {\n        _this3.loadRefs(_this3.element, {\n          iframeDropzone: 'single',\n          'sidebar-container': 'multiple',\n          'sidebar': 'single'\n        });\n\n        _this3.afterAttach();\n\n        return _this3.element;\n      });\n    }\n  }, {\n    key: \"afterAttach\",\n    value: function afterAttach() {\n      var _this4 = this;\n\n      this.on('saveComponent', function (component) {\n        _this4.webform.postMessage({\n          name: 'updateElement',\n          data: component\n        });\n      });\n      this.on('removeComponent', function (component) {\n        _this4.webform.postMessage({\n          name: 'removeElement',\n          data: component\n        });\n      });\n      this.initIframeEvents();\n      this.updateDropzoneDimensions();\n      var sidebar = this.refs.sidebar;\n\n      if (sidebar) {\n        this.addClass(sidebar, 'disabled');\n        this.webform.on('iframe-ready', function () {\n          _this4.pdfLoaded = true;\n\n          _this4.updateDragAndDrop();\n\n          _this4.removeClass(sidebar, 'disabled');\n        }, true);\n      }\n    }\n  }, {\n    key: \"upload\",\n    value: function upload(file) {\n      var _this5 = this;\n\n      var formio = new _Formio.GlobalFormio(this.projectUrl);\n\n      if (this.refs.dragDropText) {\n        this.refs.dragDropText.style.display = 'none';\n      }\n\n      if (this.refs.uploadProgressWrapper) {\n        this.refs.uploadProgressWrapper.style.display = 'inherit';\n      }\n\n      formio.uploadFile('url', file, file, '', function (event) {\n        if (_this5.refs.uploadProgress) {\n          var progress = Math.floor(event.loaded / event.total * 100);\n          _this5.refs.uploadProgress.style.width = \"\".concat(progress, \"%\");\n\n          if (progress > 98) {\n            _this5.refs.uploadProgress.innerHTML = _this5.t('Converting PDF. Please wait.');\n          } else {\n            _this5.refs.uploadProgress.innerHTML = \"\".concat(_this5.t('Uploading'), \" \").concat(progress, \"%\");\n          }\n        }\n      }, \"\".concat(this.projectUrl, \"/upload\"), {}, 'file').then(function (result) {\n        _lodash.default.set(_this5.webform.form, 'settings.pdf', {\n          id: result.data.file,\n          src: \"\".concat(result.data.filesServer).concat(result.data.path)\n        });\n\n        if (_this5.refs.dragDropText) {\n          _this5.refs.dragDropText.style.display = 'inherit';\n        }\n\n        if (_this5.refs.uploadProgressWrapper) {\n          _this5.refs.uploadProgressWrapper.style.display = 'none';\n        }\n\n        _this5.emit('pdfUploaded', result.data);\n\n        _this5.redraw();\n      }).catch(function (err) {\n        return _this5.setUploadError(err);\n      });\n    }\n  }, {\n    key: \"setUploadError\",\n    value: function setUploadError(message) {\n      if (!this.refs.uploadError) {\n        return;\n      }\n\n      this.refs.uploadError.style.display = message ? '' : 'none';\n      this.refs.uploadError.innerHTML = message;\n    }\n  }, {\n    key: \"createForm\",\n    value: function createForm(options) {\n      var _this6 = this; // Instantiate the webform from the PDF class instead of Webform\n\n\n      options.skipInit = false;\n      options.hideLoader = true;\n      this.webform = new _PDF.default(this.element, options);\n      this.webform.on('attach', function () {\n        // If the dropzone exists but has been removed in a PDF rebuild, reinstate it\n        if (_this6.refs.iframeDropzone && !_toConsumableArray(_this6.refs.form.children).includes(_this6.refs.iframeDropzone)) {\n          _this6.prependTo(_this6.refs.iframeDropzone, _this6.refs.form);\n        }\n      });\n      return this.webform;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(deleteFromGlobal) {\n      _get(_getPrototypeOf(PDFBuilder.prototype), \"destroy\", this).call(this, deleteFromGlobal);\n\n      this.webform.destroy(deleteFromGlobal);\n    } // d8b 8888888888                                                                              888\n    // Y8P 888                                                                                     888\n    //     888                                                                                     888\n    // 888 8888888 888d888 8888b.  88888b.d88b.   .d88b.        .d88b.  888  888  .d88b.  88888b.  888888 .d8888b\n    // 888 888     888P\"      \"88b 888 \"888 \"88b d8P  Y8b      d8P  Y8b 888  888 d8P  Y8b 888 \"88b 888    88K\n    // 888 888     888    .d888888 888  888  888 88888888      88888888 Y88  88P 88888888 888  888 888    \"Y8888b.\n    // 888 888     888    888  888 888  888  888 Y8b.          Y8b.      Y8bd8P  Y8b.     888  888 Y88b.       X88\n    // 888 888     888    \"Y888888 888  888  888  \"Y8888        \"Y8888    Y88P    \"Y8888  888  888  \"Y888  88888P'\n\n  }, {\n    key: \"getParentContainer\",\n    value: function getParentContainer(component) {\n      var container = [];\n      var originalComponent = null;\n      (0, _formUtils.eachComponent)(this.webform._form.components, function (comp, path, components) {\n        if (comp.id === component.component.id) {\n          container = components;\n          originalComponent = comp;\n          return true;\n        }\n      }, true);\n      return {\n        formioComponent: component.parent,\n        formioContainer: container,\n        originalComponent: originalComponent\n      };\n    }\n  }, {\n    key: \"initIframeEvents\",\n    value: function initIframeEvents() {\n      var _this7 = this;\n\n      this.webform.off('iframe-elementUpdate');\n      this.webform.off('iframe-componentUpdate');\n      this.webform.off('iframe-componentClick');\n      this.webform.on('iframe-elementUpdate', function (schema) {\n        var component = _this7.webform.getComponentById(schema.id);\n\n        if (component && component.component) {\n          var isNew = true;\n          component.component.overlay = {\n            page: schema.page,\n            left: schema.left,\n            top: schema.top,\n            height: schema.height,\n            width: schema.width\n          };\n\n          if (!_this7.options.noNewEdit && !component.component.noNewEdit) {\n            _this7.editComponent(component.component, _this7.getParentContainer(component), isNew);\n          }\n\n          _this7.emit('updateComponent', component.component);\n        }\n\n        return component;\n      });\n      this.webform.on('iframe-componentUpdate', function (schema) {\n        var component = _this7.webform.getComponentById(schema.id);\n\n        if (component && component.component) {\n          component.component.overlay = {\n            page: schema.overlay.page,\n            left: schema.overlay.left,\n            top: schema.overlay.top,\n            height: schema.overlay.height,\n            width: schema.overlay.width\n          };\n\n          _this7.emit('updateComponent', component.component);\n\n          _this7.emit('change', _this7.form);\n        }\n\n        return component;\n      });\n      this.webform.on('iframe-componentClick', function (schema) {\n        var component = _this7.webform.getComponentById(schema.id);\n\n        if (component) {\n          _this7.editComponent(component.component, _this7.getParentContainer(component));\n        }\n      }, true);\n    } // 8888888b.                                                                   888                   d8b\n    // 888  \"Y88b                                                                  888                   Y8P\n    // 888    888                                                                  888\n    // 888    888 888d888 .d88b.  88888b. 88888888  .d88b.  88888b.   .d88b.       888  .d88b.   .d88b.  888  .d8888b\n    // 888    888 888P\"  d88\"\"88b 888 \"88b   d88P  d88\"\"88b 888 \"88b d8P  Y8b      888 d88\"\"88b d88P\"88b 888 d88P\"\n    // 888    888 888    888  888 888  888  d88P   888  888 888  888 88888888      888 888  888 888  888 888 888\n    // 888  .d88P 888    Y88..88P 888 d88P d88P    Y88..88P 888  888 Y8b.          888 Y88..88P Y88b 888 888 Y88b.\n    // 8888888P\"  888     \"Y88P\"  88888P\" 88888888  \"Y88P\"  888  888  \"Y8888       888  \"Y88P\"   \"Y88888 888  \"Y8888P\n    //                            888                                                                888\n    //                            888                                                           Y8b d88P\n    //                            888                                                            \"Y88P\"\n\n  }, {\n    key: \"initDropzoneEvents\",\n    value: function initDropzoneEvents() {\n      if (!this.refs.iframeDropzone) {\n        return;\n      } // This is required per HTML spec in order for the drop event to fire\n\n\n      this.removeEventListener(this.refs.iframeDropzone, 'dragover');\n      this.removeEventListener(this.refs.iframeDropzone, 'drop');\n      this.addEventListener(this.refs.iframeDropzone, 'dragover', function (e) {\n        e.preventDefault();\n        return false;\n      });\n      this.addEventListener(this.refs.iframeDropzone, 'drop', this.onDropzoneDrop.bind(this));\n    }\n  }, {\n    key: \"updateDragAndDrop\",\n    value: function updateDragAndDrop() {\n      if (!this.pdfLoaded) {\n        return;\n      }\n\n      this.initDropzoneEvents();\n      this.prepSidebarComponentsForDrag();\n    }\n  }, {\n    key: \"prepSidebarComponentsForDrag\",\n    value: function prepSidebarComponentsForDrag() {\n      var _this8 = this;\n\n      if (!this.refs['sidebar-container']) {\n        return;\n      }\n\n      this.refs['sidebar-container'].forEach(function (container) {\n        _toConsumableArray(container.children).forEach(function (el) {\n          el.draggable = true;\n          el.setAttribute('draggable', true);\n\n          _this8.removeEventListener(el, 'dragstart');\n\n          _this8.removeEventListener(el, 'dragend');\n\n          _this8.addEventListener(el, 'dragstart', _this8.onDragStart.bind(_this8), true);\n\n          _this8.addEventListener(el, 'dragend', _this8.onDragEnd.bind(_this8), true);\n\n          _this8.addEventListener(el, 'drag', function (e) {\n            e.target.style.cursor = 'none';\n          });\n        });\n      });\n    }\n  }, {\n    key: \"updateDropzoneDimensions\",\n    value: function updateDropzoneDimensions() {\n      if (!this.refs.iframeDropzone) {\n        return;\n      }\n\n      var iframeRect = (0, _utils.getElementRect)(this.webform.refs.iframeContainer);\n      this.refs.iframeDropzone.style.height = iframeRect && iframeRect.height ? \"\".concat(iframeRect.height, \"px\") : '1000px';\n      this.refs.iframeDropzone.style.width = iframeRect && iframeRect.width ? \"\".concat(iframeRect.width, \"px\") : '100%';\n    }\n  }, {\n    key: \"onDragStart\",\n    value: function onDragStart(e) {\n      // Taking the current offset of a dragged item relative to the cursor\n      var _e$offsetX = e.offsetX,\n          offsetX = _e$offsetX === void 0 ? 0 : _e$offsetX,\n          _e$offsetY = e.offsetY,\n          offsetY = _e$offsetY === void 0 ? 0 : _e$offsetY;\n      this.itemOffsetX = offsetX;\n      this.itemOffsetY = offsetY;\n      e.dataTransfer.setData('text', '');\n      this.updateDropzoneDimensions();\n      this.addClass(this.refs.iframeDropzone, 'enabled');\n    }\n  }, {\n    key: \"onDropzoneDrop\",\n    value: function onDropzoneDrop(e) {\n      this.dropEvent = e;\n      e.preventDefault();\n      return false;\n    }\n  }, {\n    key: \"onDragEnd\",\n    value: function onDragEnd(e) {\n      // IMPORTANT - must retrieve offsets BEFORE disabling the dropzone - offsets will\n      // reflect absolute positioning if accessed after the target element is hidden\n      var layerX = this.dropEvent ? this.dropEvent.layerX : null;\n      var layerY = this.dropEvent ? this.dropEvent.layerY : null;\n      var WIDTH = 100;\n      var HEIGHT = 20; // Always disable the dropzone on drag end\n\n      this.removeClass(this.refs.iframeDropzone, 'enabled'); // If there hasn't been a drop event on the dropzone, we're done\n\n      if (!this.dropEvent) {\n        return;\n      }\n\n      var element = e.target;\n      var type = element.getAttribute('data-type');\n      var key = element.getAttribute('data-key');\n      var group = element.getAttribute('data-group');\n      var schema = (0, _utils.fastCloneDeep)(this.schemas[type]);\n\n      if (key && group) {\n        var info = this.getComponentInfo(key, group);\n\n        _lodash.default.merge(schema, info);\n      }\n\n      schema.key = this.generateKey(schema); // Set a unique key for this component.\n\n      _builder.default.uniquify([this.webform._form], schema);\n\n      this.webform._form.components.push(schema);\n\n      schema.overlay = {\n        top: layerY - this.itemOffsetY + HEIGHT,\n        left: layerX - this.itemOffsetX,\n        width: WIDTH,\n        height: HEIGHT\n      };\n      this.webform.addComponent(schema, {}, null, true);\n      this.webform.postMessage({\n        name: 'addElement',\n        data: schema\n      });\n      this.emit('addComponent', schema, this.webform, schema.key, this.webform.component.components.length, !this.options.noNewEdit && !schema.noNewEdit); // Delete the stored drop event now that it's been handled\n\n      this.dropEvent = null;\n      e.target.style.cursor = 'default';\n    }\n  }, {\n    key: \"highlightInvalidComponents\",\n    value: function highlightInvalidComponents() {\n      var _this9 = this;\n\n      var repeatablePaths = this.findRepeatablePaths(); // update elements which path was duplicated if any pathes have been changed\n\n      if (!_lodash.default.isEqual(this.repeatablePaths, repeatablePaths)) {\n        (0, _formUtils.eachComponent)(this.webform.getComponents(), function (comp, path) {\n          if (_this9.repeatablePaths.includes(path)) {\n            _this9.webform.postMessage({\n              name: 'updateElement',\n              data: comp.component\n            });\n          }\n        });\n        this.repeatablePaths = repeatablePaths;\n      }\n\n      if (!repeatablePaths.length) {\n        return;\n      }\n\n      (0, _formUtils.eachComponent)(this.webform.getComponents(), function (comp, path) {\n        if (_this9.repeatablePaths.includes(path)) {\n          _this9.webform.postMessage({\n            name: 'showBuilderErrors',\n            data: {\n              compId: comp.component.id,\n              errorMessage: \"API Key is not unique: \".concat(comp.key)\n            }\n          });\n        }\n      });\n    }\n  }]);\n\n  return PDFBuilder;\n}(_WebformBuilder2.default);\n\nexports.default = PDFBuilder;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/forms-flow-master/forms-flow-ai/forms-flow-web/node_modules/formiojs/PDFBuilder.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","_nativePromiseOnly","_Formio","_WebformBuilder2","_utils","_formUtils","_builder","_PDF","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","Array","from","test","iter","isArray","len","length","i","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","PDFBuilder","_WebformBuilder","_super","_this","element","options","HTMLElement","skipInit","display","dragDropEnabled","pdf","title","weight","components","textfield","number","password","email","phoneNumber","currency","checkbox","signature","select","textarea","datetime","file","htmlelement","signrequestsignature","basic","advanced","layout","data","premium","resource","has","webform","form","projectUrl","GlobalFormio","getProjectUrl","init","attachMode","createForm","render","_this2","renderTemplate","sidebar","scrollEnabled","sideBarScroll","groupOrder","groupId","concat","id","groups","map","groupKey","group","subgroups","hasPDF","attach","_this3","loadRefs","addEventListener","refs","event","preventDefault","setUploadError","fileDrop","_element","className","upload","dataTransfer","files","fileBrowse","hiddenFileInputElement","trigger","click","resolve","then","iframeDropzone","afterAttach","_this4","on","component","postMessage","initIframeEvents","updateDropzoneDimensions","addClass","pdfLoaded","updateDragAndDrop","removeClass","_this5","formio","dragDropText","style","uploadProgressWrapper","uploadFile","uploadProgress","progress","Math","floor","loaded","total","width","innerHTML","t","set","src","filesServer","path","emit","redraw","catch","err","message","uploadError","_this6","hideLoader","children","includes","prependTo","destroy","deleteFromGlobal","getParentContainer","container","originalComponent","eachComponent","_form","comp","formioComponent","parent","formioContainer","_this7","off","schema","getComponentById","isNew","overlay","page","left","top","height","noNewEdit","editComponent","initDropzoneEvents","removeEventListener","onDropzoneDrop","bind","prepSidebarComponentsForDrag","_this8","forEach","el","draggable","setAttribute","onDragStart","onDragEnd","cursor","iframeRect","getElementRect","iframeContainer","_e$offsetX","offsetX","_e$offsetY","offsetY","itemOffsetX","itemOffsetY","setData","dropEvent","layerX","layerY","WIDTH","HEIGHT","type","getAttribute","fastCloneDeep","schemas","info","getComponentInfo","merge","generateKey","uniquify","push","addComponent","highlightInvalidComponents","_this9","repeatablePaths","findRepeatablePaths","isEqual","getComponents","compId","errorMessage"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _Formio = require(\"./Formio\");\n\nvar _WebformBuilder2 = _interopRequireDefault(require(\"./WebformBuilder\"));\n\nvar _utils = require(\"./utils/utils\");\n\nvar _formUtils = require(\"./utils/formUtils\");\n\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\n\nvar _PDF = _interopRequireDefault(require(\"./PDF\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar PDFBuilder = /*#__PURE__*/function (_WebformBuilder) {\n  _inherits(PDFBuilder, _WebformBuilder);\n\n  var _super = _createSuper(PDFBuilder);\n\n  function PDFBuilder() {\n    var _this;\n\n    _classCallCheck(this, PDFBuilder);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Force superclass to skip the automatic init; we'll trigger it manually\n\n\n    options.skipInit = true;\n    options.display = 'pdf';\n\n    if (element) {\n      _this = _super.call(this, element, options);\n    } else {\n      _this = _super.call(this, options);\n    }\n\n    _this.dragDropEnabled = false;\n    return _possibleConstructorReturn(_this);\n  }\n\n  _createClass(PDFBuilder, [{\n    key: \"defaultGroups\",\n    get: function get() {\n      return {\n        pdf: {\n          title: 'PDF Fields',\n          weight: 0,\n          default: true,\n          components: {\n            textfield: true,\n            number: true,\n            password: true,\n            email: true,\n            phoneNumber: true,\n            currency: true,\n            checkbox: true,\n            signature: true,\n            select: true,\n            textarea: true,\n            datetime: true,\n            file: true,\n            htmlelement: true,\n            signrequestsignature: true\n          }\n        },\n        basic: false,\n        advanced: false,\n        layout: false,\n        data: false,\n        premium: false,\n        resource: false\n      };\n    }\n  }, {\n    key: \"hasPDF\",\n    get: function get() {\n      return _lodash.default.has(this.webform.form, 'settings.pdf');\n    }\n  }, {\n    key: \"projectUrl\",\n    get: function get() {\n      return this.options.projectUrl || _Formio.GlobalFormio.getProjectUrl();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.options.attachMode = 'builder';\n      this.webform = this.webform || this.createForm(this.options);\n      this.webform.init();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var result = this.renderTemplate('pdfBuilder', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this2.renderTemplate('builderSidebarGroup', {\n              group: _this2.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this2.id),\n              subgroups: _this2.groups[groupKey].subgroups.map(function (group) {\n                return _this2.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        form: this.hasPDF ? this.webform.render() : this.renderTemplate('pdfBuilderUpload', {})\n      });\n      return result;\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this3 = this;\n\n      // PDF Upload\n      if (!this.hasPDF) {\n        this.loadRefs(element, {\n          'fileDrop': 'single',\n          'fileBrowse': 'single',\n          'hiddenFileInputElement': 'single',\n          'uploadError': 'single',\n          'uploadProgress': 'single',\n          'uploadProgressWrapper': 'single',\n          'dragDropText': 'single'\n        });\n        this.addEventListener(this.refs['pdf-upload-button'], 'click', function (event) {\n          event.preventDefault();\n        }); // Init the upload error.\n\n        if (!this.projectUrl) {\n          this.setUploadError('Form options.projectUrl not set. Please set the \"projectUrl\" property of the options for this form or use Formio.setProjectUrl(). This setting is necessary to upload a pdf background.');\n        } else {\n          this.setUploadError();\n        }\n\n        if (this.refs.fileDrop) {\n          var _element = this;\n\n          this.addEventListener(this.refs.fileDrop, 'dragover', function (event) {\n            this.className = 'fileSelector fileDragOver';\n            event.preventDefault();\n          });\n          this.addEventListener(this.refs.fileDrop, 'dragleave', function (event) {\n            this.className = 'fileSelector';\n            event.preventDefault();\n          });\n          this.addEventListener(this.refs.fileDrop, 'drop', function (event) {\n            this.className = 'fileSelector';\n            event.preventDefault();\n\n            _element.upload(event.dataTransfer.files[0]);\n\n            return false;\n          });\n        }\n\n        if (this.refs.fileBrowse && this.refs.hiddenFileInputElement) {\n          this.addEventListener(this.refs.fileBrowse, 'click', function (event) {\n            event.preventDefault(); // There is no direct way to trigger a file dialog. To work around this, create an input of type file and trigger\n            // a click event on it.\n\n            if (typeof _this3.refs.hiddenFileInputElement.trigger === 'function') {\n              _this3.refs.hiddenFileInputElement.trigger('click');\n            } else {\n              _this3.refs.hiddenFileInputElement.click();\n            }\n          });\n          this.addEventListener(this.refs.hiddenFileInputElement, 'change', function () {\n            if (!_this3.refs.hiddenFileInputElement.value) {\n              return;\n            }\n\n            _this3.upload(_this3.refs.hiddenFileInputElement.files[0]);\n\n            _this3.refs.hiddenFileInputElement.value = '';\n          });\n        }\n\n        return _nativePromiseOnly.default.resolve();\n      } // Normal PDF Builder\n\n\n      return _get(_getPrototypeOf(PDFBuilder.prototype), \"attach\", this).call(this, element).then(function () {\n        _this3.loadRefs(_this3.element, {\n          iframeDropzone: 'single',\n          'sidebar-container': 'multiple',\n          'sidebar': 'single'\n        });\n\n        _this3.afterAttach();\n\n        return _this3.element;\n      });\n    }\n  }, {\n    key: \"afterAttach\",\n    value: function afterAttach() {\n      var _this4 = this;\n\n      this.on('saveComponent', function (component) {\n        _this4.webform.postMessage({\n          name: 'updateElement',\n          data: component\n        });\n      });\n      this.on('removeComponent', function (component) {\n        _this4.webform.postMessage({\n          name: 'removeElement',\n          data: component\n        });\n      });\n      this.initIframeEvents();\n      this.updateDropzoneDimensions();\n      var sidebar = this.refs.sidebar;\n\n      if (sidebar) {\n        this.addClass(sidebar, 'disabled');\n        this.webform.on('iframe-ready', function () {\n          _this4.pdfLoaded = true;\n\n          _this4.updateDragAndDrop();\n\n          _this4.removeClass(sidebar, 'disabled');\n        }, true);\n      }\n    }\n  }, {\n    key: \"upload\",\n    value: function upload(file) {\n      var _this5 = this;\n\n      var formio = new _Formio.GlobalFormio(this.projectUrl);\n\n      if (this.refs.dragDropText) {\n        this.refs.dragDropText.style.display = 'none';\n      }\n\n      if (this.refs.uploadProgressWrapper) {\n        this.refs.uploadProgressWrapper.style.display = 'inherit';\n      }\n\n      formio.uploadFile('url', file, file, '', function (event) {\n        if (_this5.refs.uploadProgress) {\n          var progress = Math.floor(event.loaded / event.total * 100);\n          _this5.refs.uploadProgress.style.width = \"\".concat(progress, \"%\");\n\n          if (progress > 98) {\n            _this5.refs.uploadProgress.innerHTML = _this5.t('Converting PDF. Please wait.');\n          } else {\n            _this5.refs.uploadProgress.innerHTML = \"\".concat(_this5.t('Uploading'), \" \").concat(progress, \"%\");\n          }\n        }\n      }, \"\".concat(this.projectUrl, \"/upload\"), {}, 'file').then(function (result) {\n        _lodash.default.set(_this5.webform.form, 'settings.pdf', {\n          id: result.data.file,\n          src: \"\".concat(result.data.filesServer).concat(result.data.path)\n        });\n\n        if (_this5.refs.dragDropText) {\n          _this5.refs.dragDropText.style.display = 'inherit';\n        }\n\n        if (_this5.refs.uploadProgressWrapper) {\n          _this5.refs.uploadProgressWrapper.style.display = 'none';\n        }\n\n        _this5.emit('pdfUploaded', result.data);\n\n        _this5.redraw();\n      }).catch(function (err) {\n        return _this5.setUploadError(err);\n      });\n    }\n  }, {\n    key: \"setUploadError\",\n    value: function setUploadError(message) {\n      if (!this.refs.uploadError) {\n        return;\n      }\n\n      this.refs.uploadError.style.display = message ? '' : 'none';\n      this.refs.uploadError.innerHTML = message;\n    }\n  }, {\n    key: \"createForm\",\n    value: function createForm(options) {\n      var _this6 = this;\n\n      // Instantiate the webform from the PDF class instead of Webform\n      options.skipInit = false;\n      options.hideLoader = true;\n      this.webform = new _PDF.default(this.element, options);\n      this.webform.on('attach', function () {\n        // If the dropzone exists but has been removed in a PDF rebuild, reinstate it\n        if (_this6.refs.iframeDropzone && !_toConsumableArray(_this6.refs.form.children).includes(_this6.refs.iframeDropzone)) {\n          _this6.prependTo(_this6.refs.iframeDropzone, _this6.refs.form);\n        }\n      });\n      return this.webform;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(deleteFromGlobal) {\n      _get(_getPrototypeOf(PDFBuilder.prototype), \"destroy\", this).call(this, deleteFromGlobal);\n\n      this.webform.destroy(deleteFromGlobal);\n    } // d8b 8888888888                                                                              888\n    // Y8P 888                                                                                     888\n    //     888                                                                                     888\n    // 888 8888888 888d888 8888b.  88888b.d88b.   .d88b.        .d88b.  888  888  .d88b.  88888b.  888888 .d8888b\n    // 888 888     888P\"      \"88b 888 \"888 \"88b d8P  Y8b      d8P  Y8b 888  888 d8P  Y8b 888 \"88b 888    88K\n    // 888 888     888    .d888888 888  888  888 88888888      88888888 Y88  88P 88888888 888  888 888    \"Y8888b.\n    // 888 888     888    888  888 888  888  888 Y8b.          Y8b.      Y8bd8P  Y8b.     888  888 Y88b.       X88\n    // 888 888     888    \"Y888888 888  888  888  \"Y8888        \"Y8888    Y88P    \"Y8888  888  888  \"Y888  88888P'\n\n  }, {\n    key: \"getParentContainer\",\n    value: function getParentContainer(component) {\n      var container = [];\n      var originalComponent = null;\n      (0, _formUtils.eachComponent)(this.webform._form.components, function (comp, path, components) {\n        if (comp.id === component.component.id) {\n          container = components;\n          originalComponent = comp;\n          return true;\n        }\n      }, true);\n      return {\n        formioComponent: component.parent,\n        formioContainer: container,\n        originalComponent: originalComponent\n      };\n    }\n  }, {\n    key: \"initIframeEvents\",\n    value: function initIframeEvents() {\n      var _this7 = this;\n\n      this.webform.off('iframe-elementUpdate');\n      this.webform.off('iframe-componentUpdate');\n      this.webform.off('iframe-componentClick');\n      this.webform.on('iframe-elementUpdate', function (schema) {\n        var component = _this7.webform.getComponentById(schema.id);\n\n        if (component && component.component) {\n          var isNew = true;\n          component.component.overlay = {\n            page: schema.page,\n            left: schema.left,\n            top: schema.top,\n            height: schema.height,\n            width: schema.width\n          };\n\n          if (!_this7.options.noNewEdit && !component.component.noNewEdit) {\n            _this7.editComponent(component.component, _this7.getParentContainer(component), isNew);\n          }\n\n          _this7.emit('updateComponent', component.component);\n        }\n\n        return component;\n      });\n      this.webform.on('iframe-componentUpdate', function (schema) {\n        var component = _this7.webform.getComponentById(schema.id);\n\n        if (component && component.component) {\n          component.component.overlay = {\n            page: schema.overlay.page,\n            left: schema.overlay.left,\n            top: schema.overlay.top,\n            height: schema.overlay.height,\n            width: schema.overlay.width\n          };\n\n          _this7.emit('updateComponent', component.component);\n\n          _this7.emit('change', _this7.form);\n        }\n\n        return component;\n      });\n      this.webform.on('iframe-componentClick', function (schema) {\n        var component = _this7.webform.getComponentById(schema.id);\n\n        if (component) {\n          _this7.editComponent(component.component, _this7.getParentContainer(component));\n        }\n      }, true);\n    } // 8888888b.                                                                   888                   d8b\n    // 888  \"Y88b                                                                  888                   Y8P\n    // 888    888                                                                  888\n    // 888    888 888d888 .d88b.  88888b. 88888888  .d88b.  88888b.   .d88b.       888  .d88b.   .d88b.  888  .d8888b\n    // 888    888 888P\"  d88\"\"88b 888 \"88b   d88P  d88\"\"88b 888 \"88b d8P  Y8b      888 d88\"\"88b d88P\"88b 888 d88P\"\n    // 888    888 888    888  888 888  888  d88P   888  888 888  888 88888888      888 888  888 888  888 888 888\n    // 888  .d88P 888    Y88..88P 888 d88P d88P    Y88..88P 888  888 Y8b.          888 Y88..88P Y88b 888 888 Y88b.\n    // 8888888P\"  888     \"Y88P\"  88888P\" 88888888  \"Y88P\"  888  888  \"Y8888       888  \"Y88P\"   \"Y88888 888  \"Y8888P\n    //                            888                                                                888\n    //                            888                                                           Y8b d88P\n    //                            888                                                            \"Y88P\"\n\n  }, {\n    key: \"initDropzoneEvents\",\n    value: function initDropzoneEvents() {\n      if (!this.refs.iframeDropzone) {\n        return;\n      } // This is required per HTML spec in order for the drop event to fire\n\n\n      this.removeEventListener(this.refs.iframeDropzone, 'dragover');\n      this.removeEventListener(this.refs.iframeDropzone, 'drop');\n      this.addEventListener(this.refs.iframeDropzone, 'dragover', function (e) {\n        e.preventDefault();\n        return false;\n      });\n      this.addEventListener(this.refs.iframeDropzone, 'drop', this.onDropzoneDrop.bind(this));\n    }\n  }, {\n    key: \"updateDragAndDrop\",\n    value: function updateDragAndDrop() {\n      if (!this.pdfLoaded) {\n        return;\n      }\n\n      this.initDropzoneEvents();\n      this.prepSidebarComponentsForDrag();\n    }\n  }, {\n    key: \"prepSidebarComponentsForDrag\",\n    value: function prepSidebarComponentsForDrag() {\n      var _this8 = this;\n\n      if (!this.refs['sidebar-container']) {\n        return;\n      }\n\n      this.refs['sidebar-container'].forEach(function (container) {\n        _toConsumableArray(container.children).forEach(function (el) {\n          el.draggable = true;\n          el.setAttribute('draggable', true);\n\n          _this8.removeEventListener(el, 'dragstart');\n\n          _this8.removeEventListener(el, 'dragend');\n\n          _this8.addEventListener(el, 'dragstart', _this8.onDragStart.bind(_this8), true);\n\n          _this8.addEventListener(el, 'dragend', _this8.onDragEnd.bind(_this8), true);\n\n          _this8.addEventListener(el, 'drag', function (e) {\n            e.target.style.cursor = 'none';\n          });\n        });\n      });\n    }\n  }, {\n    key: \"updateDropzoneDimensions\",\n    value: function updateDropzoneDimensions() {\n      if (!this.refs.iframeDropzone) {\n        return;\n      }\n\n      var iframeRect = (0, _utils.getElementRect)(this.webform.refs.iframeContainer);\n      this.refs.iframeDropzone.style.height = iframeRect && iframeRect.height ? \"\".concat(iframeRect.height, \"px\") : '1000px';\n      this.refs.iframeDropzone.style.width = iframeRect && iframeRect.width ? \"\".concat(iframeRect.width, \"px\") : '100%';\n    }\n  }, {\n    key: \"onDragStart\",\n    value: function onDragStart(e) {\n      // Taking the current offset of a dragged item relative to the cursor\n      var _e$offsetX = e.offsetX,\n          offsetX = _e$offsetX === void 0 ? 0 : _e$offsetX,\n          _e$offsetY = e.offsetY,\n          offsetY = _e$offsetY === void 0 ? 0 : _e$offsetY;\n      this.itemOffsetX = offsetX;\n      this.itemOffsetY = offsetY;\n      e.dataTransfer.setData('text', '');\n      this.updateDropzoneDimensions();\n      this.addClass(this.refs.iframeDropzone, 'enabled');\n    }\n  }, {\n    key: \"onDropzoneDrop\",\n    value: function onDropzoneDrop(e) {\n      this.dropEvent = e;\n      e.preventDefault();\n      return false;\n    }\n  }, {\n    key: \"onDragEnd\",\n    value: function onDragEnd(e) {\n      // IMPORTANT - must retrieve offsets BEFORE disabling the dropzone - offsets will\n      // reflect absolute positioning if accessed after the target element is hidden\n      var layerX = this.dropEvent ? this.dropEvent.layerX : null;\n      var layerY = this.dropEvent ? this.dropEvent.layerY : null;\n      var WIDTH = 100;\n      var HEIGHT = 20; // Always disable the dropzone on drag end\n\n      this.removeClass(this.refs.iframeDropzone, 'enabled'); // If there hasn't been a drop event on the dropzone, we're done\n\n      if (!this.dropEvent) {\n        return;\n      }\n\n      var element = e.target;\n      var type = element.getAttribute('data-type');\n      var key = element.getAttribute('data-key');\n      var group = element.getAttribute('data-group');\n      var schema = (0, _utils.fastCloneDeep)(this.schemas[type]);\n\n      if (key && group) {\n        var info = this.getComponentInfo(key, group);\n\n        _lodash.default.merge(schema, info);\n      }\n\n      schema.key = this.generateKey(schema); // Set a unique key for this component.\n\n      _builder.default.uniquify([this.webform._form], schema);\n\n      this.webform._form.components.push(schema);\n\n      schema.overlay = {\n        top: layerY - this.itemOffsetY + HEIGHT,\n        left: layerX - this.itemOffsetX,\n        width: WIDTH,\n        height: HEIGHT\n      };\n      this.webform.addComponent(schema, {}, null, true);\n      this.webform.postMessage({\n        name: 'addElement',\n        data: schema\n      });\n      this.emit('addComponent', schema, this.webform, schema.key, this.webform.component.components.length, !this.options.noNewEdit && !schema.noNewEdit); // Delete the stored drop event now that it's been handled\n\n      this.dropEvent = null;\n      e.target.style.cursor = 'default';\n    }\n  }, {\n    key: \"highlightInvalidComponents\",\n    value: function highlightInvalidComponents() {\n      var _this9 = this;\n\n      var repeatablePaths = this.findRepeatablePaths(); // update elements which path was duplicated if any pathes have been changed\n\n      if (!_lodash.default.isEqual(this.repeatablePaths, repeatablePaths)) {\n        (0, _formUtils.eachComponent)(this.webform.getComponents(), function (comp, path) {\n          if (_this9.repeatablePaths.includes(path)) {\n            _this9.webform.postMessage({\n              name: 'updateElement',\n              data: comp.component\n            });\n          }\n        });\n        this.repeatablePaths = repeatablePaths;\n      }\n\n      if (!repeatablePaths.length) {\n        return;\n      }\n\n      (0, _formUtils.eachComponent)(this.webform.getComponents(), function (comp, path) {\n        if (_this9.repeatablePaths.includes(path)) {\n          _this9.webform.postMessage({\n            name: 'showBuilderErrors',\n            data: {\n              compId: comp.component.id,\n              errorMessage: \"API Key is not unique: \".concat(comp.key)\n            }\n          });\n        }\n      });\n    }\n  }]);\n\n  return PDFBuilder;\n}(_WebformBuilder2.default);\n\nexports.default = PDFBuilder;"]},"metadata":{},"sourceType":"script"}