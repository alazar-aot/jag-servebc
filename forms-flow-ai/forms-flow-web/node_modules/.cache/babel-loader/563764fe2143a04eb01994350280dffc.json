{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar Node = /*#__PURE__*/function () {\n  function Node(parent) {\n    var _this = this;\n\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref$data = _ref.data,\n        data = _ref$data === void 0 ? {} : _ref$data,\n        _ref$children = _ref.children,\n        children = _ref$children === void 0 ? [] : _ref$children;\n\n    var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n        checkNode = _ref2.checkNode,\n        createComponents = _ref2.createComponents,\n        _ref2$isNew = _ref2.isNew,\n        isNew = _ref2$isNew === void 0 ? true : _ref2$isNew,\n        removeComponents = _ref2.removeComponents,\n        _ref2$parentPath = _ref2.parentPath,\n        parentPath = _ref2$parentPath === void 0 ? '' : _ref2$parentPath;\n\n    _classCallCheck(this, Node);\n\n    this.parent = parent;\n    this.previousData = {};\n    this.persistentData = _lodash.default.cloneDeep(data);\n    this.new = isNew;\n    this.createComponents = createComponents;\n    this.checkNode = checkNode;\n    this.removeComponents = removeComponents;\n    this.revertAvailable = false;\n    this.editing = false;\n    this.collapsed = false;\n    this.components = [];\n    this.children = [];\n    this.parentPath = parentPath;\n    this.resetData();\n    this.children = children.map(function (child, index) {\n      return new Node(_this, child, {\n        checkNode: checkNode,\n        createComponents: createComponents,\n        isNew: false,\n        removeComponents: removeComponents,\n        parentPath: _this.getChildrenPath(index)\n      });\n    });\n  }\n\n  _createClass(Node, [{\n    key: \"value\",\n    get: function get() {\n      return this.new ? null // Check the special case for empty root node.\n      : {\n        data: _lodash.default.cloneDeep(this.persistentData),\n        children: this.children.filter(function (child) {\n          return !child.new;\n        }).map(function (child) {\n          return child.value;\n        })\n      };\n    }\n  }, {\n    key: \"isRoot\",\n    get: function get() {\n      return this.parent === null;\n    }\n  }, {\n    key: \"changing\",\n    get: function get() {\n      return this.new || this.editing;\n    }\n  }, {\n    key: \"hasChangingChildren\",\n    get: function get() {\n      return this.changin || this.children.some(function (child) {\n        return child.hasChangingChildren;\n      });\n    }\n  }, {\n    key: \"hasData\",\n    get: function get() {\n      return !_lodash.default.isEmpty(this.persistentData);\n    }\n  }, {\n    key: \"hasChildren\",\n    get: function get() {\n      return Array.isArray(this.children) && this.children.length > 0;\n    }\n  }, {\n    key: \"getChildrenPath\",\n    value: function getChildrenPath(index) {\n      return this.parentPath ? \"\".concat(this.parentPath, \".children[\").concat(index, \"]\") : '';\n    }\n  }, {\n    key: \"eachChild\",\n    value: function eachChild(iteratee) {\n      iteratee(this);\n      this.children.forEach(function (child) {\n        return child.eachChild(iteratee);\n      });\n      return this;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.children.reduce(function (components, child) {\n        return components.concat(child.getComponents());\n      }, this.components);\n    }\n  }, {\n    key: \"validateNode\",\n    value: function validateNode() {\n      var _this2 = this;\n\n      var valid = true;\n      this.getComponents().forEach(function (comp) {\n        comp.setPristine(false);\n        valid &= comp.checkValidity(null, false, _this2.persistentData);\n      });\n      return valid;\n    }\n  }, {\n    key: \"addChild\",\n    value: function addChild() {\n      if (this.new) {\n        return null;\n      }\n\n      var child = new Node(this, {}, {\n        checkNode: this.checkNode,\n        createComponents: this.createComponents,\n        isNew: true,\n        removeComponents: this.removeComponents,\n        parentPath: this.getChildrenPath(this.children.length)\n      });\n      this.children = this.children.concat(child);\n      return child;\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(childToRemove) {\n      if (!this.new) {\n        this.children = this.children.filter(function (child) {\n          return child !== childToRemove;\n        });\n      }\n\n      return this;\n    }\n  }, {\n    key: \"edit\",\n    value: function edit() {\n      if (this.new) {\n        return this;\n      }\n\n      this.editing = true;\n      return this.resetData();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var isValid = this.validateNode();\n\n      if (this.changing && isValid) {\n        if (this.new) {\n          this.new = false;\n        } else {\n          this.editing = false;\n          this.revertAvailable = true;\n        }\n\n        this.commitData();\n      }\n\n      return isValid;\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      if (this.new) {\n        this.remove();\n      } else if (this.editing) {\n        this.editing = false;\n        this.resetData();\n      }\n\n      return this;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      this.parent.removeChild(this);\n      this.parent = null;\n      this.clearComponents();\n      return this;\n    }\n  }, {\n    key: \"revert\",\n    value: function revert() {\n      if (!this.revertAvailable) {\n        return this;\n      }\n\n      this.data = this.previousData;\n      return this.commitData();\n    }\n  }, {\n    key: \"commitData\",\n    value: function commitData() {\n      this.previousData = this.persistentData;\n      this.persistentData = _lodash.default.cloneDeep(this.data);\n      this.clearComponents();\n      return this;\n    }\n  }, {\n    key: \"resetData\",\n    value: function resetData() {\n      this.data = _lodash.default.cloneDeep(this.persistentData);\n      this.updateComponentsContext();\n      return this;\n    }\n  }, {\n    key: \"updateComponentsContext\",\n    value: function updateComponentsContext() {\n      if (this.changing) {\n        this.instantiateComponents();\n      } else {\n        this.clearComponents();\n      }\n\n      return this;\n    }\n  }, {\n    key: \"instantiateComponents\",\n    value: function instantiateComponents() {\n      var _this3 = this;\n\n      this.components = this.createComponents(this.data, this);\n      this.components.forEach(function (component) {\n        if (_this3.parentPath) {\n          var path = _this3.calculateComponentPath(component);\n\n          component.path = path;\n        }\n      });\n      this.checkNode(this);\n    }\n  }, {\n    key: \"clearComponents\",\n    value: function clearComponents() {\n      this.removeComponents(this.components);\n      this.components = [];\n    }\n    /**\n     * Return a path of component's value.\n     *\n     * @param {Object} component - The component instance.\n     * @return {string} - The component's value path.\n     */\n\n  }, {\n    key: \"calculateComponentPath\",\n    value: function calculateComponentPath(component) {\n      var path = '';\n\n      if (component.component.key) {\n        path = \"\".concat(this.parentPath, \".data.\").concat(component.component.key);\n      }\n\n      return path;\n    }\n  }]);\n\n  return Node;\n}();\n\nexports.default = Node;","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/forms-flow-master/forms-flow-ai/forms-flow-web/node_modules/formiojs/components/tree/Node.js"],"names":["Object","defineProperty","exports","value","default","require","_lodash","_interopRequireDefault","obj","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","prototype","Node","parent","_this","_ref","arguments","undefined","_ref$data","data","_ref$children","children","_ref2","checkNode","createComponents","_ref2$isNew","isNew","removeComponents","_ref2$parentPath","parentPath","previousData","persistentData","cloneDeep","new","revertAvailable","editing","collapsed","components","resetData","map","child","index","getChildrenPath","get","filter","changin","some","hasChangingChildren","isEmpty","Array","isArray","concat","eachChild","iteratee","forEach","getComponents","reduce","validateNode","_this2","valid","comp","setPristine","checkValidity","addChild","removeChild","childToRemove","edit","save","isValid","changing","commitData","cancel","remove","clearComponents","revert","updateComponentsContext","instantiateComponents","_this3","component","path","calculateComponentPath"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Node = /*#__PURE__*/function () {\n  function Node(parent) {\n    var _this = this;\n\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref$data = _ref.data,\n        data = _ref$data === void 0 ? {} : _ref$data,\n        _ref$children = _ref.children,\n        children = _ref$children === void 0 ? [] : _ref$children;\n\n    var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n        checkNode = _ref2.checkNode,\n        createComponents = _ref2.createComponents,\n        _ref2$isNew = _ref2.isNew,\n        isNew = _ref2$isNew === void 0 ? true : _ref2$isNew,\n        removeComponents = _ref2.removeComponents,\n        _ref2$parentPath = _ref2.parentPath,\n        parentPath = _ref2$parentPath === void 0 ? '' : _ref2$parentPath;\n\n    _classCallCheck(this, Node);\n\n    this.parent = parent;\n    this.previousData = {};\n    this.persistentData = _lodash.default.cloneDeep(data);\n    this.new = isNew;\n    this.createComponents = createComponents;\n    this.checkNode = checkNode;\n    this.removeComponents = removeComponents;\n    this.revertAvailable = false;\n    this.editing = false;\n    this.collapsed = false;\n    this.components = [];\n    this.children = [];\n    this.parentPath = parentPath;\n    this.resetData();\n    this.children = children.map(function (child, index) {\n      return new Node(_this, child, {\n        checkNode: checkNode,\n        createComponents: createComponents,\n        isNew: false,\n        removeComponents: removeComponents,\n        parentPath: _this.getChildrenPath(index)\n      });\n    });\n  }\n\n  _createClass(Node, [{\n    key: \"value\",\n    get: function get() {\n      return this.new ? null // Check the special case for empty root node.\n      : {\n        data: _lodash.default.cloneDeep(this.persistentData),\n        children: this.children.filter(function (child) {\n          return !child.new;\n        }).map(function (child) {\n          return child.value;\n        })\n      };\n    }\n  }, {\n    key: \"isRoot\",\n    get: function get() {\n      return this.parent === null;\n    }\n  }, {\n    key: \"changing\",\n    get: function get() {\n      return this.new || this.editing;\n    }\n  }, {\n    key: \"hasChangingChildren\",\n    get: function get() {\n      return this.changin || this.children.some(function (child) {\n        return child.hasChangingChildren;\n      });\n    }\n  }, {\n    key: \"hasData\",\n    get: function get() {\n      return !_lodash.default.isEmpty(this.persistentData);\n    }\n  }, {\n    key: \"hasChildren\",\n    get: function get() {\n      return Array.isArray(this.children) && this.children.length > 0;\n    }\n  }, {\n    key: \"getChildrenPath\",\n    value: function getChildrenPath(index) {\n      return this.parentPath ? \"\".concat(this.parentPath, \".children[\").concat(index, \"]\") : '';\n    }\n  }, {\n    key: \"eachChild\",\n    value: function eachChild(iteratee) {\n      iteratee(this);\n      this.children.forEach(function (child) {\n        return child.eachChild(iteratee);\n      });\n      return this;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.children.reduce(function (components, child) {\n        return components.concat(child.getComponents());\n      }, this.components);\n    }\n  }, {\n    key: \"validateNode\",\n    value: function validateNode() {\n      var _this2 = this;\n\n      var valid = true;\n      this.getComponents().forEach(function (comp) {\n        comp.setPristine(false);\n        valid &= comp.checkValidity(null, false, _this2.persistentData);\n      });\n      return valid;\n    }\n  }, {\n    key: \"addChild\",\n    value: function addChild() {\n      if (this.new) {\n        return null;\n      }\n\n      var child = new Node(this, {}, {\n        checkNode: this.checkNode,\n        createComponents: this.createComponents,\n        isNew: true,\n        removeComponents: this.removeComponents,\n        parentPath: this.getChildrenPath(this.children.length)\n      });\n      this.children = this.children.concat(child);\n      return child;\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(childToRemove) {\n      if (!this.new) {\n        this.children = this.children.filter(function (child) {\n          return child !== childToRemove;\n        });\n      }\n\n      return this;\n    }\n  }, {\n    key: \"edit\",\n    value: function edit() {\n      if (this.new) {\n        return this;\n      }\n\n      this.editing = true;\n      return this.resetData();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var isValid = this.validateNode();\n\n      if (this.changing && isValid) {\n        if (this.new) {\n          this.new = false;\n        } else {\n          this.editing = false;\n          this.revertAvailable = true;\n        }\n\n        this.commitData();\n      }\n\n      return isValid;\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      if (this.new) {\n        this.remove();\n      } else if (this.editing) {\n        this.editing = false;\n        this.resetData();\n      }\n\n      return this;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      this.parent.removeChild(this);\n      this.parent = null;\n      this.clearComponents();\n      return this;\n    }\n  }, {\n    key: \"revert\",\n    value: function revert() {\n      if (!this.revertAvailable) {\n        return this;\n      }\n\n      this.data = this.previousData;\n      return this.commitData();\n    }\n  }, {\n    key: \"commitData\",\n    value: function commitData() {\n      this.previousData = this.persistentData;\n      this.persistentData = _lodash.default.cloneDeep(this.data);\n      this.clearComponents();\n      return this;\n    }\n  }, {\n    key: \"resetData\",\n    value: function resetData() {\n      this.data = _lodash.default.cloneDeep(this.persistentData);\n      this.updateComponentsContext();\n      return this;\n    }\n  }, {\n    key: \"updateComponentsContext\",\n    value: function updateComponentsContext() {\n      if (this.changing) {\n        this.instantiateComponents();\n      } else {\n        this.clearComponents();\n      }\n\n      return this;\n    }\n  }, {\n    key: \"instantiateComponents\",\n    value: function instantiateComponents() {\n      var _this3 = this;\n\n      this.components = this.createComponents(this.data, this);\n      this.components.forEach(function (component) {\n        if (_this3.parentPath) {\n          var path = _this3.calculateComponentPath(component);\n\n          component.path = path;\n        }\n      });\n      this.checkNode(this);\n    }\n  }, {\n    key: \"clearComponents\",\n    value: function clearComponents() {\n      this.removeComponents(this.components);\n      this.components = [];\n    }\n    /**\n     * Return a path of component's value.\n     *\n     * @param {Object} component - The component instance.\n     * @return {string} - The component's value path.\n     */\n\n  }, {\n    key: \"calculateComponentPath\",\n    value: function calculateComponentPath(component) {\n      var path = '';\n\n      if (component.component.key) {\n        path = \"\".concat(this.parentPath, \".data.\").concat(component.component.key);\n      }\n\n      return path;\n    }\n  }]);\n\n  return Node;\n}();\n\nexports.default = Node;"]},"metadata":{},"sourceType":"script"}