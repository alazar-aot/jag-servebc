{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport _slicedToArray from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\src\\\\components\\\\Form\\\\List.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Devin\\\\AOT_Projects\\\\jag-servebc\\\\forms-flow-ai\\\\forms-flow-web\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { connect, useDispatch, useSelector } from \"react-redux\";\nimport { push } from \"connected-react-router\";\nimport { Link } from \"react-router-dom\";\nimport { Button } from \"react-bootstrap\";\nimport { toast } from 'react-toastify';\nimport { indexForms, selectRoot, selectError, Errors, FormGrid, deleteForm, saveForm } from \"react-formio\";\nimport Loading from \"../../containers/Loading\";\nimport { STAFF_DESIGNER } from \"../../constants/constants\";\nimport \"../Form/List.scss\";\nimport { setBPMFormLimit, setBPMFormListLoading, setBPMFormListPage, setBPMFormListSort, setFormDeleteStatus, setMaintainBPMFormPagination } from \"../../actions/formActions\";\nimport Confirm from \"../../containers/Confirm\";\nimport { fetchBPMFormList, fetchFormByAlias } from \"../../apiManager/services/bpmFormServices\";\nimport { designerColumns, getOperations, userColumns } from \"./constants/formListConstants\";\nimport FileService from \"../../services/FileService\";\nimport { setFormCheckList, setFormUploadList, updateFormUploadCounter } from \"../../actions/checkListActions\";\nimport FileModal from './FileUpload/fileUploadModal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar List = /*#__PURE__*/React.memo(_c = _s(function (props) {\n  _s();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      showFormUploadModal = _useState2[0],\n      setShowFormUploadModal = _useState2[1]; //const [selectedForm,setSelectedForms] = useState([]);\n\n\n  var dispatch = useDispatch();\n  var uploadFormNode = useRef();\n  var forms = props.forms,\n      onAction = props.onAction,\n      getForms = props.getForms,\n      getFormsInit = props.getFormsInit,\n      errors = props.errors,\n      userRoles = props.userRoles,\n      formId = props.formId,\n      _onNo = props.onNo,\n      _onYes = props.onYes;\n  var isBPMFormListLoading = useSelector(function (state) {\n    return state.bpmForms.isActive;\n  });\n  var bpmForms = useSelector(function (state) {\n    return state.bpmForms;\n  });\n  var showViewSubmissions = useSelector(function (state) {\n    return state.user.showViewSubmissions;\n  });\n  var formCheckList = useSelector(function (state) {\n    return state.formCheckList.formList;\n  });\n  var isDesigner = userRoles.includes(STAFF_DESIGNER);\n  var operations = getOperations(userRoles, showViewSubmissions);\n  var columns = isDesigner ? designerColumns : userColumns;\n\n  var getFormsList = function getFormsList(page, query) {\n    if (page) {\n      dispatch(setBPMFormListPage(page));\n    }\n\n    if (query) {\n      dispatch(setBPMFormListSort(query.sort || ''));\n    }\n  };\n\n  var onPageSizeChanged = function onPageSizeChanged(pageSize) {\n    if (isDesigner) {\n      dispatch(indexForms(\"forms\", 1, {\n        limit: pageSize\n      }));\n    } else {\n      dispatch(setBPMFormLimit(pageSize));\n    }\n  };\n\n  useEffect(function () {\n    dispatch(setFormCheckList([]));\n  }, [dispatch]);\n  useEffect(function () {\n    if (isDesigner) {\n      getFormsInit(1);\n    } else {\n      dispatch(setBPMFormListLoading(true));\n      dispatch(fetchBPMFormList());\n    }\n  }, [getFormsInit, dispatch, isDesigner]);\n\n  var downloadForms = function downloadForms() {\n    FileService.downloadFile({\n      forms: formCheckList\n    }, function () {\n      toast.success(\"\".concat(formCheckList.length, \" \").concat(formCheckList.length === 1 ? \"Form\" : \"Forms\", \" Downloaded Successfully\"));\n      dispatch(setFormCheckList([]));\n    });\n  };\n\n  var uploadClick = function uploadClick(e) {\n    var _uploadFormNode$curre;\n\n    dispatch(setFormUploadList([]));\n    e.preventDefault();\n    (_uploadFormNode$curre = uploadFormNode.current) === null || _uploadFormNode$curre === void 0 ? void 0 : _uploadFormNode$curre.click();\n    return false;\n  };\n\n  var uploadFileContents = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(fileContent) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(fileContent.forms && Array.isArray(fileContent.forms))) {\n                _context4.next = 5;\n                break;\n              }\n\n              _context4.next = 3;\n              return Promise.all(fileContent.forms.map( /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(formData) {\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          return _context3.abrupt(\"return\", new Promise(function (resolve, reject) {\n                            dispatch(saveForm(\"form\", formData, /*#__PURE__*/function () {\n                              var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(err, form) {\n                                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                                  while (1) {\n                                    switch (_context2.prev = _context2.next) {\n                                      case 0:\n                                        if (err) {\n                                          // get the form Id of the form if exists already in the server\n                                          dispatch(fetchFormByAlias(formData.path, /*#__PURE__*/function () {\n                                            var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(err, formObj) {\n                                              return _regeneratorRuntime.wrap(function _callee$(_context) {\n                                                while (1) {\n                                                  switch (_context.prev = _context.next) {\n                                                    case 0:\n                                                      if (!err) {\n                                                        formData._id = formObj._id;\n                                                        dispatch(saveForm(\"form\", formData, function (err, form) {\n                                                          if (!err) {\n                                                            dispatch(updateFormUploadCounter());\n                                                            resolve();\n                                                          } else {\n                                                            reject();\n                                                          }\n                                                        }));\n                                                      } else {\n                                                        reject();\n                                                      }\n\n                                                    case 1:\n                                                    case \"end\":\n                                                      return _context.stop();\n                                                  }\n                                                }\n                                              }, _callee);\n                                            }));\n\n                                            return function (_x5, _x6) {\n                                              return _ref4.apply(this, arguments);\n                                            };\n                                          }()));\n                                        } else {\n                                          dispatch(updateFormUploadCounter());\n                                          resolve();\n                                        }\n\n                                      case 1:\n                                      case \"end\":\n                                        return _context2.stop();\n                                    }\n                                  }\n                                }, _callee2);\n                              }));\n\n                              return function (_x3, _x4) {\n                                return _ref3.apply(this, arguments);\n                              };\n                            }()));\n                          }));\n\n                        case 1:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3);\n                }));\n\n                return function (_x2) {\n                  return _ref2.apply(this, arguments);\n                };\n              }()));\n\n            case 3:\n              _context4.next = 7;\n              break;\n\n            case 5:\n              setShowFormUploadModal(false);\n              return _context4.abrupt(\"return\", toast.error('Error in Json file structure'));\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function uploadFileContents(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var fileUploaded = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(evt) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              FileService.uploadFile(evt, /*#__PURE__*/function () {\n                var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(fileContent) {\n                  return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                    while (1) {\n                      switch (_context5.prev = _context5.next) {\n                        case 0:\n                          dispatch(setFormUploadList((fileContent === null || fileContent === void 0 ? void 0 : fileContent.forms) || []));\n                          setShowFormUploadModal(true);\n                          _context5.next = 4;\n                          return uploadFileContents(fileContent);\n\n                        case 4:\n                          dispatch(indexForms(\"forms\", 1, forms.query));\n\n                        case 5:\n                        case \"end\":\n                          return _context5.stop();\n                      }\n                    }\n                  }, _callee5);\n                }));\n\n                return function (_x8) {\n                  return _ref6.apply(this, arguments);\n                };\n              }());\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function fileUploaded(_x7) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(FileModal, {\n      modalOpen: showFormUploadModal,\n      onClose: function onClose() {\n        return setShowFormUploadModal(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, _this), forms.isActive || isBPMFormListLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      \"data-testid\": \"Form-list-component-loader\",\n      children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 94\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 48\n    }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(Confirm, {\n        modalOpen: props.modalOpen,\n        message: \"Are you sure you wish to delete the form \" + props.formName + \"?\",\n        onNo: function onNo() {\n          return _onNo();\n        },\n        onYes: function onYes() {\n          return _onYes(formId, forms);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-item-left\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"task-head\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-wpforms\",\n              \"aria-hidden\": \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 11\n            }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"forms-text\",\n              children: \"Forms\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 14\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 11\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-item-right\",\n          children: [userRoles.includes(STAFF_DESIGNER) && /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/formflow/create\",\n            className: \"btn btn-primary btn-left btn-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-plus fa-lg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 15\n            }, _this), \" Create Form\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 13\n          }, _this), userRoles.includes(STAFF_DESIGNER) && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn btn-primary btn-sm form-btn pull-right btn-left\",\n              onClick: uploadClick,\n              title: \"Upload json form only\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-upload fa-lg\",\n                \"aria-hidden\": \"true\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 13\n              }, _this), \" Upload Form\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 13\n            }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              className: \"d-none\",\n              multiple: false,\n              accept: \".json,application/json\",\n              onChange: fileUploaded,\n              ref: uploadFormNode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true), userRoles.includes(STAFF_DESIGNER) && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn btn-primary btn-sm form-btn pull-right btn-left\",\n              onClick: downloadForms,\n              disabled: formCheckList.length === 0,\n              title: \"Select atleast one form\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-download fa-lg\",\n                \"aria-hidden\": \"true\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 14\n              }, _this), \" Download Form\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 14\n            }, _this)\n          }, void 0, false)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"custom-grid grid-forms\",\n        children: [/*#__PURE__*/_jsxDEV(Errors, {\n          errors: errors\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(FormGrid, {\n          columns: columns,\n          forms: isDesigner ? forms : bpmForms,\n          onAction: onAction,\n          getForms: isDesigner ? getForms : getFormsList,\n          operations: operations,\n          onPageSizeChanged: onPageSizeChanged\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n}, \"J3XQzvVlko+c8qTDz3/kfEiG7Gw=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector];\n}));\n_c2 = List;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    forms: selectRoot(\"forms\", state),\n    errors: selectError(\"forms\", state),\n    userRoles: selectRoot(\"user\", state).roles || [],\n    modalOpen: selectRoot(\"formDelete\", state).formDelete.modalOpen,\n    formId: selectRoot(\"formDelete\", state).formDelete.formId,\n    formName: selectRoot(\"formDelete\", state).formDelete.formName,\n    isFormWorkflowSaved: selectRoot(\"formDelete\", state).isFormWorkflowSaved\n  };\n};\n\nvar getInitForms = function getInitForms() {\n  var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n  var query = arguments.length > 1 ? arguments[1] : undefined;\n  return function (dispatch, getState) {\n    var state = getState();\n    var currentPage = state.forms.pagination.page;\n    var maintainPagination = state.bpmForms.maintainPagination;\n    dispatch(indexForms(\"forms\", maintainPagination ? currentPage : page, query));\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch, ownProps) {\n  return {\n    getForms: function getForms(page, query) {\n      dispatch(indexForms(\"forms\", page, query));\n    },\n    getFormsInit: function getFormsInit(page, query) {\n      dispatch(getInitForms(page, query));\n    },\n    onAction: function onAction(form, action) {\n      switch (action) {\n        case \"insert\":\n          dispatch(push(\"/form/\".concat(form._id)));\n          break;\n\n        case \"submission\":\n          dispatch(push(\"/form/\".concat(form._id, \"/submission\")));\n          break;\n        // case \"edit\":\n        //   dispatch(push(`/form/${form._id}/edit`));\n        //   break;\n\n        case \"delete\":\n          var formDetails = {\n            modalOpen: true,\n            formId: form._id,\n            formName: form.title\n          };\n          dispatch(setFormDeleteStatus(formDetails));\n          break;\n\n        case \"viewForm\":\n          dispatch(setMaintainBPMFormPagination(true));\n          dispatch(push(\"/formflow/\".concat(form._id, \"/view-edit\")));\n          break;\n\n        default:\n      }\n    },\n    onYes: function onYes(formId, forms) {\n      dispatch(deleteForm(\"form\", formId, function (err) {\n        if (!err) {\n          var formDetails = {\n            modalOpen: false,\n            formId: \"\",\n            formName: \"\"\n          };\n          dispatch(setFormDeleteStatus(formDetails));\n          dispatch(indexForms(\"forms\", 1, forms.query));\n        }\n      }));\n    },\n    onNo: function onNo() {\n      var formDetails = {\n        modalOpen: false,\n        formId: \"\",\n        formName: \"\"\n      };\n      dispatch(setFormDeleteStatus(formDetails));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(List);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"List$React.memo\");\n$RefreshReg$(_c2, \"List\");","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/jag-servebc/forms-flow-ai/forms-flow-web/src/components/Form/List.js"],"names":["React","useEffect","useRef","useState","connect","useDispatch","useSelector","push","Link","Button","toast","indexForms","selectRoot","selectError","Errors","FormGrid","deleteForm","saveForm","Loading","STAFF_DESIGNER","setBPMFormLimit","setBPMFormListLoading","setBPMFormListPage","setBPMFormListSort","setFormDeleteStatus","setMaintainBPMFormPagination","Confirm","fetchBPMFormList","fetchFormByAlias","designerColumns","getOperations","userColumns","FileService","setFormCheckList","setFormUploadList","updateFormUploadCounter","FileModal","List","memo","props","showFormUploadModal","setShowFormUploadModal","dispatch","uploadFormNode","forms","onAction","getForms","getFormsInit","errors","userRoles","formId","onNo","onYes","isBPMFormListLoading","state","bpmForms","isActive","showViewSubmissions","user","formCheckList","formList","isDesigner","includes","operations","columns","getFormsList","page","query","sort","onPageSizeChanged","pageSize","limit","downloadForms","downloadFile","success","length","uploadClick","e","preventDefault","current","click","uploadFileContents","fileContent","Array","isArray","Promise","all","map","formData","resolve","reject","err","form","path","formObj","_id","error","fileUploaded","evt","uploadFile","modalOpen","formName","mapStateToProps","roles","formDelete","isFormWorkflowSaved","getInitForms","getState","currentPage","pagination","maintainPagination","mapDispatchToProps","ownProps","action","formDetails","title"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\r\nimport {connect, useDispatch, useSelector} from \"react-redux\";\r\nimport { push } from \"connected-react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {Button} from \"react-bootstrap\";\r\nimport { toast } from 'react-toastify';\r\nimport {\r\n  indexForms,\r\n  selectRoot,\r\n  selectError,\r\n  Errors,\r\n  FormGrid,\r\n  deleteForm,\r\n  saveForm\r\n} from \"react-formio\";\r\nimport Loading from \"../../containers/Loading\";\r\nimport {\r\n  STAFF_DESIGNER,\r\n} from \"../../constants/constants\";\r\nimport \"../Form/List.scss\";\r\nimport {\r\n  setBPMFormLimit,\r\n  setBPMFormListLoading,\r\n  setBPMFormListPage, setBPMFormListSort,\r\n  setFormDeleteStatus, setMaintainBPMFormPagination\r\n} from \"../../actions/formActions\";\r\nimport Confirm from \"../../containers/Confirm\";\r\nimport {fetchBPMFormList, fetchFormByAlias} from \"../../apiManager/services/bpmFormServices\";\r\nimport {designerColumns, getOperations, userColumns} from \"./constants/formListConstants\";\r\nimport FileService from \"../../services/FileService\";\r\nimport {setFormCheckList, setFormUploadList, updateFormUploadCounter} from \"../../actions/checkListActions\";\r\nimport FileModal from './FileUpload/fileUploadModal'\r\n const List = React.memo((props)=> {\r\n  const [showFormUploadModal, setShowFormUploadModal] = useState(false);\r\n  //const [selectedForm,setSelectedForms] = useState([]);\r\n  const dispatch = useDispatch();\r\n  const uploadFormNode = useRef();\r\n  const {\r\n    forms,\r\n    onAction,\r\n    getForms,\r\n    getFormsInit,\r\n    errors,\r\n    userRoles,\r\n    formId,\r\n    onNo,\r\n    onYes,\r\n  } = props;\r\n\r\n  const isBPMFormListLoading = useSelector(state=> state.bpmForms.isActive);\r\n  const bpmForms = useSelector(state=> state.bpmForms);\r\n  const showViewSubmissions= useSelector((state) => state.user.showViewSubmissions);\r\n  const formCheckList = useSelector(state => state.formCheckList.formList);\r\n  const isDesigner = userRoles.includes(STAFF_DESIGNER);\r\n  const operations = getOperations(userRoles, showViewSubmissions);\r\n  const columns= isDesigner? designerColumns: userColumns;\r\n\r\n\r\n  const getFormsList = (page,query)=>{\r\n    if(page){\r\n      dispatch(setBPMFormListPage(page));\r\n    }\r\n    if(query){\r\n      dispatch(setBPMFormListSort(query.sort||''));\r\n    }\r\n  }\r\n\r\n  const onPageSizeChanged=(pageSize)=>{\r\n    if(isDesigner){\r\n      dispatch(indexForms(\"forms\", 1, {limit:pageSize}));\r\n    }else{\r\n      dispatch(setBPMFormLimit(pageSize));\r\n    }\r\n  }\r\n\r\n  useEffect(()=>{\r\n    dispatch(setFormCheckList([]))\r\n  },[dispatch])\r\n\r\n  useEffect(()=>{\r\n    if(isDesigner){\r\n      getFormsInit(1);\r\n    }else {\r\n      dispatch(setBPMFormListLoading(true))\r\n      dispatch(fetchBPMFormList());\r\n    }\r\n  },[getFormsInit, dispatch, isDesigner])\r\n\r\n  const downloadForms = () => {\r\n    FileService.downloadFile({forms:formCheckList},()=>{\r\n      toast.success(`${formCheckList.length} ${formCheckList.length===1?\"Form\":\"Forms\"} Downloaded Successfully`)\r\n      dispatch(setFormCheckList([]));\r\n    })\r\n  }\r\n\r\n  const uploadClick = e => {\r\n    dispatch(setFormUploadList([]));\r\n    e.preventDefault();\r\n    uploadFormNode.current?.click();\r\n    return false;\r\n  };\r\n\r\n  const uploadFileContents = async (fileContent)=>{\r\n    if(fileContent.forms && Array.isArray(fileContent.forms))\r\n      {\r\n    await Promise.all(\r\n      fileContent.forms.map(async (formData)=>{\r\n        return new Promise((resolve, reject) => {\r\n          dispatch(saveForm(\"form\", formData, async (err, form) => {\r\n            if (err) {\r\n              // get the form Id of the form if exists already in the server\r\n              dispatch(fetchFormByAlias(formData.path, async (err, formObj) => {\r\n                if (!err) {\r\n                  formData._id = formObj._id;\r\n                  dispatch(saveForm(\"form\", formData, (err, form) => {\r\n                    if (!err) {\r\n                      dispatch(updateFormUploadCounter())\r\n                      resolve();\r\n                    }else{\r\n                      reject();\r\n                    }\r\n                  }));\r\n                }else{\r\n                  reject();\r\n                }\r\n              }));\r\n            } else {\r\n              dispatch(updateFormUploadCounter())\r\n              resolve()\r\n            }\r\n          }))\r\n        });\r\n    }));\r\n  }\r\n  else{\r\n    setShowFormUploadModal(false);\r\n    return (toast.error('Error in Json file structure'))\r\n  }\r\n  }\r\n\r\n  const fileUploaded = async (evt) =>{\r\n    FileService.uploadFile(evt,async (fileContent)=> {\r\n      dispatch(setFormUploadList(fileContent?.forms||[]));\r\n      setShowFormUploadModal(true);\r\n      await uploadFileContents(fileContent);\r\n      dispatch(indexForms(\"forms\", 1, forms.query))\r\n    })\r\n  }\r\n\r\n  return (\r\n     <>\r\n      <FileModal modalOpen={showFormUploadModal} onClose={()=>setShowFormUploadModal(false)} />\r\n       {\r\n    (forms.isActive || isBPMFormListLoading) ? <div data-testid=\"Form-list-component-loader\"><Loading/></div> :\r\n      <div className=\"container\">\r\n        <Confirm\r\n          modalOpen={props.modalOpen}\r\n          message={\r\n            \"Are you sure you wish to delete the form \" +\r\n            props.formName +\r\n            \"?\"\r\n          }\r\n          onNo={() => onNo()}\r\n          onYes={() => onYes(formId, forms)}\r\n        />\r\n        <div className=\"flex-container\">\r\n          {/*<img src=\"/form.svg\" width=\"30\" height=\"30\" alt=\"form\" />*/}\r\n          <div className=\"flex-item-left\">\r\n          <h3 className=\"task-head\">\r\n          <i className=\"fa fa-wpforms\" aria-hidden=\"true\"/>\r\n             <span className=\"forms-text\">Forms</span></h3>\r\n          </div>\r\n          <div className=\"flex-item-right\">\r\n          {userRoles.includes(STAFF_DESIGNER) && (\r\n            <Link\r\n              to=\"/formflow/create\"\r\n              className=\"btn btn-primary btn-left btn-sm\"\r\n            >\r\n              <i className=\"fa fa-plus fa-lg\" /> Create Form\r\n            </Link>\r\n          )}\r\n          {userRoles.includes(STAFF_DESIGNER) && (\r\n            <>\r\n            <Button className=\"btn btn-primary btn-sm form-btn pull-right btn-left\" onClick={uploadClick} title=\"Upload json form only\">\r\n            <i className=\"fa fa-upload fa-lg\" aria-hidden=\"true\"/> Upload Form</Button>\r\n              <input type=\"file\" className=\"d-none\"\r\n                     multiple={false}\r\n                     accept=\".json,application/json\"\r\n                     onChange={fileUploaded}\r\n                     ref={uploadFormNode}\r\n              />\r\n          </>\r\n          )}\r\n          {userRoles.includes(STAFF_DESIGNER) && (\r\n             <>\r\n             <Button className=\"btn btn-primary btn-sm form-btn pull-right btn-left\" onClick={downloadForms} disabled={formCheckList.length===0}  title=\"Select atleast one form\">\r\n             <i className=\"fa fa-download fa-lg\" aria-hidden=\"true\"/> Download Form</Button>\r\n             </>\r\n          )}\r\n          </div>\r\n        </div>\r\n        <section className=\"custom-grid grid-forms\">\r\n          <Errors errors={errors} />\r\n          <FormGrid\r\n            columns={columns}\r\n            forms={isDesigner?forms:bpmForms}\r\n            onAction={onAction}\r\n            getForms={isDesigner?getForms:getFormsList}\r\n            operations={operations}\r\n            onPageSizeChanged={onPageSizeChanged}\r\n          />\r\n        </section>\r\n      </div>\r\n     }\r\n     </>\r\n    );\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    forms: selectRoot(\"forms\", state),\r\n    errors: selectError(\"forms\", state),\r\n    userRoles: selectRoot(\"user\", state).roles || [],\r\n    modalOpen: selectRoot(\"formDelete\", state).formDelete.modalOpen,\r\n    formId: selectRoot(\"formDelete\", state).formDelete.formId,\r\n    formName: selectRoot(\"formDelete\", state).formDelete.formName,\r\n    isFormWorkflowSaved: selectRoot(\"formDelete\", state).isFormWorkflowSaved,\r\n  };\r\n};\r\n\r\nconst getInitForms =  (page=1, query)=>{\r\n  return (dispatch, getState) => {\r\n    const state = getState();\r\n    const currentPage =state.forms.pagination.page;\r\n    const maintainPagination = state.bpmForms.maintainPagination;\r\n    dispatch(indexForms(\"forms\", maintainPagination?currentPage:page, query));\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch,ownProps) => {\r\n  return {\r\n    getForms: (page, query) => {\r\n      dispatch(indexForms(\"forms\", page, query));\r\n    },\r\n    getFormsInit: (page, query) => {\r\n      dispatch(getInitForms( page, query));\r\n    },\r\n    onAction: (form, action) => {\r\n      switch (action) {\r\n        case \"insert\":\r\n          dispatch(push(`/form/${form._id}`));\r\n          break;\r\n        case \"submission\":\r\n          dispatch(push(`/form/${form._id}/submission`));\r\n          break;\r\n        // case \"edit\":\r\n        //   dispatch(push(`/form/${form._id}/edit`));\r\n        //   break;\r\n        case \"delete\":\r\n          const formDetails = {\r\n            modalOpen: true,\r\n            formId: form._id,\r\n            formName: form.title,\r\n          };\r\n          dispatch(setFormDeleteStatus(formDetails));\r\n          break;\r\n        case \"viewForm\":\r\n          dispatch(setMaintainBPMFormPagination(true));\r\n          dispatch(push(`/formflow/${form._id}/view-edit`));\r\n          break;\r\n        default:\r\n      }\r\n    },\r\n    onYes: (formId, forms) => {\r\n      dispatch(\r\n        deleteForm(\"form\", formId, (err) => {\r\n          if (!err) {\r\n            const formDetails = { modalOpen: false, formId: \"\", formName: \"\" };\r\n            dispatch(setFormDeleteStatus(formDetails));\r\n            dispatch(indexForms(\"forms\", 1, forms.query));\r\n          }\r\n        })\r\n      );\r\n    },\r\n    onNo: () => {\r\n      const formDetails = { modalOpen: false, formId: \"\", formName: \"\" };\r\n      dispatch(setFormDeleteStatus(formDetails));\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(List);\r\n"]},"metadata":{},"sourceType":"module"}