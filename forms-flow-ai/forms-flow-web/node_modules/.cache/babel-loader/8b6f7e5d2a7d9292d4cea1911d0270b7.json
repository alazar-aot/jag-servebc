{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.weak-map.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.regexp.flags.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _vanillaTextMask = require(\"@formio/vanilla-text-mask\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _tooltip = _interopRequireDefault(require(\"tooltip.js\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _ismobilejs = _interopRequireDefault(require(\"ismobilejs\"));\n\nvar _Formio = require(\"../../../Formio\");\n\nvar FormioUtils = _interopRequireWildcard(require(\"../../../utils/utils\"));\n\nvar _Validator = _interopRequireDefault(require(\"../../../validator/Validator\"));\n\nvar _Element2 = _interopRequireDefault(require(\"../../../Element\"));\n\nvar _ComponentModal = _interopRequireDefault(require(\"../componentModal/ComponentModal\"));\n\nvar _widgets = _interopRequireDefault(require(\"../../../widgets\"));\n\nvar _addons = _interopRequireDefault(require(\"../../../addons\"));\n\nvar _uploadAdapter = require(\"../../../providers/storage/uploadAdapter\");\n\nvar _en = _interopRequireDefault(require(\"../../../translations/en\"));\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar isIEBrowser = FormioUtils.getBrowserInfo().ie;\nvar CKEDITOR_URL = isIEBrowser ? 'https://cdn.ckeditor.com/4.14.1/standard/ckeditor.js' : 'https://cdn.form.io/ckeditor/19.0.0/ckeditor.js';\nvar QUILL_URL = isIEBrowser ? 'https://cdn.quilljs.com/1.3.7' : 'https://cdn.quilljs.com/2.0.0-dev.3';\nvar QUILL_TABLE_URL = 'https://cdn.form.io/quill/quill-table.js';\nvar ACE_URL = 'https://cdn.form.io/ace/1.4.10/ace.js';\nvar Templates = _Formio.GlobalFormio.Templates;\n\nif (!Templates) {\n  Templates = require('../../../templates/Templates').default;\n}\n/**\n * This is the Component class\n which all elements within the FormioForm derive from.\n */\n\n\nvar Component = /*#__PURE__*/function (_Element) {\n  _inherits(Component, _Element);\n\n  var _super = _createSuper(Component);\n  /* eslint-enable no-unused-vars */\n\n  /**\n   * Initialize a new Component.\n   *\n   * @param {Object} component - The component JSON you wish to initialize.\n   * @param {Object} options - The options for this component.\n   * @param {Object} data - The global data submission object this component will belong.\n   */\n\n  /* eslint-disable max-statements */\n\n\n  function Component(component, options, data) {\n    var _this;\n\n    _classCallCheck(this, Component);\n\n    _this = _super.call(this, Object.assign({\n      renderMode: 'form',\n      attachMode: 'full',\n      noDefaults: false\n    }, options || {})); // Restore the component id.\n\n    if (component && component.id) {\n      _this.id = component.id;\n    }\n    /**\n     * Determines if this component has a condition assigned to it.\n     * @type {null}\n     * @private\n     */\n\n\n    _this._hasCondition = null;\n    /**\n     * References to dom elements\n     */\n\n    _this.refs = {}; // Allow global override for any component JSON.\n\n    if (component && _this.options.components && _this.options.components[component.type]) {\n      _lodash.default.merge(component, _this.options.components[component.type]);\n    }\n    /**\n     * Set the validator instance.\n     */\n\n\n    _this.validator = _Validator.default;\n    /**\n     * The data path to this specific component instance.\n     *\n     * @type {string}\n     */\n\n    _this.path = '';\n    /**\n     * The Form.io component JSON schema.\n     * @type {*}\n     */\n\n    _this.component = _this.mergeSchema(component || {}); // Add the id to the component.\n\n    _this.component.id = _this.id; // Save off the original component to be used in logic.\n\n    _this.originalComponent = (0, FormioUtils.fastCloneDeep)(_this.component);\n    /**\n     * If the component has been attached\n     */\n\n    _this.attached = false;\n    /**\n     * If the component has been rendered\n     */\n\n    _this.rendered = false;\n    /**\n     * The data object in which this component resides.\n     * @type {*}\n     */\n\n    _this._data = data || {};\n    /**\n     * The existing error that this component has.\n     * @type {string}\n     */\n\n    _this.error = '';\n    /**\n     * Tool tip text after processing\n     * @type {string}\n     */\n\n    _this.tooltip = '';\n    /**\n     * The row path of this component.\n     * @type {number}\n     */\n\n    _this.row = _this.options.row;\n    /**\n     * Determines if this component is disabled, or not.\n     *\n     * @type {boolean}\n     */\n\n    _this._disabled = (0, FormioUtils.boolValue)(_this.component.disabled) ? _this.component.disabled : false;\n    /**\n     * Points to the root component, usually the FormComponent.\n     *\n     * @type {Component}\n     */\n\n    _this.root = _this.options.root;\n    _this.localRoot = _this.options.localRoot;\n    /**\n     * If this input has been input and provided value.\n     *\n     * @type {boolean}\n     */\n\n    _this.pristine = true;\n    /**\n     * Points to the parent component.\n     *\n     * @type {Component}\n     */\n\n    _this.parent = _this.options.parent;\n    _this.options.name = _this.options.name || 'data';\n    /**\n     * The validators that are assigned to this component.\n     * @type {[string]}\n     */\n\n    _this.validators = ['required', 'minLength', 'maxLength', 'minWords', 'maxWords', 'custom', 'pattern', 'json', 'mask'];\n    _this._path = ''; // Nested forms don't have parents so we need to pass their path in.\n\n    _this._parentPath = _this.options.parentPath || ''; // Needs for Nextgen Rules Engine\n\n    _this.resetCaches();\n    /**\n     * Determines if this component is visible, or not.\n     */\n\n\n    _this._parentVisible = _this.options.hasOwnProperty('parentVisible') ? _this.options.parentVisible : true;\n    _this._visible = _this._parentVisible && _this.conditionallyVisible(null, data);\n    _this._parentDisabled = false;\n    /**\n     * Used to trigger a new change in this component.\n     * @type {function} - Call to trigger a change in this component.\n     */\n\n    var changes = [];\n    var lastChanged = null;\n    var triggerArgs = [];\n\n    var _triggerChange = _lodash.default.debounce(function () {\n      var _this2;\n\n      if (_this.root) {\n        _this.root.changing = false;\n      }\n\n      triggerArgs = [];\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if (!args[1] && lastChanged) {\n        // Set the changed component if one isn't provided.\n        args[1] = lastChanged;\n      }\n\n      if (_lodash.default.isEmpty(args[0]) && lastChanged) {\n        // Set the flags if it is empty and lastChanged exists.\n        args[0] = lastChanged.flags;\n      }\n\n      lastChanged = null;\n      args[3] = changes;\n\n      var retVal = (_this2 = _this).onChange.apply(_this2, args);\n\n      changes = [];\n      return retVal;\n    }, 100);\n\n    _this.triggerChange = function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      if (args[1]) {\n        // Make sure that during the debounce that we always track lastChanged component, even if they\n        // don't provide one later.\n        lastChanged = args[1];\n        changes.push(lastChanged);\n      }\n\n      if (_this.root) {\n        _this.root.changing = true;\n      }\n\n      if (args.length) {\n        triggerArgs = args;\n      }\n\n      return _triggerChange.apply(void 0, _toConsumableArray(triggerArgs));\n    };\n    /**\n     * Used to trigger a redraw event within this component.\n     *\n     * @type {Function}\n     */\n\n\n    _this.triggerRedraw = _lodash.default.debounce(_this.redraw.bind(_assertThisInitialized(_this)), 100);\n    /**\n     * list of attached tooltips\n     * @type {Array}\n     */\n\n    _this.tooltips = [];\n    /**\n     * List of attached addons\n     * @type {Array}\n     */\n\n    _this.addons = []; // To force this component to be invalid.\n\n    _this.invalid = false;\n\n    if (_this.component) {\n      _this.type = _this.component.type;\n\n      if (_this.allowData && _this.key) {\n        _this.options.name += \"[\".concat(_this.key, \"]\"); // If component is visible or not set to clear on hide, set the default value.\n\n        if (_this.visible || !_this.component.clearOnHide) {\n          if (!_this.hasValue()) {\n            if (_this.shouldAddDefaultValue) {\n              _this.dataValue = _this.defaultValue;\n            }\n          } else {\n            // Ensure the dataValue is set.\n\n            /* eslint-disable  no-self-assign */\n            _this.dataValue = _this.dataValue;\n            /* eslint-enable  no-self-assign */\n          }\n        }\n      }\n      /**\n       * The element information for creating the input element.\n       * @type {*}\n       */\n\n\n      _this.info = _this.elementInfo();\n    } // Allow anyone to hook into the component creation.\n\n\n    _this.hook('component');\n\n    if (!_this.options.skipInit) {\n      _this.init();\n    }\n\n    return _this;\n  }\n  /* eslint-enable max-statements */\n\n\n  _createClass(Component, [{\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      this._data = value;\n    }\n  }, {\n    key: \"mergeSchema\",\n    value: function mergeSchema() {\n      var component = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return _lodash.default.defaultsDeep(component, this.defaultSchema);\n    } // Allow componets to notify when ready.\n\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return _nativePromiseOnly.default.resolve(this);\n    }\n  }, {\n    key: \"labelInfo\",\n    get: function get() {\n      var label = {};\n      label.hidden = this.labelIsHidden();\n      label.className = '';\n      label.labelPosition = this.component.labelPosition;\n      label.tooltipClass = \"\".concat(this.iconClass('question-sign'), \" text-muted\");\n      var isPDFReadOnlyMode = this.parent && this.parent.form && this.parent.form.display === 'pdf' && this.options.readOnly;\n\n      if (this.hasInput && this.component.validate && (0, FormioUtils.boolValue)(this.component.validate.required) && !isPDFReadOnlyMode) {\n        label.className += ' field-required';\n      }\n\n      if (label.hidden) {\n        label.className += ' control-label--hidden';\n      }\n\n      if (this.info.attr.id) {\n        label.for = this.info.attr.id;\n      }\n\n      return label;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this$component$addon,\n          _this3 = this;\n\n      this.disabled = this.shouldDisabled;\n      this._visible = this.conditionallyVisible(null, null);\n\n      if ((_this$component$addon = this.component.addons) !== null && _this$component$addon !== void 0 && _this$component$addon.length) {\n        this.component.addons.forEach(function (addon) {\n          return _this3.createAddon(addon);\n        });\n      }\n    }\n  }, {\n    key: \"createAddon\",\n    value: function createAddon(addonConfiguration) {\n      var _addonConfiguration$s;\n\n      var name = addonConfiguration.name;\n\n      if (!name) {\n        return;\n      }\n\n      var settings = ((_addonConfiguration$s = addonConfiguration.settings) === null || _addonConfiguration$s === void 0 ? void 0 : _addonConfiguration$s.data) || {};\n      var Addon = _addons.default[name];\n      var addon = null;\n\n      if (Addon) {\n        var supportedComponents = Addon.info.supportedComponents;\n        var supportsThisComponentType = !(supportedComponents !== null && supportedComponents !== void 0 && supportedComponents.length) || supportedComponents.indexOf(this.component.type) !== -1;\n\n        if (supportsThisComponentType) {\n          addon = new Addon(settings, this);\n          this.addons.push(addon);\n        } else {\n          console.warn(\"Addon \".concat(name, \" does not support component of type \").concat(this.component.type, \".\"));\n        }\n      }\n\n      return addon;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      _get(_getPrototypeOf(Component.prototype), \"destroy\", this).call(this);\n\n      this.detach();\n      this.addons.forEach(function (addon) {\n        return addon.destroy();\n      });\n    }\n  }, {\n    key: \"shouldDisabled\",\n    get: function get() {\n      return this.options.readOnly || this.component.disabled || this.options.hasOwnProperty('disabled') && this.options.disabled[this.key];\n    }\n  }, {\n    key: \"isInputComponent\",\n    get: function get() {\n      return !this.component.hasOwnProperty('input') || this.component.input;\n    }\n  }, {\n    key: \"allowData\",\n    get: function get() {\n      return this.hasInput;\n    }\n  }, {\n    key: \"hasInput\",\n    get: function get() {\n      return this.isInputComponent || this.refs.input && this.refs.input.length;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return Component.schema();\n    }\n  }, {\n    key: \"key\",\n    get: function get() {\n      return _lodash.default.get(this.component, 'key', '');\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return this._parentVisible;\n    },\n    set: function set(value) {\n      this._parentVisible = value;\n    }\n  }, {\n    key: \"parentDisabled\",\n    get: function get() {\n      return this._parentDisabled;\n    }\n    /**\n     *\n     * @param value {boolean}\n     */\n    ,\n    set: function set(value) {\n      this._parentDisabled = value;\n    }\n  }, {\n    key: \"visible\",\n    get:\n    /**\n     *\n     * @returns {boolean}\n     */\n    function get() {\n      // Show only if visibility changes or if we are in builder mode or if hidden fields should be shown.\n      if (this.builderMode || this.previewMode || this.options.showHiddenFields) {\n        return true;\n      }\n\n      if (this.options.hide && this.options.hide[this.component.key]) {\n        return false;\n      }\n\n      if (this.options.show && this.options.show[this.component.key]) {\n        return true;\n      }\n\n      return this._visible && this._parentVisible;\n    },\n    set: function set(value) {\n      if (this._visible !== value) {\n        this._visible = value;\n        this.clearOnHide();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return this._currentForm;\n    },\n    set: function set(instance) {\n      this._currentForm = instance;\n    }\n  }, {\n    key: \"fullMode\",\n    get: function get() {\n      return this.options.attachMode === 'full';\n    }\n  }, {\n    key: \"builderMode\",\n    get: function get() {\n      return this.options.attachMode === 'builder';\n    }\n  }, {\n    key: \"calculatedPath\",\n    get: function get() {\n      console.error('component.calculatedPath was deprecated, use component.path instead.');\n      return this.path;\n    }\n  }, {\n    key: \"labelPosition\",\n    get: function get() {\n      return this.component.labelPosition;\n    }\n  }, {\n    key: \"labelWidth\",\n    get: function get() {\n      var width = this.component.labelWidth;\n      return width >= 0 ? width : 30;\n    }\n  }, {\n    key: \"labelMargin\",\n    get: function get() {\n      var margin = this.component.labelMargin;\n      return margin >= 0 ? margin : 3;\n    }\n  }, {\n    key: \"isAdvancedLabel\",\n    get: function get() {\n      return ['left-left', 'left-right', 'right-left', 'right-right'].includes(this.labelPosition);\n    }\n  }, {\n    key: \"labelPositions\",\n    get: function get() {\n      return this.labelPosition.split('-');\n    }\n  }, {\n    key: \"skipInEmail\",\n    get: function get() {\n      return false;\n    }\n  }, {\n    key: \"rightDirection\",\n    value: function rightDirection(direction) {\n      return direction === 'right';\n    }\n  }, {\n    key: \"getLabelInfo\",\n    value: function getLabelInfo() {\n      var isRightPosition = this.rightDirection(this.labelPositions[0]);\n      var isLeftPosition = this.labelPositions[0] === 'left';\n      var isRightAlign = this.rightDirection(this.labelPositions[1]);\n      var contentMargin = '';\n\n      if (this.component.hideLabel) {\n        var margin = this.labelWidth + this.labelMargin;\n        contentMargin = isRightPosition ? \"margin-right: \".concat(margin, \"%\") : '';\n        contentMargin = isLeftPosition ? \"margin-left: \".concat(margin, \"%\") : '';\n      }\n\n      var labelStyles = \"\\n      flex: \".concat(this.labelWidth, \";\\n      \").concat(isRightPosition ? 'margin-left' : 'margin-right', \": \").concat(this.labelMargin, \"%;\\n    \");\n      var contentStyles = \"\\n      flex: \".concat(100 - this.labelWidth - this.labelMargin, \";\\n      \").concat(contentMargin, \";\\n      \").concat(this.component.hideLabel ? \"max-width: \".concat(100 - this.labelWidth - this.labelMargin) : '', \";\\n    \");\n      return {\n        isRightPosition: isRightPosition,\n        isRightAlign: isRightAlign,\n        labelStyles: labelStyles,\n        contentStyles: contentStyles\n      };\n    }\n    /**\n     * Returns only the schema that is different from the default.\n     *\n     * @param schema\n     * @param defaultSchema\n     */\n\n  }, {\n    key: \"getModifiedSchema\",\n    value: function getModifiedSchema(schema, defaultSchema, recursion) {\n      var _this4 = this;\n\n      var modified = {};\n\n      if (!defaultSchema) {\n        return schema;\n      }\n\n      _lodash.default.each(schema, function (val, key) {\n        if (!_lodash.default.isArray(val) && _lodash.default.isObject(val) && defaultSchema.hasOwnProperty(key)) {\n          var subModified = _this4.getModifiedSchema(val, defaultSchema[key], true);\n\n          if (!_lodash.default.isEmpty(subModified)) {\n            modified[key] = subModified;\n          }\n        } else if (_lodash.default.isArray(val)) {\n          if (val.length !== 0 && !_lodash.default.isEqual(val, defaultSchema[key])) {\n            modified[key] = val;\n          }\n        } else if (!recursion && key === 'type' || !recursion && key === 'key' || !recursion && key === 'label' || !recursion && key === 'input' || !recursion && key === 'tableView' || val !== '' && !defaultSchema.hasOwnProperty(key) || val !== '' && val !== defaultSchema[key] || defaultSchema[key] && val !== defaultSchema[key]) {\n          modified[key] = val;\n        }\n      });\n\n      return modified;\n    }\n    /**\n     * Returns the JSON schema for this component.\n     */\n\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return (0, FormioUtils.fastCloneDeep)(this.getModifiedSchema(_lodash.default.omit(this.component, 'id'), this.defaultSchema));\n    }\n    /**\n     * Returns true if component is inside DataGrid\n     */\n\n  }, {\n    key: \"isInDataGrid\",\n    get: function get() {\n      return this.inDataGrid;\n    }\n    /**\n     * Translate a text using the i18n system.\n     *\n     * @param {string} text - The i18n identifier.\n     * @param {Object} params - The i18n parameters to use for translation.\n     */\n\n  }, {\n    key: \"t\",\n    value: function t(text) {\n      var _get2;\n\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!text) {\n        return '';\n      } // Use _userInput: true to ignore translations from defaults\n\n\n      if (text in _en.default && params._userInput) {\n        return text;\n      }\n\n      params.data = this.rootValue;\n      params.row = this.data;\n      params.component = this.component;\n\n      for (var _len3 = arguments.length, args = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n        args[_key3 - 2] = arguments[_key3];\n      }\n\n      return (_get2 = _get(_getPrototypeOf(Component.prototype), \"t\", this)).call.apply(_get2, [this, text, params].concat(args));\n    }\n  }, {\n    key: \"labelIsHidden\",\n    value: function labelIsHidden() {\n      return !this.component.label || (!this.isInDataGrid && this.component.hideLabel || this.isInDataGrid && !this.component.dataGridLabel || this.options.inputsOnly) && !this.builderMode;\n    }\n  }, {\n    key: \"transform\",\n    get: function get() {\n      return Templates.current.hasOwnProperty('transform') ? Templates.current.transform.bind(Templates.current) : function (type, value) {\n        return value;\n      };\n    }\n  }, {\n    key: \"getTemplate\",\n    value: function getTemplate(names, modes) {\n      modes = Array.isArray(modes) ? modes : [modes];\n      names = Array.isArray(names) ? names : [names];\n\n      if (!modes.includes('form')) {\n        modes.push('form');\n      }\n\n      var result = null;\n\n      if (this.options.templates) {\n        result = this.checkTemplate(this.options.templates, names, modes);\n\n        if (result) {\n          return result;\n        }\n      }\n\n      var frameworkTemplates = this.options.template ? Templates.templates[this.options.template] : Templates.current;\n      result = this.checkTemplate(frameworkTemplates, names, modes);\n\n      if (result) {\n        return result;\n      } // Default back to bootstrap if not defined.\n\n\n      var name = names[names.length - 1];\n      var templatesByName = Templates.defaultTemplates[name];\n\n      if (!templatesByName) {\n        return \"Unknown template: \".concat(name);\n      }\n\n      var templateByMode = this.checkTemplateMode(templatesByName, modes);\n\n      if (templateByMode) {\n        return templateByMode;\n      }\n\n      return templatesByName.form;\n    }\n  }, {\n    key: \"checkTemplate\",\n    value: function checkTemplate(templates, names, modes) {\n      var _iterator = _createForOfIteratorHelper(names),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var name = _step.value;\n          var templatesByName = templates[name];\n\n          if (templatesByName) {\n            var templateByMode = this.checkTemplateMode(templatesByName, modes);\n\n            if (templateByMode) {\n              return templateByMode;\n            }\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"checkTemplateMode\",\n    value: function checkTemplateMode(templatesByName, modes) {\n      var _iterator2 = _createForOfIteratorHelper(modes),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var mode = _step2.value;\n          var templateByMode = templatesByName[mode];\n\n          if (templateByMode) {\n            return templateByMode;\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getFormattedTooltip\",\n    value: function getFormattedTooltip(tooltipValue) {\n      var tooltip = this.interpolate(tooltipValue || '').replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n      return tooltip ? this.t(tooltip, {\n        _userInput: true\n      }).replace(/\"/g, '&quot;') : '';\n    }\n  }, {\n    key: \"isHtmlRenderMode\",\n    value: function isHtmlRenderMode() {\n      return this.options.renderMode === 'html';\n    }\n  }, {\n    key: \"renderTemplate\",\n    value: function renderTemplate(name) {\n      var _this5 = this;\n\n      var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var modeOption = arguments.length > 2 ? arguments[2] : undefined; // Need to make this fall back to form if renderMode is not found similar to how we search templates.\n\n      var mode = modeOption || this.options.renderMode || 'form';\n      data.component = this.component;\n      data.self = this;\n      data.options = this.options;\n      data.readOnly = this.options.readOnly;\n      data.iconClass = this.iconClass.bind(this);\n      data.size = this.size.bind(this);\n      data.t = this.t.bind(this);\n      data.transform = this.transform;\n      data.id = data.id || this.id;\n      data.key = data.key || this.key;\n      data.value = data.value || this.dataValue;\n      data.disabled = this.disabled;\n      data.builder = this.builderMode;\n\n      data.render = function () {\n        console.warn(\"Form.io 'render' template function is deprecated.\\n      If you need to render template (template A) inside of another template (template B),\\n      pass pre-compiled template A (use this.renderTemplate('template_A_name') as template context variable for template B\");\n        return _this5.renderTemplate.apply(_this5, arguments);\n      };\n\n      data.label = this.labelInfo;\n      data.tooltip = this.getFormattedTooltip(this.component.tooltip); // Allow more specific template names\n\n      var names = [\"\".concat(name, \"-\").concat(this.component.type, \"-\").concat(this.key), \"\".concat(name, \"-\").concat(this.component.type), \"\".concat(name, \"-\").concat(this.key), \"\".concat(name)]; // Allow template alters.\n\n      return this.hook(\"render\".concat(name.charAt(0).toUpperCase() + name.substring(1, name.length)), this.interpolate(this.getTemplate(names, mode), data), data, mode);\n    }\n    /**\n     * Sanitize an html string.\n     *\n     * @param string\n     * @returns {*}\n     */\n\n  }, {\n    key: \"sanitize\",\n    value: function sanitize(dirty, forceSanitize) {\n      // No need to sanitize when generating PDF'S since no users interact with the form.\n      if ((this.options.pdf || this.options.sanitize === false) && !forceSanitize) {\n        return dirty;\n      }\n\n      return FormioUtils.sanitize(dirty, this.options);\n    }\n    /**\n     * Render a template string into html.\n     *\n     * @param template\n     * @param data\n     * @param actions\n     *\n     * @return {HTMLElement|String} - The created element or an empty string if template is not specified.\n     */\n\n  }, {\n    key: \"renderString\",\n    value: function renderString(template, data) {\n      if (!template) {\n        return '';\n      } // Interpolate the template and populate\n\n\n      return this.interpolate(template, data);\n    }\n  }, {\n    key: \"performInputMapping\",\n    value: function performInputMapping(input) {\n      return input;\n    }\n  }, {\n    key: \"widget\",\n    get: function get() {\n      var _this$root;\n\n      var settings = this.component.widget;\n\n      if (settings && (_this$root = this.root) !== null && _this$root !== void 0 && _this$root.shadowRoot) {\n        settings.shadowRoot = this.root.shadowRoot;\n      }\n\n      var widget = settings && _widgets.default[settings.type] ? new _widgets.default[settings.type](settings, this.component, this) : null;\n      return widget;\n    }\n  }, {\n    key: \"getBrowserLanguage\",\n    value: function getBrowserLanguage() {\n      var nav = window.navigator;\n      var browserLanguagePropertyKeys = ['language', 'browserLanguage', 'systemLanguage', 'userLanguage'];\n      var language; // support for HTML 5.1 \"navigator.languages\"\n\n      if (Array.isArray(nav.languages)) {\n        for (var i = 0; i < nav.languages.length; i++) {\n          language = nav.languages[i];\n\n          if (language && language.length) {\n            return language.split(';')[0];\n          }\n        }\n      } // support for other well known properties in browsers\n\n\n      for (var _i = 0; _i < browserLanguagePropertyKeys.length; _i++) {\n        language = nav[browserLanguagePropertyKeys[_i]];\n\n        if (language && language.length) {\n          return language.split(';')[0];\n        }\n      }\n\n      return null;\n    }\n    /**\n     * Called before a next and previous page is triggered allowing the components\n     * to perform special functions.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage() {\n      return _nativePromiseOnly.default.resolve(true);\n    }\n  }, {\n    key: \"beforeNext\",\n    value: function beforeNext() {\n      return this.beforePage(true);\n    }\n    /**\n     * Called before a submission is triggered allowing the components\n     * to perform special async functions.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      return _nativePromiseOnly.default.resolve(true);\n    }\n    /**\n     * Return the submission timezone.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"submissionTimezone\",\n    get: function get() {\n      this.options.submissionTimezone = this.options.submissionTimezone || _lodash.default.get(this.root, 'options.submissionTimezone');\n      return this.options.submissionTimezone;\n    }\n  }, {\n    key: \"loadRefs\",\n    value: function loadRefs(element, refs) {\n      for (var ref in refs) {\n        if (refs[ref] === 'single') {\n          this.refs[ref] = element.querySelector(\"[ref=\\\"\".concat(ref, \"\\\"]\"));\n        } else {\n          this.refs[ref] = element.querySelectorAll(\"[ref=\\\"\".concat(ref, \"\\\"]\"));\n        }\n      }\n    }\n  }, {\n    key: \"setOpenModalElement\",\n    value: function setOpenModalElement(template) {\n      this.componentModal.setOpenModalElement(template || this.getModalPreviewTemplate());\n    }\n  }, {\n    key: \"getModalPreviewTemplate\",\n    value: function getModalPreviewTemplate() {\n      var dataValue = this.component.type === 'password' ? this.dataValue.replace(/./g, '•') : this.dataValue;\n      var message = this.error ? {\n        level: 'error',\n        message: this.error.message\n      } : '';\n      return this.renderTemplate('modalPreview', {\n        previewText: this.getValueAsString(dataValue, {\n          modalPreview: true\n        }) || this.t('Click to set value'),\n        messages: message && this.renderTemplate('message', message)\n      });\n    }\n  }, {\n    key: \"build\",\n    value: function build(element) {\n      element = element || this.element;\n      this.empty(element);\n      this.setContent(element, this.render());\n      return this.attach(element);\n    }\n  }, {\n    key: \"hasModalSaveButton\",\n    get: function get() {\n      return true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"Unknown component: \".concat(this.component.type);\n      var topLevel = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var isVisible = this.visible;\n      this.rendered = true;\n\n      if (!this.builderMode && !this.previewMode && this.component.modalEdit) {\n        return _ComponentModal.default.render(this, {\n          visible: isVisible,\n          showSaveButton: this.hasModalSaveButton,\n          id: this.id,\n          classes: this.className,\n          styles: this.customStyle,\n          children: children\n        }, topLevel);\n      } else {\n        return this.renderTemplate('component', {\n          visible: isVisible,\n          id: this.id,\n          classes: this.className,\n          styles: this.customStyle,\n          children: children\n        }, topLevel);\n      }\n    }\n  }, {\n    key: \"attachTooltips\",\n    value: function attachTooltips(toolTipsRefs) {\n      var _this6 = this;\n\n      toolTipsRefs === null || toolTipsRefs === void 0 ? void 0 : toolTipsRefs.forEach(function (tooltip, index) {\n        if (tooltip) {\n          var tooltipAttribute = tooltip.getAttribute('data-tooltip');\n          var tooltipDataTitle = tooltip.getAttribute('data-title');\n\n          var tooltipText = _this6.interpolate(tooltipDataTitle || tooltipAttribute).replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n\n          _this6.tooltips[index] = new _tooltip.default(tooltip, {\n            trigger: 'hover click focus',\n            placement: 'right',\n            html: true,\n            title: _this6.t(tooltipText, {\n              _userInput: true\n            }),\n            template: \"\\n            <div class=\\\"tooltip\\\" style=\\\"opacity: 1;\\\" role=\\\"tooltip\\\">\\n              <div class=\\\"tooltip-arrow\\\"></div>\\n              <div class=\\\"tooltip-inner\\\"></div>\\n            </div>\"\n          });\n        }\n      });\n    }\n  }, {\n    key: \"createComponentModal\",\n    value: function createComponentModal(element, modalShouldBeOpened, currentValue) {\n      return new _ComponentModal.default(this, element, modalShouldBeOpened, currentValue);\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      if (!this.builderMode && !this.previewMode && this.component.modalEdit) {\n        var modalShouldBeOpened = this.componentModal ? this.componentModal.isOpened : false;\n        var currentValue = modalShouldBeOpened ? this.componentModal.currentValue : this.dataValue;\n        var openModalTemplate = this.componentModal && modalShouldBeOpened ? this.componentModal.openModalTemplate : null;\n        this.componentModal = this.createComponentModal(element, modalShouldBeOpened, currentValue);\n        this.setOpenModalElement(openModalTemplate);\n      }\n\n      this.attached = true;\n      this.element = element;\n      element.component = this; // If this already has an id, get it from the dom. If SSR, it could be different from the initiated id.\n\n      if (this.element.id) {\n        this.id = this.element.id;\n        this.component.id = this.id;\n      }\n\n      this.loadRefs(element, {\n        messageContainer: 'single',\n        tooltip: 'multiple'\n      });\n      this.attachTooltips(this.refs.tooltip); // Attach logic.\n\n      this.attachLogic();\n      this.autofocus(); // Allow global attach.\n\n      this.hook('attachComponent', element, this); // Allow attach per component type.\n\n      var type = this.component.type;\n\n      if (type) {\n        this.hook(\"attach\".concat(type.charAt(0).toUpperCase() + type.substring(1, type.length)), element, this);\n      }\n\n      this.restoreFocus();\n      this.addons.forEach(function (addon) {\n        return addon.attach(element);\n      });\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"restoreFocus\",\n    value: function restoreFocus() {\n      var _this$root2, _this$root2$focusedCo;\n\n      var isFocused = ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : (_this$root2$focusedCo = _this$root2.focusedComponent) === null || _this$root2$focusedCo === void 0 ? void 0 : _this$root2$focusedCo.path) === this.path;\n\n      if (isFocused) {\n        var _this$root$currentSel;\n\n        this.loadRefs(this.element, {\n          input: 'multiple'\n        });\n        this.focus((_this$root$currentSel = this.root.currentSelection) === null || _this$root$currentSel === void 0 ? void 0 : _this$root$currentSel.index);\n        this.restoreCaretPosition();\n      }\n    }\n  }, {\n    key: \"addShortcut\",\n    value: function addShortcut(element, shortcut) {\n      // Avoid infinite recursion.\n      if (!element || !this.root || this.root === this) {\n        return;\n      }\n\n      if (!shortcut) {\n        shortcut = this.component.shortcut;\n      }\n\n      this.root.addShortcut(element, shortcut);\n    }\n  }, {\n    key: \"removeShortcut\",\n    value: function removeShortcut(element, shortcut) {\n      // Avoid infinite recursion.\n      if (!element || this.root === this) {\n        return;\n      }\n\n      if (!shortcut) {\n        shortcut = this.component.shortcut;\n      }\n\n      this.root.removeShortcut(element, shortcut);\n    }\n    /**\n     * Remove all event handlers.\n     */\n\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.refs = {};\n      this.removeEventListeners();\n      this.detachLogic();\n\n      if (this.tooltip) {\n        this.tooltip.dispose();\n      }\n    }\n  }, {\n    key: \"checkRefresh\",\n    value: function checkRefresh(refreshData, changed, flags) {\n      var changePath = _lodash.default.get(changed, 'instance.path', false); // Don't let components change themselves.\n\n\n      if (changePath && this.path === changePath) {\n        return;\n      }\n\n      if (refreshData === 'data') {\n        this.refresh(this.data, changed, flags);\n      } else if (changePath && (0, FormioUtils.getComponentPath)(changed.instance) === refreshData && changed && changed.instance && // Make sure the changed component is not in a different \"context\". Solves issues where refreshOn being set\n      // in fields inside EditGrids could alter their state from other rows (which is bad).\n      this.inContext(changed.instance)) {\n        this.refresh(changed.value, changed, flags);\n      }\n    }\n  }, {\n    key: \"checkRefreshOn\",\n    value: function checkRefreshOn(changes) {\n      var _this7 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      changes = changes || [];\n\n      if (flags.noRefresh) {\n        return;\n      }\n\n      if (!changes.length && flags.changed) {\n        changes = [flags.changed];\n      }\n\n      var refreshOn = flags.fromBlur ? this.component.refreshOnBlur : this.component.refreshOn || this.component.redrawOn; // If they wish to refresh on a value, then add that here.\n\n      if (refreshOn) {\n        if (Array.isArray(refreshOn)) {\n          refreshOn.forEach(function (refreshData) {\n            return changes.forEach(function (changed) {\n              return _this7.checkRefresh(refreshData, changed, flags);\n            });\n          });\n        } else {\n          changes.forEach(function (changed) {\n            return _this7.checkRefresh(refreshOn, changed, flags);\n          });\n        }\n      }\n    }\n    /**\n     * Refreshes the component with a new value.\n     *\n     * @param value\n     */\n\n  }, {\n    key: \"refresh\",\n    value: function refresh(value) {\n      if (this.hasOwnProperty('refreshOnValue')) {\n        this.refreshOnChanged = !_lodash.default.isEqual(value, this.refreshOnValue);\n      } else {\n        this.refreshOnChanged = true;\n      }\n\n      this.refreshOnValue = (0, FormioUtils.fastCloneDeep)(value);\n\n      if (this.refreshOnChanged) {\n        if (this.component.clearOnRefresh) {\n          this.setValue(null);\n        }\n\n        this.triggerRedraw();\n      }\n    }\n    /**\n     * Checks to see if a separate component is in the \"context\" of this component. This is determined by first checking\n     * if they share the same \"data\" object. It will then walk up the parent tree and compare its parents data objects\n     * with the components data and returns true if they are in the same context.\n     *\n     * Different rows of the same EditGrid, for example, are in different contexts.\n     *\n     * @param component\n     */\n\n  }, {\n    key: \"inContext\",\n    value: function inContext(component) {\n      if (component.data === this.data) {\n        return true;\n      }\n\n      var parent = this.parent;\n\n      while (parent) {\n        if (parent.data === component.data) {\n          return true;\n        }\n\n        parent = parent.parent;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"viewOnly\",\n    get: function get() {\n      return this.options.readOnly && this.options.viewAsHtml;\n    }\n  }, {\n    key: \"createViewOnlyElement\",\n    value: function createViewOnlyElement() {\n      this.element = this.ce('dl', {\n        id: this.id\n      });\n\n      if (this.element) {\n        // Ensure you can get the component info from the element.\n        this.element.component = this;\n      }\n\n      return this.element;\n    }\n  }, {\n    key: \"defaultViewOnlyValue\",\n    get: function get() {\n      return '-';\n    }\n    /**\n     * Uses the widget to determine the output string.\n     *\n     * @param value\n     * @return {*}\n     */\n\n  }, {\n    key: \"getWidgetValueAsString\",\n    value: function getWidgetValueAsString(value, options) {\n      var _this8 = this;\n\n      var noInputWidget = !this.refs.input || !this.refs.input[0] || !this.refs.input[0].widget;\n\n      if (!value || noInputWidget) {\n        if (!this.widget || !value) {\n          return value;\n        } else {\n          return this.widget.getValueAsString(value);\n        }\n      }\n\n      if (Array.isArray(value)) {\n        var values = [];\n        value.forEach(function (val, index) {\n          var widget = _this8.refs.input[index] && _this8.refs.input[index].widget;\n\n          if (widget) {\n            values.push(widget.getValueAsString(val, options));\n          }\n        });\n        return values;\n      }\n\n      var widget = this.refs.input[0].widget;\n      return widget.getValueAsString(value, options);\n    }\n  }, {\n    key: \"getValueAsString\",\n    value: function getValueAsString(value, options) {\n      if (!value) {\n        return '';\n      }\n\n      value = this.getWidgetValueAsString(value, options);\n\n      if (Array.isArray(value)) {\n        return value.join(', ');\n      }\n\n      if (_lodash.default.isPlainObject(value)) {\n        return JSON.stringify(value);\n      }\n\n      if (value === null || value === undefined) {\n        return '';\n      }\n\n      var stringValue = value.toString();\n      return this.sanitize(stringValue, this.shouldSanitizeValue);\n    }\n  }, {\n    key: \"getView\",\n    value: function getView(value, options) {\n      if (this.component.protected) {\n        return '--- PROTECTED ---';\n      }\n\n      return this.getValueAsString(value, options);\n    }\n  }, {\n    key: \"updateItems\",\n    value: function updateItems() {\n      this.restoreValue();\n      this.onChange.apply(this, arguments);\n    }\n    /**\n     * @param {*} data\n     * @param {boolean} [forceUseValue=false] - if true, return 'value' property of the data\n     * @return {*}\n     */\n\n  }, {\n    key: \"itemValue\",\n    value: function itemValue(data) {\n      var forceUseValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (_lodash.default.isObject(data)) {\n        if (this.valueProperty) {\n          return _lodash.default.get(data, this.valueProperty);\n        }\n\n        if (forceUseValue) {\n          return data.value;\n        }\n      }\n\n      return data;\n    }\n  }, {\n    key: \"itemValueForHTMLMode\",\n    value: function itemValueForHTMLMode(value) {\n      var _this9 = this;\n\n      if (Array.isArray(value)) {\n        var values = value.map(function (item) {\n          return Array.isArray(item) ? _this9.itemValueForHTMLMode(item) : _this9.itemValue(item);\n        });\n        return values.join(', ');\n      }\n\n      return this.itemValue(value);\n    }\n  }, {\n    key: \"createModal\",\n    value: function createModal(element, attr, confirm) {\n      var _this10 = this;\n\n      var dialog = this.ce('div', attr || {});\n      this.setContent(dialog, this.renderTemplate('dialog')); // Add refs to dialog, not \"this\".\n\n      dialog.refs = {};\n      this.loadRefs.call(dialog, dialog, {\n        dialogOverlay: 'single',\n        dialogContents: 'single',\n        dialogClose: 'single'\n      });\n      dialog.refs.dialogContents.appendChild(element);\n      document.body.appendChild(dialog);\n      document.body.classList.add('modal-open');\n\n      dialog.close = function () {\n        document.body.classList.remove('modal-open');\n        dialog.dispatchEvent(new CustomEvent('close'));\n      };\n\n      this.addEventListener(dialog, 'close', function () {\n        return _this10.removeChildFrom(dialog, document.body);\n      });\n\n      var close = function close(event) {\n        event.preventDefault();\n        dialog.close();\n      };\n\n      var handleCloseClick = function handleCloseClick(e) {\n        if (confirm) {\n          confirm().then(function () {\n            return close(e);\n          }).catch(function () {});\n        } else {\n          close(e);\n        }\n      };\n\n      this.addEventListener(dialog.refs.dialogOverlay, 'click', handleCloseClick);\n      this.addEventListener(dialog.refs.dialogClose, 'click', handleCloseClick);\n      return dialog;\n    }\n  }, {\n    key: \"optimizeRedraw\",\n    get: function get() {\n      if (this.options.optimizeRedraw && this.element && !this.visible) {\n        this.addClass(this.element, 'formio-removed');\n        return true;\n      }\n\n      return false;\n    }\n    /**\n     * Retrieves the CSS class name of this component.\n     * @returns {string} - The class name of this component.\n     */\n\n  }, {\n    key: \"className\",\n    get: function get() {\n      var className = this.hasInput ? 'form-group has-feedback ' : '';\n      className += \"formio-component formio-component-\".concat(this.component.type, \" \"); // TODO: find proper way to avoid overriding of default type-based component styles\n\n      if (this.key && this.key !== 'form') {\n        className += \"formio-component-\".concat(this.key, \" \");\n      }\n\n      if (this.component.multiple) {\n        className += 'formio-component-multiple ';\n      }\n\n      if (this.component.customClass) {\n        className += this.component.customClass;\n      }\n\n      if (this.hasInput && this.component.validate && (0, FormioUtils.boolValue)(this.component.validate.required)) {\n        className += ' required';\n      }\n\n      if (this.labelIsHidden()) {\n        className += ' formio-component-label-hidden';\n      }\n\n      if (!this.visible) {\n        className += ' formio-hidden';\n      }\n\n      return className;\n    }\n    /**\n     * Build the custom style from the layout values\n     * @return {string} - The custom style\n     */\n\n  }, {\n    key: \"customStyle\",\n    get: function get() {\n      var customCSS = '';\n\n      _lodash.default.each(this.component.style, function (value, key) {\n        if (value !== '') {\n          customCSS += \"\".concat(key, \":\").concat(value, \";\");\n        }\n      });\n\n      return customCSS;\n    }\n  }, {\n    key: \"isMobile\",\n    get: function get() {\n      return (0, _ismobilejs.default)();\n    }\n    /**\n     * Returns the outside wrapping element of this component.\n     * @returns {HTMLElement}\n     */\n\n  }, {\n    key: \"getElement\",\n    value: function getElement() {\n      return this.element;\n    }\n    /**\n     * Create an evaluation context for all script executions and interpolations.\n     *\n     * @param additional\n     * @return {*}\n     */\n\n  }, {\n    key: \"evalContext\",\n    value: function evalContext(additional) {\n      return _get(_getPrototypeOf(Component.prototype), \"evalContext\", this).call(this, Object.assign({\n        component: this.component,\n        row: this.data,\n        rowIndex: this.rowIndex,\n        data: this.rootValue,\n        iconClass: this.iconClass.bind(this),\n        // Bind the translate function to the data context of any interpolated string.\n        // It is useful to translate strings in different scenarions (eg: custom edit grid templates, custom error messages etc.)\n        // and desirable to be publicly available rather than calling the internal {instance.t} function in the template string.\n        t: this.t.bind(this),\n        submission: this.root ? this.root._submission : {\n          data: this.rootValue\n        },\n        form: this.root ? this.root._form : {},\n        options: this.options\n      }, additional));\n    }\n    /**\n     * Sets the pristine flag for this component.\n     *\n     * @param pristine {boolean} - TRUE to make pristine, FALSE not pristine.\n     */\n\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      this.pristine = pristine;\n    }\n  }, {\n    key: \"isPristine\",\n    get: function get() {\n      return this.pristine;\n    }\n  }, {\n    key: \"setDirty\",\n    value: function setDirty(dirty) {\n      this.dirty = dirty;\n    }\n  }, {\n    key: \"isDirty\",\n    get: function get() {\n      return this.dirty;\n    }\n    /**\n     * Removes a value out of the data array and rebuild the rows.\n     * @param {number} index - The index of the data element to remove.\n     */\n\n  }, {\n    key: \"removeValue\",\n    value: function removeValue(index) {\n      this.splice(index);\n      this.redraw();\n      this.restoreValue();\n      this.triggerRootChange();\n    }\n  }, {\n    key: \"iconClass\",\n    value: function iconClass(name, spinning) {\n      var iconset = this.options.iconset || Templates.current.defaultIconset || 'fa';\n      return Templates.current.hasOwnProperty('iconClass') ? Templates.current.iconClass(iconset, name, spinning) : this.options.iconset === 'fa' ? Templates.defaultTemplates.iconClass(iconset, name, spinning) : name;\n    }\n  }, {\n    key: \"size\",\n    value: function size(_size) {\n      return Templates.current.hasOwnProperty('size') ? Templates.current.size(_size) : _size;\n    }\n    /**\n     * The readible name for this component.\n     * @returns {string} - The name of the component.\n     */\n\n  }, {\n    key: \"name\",\n    get: function get() {\n      return this.t(this.component.label || this.component.placeholder || this.key, {\n        _userInput: true\n      });\n    }\n    /**\n     * Returns the error label for this component.\n     * @return {*}\n     */\n\n  }, {\n    key: \"errorLabel\",\n    get: function get() {\n      return this.t(this.component.errorLabel || this.component.label || this.component.placeholder || this.key);\n    }\n    /**\n     * Get the error message provided a certain type of error.\n     * @param type\n     * @return {*}\n     */\n\n  }, {\n    key: \"errorMessage\",\n    value: function errorMessage(type) {\n      return this.component.errors && this.component.errors[type] ? this.component.errors[type] : type;\n    }\n  }, {\n    key: \"setContent\",\n    value: function setContent(element, content, forceSanitize) {\n      if (element instanceof HTMLElement) {\n        element.innerHTML = this.sanitize(content, forceSanitize);\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"restoreCaretPosition\",\n    value: function restoreCaretPosition() {\n      var _this$root3;\n\n      if ((_this$root3 = this.root) !== null && _this$root3 !== void 0 && _this$root3.currentSelection) {\n        var _this$refs$input;\n\n        if ((_this$refs$input = this.refs.input) !== null && _this$refs$input !== void 0 && _this$refs$input.length) {\n          var _this$root$currentSel2 = this.root.currentSelection,\n              selection = _this$root$currentSel2.selection,\n              index = _this$root$currentSel2.index;\n          var input = this.refs.input[index];\n          var isInputRangeSelectable = /text|search|password|tel|url/i.test(input.type || '');\n\n          if (input) {\n            if (isInputRangeSelectable) {\n              var _input;\n\n              (_input = input).setSelectionRange.apply(_input, _toConsumableArray(selection));\n            }\n          } else {\n            var _input$value;\n\n            input = this.refs.input[this.refs.input.length];\n            var lastCharacter = ((_input$value = input.value) === null || _input$value === void 0 ? void 0 : _input$value.length) || 0;\n\n            if (isInputRangeSelectable) {\n              input.setSelectionRange(lastCharacter, lastCharacter);\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      // Don't bother if we have not built yet.\n      if (!this.element || !this.element.parentNode || this.optimizeRedraw) {\n        // Return a non-resolving promise.\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      this.detach();\n      this.emit('redraw'); // Since we are going to replace the element, we need to know it's position so we can find it in the parent's children.\n\n      var parent = this.element.parentNode;\n      var index = Array.prototype.indexOf.call(parent.children, this.element);\n      this.element.outerHTML = this.sanitize(this.render());\n      this.element = parent.children[index];\n      return this.attach(this.element);\n    }\n  }, {\n    key: \"rebuild\",\n    value: function rebuild() {\n      this.destroy();\n      this.init();\n      this.visible = this.conditionallyVisible(null, null);\n      return this.redraw();\n    }\n  }, {\n    key: \"removeEventListeners\",\n    value: function removeEventListeners() {\n      _get(_getPrototypeOf(Component.prototype), \"removeEventListeners\", this).call(this);\n\n      this.tooltips.forEach(function (tooltip) {\n        return tooltip.dispose();\n      });\n      this.tooltips = [];\n    }\n  }, {\n    key: \"hasClass\",\n    value: function hasClass(element, className) {\n      if (!element) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Component.prototype), \"hasClass\", this).call(this, element, this.transform('class', className));\n    }\n  }, {\n    key: \"addClass\",\n    value: function addClass(element, className) {\n      if (!element) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Component.prototype), \"addClass\", this).call(this, element, this.transform('class', className));\n    }\n  }, {\n    key: \"removeClass\",\n    value: function removeClass(element, className) {\n      if (!element) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Component.prototype), \"removeClass\", this).call(this, element, this.transform('class', className));\n    }\n    /**\n     * Determines if this component has a condition defined.\n     *\n     * @return {null}\n     */\n\n  }, {\n    key: \"hasCondition\",\n    value: function hasCondition() {\n      if (this._hasCondition !== null) {\n        return this._hasCondition;\n      }\n\n      this._hasCondition = FormioUtils.hasCondition(this.component);\n      return this._hasCondition;\n    }\n    /**\n     * Check if this component is conditionally visible.\n     *\n     * @param data\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"conditionallyVisible\",\n    value: function conditionallyVisible(data, row) {\n      data = data || this.rootValue;\n      row = row || this.data;\n\n      if (this.builderMode || this.previewMode || !this.hasCondition()) {\n        return !this.component.hidden;\n      }\n\n      data = data || (this.root ? this.root.data : {});\n      return this.checkCondition(row, data);\n    }\n    /**\n     * Checks the condition of this component.\n     *\n     * TODO: Switch row and data parameters to be consistent with other methods.\n     *\n     * @param row - The row contextual data.\n     * @param data - The global data object.\n     * @return {boolean} - True if the condition applies to this component.\n     */\n\n  }, {\n    key: \"checkCondition\",\n    value: function checkCondition(row, data) {\n      return FormioUtils.checkCondition(this.component, row || this.data, data || this.rootValue, this.root ? this.root._form : {}, this);\n    }\n    /**\n     * Check for conditionals and hide/show the element based on those conditions.\n     */\n\n  }, {\n    key: \"checkComponentConditions\",\n    value: function checkComponentConditions(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n\n      if (!this.builderMode & !this.previewMode && this.fieldLogic(data, row)) {\n        this.redraw();\n      } // Check advanced conditions\n\n\n      var visible = this.conditionallyVisible(data, row);\n\n      if (this.visible !== visible) {\n        this.visible = visible;\n      }\n\n      return visible;\n    }\n    /**\n     * Checks conditions for this component and any sub components.\n     * @param args\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      return this.checkComponentConditions(data, flags, row);\n    }\n  }, {\n    key: \"logic\",\n    get: function get() {\n      return this.component.logic || [];\n    }\n    /**\n     * Check all triggers and apply necessary actions.\n     *\n     * @param data\n     */\n\n  }, {\n    key: \"fieldLogic\",\n    value: function fieldLogic(data, row) {\n      var _this11 = this;\n\n      data = data || this.rootValue;\n      row = row || this.data;\n      var logics = this.logic; // If there aren't logic, don't go further.\n\n      if (logics.length === 0) {\n        return;\n      }\n\n      var newComponent = (0, FormioUtils.fastCloneDeep)(this.originalComponent);\n      var changed = logics.reduce(function (changed, logic) {\n        var result = FormioUtils.checkTrigger(newComponent, logic.trigger, row, data, _this11.root ? _this11.root._form : {}, _this11);\n        return (result ? _this11.applyActions(newComponent, logic.actions, result, row, data) : false) || changed;\n      }, false); // If component definition changed, replace and mark as changed.\n\n      if (!_lodash.default.isEqual(this.component, newComponent)) {\n        this.component = newComponent;\n        changed = true;\n        var disabled = this.shouldDisabled; // Change disabled state if it has changed\n\n        if (this.disabled !== disabled) {\n          this.disabled = disabled;\n        }\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"isIE\",\n    value: function isIE() {\n      if (typeof window === 'undefined') {\n        return false;\n      }\n\n      var userAgent = window.navigator.userAgent;\n      var msie = userAgent.indexOf('MSIE ');\n\n      if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(userAgent.substring(msie + 5, userAgent.indexOf('.', msie)), 10);\n      }\n\n      var trident = userAgent.indexOf('Trident/');\n\n      if (trident > 0) {\n        // IE 11 => return version number\n        var rv = userAgent.indexOf('rv:');\n        return parseInt(userAgent.substring(rv + 3, userAgent.indexOf('.', rv)), 10);\n      }\n\n      var edge = userAgent.indexOf('Edge/');\n\n      if (edge > 0) {\n        // IE 12 (aka Edge) => return version number\n        return parseInt(userAgent.substring(edge + 5, userAgent.indexOf('.', edge)), 10);\n      } // other browser\n\n\n      return false;\n    }\n  }, {\n    key: \"defineActionValue\",\n    value: function defineActionValue(action, argsObject) {\n      return this.evaluate(action.value, argsObject, 'value');\n    }\n  }, {\n    key: \"applyActions\",\n    value: function applyActions(newComponent, actions, result, row, data) {\n      var _this12 = this;\n\n      data = data || this.rootValue;\n      row = row || this.data;\n      return actions.reduce(function (changed, action) {\n        switch (action.type) {\n          case 'property':\n            {\n              FormioUtils.setActionProperty(newComponent, action, result, row, data, _this12);\n              var property = action.property.value;\n\n              if (!_lodash.default.isEqual(_lodash.default.get(_this12.component, property), _lodash.default.get(newComponent, property))) {\n                changed = true;\n              }\n\n              break;\n            }\n\n          case 'value':\n            {\n              var oldValue = _this12.getValue();\n\n              var newValue = _this12.defineActionValue(action, {\n                value: _lodash.default.clone(oldValue),\n                data: data,\n                row: row,\n                component: newComponent,\n                result: result\n              });\n\n              if (!_lodash.default.isEqual(oldValue, newValue)) {\n                _this12.setValue(newValue);\n\n                if (_this12.viewOnly) {\n                  _this12.dataValue = newValue;\n                }\n\n                changed = true;\n              }\n\n              break;\n            }\n\n          case 'mergeComponentSchema':\n            {\n              var schema = _this12.evaluate(action.schemaDefinition, {\n                value: _lodash.default.clone(_this12.getValue()),\n                data: data,\n                row: row,\n                component: newComponent,\n                result: result\n              }, 'schema');\n\n              _lodash.default.assign(newComponent, schema);\n\n              if (!_lodash.default.isEqual(_this12.component, newComponent)) {\n                changed = true;\n              }\n\n              break;\n            }\n\n          case 'customAction':\n            {\n              var _oldValue = _this12.getValue();\n\n              var _newValue = _this12.evaluate(action.customAction, {\n                value: _lodash.default.clone(_oldValue),\n                data: data,\n                row: row,\n                input: _oldValue,\n                component: newComponent,\n                result: result\n              }, 'value');\n\n              if (!_lodash.default.isEqual(_oldValue, _newValue)) {\n                _this12.setValue(_newValue);\n\n                if (_this12.viewOnly) {\n                  _this12.dataValue = _newValue;\n                }\n\n                changed = true;\n              }\n\n              break;\n            }\n        }\n\n        return changed;\n      }, false);\n    } // Deprecated\n\n  }, {\n    key: \"addInputError\",\n    value: function addInputError(message, dirty, elements) {\n      this.addMessages(message);\n      this.setErrorClasses(elements, dirty, !!message);\n    } // Deprecated\n\n  }, {\n    key: \"removeInputError\",\n    value: function removeInputError(elements) {\n      this.setErrorClasses(elements, true, false);\n    }\n    /**\n     * Add a new input error to this element.\n     *\n     * @param message\n     * @param dirty\n     */\n\n  }, {\n    key: \"addMessages\",\n    value: function addMessages(messages) {\n      var _this13 = this;\n\n      if (!messages) {\n        return;\n      } // Standardize on array of objects for message.\n\n\n      if (typeof messages === 'string') {\n        messages = {\n          messages: messages,\n          level: 'error'\n        };\n      }\n\n      if (!Array.isArray(messages)) {\n        messages = [messages];\n      }\n\n      messages = _lodash.default.uniqBy(messages, function (message) {\n        return message.message;\n      });\n\n      if (this.refs.messageContainer) {\n        this.setContent(this.refs.messageContainer, messages.map(function (message) {\n          return _this13.renderTemplate('message', message);\n        }).join(''));\n      }\n    }\n  }, {\n    key: \"setErrorClasses\",\n    value: function setErrorClasses(elements, dirty, hasErrors, hasMessages) {\n      var _this14 = this;\n\n      var element = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : this.element;\n      this.clearErrorClasses();\n      elements.forEach(function (element) {\n        _this14.setElementInvalid(_this14.performInputMapping(element), false);\n      });\n      this.setInputWidgetErrorClasses(elements, hasErrors);\n\n      if (hasErrors) {\n        // Add error classes\n        elements.forEach(function (input) {\n          _this14.setElementInvalid(_this14.performInputMapping(input), true);\n        });\n\n        if (dirty && this.options.highlightErrors) {\n          this.addClass(element, this.options.componentErrorClass);\n        } else {\n          this.addClass(element, 'has-error');\n        }\n      }\n\n      if (hasMessages) {\n        this.addClass(element, 'has-message');\n      }\n    }\n  }, {\n    key: \"setElementInvalid\",\n    value: function setElementInvalid(element, invalid) {\n      if (!element) return;\n\n      if (invalid) {\n        this.addClass(element, 'is-invalid');\n      } else {\n        this.removeClass(element, 'is-invalid');\n      }\n\n      element.setAttribute('aria-invalid', invalid ? 'true' : 'false');\n    }\n  }, {\n    key: \"clearOnHide\",\n    value: function clearOnHide() {\n      // clearOnHide defaults to true for old forms (without the value set) so only trigger if the value is false.\n      if ( // if change happens inside EditGrid's row, it doesn't trigger change on the root level, so rootPristine will be true\n      (!this.rootPristine || this.options.server || (0, FormioUtils.isInsideScopingComponent)(this)) && this.component.clearOnHide !== false && !this.options.readOnly && !this.options.showHiddenFields) {\n        if (!this.visible) {\n          this.deleteValue();\n        } else if (!this.hasValue() && this.shouldAddDefaultValue) {\n          // If shown, ensure the default is set.\n          this.setValue(this.defaultValue, {\n            noUpdateEvent: true\n          });\n        }\n      }\n    }\n  }, {\n    key: \"triggerRootChange\",\n    value: function triggerRootChange() {\n      if (this.options.onChange) {\n        var _this$options;\n\n        (_this$options = this.options).onChange.apply(_this$options, arguments);\n      } else if (this.root) {\n        var _this$root4;\n\n        (_this$root4 = this.root).triggerChange.apply(_this$root4, arguments);\n      }\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, fromRoot) {\n      flags = flags || {};\n\n      if (flags.modified) {\n        if (!flags.noPristineChangeOnModified) {\n          this.pristine = false;\n        }\n\n        this.addClass(this.getElement(), 'formio-modified');\n      } // If we are supposed to validate on blur, then don't trigger validation yet.\n\n\n      if (this.component.validateOn === 'blur' && !this.errors.length) {\n        flags.noValidate = true;\n      }\n\n      if (this.component.onChange) {\n        this.evaluate(this.component.onChange, {\n          flags: flags\n        });\n      } // Set the changed variable.\n\n\n      var changed = {\n        instance: this,\n        component: this.component,\n        value: this.dataValue,\n        flags: flags\n      }; // Emit the change.\n\n      this.emit('componentChange', changed); // Do not propogate the modified flag.\n\n      var modified = false;\n\n      if (flags.modified) {\n        modified = true;\n        delete flags.modified;\n      } // Bubble this change up to the top.\n\n\n      if (!fromRoot) {\n        this.triggerRootChange(flags, changed, modified);\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"wysiwygDefault\",\n    get: function get() {\n      return {\n        quill: {\n          theme: 'snow',\n          placeholder: this.t(this.component.placeholder, {\n            _userInput: true\n          }),\n          modules: {\n            toolbar: [[{\n              'size': ['small', false, 'large', 'huge']\n            }], // custom dropdown\n            [{\n              'header': [1, 2, 3, 4, 5, 6, false]\n            }], [{\n              'font': []\n            }], ['bold', 'italic', 'underline', 'strike', {\n              'script': 'sub'\n            }, {\n              'script': 'super'\n            }, 'clean'], [{\n              'color': []\n            }, {\n              'background': []\n            }], [{\n              'list': 'ordered'\n            }, {\n              'list': 'bullet'\n            }, {\n              'indent': '-1'\n            }, {\n              'indent': '+1'\n            }, {\n              'align': []\n            }], ['blockquote', 'code-block'], ['link', 'image', 'video', 'formula', 'source']]\n          }\n        },\n        ace: {\n          theme: 'ace/theme/xcode',\n          maxLines: 12,\n          minLines: 12,\n          tabSize: 2,\n          mode: 'ace/mode/javascript',\n          placeholder: this.t(this.component.placeholder, {\n            _userInput: true\n          })\n        },\n        ckeditor: {\n          image: {\n            toolbar: ['imageTextAlternative', '|', 'imageStyle:full', 'imageStyle:alignLeft', 'imageStyle:alignCenter', 'imageStyle:alignRight'],\n            styles: ['full', 'alignLeft', 'alignCenter', 'alignRight']\n          },\n          extraPlugins: []\n        },\n        default: {}\n      };\n    }\n  }, {\n    key: \"addCKE\",\n    value: function addCKE(element, settings, onChange) {\n      settings = _lodash.default.isEmpty(settings) ? {} : settings;\n      settings.base64Upload = this.component.isUploadEnabled ? false : true;\n      settings.mediaEmbed = {\n        previewsInData: true\n      };\n      settings = _lodash.default.merge(this.wysiwygDefault.ckeditor, _lodash.default.get(this.options, 'editors.ckeditor.settings', {}), settings);\n\n      if (this.component.isUploadEnabled) {\n        settings.extraPlugins.push((0, _uploadAdapter.getFormioUploadAdapterPlugin)(this.fileService, this));\n      }\n\n      return _Formio.GlobalFormio.requireLibrary('ckeditor', isIEBrowser ? 'CKEDITOR' : 'ClassicEditor', _lodash.default.get(this.options, 'editors.ckeditor.src', CKEDITOR_URL), true).then(function () {\n        if (!element.parentNode) {\n          return _nativePromiseOnly.default.reject();\n        }\n\n        if (isIEBrowser) {\n          var editor = CKEDITOR.replace(element);\n          editor.on('change', function () {\n            return onChange(editor.getData());\n          });\n          return _nativePromiseOnly.default.resolve(editor);\n        } else {\n          return ClassicEditor.create(element, settings).then(function (editor) {\n            editor.model.document.on('change', function () {\n              return onChange(editor.data.get());\n            });\n            return editor;\n          });\n        }\n      });\n    }\n  }, {\n    key: \"addQuill\",\n    value: function addQuill(element, settings, onChange) {\n      var _this15 = this;\n\n      settings = _lodash.default.isEmpty(settings) ? this.wysiwygDefault.quill : settings;\n      settings = _lodash.default.merge(this.wysiwygDefault.quill, _lodash.default.get(this.options, 'editors.quill.settings', {}), settings);\n      settings = _objectSpread(_objectSpread({}, settings), {}, {\n        modules: _objectSpread({\n          table: true\n        }, settings.modules)\n      }); // Lazy load the quill css.\n\n      _Formio.GlobalFormio.requireLibrary(\"quill-css-\".concat(settings.theme), 'Quill', [{\n        type: 'styles',\n        src: \"\".concat(QUILL_URL, \"/quill.\").concat(settings.theme, \".css\")\n      }], true); // Lazy load the quill library.\n\n\n      return _Formio.GlobalFormio.requireLibrary('quill', 'Quill', _lodash.default.get(this.options, 'editors.quill.src', \"\".concat(QUILL_URL, \"/quill.min.js\")), true).then(function () {\n        return _Formio.GlobalFormio.requireLibrary('quill-table', 'Quill', QUILL_TABLE_URL, true).then(function () {\n          if (!element.parentNode) {\n            return _nativePromiseOnly.default.reject();\n          }\n\n          _this15.quill = new Quill(element, isIEBrowser ? _objectSpread(_objectSpread({}, settings), {}, {\n            modules: {}\n          }) : settings);\n          /** This block of code adds the [source] capabilities.  See https://codepen.io/anon/pen/ZyEjrQ **/\n\n          var txtArea = document.createElement('textarea');\n          txtArea.setAttribute('class', 'quill-source-code');\n\n          _this15.quill.addContainer('ql-custom').appendChild(txtArea);\n\n          var qlSource = element.parentNode.querySelector('.ql-source');\n\n          if (qlSource) {\n            _this15.addEventListener(qlSource, 'click', function (event) {\n              event.preventDefault();\n\n              if (txtArea.style.display === 'inherit') {\n                _this15.quill.setContents(_this15.quill.clipboard.convert(txtArea.value));\n              }\n\n              txtArea.style.display = txtArea.style.display === 'none' ? 'inherit' : 'none';\n            });\n          }\n          /** END CODEBLOCK **/\n          // Make sure to select cursor when they click on the element.\n\n\n          _this15.addEventListener(element, 'click', function () {\n            return _this15.quill.focus();\n          }); // Allows users to skip toolbar items when tabbing though form\n\n\n          var elm = document.querySelectorAll('.ql-formats > button');\n\n          for (var i = 0; i < elm.length; i++) {\n            elm[i].setAttribute('tabindex', '-1');\n          }\n\n          _this15.quill.on('text-change', function () {\n            txtArea.value = _this15.quill.root.innerHTML;\n            onChange(txtArea);\n          });\n\n          return _this15.quill;\n        });\n      });\n    }\n  }, {\n    key: \"shouldSanitizeValue\",\n    get: function get() {\n      var _this$options2; // Sanitize value if sanitizing for thw whole content is turned off\n\n\n      return ((_this$options2 = this.options) === null || _this$options2 === void 0 ? void 0 : _this$options2.sanitize) === false ? true : false;\n    }\n  }, {\n    key: \"addAce\",\n    value: function addAce(element, settings, onChange) {\n      if (!settings || settings.theme === 'snow') {\n        var mode = settings ? settings.mode : '';\n        settings = {};\n\n        if (mode) {\n          settings.mode = mode;\n        }\n      }\n\n      settings = _lodash.default.merge(this.wysiwygDefault.ace, _lodash.default.get(this.options, 'editors.ace.settings', {}), settings || {});\n      return _Formio.GlobalFormio.requireLibrary('ace', 'ace', _lodash.default.get(this.options, 'editors.ace.src', ACE_URL), true).then(function (editor) {\n        editor = editor.edit(element);\n        editor.removeAllListeners('change');\n        editor.setOptions(settings);\n        editor.getSession().setMode(settings.mode);\n        editor.on('change', function () {\n          return onChange(editor.getValue());\n        });\n\n        if (settings.isUseWorkerDisabled) {\n          editor.session.setUseWorker(false);\n        }\n\n        return editor;\n      });\n    }\n  }, {\n    key: \"tree\",\n    get: function get() {\n      return this.component.tree || false;\n    }\n    /**\n     * The empty value for this component.\n     *\n     * @return {null}\n     */\n\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return null;\n    }\n    /**\n     * Returns if this component has a value set.\n     *\n     */\n\n  }, {\n    key: \"hasValue\",\n    value: function hasValue(data) {\n      return _lodash.default.has(data || this.data, this.key);\n    }\n    /**\n     * Get the data value at the root level.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"rootValue\",\n    get: function get() {\n      return this.root ? this.root.data : this.data;\n    }\n  }, {\n    key: \"rootPristine\",\n    get: function get() {\n      return _lodash.default.get(this, 'root.pristine', false);\n    }\n    /**\n     * Get the static value of this component.\n     * @return {*}\n     */\n\n  }, {\n    key: \"dataValue\",\n    get: function get() {\n      if (!this.key || !this.visible && this.component.clearOnHide && !this.rootPristine) {\n        return this.emptyValue;\n      }\n\n      if (!this.hasValue() && this.shouldAddDefaultValue) {\n        var empty = this.component.multiple ? [] : this.emptyValue;\n\n        if (!this.rootPristine) {\n          this.dataValue = empty;\n        }\n\n        return empty;\n      }\n\n      return _lodash.default.get(this._data, this.key);\n    }\n    /**\n     * Sets the static value of this component.\n     *\n     * @param value\n     */\n    ,\n    set: function set(value) {\n      if (!this.allowData || !this.key || !this.visible && this.component.clearOnHide && !this.rootPristine) {\n        return;\n      }\n\n      if (value !== null && value !== undefined) {\n        value = this.hook('setDataValue', value, this.key, this._data);\n      }\n\n      if (value === null || value === undefined) {\n        this.unset();\n        return;\n      }\n\n      _lodash.default.set(this._data, this.key, value);\n\n      return;\n    }\n    /**\n     * Splice a value from the dataValue.\n     *\n     * @param index\n     */\n\n  }, {\n    key: \"splice\",\n    value: function splice(index) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (this.hasValue()) {\n        var dataValue = this.dataValue || [];\n\n        if (_lodash.default.isArray(dataValue) && dataValue.hasOwnProperty(index)) {\n          dataValue.splice(index, 1);\n          this.dataValue = dataValue;\n          this.triggerChange(flags);\n        }\n      }\n    }\n  }, {\n    key: \"unset\",\n    value: function unset() {\n      _lodash.default.unset(this._data, this.key);\n    }\n    /**\n     * Deletes the value of the component.\n     */\n\n  }, {\n    key: \"deleteValue\",\n    value: function deleteValue() {\n      this.setValue(null, {\n        noUpdateEvent: true,\n        noDefault: true\n      });\n      this.unset();\n    }\n  }, {\n    key: \"getCustomDefaultValue\",\n    value: function getCustomDefaultValue(defaultValue) {\n      if (this.component.customDefaultValue && !this.options.preview) {\n        defaultValue = this.evaluate(this.component.customDefaultValue, {\n          value: ''\n        }, 'value');\n      }\n\n      return defaultValue;\n    }\n  }, {\n    key: \"shouldAddDefaultValue\",\n    get: function get() {\n      return !this.options.noDefaults || this.component.defaultValue && !this.isEmpty(this.component.defaultValue) || this.component.customDefaultValue;\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var _this16 = this;\n\n      var defaultValue = this.emptyValue;\n\n      if (this.component.defaultValue) {\n        defaultValue = this.component.defaultValue;\n      }\n\n      defaultValue = this.getCustomDefaultValue(defaultValue);\n\n      var checkMask = function checkMask(value) {\n        if (typeof value === 'string') {\n          var placeholderChar = _this16.placeholderChar;\n          value = (0, _vanillaTextMask.conformToMask)(value, _this16.defaultMask, {\n            placeholderChar: placeholderChar\n          }).conformedValue;\n\n          if (!FormioUtils.matchInputMask(value, _this16.defaultMask)) {\n            value = '';\n          }\n        } else {\n          value = '';\n        }\n\n        return value;\n      };\n\n      if (this.defaultMask) {\n        if (Array.isArray(defaultValue)) {\n          defaultValue = defaultValue.map(checkMask);\n        } else {\n          defaultValue = checkMask(defaultValue);\n        }\n      } // Clone so that it creates a new instance.\n\n\n      return _lodash.default.cloneDeep(defaultValue);\n    }\n    /**\n     * Get the input value of this component.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (!this.hasInput || this.viewOnly || !this.refs.input || !this.refs.input.length) {\n        return this.dataValue;\n      }\n\n      var values = [];\n\n      for (var i in this.refs.input) {\n        if (this.refs.input.hasOwnProperty(i)) {\n          if (!this.component.multiple) {\n            return this.getValueAt(i);\n          }\n\n          values.push(this.getValueAt(i));\n        }\n      }\n\n      if (values.length === 0 && !this.component.multiple) {\n        return '';\n      }\n\n      return values;\n    }\n    /**\n     * Get the value at a specific index.\n     *\n     * @param index\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getValueAt\",\n    value: function getValueAt(index) {\n      var input = this.performInputMapping(this.refs.input[index]);\n      return input ? input.value : undefined;\n    }\n    /**\n     * Set the value of this component.\n     *\n     * @param value\n     * @param flags\n     *\n     * @return {boolean} - If the value changed.\n     */\n\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var changed = this.updateValue(value, flags);\n      value = this.dataValue;\n\n      if (!this.hasInput) {\n        return changed;\n      }\n\n      var isArray = Array.isArray(value);\n      var valueInput = this.refs.fileLink || this.refs.input;\n\n      if (isArray && Array.isArray(this.defaultValue) && this.refs.hasOwnProperty('input') && valueInput && valueInput.length !== value.length && this.visible) {\n        this.redraw();\n      }\n\n      if (this.isHtmlRenderMode() && flags && flags.fromSubmission && changed) {\n        this.redraw();\n        return changed;\n      }\n\n      for (var i in this.refs.input) {\n        if (this.refs.input.hasOwnProperty(i)) {\n          this.setValueAt(i, isArray ? value[i] : value, flags);\n        }\n      }\n\n      return changed;\n    }\n    /**\n     * Set the value at a specific index.\n     *\n     * @param index\n     * @param value\n     */\n\n  }, {\n    key: \"setValueAt\",\n    value: function setValueAt(index, value) {\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      if (!flags.noDefault && (value === null || value === undefined) && !this.component.multiple) {\n        value = this.defaultValue;\n      }\n\n      var input = this.performInputMapping(this.refs.input[index]);\n      var valueMaskInput = this.refs.valueMaskInput;\n\n      if (valueMaskInput !== null && valueMaskInput !== void 0 && valueMaskInput.mask) {\n        valueMaskInput.mask.textMaskInputElement.update(value);\n      }\n\n      if (input.mask) {\n        input.mask.textMaskInputElement.update(value);\n      } else if (input.widget && input.widget.setValue) {\n        input.widget.setValue(value);\n      } else {\n        input.value = value;\n      }\n    }\n  }, {\n    key: \"hasSetValue\",\n    get: function get() {\n      return this.hasValue() && !this.isEmpty(this.dataValue);\n    }\n  }, {\n    key: \"setDefaultValue\",\n    value: function setDefaultValue() {\n      if (this.defaultValue && this.shouldAddDefaultValue) {\n        var defaultValue = this.component.multiple && !this.dataValue.length ? [] : this.defaultValue;\n        this.setValue(defaultValue, {\n          noUpdateEvent: true\n        });\n      }\n    }\n    /**\n     * Restore the value of a control.\n     */\n\n  }, {\n    key: \"restoreValue\",\n    value: function restoreValue() {\n      if (this.hasSetValue) {\n        this.setValue(this.dataValue, {\n          noUpdateEvent: true\n        });\n      } else {\n        this.setDefaultValue();\n      }\n    }\n    /**\n     * Normalize values coming into updateValue.\n     *\n     * @param value\n     * @return {*}\n     */\n\n  }, {\n    key: \"normalizeValue\",\n    value: function normalizeValue(value) {\n      if (this.component.multiple && !Array.isArray(value)) {\n        value = value ? [value] : [];\n      }\n\n      return value;\n    }\n    /**\n     * Update a value of this component.\n     *\n     * @param flags\n     */\n\n  }, {\n    key: \"updateComponentValue\",\n    value: function updateComponentValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var newValue = !flags.resetValue && (value === undefined || value === null) ? this.getValue() : value;\n      newValue = this.normalizeValue(newValue, flags);\n      var changed = newValue !== undefined ? this.hasChanged(newValue, this.dataValue) : false;\n\n      if (changed) {\n        this.dataValue = newValue;\n        this.updateOnChange(flags, changed);\n      }\n\n      if (this.componentModal && flags && flags.fromSubmission) {\n        this.componentModal.setValue(value);\n      }\n\n      return changed;\n    }\n    /**\n     * Updates the value of this component plus all sub-components.\n     *\n     * @param args\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"updateValue\",\n    value: function updateValue() {\n      return this.updateComponentValue.apply(this, arguments);\n    }\n  }, {\n    key: \"getIcon\",\n    value: function getIcon(name, content, styles) {\n      var ref = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'icon';\n      return this.renderTemplate('icon', {\n        className: this.iconClass(name),\n        ref: ref,\n        styles: styles,\n        content: content\n      });\n    }\n    /**\n     * Resets the value of this component.\n     */\n\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      this.unset();\n      this.setValue(this.emptyValue, {\n        noUpdateEvent: true,\n        noValidate: true,\n        resetValue: true\n      });\n    }\n    /**\n     * Determine if the value of this component has changed.\n     *\n     * @param newValue\n     * @param oldValue\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"hasChanged\",\n    value: function hasChanged(newValue, oldValue) {\n      if ((newValue === undefined || newValue === null) && (oldValue === undefined || oldValue === null || this.isEmpty(oldValue))) {\n        return false;\n      } // If we do not have a value and are getting set to anything other than undefined or null, then we changed.\n\n\n      if (newValue !== undefined && newValue !== null && this.allowData && !this.hasValue()) {\n        return true;\n      }\n\n      return !_lodash.default.isEqual(newValue, oldValue);\n    }\n    /**\n     * Update the value on change.\n     *\n     * @param flags\n     */\n\n  }, {\n    key: \"updateOnChange\",\n    value: function updateOnChange() {\n      var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var changed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!flags.noUpdateEvent && changed) {\n        this.triggerChange(flags);\n        return true;\n      }\n\n      return false;\n    }\n    /**\n     * Perform a calculated value operation.\n     *\n     * @param data - The global data object.\n     *\n     * @return {boolean} - If the value changed during calculation.\n     */\n\n  }, {\n    key: \"convertNumberOrBoolToString\",\n    value: function convertNumberOrBoolToString(value) {\n      if (typeof value === 'number' || typeof value === 'boolean') {\n        return value.toString();\n      }\n\n      return value;\n    }\n  }, {\n    key: \"doValueCalculation\",\n    value: function doValueCalculation(dataValue, data, row) {\n      return this.evaluate(this.component.calculateValue, {\n        value: dataValue,\n        data: data,\n        row: row || this.data\n      }, 'value');\n    }\n  }, {\n    key: \"calculateComponentValue\",\n    value: function calculateComponentValue(data, flags, row) {\n      // If no calculated value or\n      // hidden and set to clearOnHide (Don't calculate a value for a hidden field set to clear when hidden)\n      var clearOnHide = this.component.clearOnHide;\n      var shouldBeCleared = !this.visible && clearOnHide;\n\n      var allowOverride = _lodash.default.get(this.component, 'allowCalculateOverride', false); // Handle all cases when calculated values should not fire.\n\n\n      if (this.options.readOnly && !this.options.pdf || !(this.component.calculateValue || this.component.calculateValueVariable) || shouldBeCleared || this.options.server && !this.component.calculateServer || flags.dataSourceInitialLoading && allowOverride) {\n        return false;\n      }\n\n      var dataValue = this.dataValue; // Calculate the new value.\n\n      var calculatedValue = this.doValueCalculation(dataValue, data, row, flags);\n\n      if (_lodash.default.isNil(calculatedValue)) {\n        calculatedValue = this.emptyValue;\n      }\n\n      var changed = !_lodash.default.isEqual(dataValue, calculatedValue); // Do not override calculations on server if they have calculateServer set.\n\n      if (allowOverride) {\n        var firstPass = this.calculatedValue === undefined;\n\n        if (firstPass) {\n          this.calculatedValue = null;\n        }\n\n        var newCalculatedValue = this.normalizeValue(this.convertNumberOrBoolToString(calculatedValue));\n        var previousCalculatedValue = this.normalizeValue(this.convertNumberOrBoolToString(this.calculatedValue));\n        var calculationChanged = !_lodash.default.isEqual(previousCalculatedValue, newCalculatedValue);\n        var previousChanged = !_lodash.default.isEqual(dataValue, previousCalculatedValue); // Check to ensure that the calculated value is different than the previously calculated value.\n\n        if (previousCalculatedValue && previousChanged && !calculationChanged) {\n          return false;\n        }\n\n        if (flags.isReordered || !calculationChanged) {\n          return false;\n        }\n\n        if (flags.fromSubmission && this.component.persistent === true) {\n          // If we set value from submission and it differs from calculated one, set the calculated value to prevent overriding dataValue in the next pass\n          this.calculatedValue = calculatedValue;\n          return false;\n        } // If this is the firstPass, and the dataValue is different than to the calculatedValue.\n\n\n        if (firstPass && !this.isEmpty(dataValue) && changed && calculationChanged) {\n          // Return that we have a change so it will perform another pass.\n          return true;\n        }\n      }\n\n      this.calculatedValue = calculatedValue;\n\n      if (changed) {\n        if (!flags.noPristineChangeOnModified) {\n          this.pristine = false;\n        }\n\n        flags.triggeredComponentId = this.id;\n        return this.setValue(calculatedValue, flags);\n      }\n\n      return false;\n    }\n    /**\n     * Performs calculations in this component plus any child components.\n     *\n     * @param args\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      return this.calculateComponentValue(data, flags, row);\n    }\n    /**\n     * Get this component's label text.\n     *\n     */\n\n  }, {\n    key: \"label\",\n    get: function get() {\n      return this.component.label;\n    }\n    /**\n     * Set this component's label text and render it.\n     *\n     * @param value - The new label text.\n     */\n    ,\n    set: function set(value) {\n      this.component.label = value;\n\n      if (this.labelElement) {\n        this.labelElement.innerText = value;\n      }\n    }\n    /**\n     * Get FormioForm element at the root of this component tree.\n     *\n     */\n\n  }, {\n    key: \"getRoot\",\n    value: function getRoot() {\n      return this.root;\n    }\n    /**\n     * Returns the invalid message, or empty string if the component is valid.\n     *\n     * @param data\n     * @param dirty\n     * @return {*}\n     */\n\n  }, {\n    key: \"invalidMessage\",\n    value: function invalidMessage(data, dirty, ignoreCondition, row) {\n      if (!ignoreCondition && !this.checkCondition(row, data)) {\n        return '';\n      } // See if this is forced invalid.\n\n\n      if (this.invalid) {\n        return this.invalid;\n      } // No need to check for errors if there is no input or if it is pristine.\n\n\n      if (!this.hasInput || !dirty && this.pristine) {\n        return '';\n      }\n\n      return _lodash.default.map(_Validator.default.checkComponent(this, data), 'message').join('\\n\\n');\n    }\n    /**\n     * Returns if the component is valid or not.\n     *\n     * @param data\n     * @param dirty\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"isValid\",\n    value: function isValid(data, dirty) {\n      return !this.invalidMessage(data, dirty);\n    }\n  }, {\n    key: \"setComponentValidity\",\n    value: function setComponentValidity(messages, dirty, silentCheck) {\n      var hasErrors = !!messages.filter(function (message) {\n        return message.level === 'error' && !message.fromServer;\n      }).length;\n\n      if (messages.length && (!silentCheck || this.error) && (dirty || !this.pristine)) {\n        this.setCustomValidity(messages, dirty);\n      } else if (!silentCheck) {\n        this.setCustomValidity('');\n      }\n\n      return !hasErrors;\n    }\n    /**\n     * Checks the validity of this component and sets the error message if it is invalid.\n     *\n     * @param data\n     * @param dirty\n     * @param row\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row) {\n      var _this$serverErrors,\n          _this17 = this;\n\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      data = data || this.rootValue;\n      row = row || this.data;\n      var _options$async = options.async,\n          async = _options$async === void 0 ? false : _options$async,\n          _options$silentCheck = options.silentCheck,\n          silentCheck = _options$silentCheck === void 0 ? false : _options$silentCheck;\n\n      if (this.shouldSkipValidation(data, dirty, row)) {\n        this.setCustomValidity('');\n        return async ? _nativePromiseOnly.default.resolve(true) : true;\n      }\n\n      var check = _Validator.default.checkComponent(this, data, row, true, async);\n\n      var validations = check;\n\n      if ((_this$serverErrors = this.serverErrors) !== null && _this$serverErrors !== void 0 && _this$serverErrors.length) {\n        validations = check.concat(this.serverErrors);\n      }\n\n      return async ? validations.then(function (messages) {\n        return _this17.setComponentValidity(messages, dirty, silentCheck);\n      }) : this.setComponentValidity(validations, dirty, silentCheck);\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      data = data || this.rootValue;\n      row = row || this.data;\n      var isValid = this.checkComponentValidity(data, dirty, row, {\n        silentCheck: silentCheck\n      });\n      this.checkModal();\n      return isValid;\n    }\n  }, {\n    key: \"checkAsyncValidity\",\n    value: function checkAsyncValidity(data, dirty, row, silentCheck) {\n      return _nativePromiseOnly.default.resolve(this.checkComponentValidity(data, dirty, row, {\n        async: true,\n        silentCheck: silentCheck\n      }));\n    }\n    /**\n     * Check the conditions, calculations, and validity of a single component and triggers an update if\n     * something changed.\n     *\n     * @param data - The root data of the change event.\n     * @param flags - The flags from this change event.\n     *\n     * @return boolean - If component is valid or not.\n     */\n\n  }, {\n    key: \"checkData\",\n    value: function checkData(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data; // Needs for Nextgen Rules Engine\n\n      this.resetCaches(); // Do not trigger refresh if change was triggered on blur event since components with Refresh on Blur have their own listeners\n\n      if (!flags.fromBlur) {\n        this.checkRefreshOn(flags.changes, flags);\n      }\n\n      if (flags.noCheck) {\n        return true;\n      }\n\n      this.checkComponentConditions(data, flags, row);\n\n      if (this.id !== flags.triggeredComponentId) {\n        this.calculateComponentValue(data, flags, row);\n      }\n\n      if (flags.noValidate && !flags.validateOnInit && !flags.fromIframe) {\n        if (flags.fromSubmission && this.rootPristine && this.pristine && this.error && flags.changed) {\n          this.checkComponentValidity(data, !!this.options.alwaysDirty, row, true);\n        }\n\n        return true;\n      }\n\n      var isDirty = false; // We need to set dirty if they explicitly set noValidate to false.\n\n      if (this.options.alwaysDirty || flags.dirty) {\n        isDirty = true;\n      } // See if they explicitely set the values with setSubmission.\n\n\n      if (flags.fromSubmission && this.hasValue(data)) {\n        isDirty = true;\n      }\n\n      this.setDirty(isDirty);\n\n      if (this.component.validateOn === 'blur' && flags.fromSubmission) {\n        return true;\n      }\n\n      var isValid = this.checkComponentValidity(data, isDirty, row, flags);\n      this.checkModal();\n      return isValid;\n    }\n  }, {\n    key: \"checkModal\",\n    value: function checkModal() {\n      var isValid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var dirty = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!this.component.modalEdit || !this.componentModal) {\n        return;\n      }\n\n      if (dirty && !isValid) {\n        this.setErrorClasses([this.refs.openModal], dirty, !isValid, !!this.errors.length, this.refs.openModalWrapper);\n      } else {\n        this.clearErrorClasses(this.refs.openModalWrapper);\n      }\n    }\n  }, {\n    key: \"validationValue\",\n    get: function get() {\n      return this.dataValue;\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      var isEmptyArray = _lodash.default.isArray(value) && value.length === 1 ? _lodash.default.isEqual(value[0], this.emptyValue) : false;\n      return value == null || value.length === 0 || _lodash.default.isEqual(value, this.emptyValue) || isEmptyArray;\n    }\n  }, {\n    key: \"isEqual\",\n    value: function isEqual(valueA) {\n      var valueB = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.dataValue;\n      return this.isEmpty(valueA) && this.isEmpty(valueB) || _lodash.default.isEqual(valueA, valueB);\n    }\n    /**\n     * Check if a component is eligible for multiple validation\n     *\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"validateMultiple\",\n    value: function validateMultiple() {\n      return true;\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      return this.error ? [this.error] : [];\n    }\n  }, {\n    key: \"clearErrorClasses\",\n    value: function clearErrorClasses() {\n      var element = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.element;\n      this.removeClass(element, this.options.componentErrorClass);\n      this.removeClass(element, 'alert alert-danger');\n      this.removeClass(element, 'has-error');\n      this.removeClass(element, 'has-message');\n    }\n  }, {\n    key: \"setInputWidgetErrorClasses\",\n    value: function setInputWidgetErrorClasses(inputRefs, hasErrors) {\n      if (!this.isInputComponent || !this.component.widget || !(inputRefs !== null && inputRefs !== void 0 && inputRefs.length)) {\n        return;\n      }\n\n      inputRefs.forEach(function (input) {\n        if (input !== null && input !== void 0 && input.widget && input.widget.setErrorClasses) {\n          input.widget.setErrorClasses(hasErrors);\n        }\n      });\n    }\n  }, {\n    key: \"setCustomValidity\",\n    value: function setCustomValidity(messages, dirty, external) {\n      var _this18 = this;\n\n      var inputRefs = this.isInputComponent ? this.refs.input || [] : null;\n\n      if (typeof messages === 'string' && messages) {\n        messages = {\n          level: 'error',\n          message: messages\n        };\n      }\n\n      if (!Array.isArray(messages)) {\n        if (messages) {\n          messages = [messages];\n        } else {\n          messages = [];\n        }\n      }\n\n      var hasErrors = !!messages.filter(function (message) {\n        return message.level === 'error';\n      }).length;\n      var invalidInputRefs = inputRefs;\n\n      if (this.component.multiple) {\n        var inputRefsArray = Array.from(inputRefs);\n        inputRefsArray.forEach(function (input) {\n          _this18.setElementInvalid(_this18.performInputMapping(input), false);\n        });\n        invalidInputRefs = inputRefsArray.filter(function (ref) {\n          var _messages$some, _messages;\n\n          return (_messages$some = (_messages = messages).some) === null || _messages$some === void 0 ? void 0 : _messages$some.call(_messages, function (msg) {\n            var _msg$context;\n\n            return (msg === null || msg === void 0 ? void 0 : (_msg$context = msg.context) === null || _msg$context === void 0 ? void 0 : _msg$context.input) === ref;\n          });\n        });\n      }\n\n      if (messages.length) {\n        if (this.refs.messageContainer) {\n          this.empty(this.refs.messageContainer);\n        }\n\n        this.error = {\n          component: this.component,\n          message: messages[0].message,\n          messages: messages,\n          external: !!external\n        };\n        this.emit('componentError', this.error);\n        this.addMessages(messages, dirty, invalidInputRefs);\n\n        if (invalidInputRefs) {\n          this.setErrorClasses(invalidInputRefs, dirty, hasErrors, !!messages.length);\n        }\n      } else if (this.error && this.error.external === !!external) {\n        if (this.refs.messageContainer) {\n          this.empty(this.refs.messageContainer);\n        }\n\n        if (this.refs.modalMessageContainer) {\n          this.empty(this.refs.modalMessageContainer);\n        }\n\n        this.error = null;\n\n        if (invalidInputRefs) {\n          this.setErrorClasses(invalidInputRefs, dirty, hasErrors, !!messages.length);\n        }\n\n        this.clearErrorClasses();\n      } // if (!this.refs.input) {\n      //   return;\n      // }\n      // this.refs.input.forEach(input => {\n      //   input = this.performInputMapping(input);\n      //   if (typeof input.setCustomValidity === 'function') {\n      //     input.setCustomValidity(message, dirty);\n      //   }\n      // });\n\n    }\n    /**\n     * Determines if the value of this component is hidden from the user as if it is coming from the server, but is\n     * protected.\n     *\n     * @return {boolean|*}\n     */\n\n  }, {\n    key: \"isValueHidden\",\n    value: function isValueHidden() {\n      if (!this.root || !this.root.hasOwnProperty('editing')) {\n        return false;\n      }\n\n      if (!this.root || !this.root.editing) {\n        return false;\n      }\n\n      return this.component.protected || !this.component.persistent || this.component.persistent === 'client-only';\n    }\n  }, {\n    key: \"shouldSkipValidation\",\n    value: function shouldSkipValidation(data, dirty, row) {\n      var _this19 = this;\n\n      var rules = [// Force valid if component is read-only\n      function () {\n        return _this19.options.readOnly;\n      }, // Do not check validations if component is not an input component.\n      function () {\n        return !_this19.hasInput;\n      }, // Check to see if we are editing and if so, check component persistence.\n      function () {\n        return _this19.isValueHidden();\n      }, // Force valid if component is hidden.\n      function () {\n        return !_this19.visible;\n      }, // Force valid if component is conditionally hidden.\n      function () {\n        return !_this19.checkCondition(row, data);\n      }];\n      return rules.some(function (pred) {\n        return pred();\n      });\n    } // Maintain reverse compatibility.\n\n  }, {\n    key: \"whenReady\",\n    value: function whenReady() {\n      console.warn('The whenReady() method has been deprecated. Please use the dataReady property instead.');\n      return this.dataReady;\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return _nativePromiseOnly.default.resolve();\n    }\n    /**\n     * Prints out the value of this component as a string value.\n     */\n\n  }, {\n    key: \"asString\",\n    value: function asString(value) {\n      value = value || this.getValue();\n      return (Array.isArray(value) ? value : [value]).map(_lodash.default.toString).join(', ');\n    }\n    /**\n     * Return if the component is disabled.\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"disabled\",\n    get: function get() {\n      return this._disabled || this.parentDisabled;\n    }\n    /**\n     * Disable this component.\n     *\n     * @param {boolean} disabled\n     */\n    ,\n    set: function set(disabled) {\n      this._disabled = disabled;\n    }\n  }, {\n    key: \"setDisabled\",\n    value: function setDisabled(element, disabled) {\n      if (!element) {\n        return;\n      }\n\n      element.disabled = disabled;\n\n      if (disabled) {\n        element.setAttribute('disabled', 'disabled');\n      } else {\n        element.removeAttribute('disabled');\n      }\n    }\n  }, {\n    key: \"setLoading\",\n    value: function setLoading(element, loading) {\n      if (!element || element.loading === loading) {\n        return;\n      }\n\n      element.loading = loading;\n\n      if (!element.loader && loading) {\n        element.loader = this.ce('i', {\n          class: \"\".concat(this.iconClass('refresh', true), \" button-icon-right\")\n        });\n      }\n\n      if (element.loader) {\n        if (loading) {\n          this.appendTo(element.loader, element);\n        } else {\n          this.removeChildFrom(element.loader, element);\n        }\n      }\n    }\n  }, {\n    key: \"selectOptions\",\n    value: function selectOptions(select, tag, options, defaultValue) {\n      var _this20 = this;\n\n      _lodash.default.each(options, function (option) {\n        var attrs = {\n          value: option.value\n        };\n\n        if (defaultValue !== undefined && option.value === defaultValue) {\n          attrs.selected = 'selected';\n        }\n\n        var optionElement = _this20.ce('option', attrs);\n\n        optionElement.appendChild(_this20.text(option.label));\n        select.appendChild(optionElement);\n      });\n    }\n  }, {\n    key: \"setSelectValue\",\n    value: function setSelectValue(select, value) {\n      var options = select.querySelectorAll('option');\n\n      _lodash.default.each(options, function (option) {\n        if (option.value === value) {\n          option.setAttribute('selected', 'selected');\n        } else {\n          option.removeAttribute('selected');\n        }\n      });\n\n      if (select.onchange) {\n        select.onchange();\n      }\n\n      if (select.onselect) {\n        select.onselect();\n      }\n    }\n  }, {\n    key: \"getRelativePath\",\n    value: function getRelativePath(path) {\n      var keyPart = \".\".concat(this.key);\n      var thisPath = this.isInputComponent ? this.path : this.path.slice(0).replace(keyPart, '');\n      return path.replace(thisPath, '');\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.detach();\n      this.empty(this.getElement());\n    }\n  }, {\n    key: \"append\",\n    value: function append(element) {\n      this.appendTo(element, this.element);\n    }\n  }, {\n    key: \"prepend\",\n    value: function prepend(element) {\n      this.prependTo(element, this.element);\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(element) {\n      this.removeChildFrom(element, this.element);\n    }\n  }, {\n    key: \"detachLogic\",\n    value: function detachLogic() {\n      var _this21 = this;\n\n      this.logic.forEach(function (logic) {\n        if (logic.trigger.type === 'event') {\n          var event = _this21.interpolate(logic.trigger.event);\n\n          _this21.off(event); // only applies to callbacks on this component\n\n        }\n      });\n    }\n  }, {\n    key: \"attachLogic\",\n    value: function attachLogic() {\n      var _this22 = this; // Do not attach logic during builder mode.\n\n\n      if (this.builderMode) {\n        return;\n      }\n\n      this.logic.forEach(function (logic) {\n        if (logic.trigger.type === 'event') {\n          var event = _this22.interpolate(logic.trigger.event);\n\n          _this22.on(event, function () {\n            var newComponent = (0, FormioUtils.fastCloneDeep)(_this22.originalComponent);\n\n            for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n              args[_key4] = arguments[_key4];\n            }\n\n            if (_this22.applyActions(newComponent, logic.actions, args)) {\n              // If component definition changed, replace it.\n              if (!_lodash.default.isEqual(_this22.component, newComponent)) {\n                _this22.component = newComponent;\n\n                var visible = _this22.conditionallyVisible(null, null);\n\n                var disabled = _this22.shouldDisabled; // Change states which won't be recalculated during redrawing\n\n                if (_this22.visible !== visible) {\n                  _this22.visible = visible;\n                }\n\n                if (_this22.disabled !== disabled) {\n                  _this22.disabled = disabled;\n                }\n\n                _this22.redraw();\n              }\n            }\n          }, true);\n        }\n      });\n    }\n    /**\n     * Get the element information.\n     */\n\n  }, {\n    key: \"elementInfo\",\n    value: function elementInfo() {\n      var attributes = {\n        name: this.options.name,\n        type: this.component.inputType || 'text',\n        class: 'form-control',\n        lang: this.options.language\n      };\n\n      if (this.component.placeholder) {\n        attributes.placeholder = this.t(this.component.placeholder, {\n          _userInput: true\n        });\n      }\n\n      if (this.component.tabindex) {\n        attributes.tabindex = this.component.tabindex;\n      }\n\n      if (this.disabled) {\n        attributes.disabled = 'disabled';\n      }\n\n      _lodash.default.defaults(attributes, this.component.attributes);\n\n      return {\n        type: 'input',\n        component: this.component,\n        changeEvent: 'change',\n        attr: attributes\n      };\n    }\n  }, {\n    key: \"autofocus\",\n    value: function autofocus() {\n      var _this23 = this;\n\n      var hasAutofocus = this.component.autofocus && !this.builderMode && !this.options.preview;\n\n      if (hasAutofocus) {\n        this.on('render', function () {\n          return _this23.focus();\n        }, true);\n      }\n    }\n  }, {\n    key: \"scrollIntoView\",\n    value: function scrollIntoView() {\n      var element = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.element;\n\n      if (!element) {\n        return;\n      }\n\n      var _element$getBoundingC = element.getBoundingClientRect(),\n          left = _element$getBoundingC.left,\n          top = _element$getBoundingC.top;\n\n      window.scrollTo(left + window.scrollX, top + window.scrollY);\n    }\n  }, {\n    key: \"focus\",\n    value: function focus(index) {\n      var _this$refs$input2;\n\n      if ('beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n\n      if ((_this$refs$input2 = this.refs.input) !== null && _this$refs$input2 !== void 0 && _this$refs$input2.length) {\n        var _this$component$widge;\n\n        var focusingInput = typeof index === 'number' && this.refs.input[index] ? this.refs.input[index] : this.refs.input[this.refs.input.length - 1];\n\n        if (((_this$component$widge = this.component.widget) === null || _this$component$widge === void 0 ? void 0 : _this$component$widge.type) === 'calendar') {\n          var sibling = focusingInput.nextSibling;\n\n          if (sibling) {\n            sibling.focus();\n          }\n        } else {\n          focusingInput.focus();\n        }\n      }\n\n      if (this.refs.openModal) {\n        this.refs.openModal.focus();\n      }\n\n      if (this.parent.refs.openModal) {\n        this.parent.refs.openModal.focus();\n      }\n    }\n    /**\n     * Get `Formio` instance for working with files\n     */\n\n  }, {\n    key: \"fileService\",\n    get: function get() {\n      if (this.options.fileService) {\n        return this.options.fileService;\n      }\n\n      if (this.options.formio) {\n        return this.options.formio;\n      }\n\n      if (this.root && this.root.formio) {\n        return this.root.formio;\n      }\n\n      var formio = new _Formio.GlobalFormio(); // If a form is loaded, then make sure to set the correct formUrl.\n\n      if (this.root && this.root._form && this.root._form._id) {\n        formio.formUrl = \"\".concat(formio.projectUrl, \"/form/\").concat(this.root._form._id);\n      }\n\n      return formio;\n    }\n  }, {\n    key: \"resetCaches\",\n    value: function resetCaches() {}\n  }, {\n    key: \"previewMode\",\n    get: function get() {\n      return false;\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len5 = arguments.length, sources = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n        sources[_key5] = arguments[_key5];\n      }\n\n      return _lodash.default.merge.apply(_lodash.default, [{\n        /**\n         * Determines if this component provides an input.\n         */\n        input: true,\n\n        /**\n         * The data key for this component (how the data is stored in the database).\n         */\n        key: '',\n\n        /**\n         * The input placeholder for this component.\n         */\n        placeholder: '',\n\n        /**\n         * The input prefix\n         */\n        prefix: '',\n\n        /**\n         * The custom CSS class to provide to this component.\n         */\n        customClass: '',\n\n        /**\n         * The input suffix.\n         */\n        suffix: '',\n\n        /**\n         * If this component should allow an array of values to be captured.\n         */\n        multiple: false,\n\n        /**\n         * The default value of this component.\n         */\n        defaultValue: null,\n\n        /**\n         * If the data of this component should be protected (no GET api requests can see the data)\n         */\n        protected: false,\n\n        /**\n         * Validate if the value of this component should be unique within the form.\n         */\n        unique: false,\n\n        /**\n         * If the value of this component should be persisted within the backend api database.\n         */\n        persistent: true,\n\n        /**\n         * Determines if the component should be within the form, but not visible.\n         */\n        hidden: false,\n\n        /**\n         * If the component should be cleared when hidden.\n         */\n        clearOnHide: true,\n\n        /**\n         * This will refresh this component options when this field changes.\n         */\n        refreshOn: '',\n\n        /**\n         * This will redraw the component when this field changes.\n         */\n        redrawOn: '',\n\n        /**\n         * If this component should be included as a column within a submission table.\n         */\n        tableView: false,\n\n        /**\n         * If this component should be rendering in modal.\n         */\n        modalEdit: false,\n\n        /**\n         * The input label provided to this component.\n         */\n        label: '',\n        dataGridLabel: false,\n        labelPosition: 'top',\n        description: '',\n        errorLabel: '',\n        tooltip: '',\n        hideLabel: false,\n        tabindex: '',\n        disabled: false,\n        autofocus: false,\n        dbIndex: false,\n        customDefaultValue: '',\n        calculateValue: '',\n        calculateServer: false,\n        widget: null,\n\n        /**\n         * Attributes that will be assigned to the input elements of this component.\n         */\n        attributes: {},\n\n        /**\n         * This will perform the validation on either \"change\" or \"blur\" of the input element.\n         */\n        validateOn: 'change',\n\n        /**\n         * The validation criteria for this component.\n         */\n        validate: {\n          /**\n           * If this component is required.\n           */\n          required: false,\n\n          /**\n           * Custom JavaScript validation.\n           */\n          custom: '',\n\n          /**\n           * If the custom validation should remain private (only the backend will see it and execute it).\n           */\n          customPrivate: false,\n\n          /**\n           * If this component should implement a strict date validation if the Calendar widget is implemented.\n           */\n          strictDateValidation: false,\n          multiple: false,\n          unique: false\n        },\n\n        /**\n         * The simple conditional settings for a component.\n         */\n        conditional: {\n          show: null,\n          when: null,\n          eq: ''\n        },\n        overlay: {\n          style: '',\n          left: '',\n          top: '',\n          width: '',\n          height: ''\n        },\n        allowCalculateOverride: false,\n        encrypted: false,\n        showCharCount: false,\n        showWordCount: false,\n        properties: {},\n        allowMultipleMasks: false,\n        addons: []\n      }].concat(sources));\n    }\n    /**\n     * Return the validator as part of the component.\n     *\n     * @return {ValidationChecker}\n     * @constructor\n     */\n\n  }, {\n    key: \"Validator\",\n    get: function get() {\n      return _Validator.default;\n    }\n    /**\n     * Provides a table view for this component. Override if you wish to do something different than using getView\n     * method of your instance.\n     *\n     * @param value\n     * @param options\n     */\n\n    /* eslint-disable no-unused-vars */\n\n  }, {\n    key: \"tableView\",\n    value: function tableView(value, options) {}\n  }]);\n\n  return Component;\n}(_Element2.default);\n\nexports.default = Component;\nComponent.externalLibraries = {};\n\nComponent.requireLibrary = function (name, property, src, polling) {\n  if (!Component.externalLibraries.hasOwnProperty(name)) {\n    Component.externalLibraries[name] = {};\n    Component.externalLibraries[name].ready = new _nativePromiseOnly.default(function (resolve, reject) {\n      Component.externalLibraries[name].resolve = resolve;\n      Component.externalLibraries[name].reject = reject;\n    });\n    var callbackName = \"\".concat(name, \"Callback\");\n\n    if (!polling && !window[callbackName]) {\n      window[callbackName] = function () {\n        this.resolve();\n      }.bind(Component.externalLibraries[name]);\n    } // See if the plugin already exists.\n\n\n    var plugin = _lodash.default.get(window, property);\n\n    if (plugin) {\n      Component.externalLibraries[name].resolve(plugin);\n    } else {\n      src = Array.isArray(src) ? src : [src];\n      src.forEach(function (lib) {\n        var attrs = {};\n        var elementType = '';\n\n        if (typeof lib === 'string') {\n          lib = {\n            type: 'script',\n            src: lib\n          };\n        }\n\n        switch (lib.type) {\n          case 'script':\n            elementType = 'script';\n            attrs = {\n              src: lib.src,\n              type: 'text/javascript',\n              defer: true,\n              async: true\n            };\n            break;\n\n          case 'styles':\n            elementType = 'link';\n            attrs = {\n              href: lib.src,\n              rel: 'stylesheet'\n            };\n            break;\n        } // Add the script to the top page.\n\n\n        var script = document.createElement(elementType);\n\n        for (var attr in attrs) {\n          script.setAttribute(attr, attrs[attr]);\n        }\n\n        document.getElementsByTagName('head')[0].appendChild(script);\n      }); // if no callback is provided, then check periodically for the script.\n\n      if (polling) {\n        setTimeout(function checkLibrary() {\n          var plugin = _lodash.default.get(window, property);\n\n          if (plugin) {\n            Component.externalLibraries[name].resolve(plugin);\n          } else {\n            // check again after 200 ms.\n            setTimeout(checkLibrary, 200);\n          }\n        }, 200);\n      }\n    }\n  }\n\n  return Component.externalLibraries[name].ready;\n};\n\nComponent.libraryReady = function (name) {\n  if (Component.externalLibraries.hasOwnProperty(name) && Component.externalLibraries[name].ready) {\n    return Component.externalLibraries[name].ready;\n  }\n\n  return _nativePromiseOnly.default.reject(\"\".concat(name, \" library was not required.\"));\n};","map":{"version":3,"sources":["C:/Users/Devin/AOT_Projects/jag-servebc/forms-flow-ai/forms-flow-web/node_modules/formiojs/components/_classes/component/Component.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_vanillaTextMask","_nativePromiseOnly","_interopRequireDefault","_tooltip","_lodash","_ismobilejs","_Formio","FormioUtils","_interopRequireWildcard","_Validator","_Element2","_ComponentModal","_widgets","_addons","_uploadAdapter","_en","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","__esModule","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_createForOfIteratorHelper","o","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","F","s","n","done","e","_e","f","TypeError","normalCompletion","didErr","err","step","next","_e2","return","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","minLen","_arrayLikeToArray","toString","slice","name","from","test","iter","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","base","_superPropBase","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","getPrototypeOf","isIEBrowser","getBrowserInfo","ie","CKEDITOR_URL","QUILL_URL","QUILL_TABLE_URL","ACE_URL","Templates","GlobalFormio","Component","_Element","_super","component","options","data","_this","assign","renderMode","attachMode","noDefaults","id","_hasCondition","refs","components","type","merge","validator","path","mergeSchema","originalComponent","fastCloneDeep","attached","rendered","_data","error","tooltip","row","_disabled","boolValue","disabled","root","localRoot","pristine","parent","validators","_path","_parentPath","parentPath","resetCaches","_parentVisible","parentVisible","_visible","conditionallyVisible","_parentDisabled","changes","lastChanged","triggerArgs","_triggerChange","debounce","_this2","changing","_len","args","_key","isEmpty","flags","retVal","onChange","triggerChange","_len2","_key2","triggerRedraw","redraw","bind","tooltips","addons","invalid","allowData","concat","visible","clearOnHide","hasValue","shouldAddDefaultValue","dataValue","defaultValue","info","elementInfo","hook","skipInit","init","undefined","defaultsDeep","defaultSchema","resolve","label","hidden","labelIsHidden","className","labelPosition","tooltipClass","iconClass","isPDFReadOnlyMode","form","display","readOnly","hasInput","validate","required","attr","for","_this$component$addon","_this3","shouldDisabled","addon","createAddon","addonConfiguration","_addonConfiguration$s","settings","Addon","supportedComponents","supportsThisComponentType","indexOf","console","warn","destroy","detach","input","isInputComponent","schema","builderMode","previewMode","showHiddenFields","hide","show","_currentForm","width","labelWidth","margin","labelMargin","includes","split","rightDirection","direction","getLabelInfo","isRightPosition","labelPositions","isLeftPosition","isRightAlign","contentMargin","hideLabel","labelStyles","contentStyles","getModifiedSchema","recursion","_this4","modified","each","val","isObject","subModified","isEqual","omit","inDataGrid","t","text","_get2","params","_userInput","rootValue","_len3","_key3","isInDataGrid","dataGridLabel","inputsOnly","current","transform","getTemplate","names","modes","templates","checkTemplate","frameworkTemplates","template","templatesByName","defaultTemplates","templateByMode","checkTemplateMode","_iterator","_step","_iterator2","_step2","mode","getFormattedTooltip","tooltipValue","interpolate","replace","isHtmlRenderMode","renderTemplate","_this5","modeOption","size","builder","render","labelInfo","charAt","toUpperCase","substring","sanitize","dirty","forceSanitize","pdf","renderString","performInputMapping","_this$root","widget","shadowRoot","getBrowserLanguage","nav","window","navigator","browserLanguagePropertyKeys","language","languages","_i","beforePage","beforeNext","beforeSubmit","submissionTimezone","loadRefs","element","ref","querySelector","querySelectorAll","setOpenModalElement","componentModal","getModalPreviewTemplate","message","level","previewText","getValueAsString","modalPreview","messages","build","empty","setContent","attach","children","topLevel","isVisible","modalEdit","showSaveButton","hasModalSaveButton","classes","styles","customStyle","attachTooltips","toolTipsRefs","_this6","index","tooltipAttribute","getAttribute","tooltipDataTitle","tooltipText","trigger","placement","html","title","createComponentModal","modalShouldBeOpened","currentValue","isOpened","openModalTemplate","messageContainer","attachLogic","autofocus","restoreFocus","_this$root2","_this$root2$focusedCo","isFocused","focusedComponent","_this$root$currentSel","focus","currentSelection","restoreCaretPosition","addShortcut","shortcut","removeShortcut","removeEventListeners","detachLogic","dispose","checkRefresh","refreshData","changed","changePath","refresh","getComponentPath","inContext","checkRefreshOn","_this7","noRefresh","refreshOn","fromBlur","refreshOnBlur","redrawOn","refreshOnChanged","refreshOnValue","clearOnRefresh","setValue","viewAsHtml","createViewOnlyElement","ce","getWidgetValueAsString","_this8","noInputWidget","values","join","isPlainObject","JSON","stringify","stringValue","shouldSanitizeValue","getView","protected","updateItems","restoreValue","itemValue","forceUseValue","valueProperty","itemValueForHTMLMode","_this9","map","item","createModal","confirm","_this10","dialog","dialogOverlay","dialogContents","dialogClose","appendChild","document","body","classList","add","close","remove","dispatchEvent","CustomEvent","addEventListener","removeChildFrom","event","preventDefault","handleCloseClick","then","catch","optimizeRedraw","addClass","multiple","customClass","customCSS","style","getElement","evalContext","additional","rowIndex","submission","_submission","_form","setPristine","setDirty","removeValue","splice","triggerRootChange","spinning","iconset","defaultIconset","_size","placeholder","errorLabel","errorMessage","errors","content","HTMLElement","innerHTML","_this$root3","_this$refs$input","_this$root$currentSel2","selection","isInputRangeSelectable","_input","setSelectionRange","_input$value","lastCharacter","parentNode","emit","outerHTML","rebuild","hasClass","removeClass","hasCondition","checkCondition","checkComponentConditions","fieldLogic","checkConditions","logic","_this11","logics","newComponent","reduce","checkTrigger","applyActions","actions","isIE","userAgent","msie","parseInt","trident","rv","edge","defineActionValue","action","argsObject","evaluate","_this12","setActionProperty","oldValue","getValue","newValue","clone","viewOnly","schemaDefinition","_oldValue","_newValue","customAction","addInputError","elements","addMessages","setErrorClasses","removeInputError","_this13","uniqBy","hasErrors","hasMessages","_this14","clearErrorClasses","setElementInvalid","setInputWidgetErrorClasses","highlightErrors","componentErrorClass","setAttribute","rootPristine","server","isInsideScopingComponent","deleteValue","noUpdateEvent","_this$options","_this$root4","fromRoot","noPristineChangeOnModified","validateOn","noValidate","quill","theme","modules","toolbar","ace","maxLines","minLines","tabSize","ckeditor","image","extraPlugins","addCKE","base64Upload","isUploadEnabled","mediaEmbed","previewsInData","wysiwygDefault","getFormioUploadAdapterPlugin","fileService","requireLibrary","reject","editor","CKEDITOR","on","getData","ClassicEditor","model","addQuill","_this15","table","src","Quill","txtArea","createElement","addContainer","qlSource","setContents","clipboard","convert","elm","_this$options2","addAce","edit","removeAllListeners","setOptions","getSession","setMode","isUseWorkerDisabled","session","setUseWorker","tree","emptyValue","unset","noDefault","getCustomDefaultValue","customDefaultValue","preview","_this16","checkMask","placeholderChar","conformToMask","defaultMask","conformedValue","matchInputMask","cloneDeep","getValueAt","updateValue","valueInput","fileLink","fromSubmission","setValueAt","valueMaskInput","mask","textMaskInputElement","update","setDefaultValue","hasSetValue","normalizeValue","updateComponentValue","resetValue","hasChanged","updateOnChange","getIcon","convertNumberOrBoolToString","doValueCalculation","calculateValue","calculateComponentValue","shouldBeCleared","allowOverride","calculateValueVariable","calculateServer","dataSourceInitialLoading","calculatedValue","isNil","firstPass","newCalculatedValue","previousCalculatedValue","calculationChanged","previousChanged","isReordered","persistent","triggeredComponentId","labelElement","innerText","getRoot","invalidMessage","ignoreCondition","checkComponent","isValid","setComponentValidity","silentCheck","fromServer","setCustomValidity","checkComponentValidity","_this$serverErrors","_this17","_options$async","async","_options$silentCheck","shouldSkipValidation","check","validations","serverErrors","checkValidity","checkModal","checkAsyncValidity","checkData","noCheck","validateOnInit","fromIframe","alwaysDirty","isDirty","openModal","openModalWrapper","isEmptyArray","valueA","valueB","validateMultiple","inputRefs","external","_this18","invalidInputRefs","inputRefsArray","_messages$some","_messages","some","msg","_msg$context","context","modalMessageContainer","isValueHidden","editing","_this19","rules","pred","whenReady","dataReady","asString","parentDisabled","setDisabled","removeAttribute","setLoading","loading","loader","class","appendTo","selectOptions","select","tag","_this20","option","attrs","selected","optionElement","setSelectValue","onchange","onselect","getRelativePath","keyPart","thisPath","clear","append","prepend","prependTo","removeChild","_this21","off","_this22","_len4","_key4","attributes","inputType","lang","tabindex","defaults","changeEvent","_this23","hasAutofocus","scrollIntoView","_element$getBoundingC","getBoundingClientRect","left","top","scrollTo","scrollX","scrollY","_this$refs$input2","beforeFocus","_this$component$widge","focusingInput","sibling","nextSibling","formio","_id","formUrl","projectUrl","_len5","sources","_key5","prefix","suffix","unique","tableView","description","dbIndex","custom","customPrivate","strictDateValidation","conditional","when","eq","overlay","height","allowCalculateOverride","encrypted","showCharCount","showWordCount","properties","allowMultipleMasks","externalLibraries","polling","ready","callbackName","plugin","lib","elementType","defer","href","rel","script","getElementsByTagName","setTimeout","checkLibrary","libraryReady"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.weak-map.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.regexp.flags.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _vanillaTextMask = require(\"@formio/vanilla-text-mask\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _tooltip = _interopRequireDefault(require(\"tooltip.js\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _ismobilejs = _interopRequireDefault(require(\"ismobilejs\"));\n\nvar _Formio = require(\"../../../Formio\");\n\nvar FormioUtils = _interopRequireWildcard(require(\"../../../utils/utils\"));\n\nvar _Validator = _interopRequireDefault(require(\"../../../validator/Validator\"));\n\nvar _Element2 = _interopRequireDefault(require(\"../../../Element\"));\n\nvar _ComponentModal = _interopRequireDefault(require(\"../componentModal/ComponentModal\"));\n\nvar _widgets = _interopRequireDefault(require(\"../../../widgets\"));\n\nvar _addons = _interopRequireDefault(require(\"../../../addons\"));\n\nvar _uploadAdapter = require(\"../../../providers/storage/uploadAdapter\");\n\nvar _en = _interopRequireDefault(require(\"../../../translations/en\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar isIEBrowser = FormioUtils.getBrowserInfo().ie;\nvar CKEDITOR_URL = isIEBrowser ? 'https://cdn.ckeditor.com/4.14.1/standard/ckeditor.js' : 'https://cdn.form.io/ckeditor/19.0.0/ckeditor.js';\nvar QUILL_URL = isIEBrowser ? 'https://cdn.quilljs.com/1.3.7' : 'https://cdn.quilljs.com/2.0.0-dev.3';\nvar QUILL_TABLE_URL = 'https://cdn.form.io/quill/quill-table.js';\nvar ACE_URL = 'https://cdn.form.io/ace/1.4.10/ace.js';\nvar Templates = _Formio.GlobalFormio.Templates;\n\nif (!Templates) {\n  Templates = require('../../../templates/Templates').default;\n}\n/**\n * This is the Component class\n which all elements within the FormioForm derive from.\n */\n\n\nvar Component = /*#__PURE__*/function (_Element) {\n  _inherits(Component, _Element);\n\n  var _super = _createSuper(Component);\n\n  /* eslint-enable no-unused-vars */\n\n  /**\n   * Initialize a new Component.\n   *\n   * @param {Object} component - The component JSON you wish to initialize.\n   * @param {Object} options - The options for this component.\n   * @param {Object} data - The global data submission object this component will belong.\n   */\n\n  /* eslint-disable max-statements */\n  function Component(component, options, data) {\n    var _this;\n\n    _classCallCheck(this, Component);\n\n    _this = _super.call(this, Object.assign({\n      renderMode: 'form',\n      attachMode: 'full',\n      noDefaults: false\n    }, options || {})); // Restore the component id.\n\n    if (component && component.id) {\n      _this.id = component.id;\n    }\n    /**\n     * Determines if this component has a condition assigned to it.\n     * @type {null}\n     * @private\n     */\n\n\n    _this._hasCondition = null;\n    /**\n     * References to dom elements\n     */\n\n    _this.refs = {}; // Allow global override for any component JSON.\n\n    if (component && _this.options.components && _this.options.components[component.type]) {\n      _lodash.default.merge(component, _this.options.components[component.type]);\n    }\n    /**\n     * Set the validator instance.\n     */\n\n\n    _this.validator = _Validator.default;\n    /**\n     * The data path to this specific component instance.\n     *\n     * @type {string}\n     */\n\n    _this.path = '';\n    /**\n     * The Form.io component JSON schema.\n     * @type {*}\n     */\n\n    _this.component = _this.mergeSchema(component || {}); // Add the id to the component.\n\n    _this.component.id = _this.id; // Save off the original component to be used in logic.\n\n    _this.originalComponent = (0, FormioUtils.fastCloneDeep)(_this.component);\n    /**\n     * If the component has been attached\n     */\n\n    _this.attached = false;\n    /**\n     * If the component has been rendered\n     */\n\n    _this.rendered = false;\n    /**\n     * The data object in which this component resides.\n     * @type {*}\n     */\n\n    _this._data = data || {};\n    /**\n     * The existing error that this component has.\n     * @type {string}\n     */\n\n    _this.error = '';\n    /**\n     * Tool tip text after processing\n     * @type {string}\n     */\n\n    _this.tooltip = '';\n    /**\n     * The row path of this component.\n     * @type {number}\n     */\n\n    _this.row = _this.options.row;\n    /**\n     * Determines if this component is disabled, or not.\n     *\n     * @type {boolean}\n     */\n\n    _this._disabled = (0, FormioUtils.boolValue)(_this.component.disabled) ? _this.component.disabled : false;\n    /**\n     * Points to the root component, usually the FormComponent.\n     *\n     * @type {Component}\n     */\n\n    _this.root = _this.options.root;\n    _this.localRoot = _this.options.localRoot;\n    /**\n     * If this input has been input and provided value.\n     *\n     * @type {boolean}\n     */\n\n    _this.pristine = true;\n    /**\n     * Points to the parent component.\n     *\n     * @type {Component}\n     */\n\n    _this.parent = _this.options.parent;\n    _this.options.name = _this.options.name || 'data';\n    /**\n     * The validators that are assigned to this component.\n     * @type {[string]}\n     */\n\n    _this.validators = ['required', 'minLength', 'maxLength', 'minWords', 'maxWords', 'custom', 'pattern', 'json', 'mask'];\n    _this._path = ''; // Nested forms don't have parents so we need to pass their path in.\n\n    _this._parentPath = _this.options.parentPath || ''; // Needs for Nextgen Rules Engine\n\n    _this.resetCaches();\n    /**\n     * Determines if this component is visible, or not.\n     */\n\n\n    _this._parentVisible = _this.options.hasOwnProperty('parentVisible') ? _this.options.parentVisible : true;\n    _this._visible = _this._parentVisible && _this.conditionallyVisible(null, data);\n    _this._parentDisabled = false;\n    /**\n     * Used to trigger a new change in this component.\n     * @type {function} - Call to trigger a change in this component.\n     */\n\n    var changes = [];\n    var lastChanged = null;\n    var triggerArgs = [];\n\n    var _triggerChange = _lodash.default.debounce(function () {\n      var _this2;\n\n      if (_this.root) {\n        _this.root.changing = false;\n      }\n\n      triggerArgs = [];\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if (!args[1] && lastChanged) {\n        // Set the changed component if one isn't provided.\n        args[1] = lastChanged;\n      }\n\n      if (_lodash.default.isEmpty(args[0]) && lastChanged) {\n        // Set the flags if it is empty and lastChanged exists.\n        args[0] = lastChanged.flags;\n      }\n\n      lastChanged = null;\n      args[3] = changes;\n\n      var retVal = (_this2 = _this).onChange.apply(_this2, args);\n\n      changes = [];\n      return retVal;\n    }, 100);\n\n    _this.triggerChange = function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      if (args[1]) {\n        // Make sure that during the debounce that we always track lastChanged component, even if they\n        // don't provide one later.\n        lastChanged = args[1];\n        changes.push(lastChanged);\n      }\n\n      if (_this.root) {\n        _this.root.changing = true;\n      }\n\n      if (args.length) {\n        triggerArgs = args;\n      }\n\n      return _triggerChange.apply(void 0, _toConsumableArray(triggerArgs));\n    };\n    /**\n     * Used to trigger a redraw event within this component.\n     *\n     * @type {Function}\n     */\n\n\n    _this.triggerRedraw = _lodash.default.debounce(_this.redraw.bind(_assertThisInitialized(_this)), 100);\n    /**\n     * list of attached tooltips\n     * @type {Array}\n     */\n\n    _this.tooltips = [];\n    /**\n     * List of attached addons\n     * @type {Array}\n     */\n\n    _this.addons = []; // To force this component to be invalid.\n\n    _this.invalid = false;\n\n    if (_this.component) {\n      _this.type = _this.component.type;\n\n      if (_this.allowData && _this.key) {\n        _this.options.name += \"[\".concat(_this.key, \"]\"); // If component is visible or not set to clear on hide, set the default value.\n\n        if (_this.visible || !_this.component.clearOnHide) {\n          if (!_this.hasValue()) {\n            if (_this.shouldAddDefaultValue) {\n              _this.dataValue = _this.defaultValue;\n            }\n          } else {\n            // Ensure the dataValue is set.\n\n            /* eslint-disable  no-self-assign */\n            _this.dataValue = _this.dataValue;\n            /* eslint-enable  no-self-assign */\n          }\n        }\n      }\n      /**\n       * The element information for creating the input element.\n       * @type {*}\n       */\n\n\n      _this.info = _this.elementInfo();\n    } // Allow anyone to hook into the component creation.\n\n\n    _this.hook('component');\n\n    if (!_this.options.skipInit) {\n      _this.init();\n    }\n\n    return _this;\n  }\n  /* eslint-enable max-statements */\n\n\n  _createClass(Component, [{\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      this._data = value;\n    }\n  }, {\n    key: \"mergeSchema\",\n    value: function mergeSchema() {\n      var component = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return _lodash.default.defaultsDeep(component, this.defaultSchema);\n    } // Allow componets to notify when ready.\n\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return _nativePromiseOnly.default.resolve(this);\n    }\n  }, {\n    key: \"labelInfo\",\n    get: function get() {\n      var label = {};\n      label.hidden = this.labelIsHidden();\n      label.className = '';\n      label.labelPosition = this.component.labelPosition;\n      label.tooltipClass = \"\".concat(this.iconClass('question-sign'), \" text-muted\");\n      var isPDFReadOnlyMode = this.parent && this.parent.form && this.parent.form.display === 'pdf' && this.options.readOnly;\n\n      if (this.hasInput && this.component.validate && (0, FormioUtils.boolValue)(this.component.validate.required) && !isPDFReadOnlyMode) {\n        label.className += ' field-required';\n      }\n\n      if (label.hidden) {\n        label.className += ' control-label--hidden';\n      }\n\n      if (this.info.attr.id) {\n        label.for = this.info.attr.id;\n      }\n\n      return label;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this$component$addon,\n          _this3 = this;\n\n      this.disabled = this.shouldDisabled;\n      this._visible = this.conditionallyVisible(null, null);\n\n      if ((_this$component$addon = this.component.addons) !== null && _this$component$addon !== void 0 && _this$component$addon.length) {\n        this.component.addons.forEach(function (addon) {\n          return _this3.createAddon(addon);\n        });\n      }\n    }\n  }, {\n    key: \"createAddon\",\n    value: function createAddon(addonConfiguration) {\n      var _addonConfiguration$s;\n\n      var name = addonConfiguration.name;\n\n      if (!name) {\n        return;\n      }\n\n      var settings = ((_addonConfiguration$s = addonConfiguration.settings) === null || _addonConfiguration$s === void 0 ? void 0 : _addonConfiguration$s.data) || {};\n      var Addon = _addons.default[name];\n      var addon = null;\n\n      if (Addon) {\n        var supportedComponents = Addon.info.supportedComponents;\n        var supportsThisComponentType = !(supportedComponents !== null && supportedComponents !== void 0 && supportedComponents.length) || supportedComponents.indexOf(this.component.type) !== -1;\n\n        if (supportsThisComponentType) {\n          addon = new Addon(settings, this);\n          this.addons.push(addon);\n        } else {\n          console.warn(\"Addon \".concat(name, \" does not support component of type \").concat(this.component.type, \".\"));\n        }\n      }\n\n      return addon;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      _get(_getPrototypeOf(Component.prototype), \"destroy\", this).call(this);\n\n      this.detach();\n      this.addons.forEach(function (addon) {\n        return addon.destroy();\n      });\n    }\n  }, {\n    key: \"shouldDisabled\",\n    get: function get() {\n      return this.options.readOnly || this.component.disabled || this.options.hasOwnProperty('disabled') && this.options.disabled[this.key];\n    }\n  }, {\n    key: \"isInputComponent\",\n    get: function get() {\n      return !this.component.hasOwnProperty('input') || this.component.input;\n    }\n  }, {\n    key: \"allowData\",\n    get: function get() {\n      return this.hasInput;\n    }\n  }, {\n    key: \"hasInput\",\n    get: function get() {\n      return this.isInputComponent || this.refs.input && this.refs.input.length;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return Component.schema();\n    }\n  }, {\n    key: \"key\",\n    get: function get() {\n      return _lodash.default.get(this.component, 'key', '');\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return this._parentVisible;\n    },\n    set: function set(value) {\n      this._parentVisible = value;\n    }\n  }, {\n    key: \"parentDisabled\",\n    get: function get() {\n      return this._parentDisabled;\n    }\n    /**\n     *\n     * @param value {boolean}\n     */\n    ,\n    set: function set(value) {\n      this._parentDisabled = value;\n    }\n  }, {\n    key: \"visible\",\n    get:\n    /**\n     *\n     * @returns {boolean}\n     */\n    function get() {\n      // Show only if visibility changes or if we are in builder mode or if hidden fields should be shown.\n      if (this.builderMode || this.previewMode || this.options.showHiddenFields) {\n        return true;\n      }\n\n      if (this.options.hide && this.options.hide[this.component.key]) {\n        return false;\n      }\n\n      if (this.options.show && this.options.show[this.component.key]) {\n        return true;\n      }\n\n      return this._visible && this._parentVisible;\n    },\n    set: function set(value) {\n      if (this._visible !== value) {\n        this._visible = value;\n        this.clearOnHide();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return this._currentForm;\n    },\n    set: function set(instance) {\n      this._currentForm = instance;\n    }\n  }, {\n    key: \"fullMode\",\n    get: function get() {\n      return this.options.attachMode === 'full';\n    }\n  }, {\n    key: \"builderMode\",\n    get: function get() {\n      return this.options.attachMode === 'builder';\n    }\n  }, {\n    key: \"calculatedPath\",\n    get: function get() {\n      console.error('component.calculatedPath was deprecated, use component.path instead.');\n      return this.path;\n    }\n  }, {\n    key: \"labelPosition\",\n    get: function get() {\n      return this.component.labelPosition;\n    }\n  }, {\n    key: \"labelWidth\",\n    get: function get() {\n      var width = this.component.labelWidth;\n      return width >= 0 ? width : 30;\n    }\n  }, {\n    key: \"labelMargin\",\n    get: function get() {\n      var margin = this.component.labelMargin;\n      return margin >= 0 ? margin : 3;\n    }\n  }, {\n    key: \"isAdvancedLabel\",\n    get: function get() {\n      return ['left-left', 'left-right', 'right-left', 'right-right'].includes(this.labelPosition);\n    }\n  }, {\n    key: \"labelPositions\",\n    get: function get() {\n      return this.labelPosition.split('-');\n    }\n  }, {\n    key: \"skipInEmail\",\n    get: function get() {\n      return false;\n    }\n  }, {\n    key: \"rightDirection\",\n    value: function rightDirection(direction) {\n      return direction === 'right';\n    }\n  }, {\n    key: \"getLabelInfo\",\n    value: function getLabelInfo() {\n      var isRightPosition = this.rightDirection(this.labelPositions[0]);\n      var isLeftPosition = this.labelPositions[0] === 'left';\n      var isRightAlign = this.rightDirection(this.labelPositions[1]);\n      var contentMargin = '';\n\n      if (this.component.hideLabel) {\n        var margin = this.labelWidth + this.labelMargin;\n        contentMargin = isRightPosition ? \"margin-right: \".concat(margin, \"%\") : '';\n        contentMargin = isLeftPosition ? \"margin-left: \".concat(margin, \"%\") : '';\n      }\n\n      var labelStyles = \"\\n      flex: \".concat(this.labelWidth, \";\\n      \").concat(isRightPosition ? 'margin-left' : 'margin-right', \": \").concat(this.labelMargin, \"%;\\n    \");\n      var contentStyles = \"\\n      flex: \".concat(100 - this.labelWidth - this.labelMargin, \";\\n      \").concat(contentMargin, \";\\n      \").concat(this.component.hideLabel ? \"max-width: \".concat(100 - this.labelWidth - this.labelMargin) : '', \";\\n    \");\n      return {\n        isRightPosition: isRightPosition,\n        isRightAlign: isRightAlign,\n        labelStyles: labelStyles,\n        contentStyles: contentStyles\n      };\n    }\n    /**\n     * Returns only the schema that is different from the default.\n     *\n     * @param schema\n     * @param defaultSchema\n     */\n\n  }, {\n    key: \"getModifiedSchema\",\n    value: function getModifiedSchema(schema, defaultSchema, recursion) {\n      var _this4 = this;\n\n      var modified = {};\n\n      if (!defaultSchema) {\n        return schema;\n      }\n\n      _lodash.default.each(schema, function (val, key) {\n        if (!_lodash.default.isArray(val) && _lodash.default.isObject(val) && defaultSchema.hasOwnProperty(key)) {\n          var subModified = _this4.getModifiedSchema(val, defaultSchema[key], true);\n\n          if (!_lodash.default.isEmpty(subModified)) {\n            modified[key] = subModified;\n          }\n        } else if (_lodash.default.isArray(val)) {\n          if (val.length !== 0 && !_lodash.default.isEqual(val, defaultSchema[key])) {\n            modified[key] = val;\n          }\n        } else if (!recursion && key === 'type' || !recursion && key === 'key' || !recursion && key === 'label' || !recursion && key === 'input' || !recursion && key === 'tableView' || val !== '' && !defaultSchema.hasOwnProperty(key) || val !== '' && val !== defaultSchema[key] || defaultSchema[key] && val !== defaultSchema[key]) {\n          modified[key] = val;\n        }\n      });\n\n      return modified;\n    }\n    /**\n     * Returns the JSON schema for this component.\n     */\n\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return (0, FormioUtils.fastCloneDeep)(this.getModifiedSchema(_lodash.default.omit(this.component, 'id'), this.defaultSchema));\n    }\n    /**\n     * Returns true if component is inside DataGrid\n     */\n\n  }, {\n    key: \"isInDataGrid\",\n    get: function get() {\n      return this.inDataGrid;\n    }\n    /**\n     * Translate a text using the i18n system.\n     *\n     * @param {string} text - The i18n identifier.\n     * @param {Object} params - The i18n parameters to use for translation.\n     */\n\n  }, {\n    key: \"t\",\n    value: function t(text) {\n      var _get2;\n\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!text) {\n        return '';\n      } // Use _userInput: true to ignore translations from defaults\n\n\n      if (text in _en.default && params._userInput) {\n        return text;\n      }\n\n      params.data = this.rootValue;\n      params.row = this.data;\n      params.component = this.component;\n\n      for (var _len3 = arguments.length, args = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n        args[_key3 - 2] = arguments[_key3];\n      }\n\n      return (_get2 = _get(_getPrototypeOf(Component.prototype), \"t\", this)).call.apply(_get2, [this, text, params].concat(args));\n    }\n  }, {\n    key: \"labelIsHidden\",\n    value: function labelIsHidden() {\n      return !this.component.label || (!this.isInDataGrid && this.component.hideLabel || this.isInDataGrid && !this.component.dataGridLabel || this.options.inputsOnly) && !this.builderMode;\n    }\n  }, {\n    key: \"transform\",\n    get: function get() {\n      return Templates.current.hasOwnProperty('transform') ? Templates.current.transform.bind(Templates.current) : function (type, value) {\n        return value;\n      };\n    }\n  }, {\n    key: \"getTemplate\",\n    value: function getTemplate(names, modes) {\n      modes = Array.isArray(modes) ? modes : [modes];\n      names = Array.isArray(names) ? names : [names];\n\n      if (!modes.includes('form')) {\n        modes.push('form');\n      }\n\n      var result = null;\n\n      if (this.options.templates) {\n        result = this.checkTemplate(this.options.templates, names, modes);\n\n        if (result) {\n          return result;\n        }\n      }\n\n      var frameworkTemplates = this.options.template ? Templates.templates[this.options.template] : Templates.current;\n      result = this.checkTemplate(frameworkTemplates, names, modes);\n\n      if (result) {\n        return result;\n      } // Default back to bootstrap if not defined.\n\n\n      var name = names[names.length - 1];\n      var templatesByName = Templates.defaultTemplates[name];\n\n      if (!templatesByName) {\n        return \"Unknown template: \".concat(name);\n      }\n\n      var templateByMode = this.checkTemplateMode(templatesByName, modes);\n\n      if (templateByMode) {\n        return templateByMode;\n      }\n\n      return templatesByName.form;\n    }\n  }, {\n    key: \"checkTemplate\",\n    value: function checkTemplate(templates, names, modes) {\n      var _iterator = _createForOfIteratorHelper(names),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var name = _step.value;\n          var templatesByName = templates[name];\n\n          if (templatesByName) {\n            var templateByMode = this.checkTemplateMode(templatesByName, modes);\n\n            if (templateByMode) {\n              return templateByMode;\n            }\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"checkTemplateMode\",\n    value: function checkTemplateMode(templatesByName, modes) {\n      var _iterator2 = _createForOfIteratorHelper(modes),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var mode = _step2.value;\n          var templateByMode = templatesByName[mode];\n\n          if (templateByMode) {\n            return templateByMode;\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getFormattedTooltip\",\n    value: function getFormattedTooltip(tooltipValue) {\n      var tooltip = this.interpolate(tooltipValue || '').replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n      return tooltip ? this.t(tooltip, {\n        _userInput: true\n      }).replace(/\"/g, '&quot;') : '';\n    }\n  }, {\n    key: \"isHtmlRenderMode\",\n    value: function isHtmlRenderMode() {\n      return this.options.renderMode === 'html';\n    }\n  }, {\n    key: \"renderTemplate\",\n    value: function renderTemplate(name) {\n      var _this5 = this;\n\n      var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var modeOption = arguments.length > 2 ? arguments[2] : undefined;\n      // Need to make this fall back to form if renderMode is not found similar to how we search templates.\n      var mode = modeOption || this.options.renderMode || 'form';\n      data.component = this.component;\n      data.self = this;\n      data.options = this.options;\n      data.readOnly = this.options.readOnly;\n      data.iconClass = this.iconClass.bind(this);\n      data.size = this.size.bind(this);\n      data.t = this.t.bind(this);\n      data.transform = this.transform;\n      data.id = data.id || this.id;\n      data.key = data.key || this.key;\n      data.value = data.value || this.dataValue;\n      data.disabled = this.disabled;\n      data.builder = this.builderMode;\n\n      data.render = function () {\n        console.warn(\"Form.io 'render' template function is deprecated.\\n      If you need to render template (template A) inside of another template (template B),\\n      pass pre-compiled template A (use this.renderTemplate('template_A_name') as template context variable for template B\");\n        return _this5.renderTemplate.apply(_this5, arguments);\n      };\n\n      data.label = this.labelInfo;\n      data.tooltip = this.getFormattedTooltip(this.component.tooltip); // Allow more specific template names\n\n      var names = [\"\".concat(name, \"-\").concat(this.component.type, \"-\").concat(this.key), \"\".concat(name, \"-\").concat(this.component.type), \"\".concat(name, \"-\").concat(this.key), \"\".concat(name)]; // Allow template alters.\n\n      return this.hook(\"render\".concat(name.charAt(0).toUpperCase() + name.substring(1, name.length)), this.interpolate(this.getTemplate(names, mode), data), data, mode);\n    }\n    /**\n     * Sanitize an html string.\n     *\n     * @param string\n     * @returns {*}\n     */\n\n  }, {\n    key: \"sanitize\",\n    value: function sanitize(dirty, forceSanitize) {\n      // No need to sanitize when generating PDF'S since no users interact with the form.\n      if ((this.options.pdf || this.options.sanitize === false) && !forceSanitize) {\n        return dirty;\n      }\n\n      return FormioUtils.sanitize(dirty, this.options);\n    }\n    /**\n     * Render a template string into html.\n     *\n     * @param template\n     * @param data\n     * @param actions\n     *\n     * @return {HTMLElement|String} - The created element or an empty string if template is not specified.\n     */\n\n  }, {\n    key: \"renderString\",\n    value: function renderString(template, data) {\n      if (!template) {\n        return '';\n      } // Interpolate the template and populate\n\n\n      return this.interpolate(template, data);\n    }\n  }, {\n    key: \"performInputMapping\",\n    value: function performInputMapping(input) {\n      return input;\n    }\n  }, {\n    key: \"widget\",\n    get: function get() {\n      var _this$root;\n\n      var settings = this.component.widget;\n\n      if (settings && (_this$root = this.root) !== null && _this$root !== void 0 && _this$root.shadowRoot) {\n        settings.shadowRoot = this.root.shadowRoot;\n      }\n\n      var widget = settings && _widgets.default[settings.type] ? new _widgets.default[settings.type](settings, this.component, this) : null;\n      return widget;\n    }\n  }, {\n    key: \"getBrowserLanguage\",\n    value: function getBrowserLanguage() {\n      var nav = window.navigator;\n      var browserLanguagePropertyKeys = ['language', 'browserLanguage', 'systemLanguage', 'userLanguage'];\n      var language; // support for HTML 5.1 \"navigator.languages\"\n\n      if (Array.isArray(nav.languages)) {\n        for (var i = 0; i < nav.languages.length; i++) {\n          language = nav.languages[i];\n\n          if (language && language.length) {\n            return language.split(';')[0];\n          }\n        }\n      } // support for other well known properties in browsers\n\n\n      for (var _i = 0; _i < browserLanguagePropertyKeys.length; _i++) {\n        language = nav[browserLanguagePropertyKeys[_i]];\n\n        if (language && language.length) {\n          return language.split(';')[0];\n        }\n      }\n\n      return null;\n    }\n    /**\n     * Called before a next and previous page is triggered allowing the components\n     * to perform special functions.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage() {\n      return _nativePromiseOnly.default.resolve(true);\n    }\n  }, {\n    key: \"beforeNext\",\n    value: function beforeNext() {\n      return this.beforePage(true);\n    }\n    /**\n     * Called before a submission is triggered allowing the components\n     * to perform special async functions.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      return _nativePromiseOnly.default.resolve(true);\n    }\n    /**\n     * Return the submission timezone.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"submissionTimezone\",\n    get: function get() {\n      this.options.submissionTimezone = this.options.submissionTimezone || _lodash.default.get(this.root, 'options.submissionTimezone');\n      return this.options.submissionTimezone;\n    }\n  }, {\n    key: \"loadRefs\",\n    value: function loadRefs(element, refs) {\n      for (var ref in refs) {\n        if (refs[ref] === 'single') {\n          this.refs[ref] = element.querySelector(\"[ref=\\\"\".concat(ref, \"\\\"]\"));\n        } else {\n          this.refs[ref] = element.querySelectorAll(\"[ref=\\\"\".concat(ref, \"\\\"]\"));\n        }\n      }\n    }\n  }, {\n    key: \"setOpenModalElement\",\n    value: function setOpenModalElement(template) {\n      this.componentModal.setOpenModalElement(template || this.getModalPreviewTemplate());\n    }\n  }, {\n    key: \"getModalPreviewTemplate\",\n    value: function getModalPreviewTemplate() {\n      var dataValue = this.component.type === 'password' ? this.dataValue.replace(/./g, '•') : this.dataValue;\n      var message = this.error ? {\n        level: 'error',\n        message: this.error.message\n      } : '';\n      return this.renderTemplate('modalPreview', {\n        previewText: this.getValueAsString(dataValue, {\n          modalPreview: true\n        }) || this.t('Click to set value'),\n        messages: message && this.renderTemplate('message', message)\n      });\n    }\n  }, {\n    key: \"build\",\n    value: function build(element) {\n      element = element || this.element;\n      this.empty(element);\n      this.setContent(element, this.render());\n      return this.attach(element);\n    }\n  }, {\n    key: \"hasModalSaveButton\",\n    get: function get() {\n      return true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"Unknown component: \".concat(this.component.type);\n      var topLevel = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var isVisible = this.visible;\n      this.rendered = true;\n\n      if (!this.builderMode && !this.previewMode && this.component.modalEdit) {\n        return _ComponentModal.default.render(this, {\n          visible: isVisible,\n          showSaveButton: this.hasModalSaveButton,\n          id: this.id,\n          classes: this.className,\n          styles: this.customStyle,\n          children: children\n        }, topLevel);\n      } else {\n        return this.renderTemplate('component', {\n          visible: isVisible,\n          id: this.id,\n          classes: this.className,\n          styles: this.customStyle,\n          children: children\n        }, topLevel);\n      }\n    }\n  }, {\n    key: \"attachTooltips\",\n    value: function attachTooltips(toolTipsRefs) {\n      var _this6 = this;\n\n      toolTipsRefs === null || toolTipsRefs === void 0 ? void 0 : toolTipsRefs.forEach(function (tooltip, index) {\n        if (tooltip) {\n          var tooltipAttribute = tooltip.getAttribute('data-tooltip');\n          var tooltipDataTitle = tooltip.getAttribute('data-title');\n\n          var tooltipText = _this6.interpolate(tooltipDataTitle || tooltipAttribute).replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n\n          _this6.tooltips[index] = new _tooltip.default(tooltip, {\n            trigger: 'hover click focus',\n            placement: 'right',\n            html: true,\n            title: _this6.t(tooltipText, {\n              _userInput: true\n            }),\n            template: \"\\n            <div class=\\\"tooltip\\\" style=\\\"opacity: 1;\\\" role=\\\"tooltip\\\">\\n              <div class=\\\"tooltip-arrow\\\"></div>\\n              <div class=\\\"tooltip-inner\\\"></div>\\n            </div>\"\n          });\n        }\n      });\n    }\n  }, {\n    key: \"createComponentModal\",\n    value: function createComponentModal(element, modalShouldBeOpened, currentValue) {\n      return new _ComponentModal.default(this, element, modalShouldBeOpened, currentValue);\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      if (!this.builderMode && !this.previewMode && this.component.modalEdit) {\n        var modalShouldBeOpened = this.componentModal ? this.componentModal.isOpened : false;\n        var currentValue = modalShouldBeOpened ? this.componentModal.currentValue : this.dataValue;\n        var openModalTemplate = this.componentModal && modalShouldBeOpened ? this.componentModal.openModalTemplate : null;\n        this.componentModal = this.createComponentModal(element, modalShouldBeOpened, currentValue);\n        this.setOpenModalElement(openModalTemplate);\n      }\n\n      this.attached = true;\n      this.element = element;\n      element.component = this; // If this already has an id, get it from the dom. If SSR, it could be different from the initiated id.\n\n      if (this.element.id) {\n        this.id = this.element.id;\n        this.component.id = this.id;\n      }\n\n      this.loadRefs(element, {\n        messageContainer: 'single',\n        tooltip: 'multiple'\n      });\n      this.attachTooltips(this.refs.tooltip); // Attach logic.\n\n      this.attachLogic();\n      this.autofocus(); // Allow global attach.\n\n      this.hook('attachComponent', element, this); // Allow attach per component type.\n\n      var type = this.component.type;\n\n      if (type) {\n        this.hook(\"attach\".concat(type.charAt(0).toUpperCase() + type.substring(1, type.length)), element, this);\n      }\n\n      this.restoreFocus();\n      this.addons.forEach(function (addon) {\n        return addon.attach(element);\n      });\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"restoreFocus\",\n    value: function restoreFocus() {\n      var _this$root2, _this$root2$focusedCo;\n\n      var isFocused = ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : (_this$root2$focusedCo = _this$root2.focusedComponent) === null || _this$root2$focusedCo === void 0 ? void 0 : _this$root2$focusedCo.path) === this.path;\n\n      if (isFocused) {\n        var _this$root$currentSel;\n\n        this.loadRefs(this.element, {\n          input: 'multiple'\n        });\n        this.focus((_this$root$currentSel = this.root.currentSelection) === null || _this$root$currentSel === void 0 ? void 0 : _this$root$currentSel.index);\n        this.restoreCaretPosition();\n      }\n    }\n  }, {\n    key: \"addShortcut\",\n    value: function addShortcut(element, shortcut) {\n      // Avoid infinite recursion.\n      if (!element || !this.root || this.root === this) {\n        return;\n      }\n\n      if (!shortcut) {\n        shortcut = this.component.shortcut;\n      }\n\n      this.root.addShortcut(element, shortcut);\n    }\n  }, {\n    key: \"removeShortcut\",\n    value: function removeShortcut(element, shortcut) {\n      // Avoid infinite recursion.\n      if (!element || this.root === this) {\n        return;\n      }\n\n      if (!shortcut) {\n        shortcut = this.component.shortcut;\n      }\n\n      this.root.removeShortcut(element, shortcut);\n    }\n    /**\n     * Remove all event handlers.\n     */\n\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.refs = {};\n      this.removeEventListeners();\n      this.detachLogic();\n\n      if (this.tooltip) {\n        this.tooltip.dispose();\n      }\n    }\n  }, {\n    key: \"checkRefresh\",\n    value: function checkRefresh(refreshData, changed, flags) {\n      var changePath = _lodash.default.get(changed, 'instance.path', false); // Don't let components change themselves.\n\n\n      if (changePath && this.path === changePath) {\n        return;\n      }\n\n      if (refreshData === 'data') {\n        this.refresh(this.data, changed, flags);\n      } else if (changePath && (0, FormioUtils.getComponentPath)(changed.instance) === refreshData && changed && changed.instance && // Make sure the changed component is not in a different \"context\". Solves issues where refreshOn being set\n      // in fields inside EditGrids could alter their state from other rows (which is bad).\n      this.inContext(changed.instance)) {\n        this.refresh(changed.value, changed, flags);\n      }\n    }\n  }, {\n    key: \"checkRefreshOn\",\n    value: function checkRefreshOn(changes) {\n      var _this7 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      changes = changes || [];\n\n      if (flags.noRefresh) {\n        return;\n      }\n\n      if (!changes.length && flags.changed) {\n        changes = [flags.changed];\n      }\n\n      var refreshOn = flags.fromBlur ? this.component.refreshOnBlur : this.component.refreshOn || this.component.redrawOn; // If they wish to refresh on a value, then add that here.\n\n      if (refreshOn) {\n        if (Array.isArray(refreshOn)) {\n          refreshOn.forEach(function (refreshData) {\n            return changes.forEach(function (changed) {\n              return _this7.checkRefresh(refreshData, changed, flags);\n            });\n          });\n        } else {\n          changes.forEach(function (changed) {\n            return _this7.checkRefresh(refreshOn, changed, flags);\n          });\n        }\n      }\n    }\n    /**\n     * Refreshes the component with a new value.\n     *\n     * @param value\n     */\n\n  }, {\n    key: \"refresh\",\n    value: function refresh(value) {\n      if (this.hasOwnProperty('refreshOnValue')) {\n        this.refreshOnChanged = !_lodash.default.isEqual(value, this.refreshOnValue);\n      } else {\n        this.refreshOnChanged = true;\n      }\n\n      this.refreshOnValue = (0, FormioUtils.fastCloneDeep)(value);\n\n      if (this.refreshOnChanged) {\n        if (this.component.clearOnRefresh) {\n          this.setValue(null);\n        }\n\n        this.triggerRedraw();\n      }\n    }\n    /**\n     * Checks to see if a separate component is in the \"context\" of this component. This is determined by first checking\n     * if they share the same \"data\" object. It will then walk up the parent tree and compare its parents data objects\n     * with the components data and returns true if they are in the same context.\n     *\n     * Different rows of the same EditGrid, for example, are in different contexts.\n     *\n     * @param component\n     */\n\n  }, {\n    key: \"inContext\",\n    value: function inContext(component) {\n      if (component.data === this.data) {\n        return true;\n      }\n\n      var parent = this.parent;\n\n      while (parent) {\n        if (parent.data === component.data) {\n          return true;\n        }\n\n        parent = parent.parent;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"viewOnly\",\n    get: function get() {\n      return this.options.readOnly && this.options.viewAsHtml;\n    }\n  }, {\n    key: \"createViewOnlyElement\",\n    value: function createViewOnlyElement() {\n      this.element = this.ce('dl', {\n        id: this.id\n      });\n\n      if (this.element) {\n        // Ensure you can get the component info from the element.\n        this.element.component = this;\n      }\n\n      return this.element;\n    }\n  }, {\n    key: \"defaultViewOnlyValue\",\n    get: function get() {\n      return '-';\n    }\n    /**\n     * Uses the widget to determine the output string.\n     *\n     * @param value\n     * @return {*}\n     */\n\n  }, {\n    key: \"getWidgetValueAsString\",\n    value: function getWidgetValueAsString(value, options) {\n      var _this8 = this;\n\n      var noInputWidget = !this.refs.input || !this.refs.input[0] || !this.refs.input[0].widget;\n\n      if (!value || noInputWidget) {\n        if (!this.widget || !value) {\n          return value;\n        } else {\n          return this.widget.getValueAsString(value);\n        }\n      }\n\n      if (Array.isArray(value)) {\n        var values = [];\n        value.forEach(function (val, index) {\n          var widget = _this8.refs.input[index] && _this8.refs.input[index].widget;\n\n          if (widget) {\n            values.push(widget.getValueAsString(val, options));\n          }\n        });\n        return values;\n      }\n\n      var widget = this.refs.input[0].widget;\n      return widget.getValueAsString(value, options);\n    }\n  }, {\n    key: \"getValueAsString\",\n    value: function getValueAsString(value, options) {\n      if (!value) {\n        return '';\n      }\n\n      value = this.getWidgetValueAsString(value, options);\n\n      if (Array.isArray(value)) {\n        return value.join(', ');\n      }\n\n      if (_lodash.default.isPlainObject(value)) {\n        return JSON.stringify(value);\n      }\n\n      if (value === null || value === undefined) {\n        return '';\n      }\n\n      var stringValue = value.toString();\n      return this.sanitize(stringValue, this.shouldSanitizeValue);\n    }\n  }, {\n    key: \"getView\",\n    value: function getView(value, options) {\n      if (this.component.protected) {\n        return '--- PROTECTED ---';\n      }\n\n      return this.getValueAsString(value, options);\n    }\n  }, {\n    key: \"updateItems\",\n    value: function updateItems() {\n      this.restoreValue();\n      this.onChange.apply(this, arguments);\n    }\n    /**\n     * @param {*} data\n     * @param {boolean} [forceUseValue=false] - if true, return 'value' property of the data\n     * @return {*}\n     */\n\n  }, {\n    key: \"itemValue\",\n    value: function itemValue(data) {\n      var forceUseValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (_lodash.default.isObject(data)) {\n        if (this.valueProperty) {\n          return _lodash.default.get(data, this.valueProperty);\n        }\n\n        if (forceUseValue) {\n          return data.value;\n        }\n      }\n\n      return data;\n    }\n  }, {\n    key: \"itemValueForHTMLMode\",\n    value: function itemValueForHTMLMode(value) {\n      var _this9 = this;\n\n      if (Array.isArray(value)) {\n        var values = value.map(function (item) {\n          return Array.isArray(item) ? _this9.itemValueForHTMLMode(item) : _this9.itemValue(item);\n        });\n        return values.join(', ');\n      }\n\n      return this.itemValue(value);\n    }\n  }, {\n    key: \"createModal\",\n    value: function createModal(element, attr, confirm) {\n      var _this10 = this;\n\n      var dialog = this.ce('div', attr || {});\n      this.setContent(dialog, this.renderTemplate('dialog')); // Add refs to dialog, not \"this\".\n\n      dialog.refs = {};\n      this.loadRefs.call(dialog, dialog, {\n        dialogOverlay: 'single',\n        dialogContents: 'single',\n        dialogClose: 'single'\n      });\n      dialog.refs.dialogContents.appendChild(element);\n      document.body.appendChild(dialog);\n      document.body.classList.add('modal-open');\n\n      dialog.close = function () {\n        document.body.classList.remove('modal-open');\n        dialog.dispatchEvent(new CustomEvent('close'));\n      };\n\n      this.addEventListener(dialog, 'close', function () {\n        return _this10.removeChildFrom(dialog, document.body);\n      });\n\n      var close = function close(event) {\n        event.preventDefault();\n        dialog.close();\n      };\n\n      var handleCloseClick = function handleCloseClick(e) {\n        if (confirm) {\n          confirm().then(function () {\n            return close(e);\n          }).catch(function () {});\n        } else {\n          close(e);\n        }\n      };\n\n      this.addEventListener(dialog.refs.dialogOverlay, 'click', handleCloseClick);\n      this.addEventListener(dialog.refs.dialogClose, 'click', handleCloseClick);\n      return dialog;\n    }\n  }, {\n    key: \"optimizeRedraw\",\n    get: function get() {\n      if (this.options.optimizeRedraw && this.element && !this.visible) {\n        this.addClass(this.element, 'formio-removed');\n        return true;\n      }\n\n      return false;\n    }\n    /**\n     * Retrieves the CSS class name of this component.\n     * @returns {string} - The class name of this component.\n     */\n\n  }, {\n    key: \"className\",\n    get: function get() {\n      var className = this.hasInput ? 'form-group has-feedback ' : '';\n      className += \"formio-component formio-component-\".concat(this.component.type, \" \"); // TODO: find proper way to avoid overriding of default type-based component styles\n\n      if (this.key && this.key !== 'form') {\n        className += \"formio-component-\".concat(this.key, \" \");\n      }\n\n      if (this.component.multiple) {\n        className += 'formio-component-multiple ';\n      }\n\n      if (this.component.customClass) {\n        className += this.component.customClass;\n      }\n\n      if (this.hasInput && this.component.validate && (0, FormioUtils.boolValue)(this.component.validate.required)) {\n        className += ' required';\n      }\n\n      if (this.labelIsHidden()) {\n        className += ' formio-component-label-hidden';\n      }\n\n      if (!this.visible) {\n        className += ' formio-hidden';\n      }\n\n      return className;\n    }\n    /**\n     * Build the custom style from the layout values\n     * @return {string} - The custom style\n     */\n\n  }, {\n    key: \"customStyle\",\n    get: function get() {\n      var customCSS = '';\n\n      _lodash.default.each(this.component.style, function (value, key) {\n        if (value !== '') {\n          customCSS += \"\".concat(key, \":\").concat(value, \";\");\n        }\n      });\n\n      return customCSS;\n    }\n  }, {\n    key: \"isMobile\",\n    get: function get() {\n      return (0, _ismobilejs.default)();\n    }\n    /**\n     * Returns the outside wrapping element of this component.\n     * @returns {HTMLElement}\n     */\n\n  }, {\n    key: \"getElement\",\n    value: function getElement() {\n      return this.element;\n    }\n    /**\n     * Create an evaluation context for all script executions and interpolations.\n     *\n     * @param additional\n     * @return {*}\n     */\n\n  }, {\n    key: \"evalContext\",\n    value: function evalContext(additional) {\n      return _get(_getPrototypeOf(Component.prototype), \"evalContext\", this).call(this, Object.assign({\n        component: this.component,\n        row: this.data,\n        rowIndex: this.rowIndex,\n        data: this.rootValue,\n        iconClass: this.iconClass.bind(this),\n        // Bind the translate function to the data context of any interpolated string.\n        // It is useful to translate strings in different scenarions (eg: custom edit grid templates, custom error messages etc.)\n        // and desirable to be publicly available rather than calling the internal {instance.t} function in the template string.\n        t: this.t.bind(this),\n        submission: this.root ? this.root._submission : {\n          data: this.rootValue\n        },\n        form: this.root ? this.root._form : {},\n        options: this.options\n      }, additional));\n    }\n    /**\n     * Sets the pristine flag for this component.\n     *\n     * @param pristine {boolean} - TRUE to make pristine, FALSE not pristine.\n     */\n\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      this.pristine = pristine;\n    }\n  }, {\n    key: \"isPristine\",\n    get: function get() {\n      return this.pristine;\n    }\n  }, {\n    key: \"setDirty\",\n    value: function setDirty(dirty) {\n      this.dirty = dirty;\n    }\n  }, {\n    key: \"isDirty\",\n    get: function get() {\n      return this.dirty;\n    }\n    /**\n     * Removes a value out of the data array and rebuild the rows.\n     * @param {number} index - The index of the data element to remove.\n     */\n\n  }, {\n    key: \"removeValue\",\n    value: function removeValue(index) {\n      this.splice(index);\n      this.redraw();\n      this.restoreValue();\n      this.triggerRootChange();\n    }\n  }, {\n    key: \"iconClass\",\n    value: function iconClass(name, spinning) {\n      var iconset = this.options.iconset || Templates.current.defaultIconset || 'fa';\n      return Templates.current.hasOwnProperty('iconClass') ? Templates.current.iconClass(iconset, name, spinning) : this.options.iconset === 'fa' ? Templates.defaultTemplates.iconClass(iconset, name, spinning) : name;\n    }\n  }, {\n    key: \"size\",\n    value: function size(_size) {\n      return Templates.current.hasOwnProperty('size') ? Templates.current.size(_size) : _size;\n    }\n    /**\n     * The readible name for this component.\n     * @returns {string} - The name of the component.\n     */\n\n  }, {\n    key: \"name\",\n    get: function get() {\n      return this.t(this.component.label || this.component.placeholder || this.key, {\n        _userInput: true\n      });\n    }\n    /**\n     * Returns the error label for this component.\n     * @return {*}\n     */\n\n  }, {\n    key: \"errorLabel\",\n    get: function get() {\n      return this.t(this.component.errorLabel || this.component.label || this.component.placeholder || this.key);\n    }\n    /**\n     * Get the error message provided a certain type of error.\n     * @param type\n     * @return {*}\n     */\n\n  }, {\n    key: \"errorMessage\",\n    value: function errorMessage(type) {\n      return this.component.errors && this.component.errors[type] ? this.component.errors[type] : type;\n    }\n  }, {\n    key: \"setContent\",\n    value: function setContent(element, content, forceSanitize) {\n      if (element instanceof HTMLElement) {\n        element.innerHTML = this.sanitize(content, forceSanitize);\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"restoreCaretPosition\",\n    value: function restoreCaretPosition() {\n      var _this$root3;\n\n      if ((_this$root3 = this.root) !== null && _this$root3 !== void 0 && _this$root3.currentSelection) {\n        var _this$refs$input;\n\n        if ((_this$refs$input = this.refs.input) !== null && _this$refs$input !== void 0 && _this$refs$input.length) {\n          var _this$root$currentSel2 = this.root.currentSelection,\n              selection = _this$root$currentSel2.selection,\n              index = _this$root$currentSel2.index;\n          var input = this.refs.input[index];\n          var isInputRangeSelectable = /text|search|password|tel|url/i.test(input.type || '');\n\n          if (input) {\n            if (isInputRangeSelectable) {\n              var _input;\n\n              (_input = input).setSelectionRange.apply(_input, _toConsumableArray(selection));\n            }\n          } else {\n            var _input$value;\n\n            input = this.refs.input[this.refs.input.length];\n            var lastCharacter = ((_input$value = input.value) === null || _input$value === void 0 ? void 0 : _input$value.length) || 0;\n\n            if (isInputRangeSelectable) {\n              input.setSelectionRange(lastCharacter, lastCharacter);\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      // Don't bother if we have not built yet.\n      if (!this.element || !this.element.parentNode || this.optimizeRedraw) {\n        // Return a non-resolving promise.\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      this.detach();\n      this.emit('redraw'); // Since we are going to replace the element, we need to know it's position so we can find it in the parent's children.\n\n      var parent = this.element.parentNode;\n      var index = Array.prototype.indexOf.call(parent.children, this.element);\n      this.element.outerHTML = this.sanitize(this.render());\n      this.element = parent.children[index];\n      return this.attach(this.element);\n    }\n  }, {\n    key: \"rebuild\",\n    value: function rebuild() {\n      this.destroy();\n      this.init();\n      this.visible = this.conditionallyVisible(null, null);\n      return this.redraw();\n    }\n  }, {\n    key: \"removeEventListeners\",\n    value: function removeEventListeners() {\n      _get(_getPrototypeOf(Component.prototype), \"removeEventListeners\", this).call(this);\n\n      this.tooltips.forEach(function (tooltip) {\n        return tooltip.dispose();\n      });\n      this.tooltips = [];\n    }\n  }, {\n    key: \"hasClass\",\n    value: function hasClass(element, className) {\n      if (!element) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Component.prototype), \"hasClass\", this).call(this, element, this.transform('class', className));\n    }\n  }, {\n    key: \"addClass\",\n    value: function addClass(element, className) {\n      if (!element) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Component.prototype), \"addClass\", this).call(this, element, this.transform('class', className));\n    }\n  }, {\n    key: \"removeClass\",\n    value: function removeClass(element, className) {\n      if (!element) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Component.prototype), \"removeClass\", this).call(this, element, this.transform('class', className));\n    }\n    /**\n     * Determines if this component has a condition defined.\n     *\n     * @return {null}\n     */\n\n  }, {\n    key: \"hasCondition\",\n    value: function hasCondition() {\n      if (this._hasCondition !== null) {\n        return this._hasCondition;\n      }\n\n      this._hasCondition = FormioUtils.hasCondition(this.component);\n      return this._hasCondition;\n    }\n    /**\n     * Check if this component is conditionally visible.\n     *\n     * @param data\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"conditionallyVisible\",\n    value: function conditionallyVisible(data, row) {\n      data = data || this.rootValue;\n      row = row || this.data;\n\n      if (this.builderMode || this.previewMode || !this.hasCondition()) {\n        return !this.component.hidden;\n      }\n\n      data = data || (this.root ? this.root.data : {});\n      return this.checkCondition(row, data);\n    }\n    /**\n     * Checks the condition of this component.\n     *\n     * TODO: Switch row and data parameters to be consistent with other methods.\n     *\n     * @param row - The row contextual data.\n     * @param data - The global data object.\n     * @return {boolean} - True if the condition applies to this component.\n     */\n\n  }, {\n    key: \"checkCondition\",\n    value: function checkCondition(row, data) {\n      return FormioUtils.checkCondition(this.component, row || this.data, data || this.rootValue, this.root ? this.root._form : {}, this);\n    }\n    /**\n     * Check for conditionals and hide/show the element based on those conditions.\n     */\n\n  }, {\n    key: \"checkComponentConditions\",\n    value: function checkComponentConditions(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n\n      if (!this.builderMode & !this.previewMode && this.fieldLogic(data, row)) {\n        this.redraw();\n      } // Check advanced conditions\n\n\n      var visible = this.conditionallyVisible(data, row);\n\n      if (this.visible !== visible) {\n        this.visible = visible;\n      }\n\n      return visible;\n    }\n    /**\n     * Checks conditions for this component and any sub components.\n     * @param args\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      return this.checkComponentConditions(data, flags, row);\n    }\n  }, {\n    key: \"logic\",\n    get: function get() {\n      return this.component.logic || [];\n    }\n    /**\n     * Check all triggers and apply necessary actions.\n     *\n     * @param data\n     */\n\n  }, {\n    key: \"fieldLogic\",\n    value: function fieldLogic(data, row) {\n      var _this11 = this;\n\n      data = data || this.rootValue;\n      row = row || this.data;\n      var logics = this.logic; // If there aren't logic, don't go further.\n\n      if (logics.length === 0) {\n        return;\n      }\n\n      var newComponent = (0, FormioUtils.fastCloneDeep)(this.originalComponent);\n      var changed = logics.reduce(function (changed, logic) {\n        var result = FormioUtils.checkTrigger(newComponent, logic.trigger, row, data, _this11.root ? _this11.root._form : {}, _this11);\n        return (result ? _this11.applyActions(newComponent, logic.actions, result, row, data) : false) || changed;\n      }, false); // If component definition changed, replace and mark as changed.\n\n      if (!_lodash.default.isEqual(this.component, newComponent)) {\n        this.component = newComponent;\n        changed = true;\n        var disabled = this.shouldDisabled; // Change disabled state if it has changed\n\n        if (this.disabled !== disabled) {\n          this.disabled = disabled;\n        }\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"isIE\",\n    value: function isIE() {\n      if (typeof window === 'undefined') {\n        return false;\n      }\n\n      var userAgent = window.navigator.userAgent;\n      var msie = userAgent.indexOf('MSIE ');\n\n      if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(userAgent.substring(msie + 5, userAgent.indexOf('.', msie)), 10);\n      }\n\n      var trident = userAgent.indexOf('Trident/');\n\n      if (trident > 0) {\n        // IE 11 => return version number\n        var rv = userAgent.indexOf('rv:');\n        return parseInt(userAgent.substring(rv + 3, userAgent.indexOf('.', rv)), 10);\n      }\n\n      var edge = userAgent.indexOf('Edge/');\n\n      if (edge > 0) {\n        // IE 12 (aka Edge) => return version number\n        return parseInt(userAgent.substring(edge + 5, userAgent.indexOf('.', edge)), 10);\n      } // other browser\n\n\n      return false;\n    }\n  }, {\n    key: \"defineActionValue\",\n    value: function defineActionValue(action, argsObject) {\n      return this.evaluate(action.value, argsObject, 'value');\n    }\n  }, {\n    key: \"applyActions\",\n    value: function applyActions(newComponent, actions, result, row, data) {\n      var _this12 = this;\n\n      data = data || this.rootValue;\n      row = row || this.data;\n      return actions.reduce(function (changed, action) {\n        switch (action.type) {\n          case 'property':\n            {\n              FormioUtils.setActionProperty(newComponent, action, result, row, data, _this12);\n              var property = action.property.value;\n\n              if (!_lodash.default.isEqual(_lodash.default.get(_this12.component, property), _lodash.default.get(newComponent, property))) {\n                changed = true;\n              }\n\n              break;\n            }\n\n          case 'value':\n            {\n              var oldValue = _this12.getValue();\n\n              var newValue = _this12.defineActionValue(action, {\n                value: _lodash.default.clone(oldValue),\n                data: data,\n                row: row,\n                component: newComponent,\n                result: result\n              });\n\n              if (!_lodash.default.isEqual(oldValue, newValue)) {\n                _this12.setValue(newValue);\n\n                if (_this12.viewOnly) {\n                  _this12.dataValue = newValue;\n                }\n\n                changed = true;\n              }\n\n              break;\n            }\n\n          case 'mergeComponentSchema':\n            {\n              var schema = _this12.evaluate(action.schemaDefinition, {\n                value: _lodash.default.clone(_this12.getValue()),\n                data: data,\n                row: row,\n                component: newComponent,\n                result: result\n              }, 'schema');\n\n              _lodash.default.assign(newComponent, schema);\n\n              if (!_lodash.default.isEqual(_this12.component, newComponent)) {\n                changed = true;\n              }\n\n              break;\n            }\n\n          case 'customAction':\n            {\n              var _oldValue = _this12.getValue();\n\n              var _newValue = _this12.evaluate(action.customAction, {\n                value: _lodash.default.clone(_oldValue),\n                data: data,\n                row: row,\n                input: _oldValue,\n                component: newComponent,\n                result: result\n              }, 'value');\n\n              if (!_lodash.default.isEqual(_oldValue, _newValue)) {\n                _this12.setValue(_newValue);\n\n                if (_this12.viewOnly) {\n                  _this12.dataValue = _newValue;\n                }\n\n                changed = true;\n              }\n\n              break;\n            }\n        }\n\n        return changed;\n      }, false);\n    } // Deprecated\n\n  }, {\n    key: \"addInputError\",\n    value: function addInputError(message, dirty, elements) {\n      this.addMessages(message);\n      this.setErrorClasses(elements, dirty, !!message);\n    } // Deprecated\n\n  }, {\n    key: \"removeInputError\",\n    value: function removeInputError(elements) {\n      this.setErrorClasses(elements, true, false);\n    }\n    /**\n     * Add a new input error to this element.\n     *\n     * @param message\n     * @param dirty\n     */\n\n  }, {\n    key: \"addMessages\",\n    value: function addMessages(messages) {\n      var _this13 = this;\n\n      if (!messages) {\n        return;\n      } // Standardize on array of objects for message.\n\n\n      if (typeof messages === 'string') {\n        messages = {\n          messages: messages,\n          level: 'error'\n        };\n      }\n\n      if (!Array.isArray(messages)) {\n        messages = [messages];\n      }\n\n      messages = _lodash.default.uniqBy(messages, function (message) {\n        return message.message;\n      });\n\n      if (this.refs.messageContainer) {\n        this.setContent(this.refs.messageContainer, messages.map(function (message) {\n          return _this13.renderTemplate('message', message);\n        }).join(''));\n      }\n    }\n  }, {\n    key: \"setErrorClasses\",\n    value: function setErrorClasses(elements, dirty, hasErrors, hasMessages) {\n      var _this14 = this;\n\n      var element = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : this.element;\n      this.clearErrorClasses();\n      elements.forEach(function (element) {\n        _this14.setElementInvalid(_this14.performInputMapping(element), false);\n      });\n      this.setInputWidgetErrorClasses(elements, hasErrors);\n\n      if (hasErrors) {\n        // Add error classes\n        elements.forEach(function (input) {\n          _this14.setElementInvalid(_this14.performInputMapping(input), true);\n        });\n\n        if (dirty && this.options.highlightErrors) {\n          this.addClass(element, this.options.componentErrorClass);\n        } else {\n          this.addClass(element, 'has-error');\n        }\n      }\n\n      if (hasMessages) {\n        this.addClass(element, 'has-message');\n      }\n    }\n  }, {\n    key: \"setElementInvalid\",\n    value: function setElementInvalid(element, invalid) {\n      if (!element) return;\n\n      if (invalid) {\n        this.addClass(element, 'is-invalid');\n      } else {\n        this.removeClass(element, 'is-invalid');\n      }\n\n      element.setAttribute('aria-invalid', invalid ? 'true' : 'false');\n    }\n  }, {\n    key: \"clearOnHide\",\n    value: function clearOnHide() {\n      // clearOnHide defaults to true for old forms (without the value set) so only trigger if the value is false.\n      if ( // if change happens inside EditGrid's row, it doesn't trigger change on the root level, so rootPristine will be true\n      (!this.rootPristine || this.options.server || (0, FormioUtils.isInsideScopingComponent)(this)) && this.component.clearOnHide !== false && !this.options.readOnly && !this.options.showHiddenFields) {\n        if (!this.visible) {\n          this.deleteValue();\n        } else if (!this.hasValue() && this.shouldAddDefaultValue) {\n          // If shown, ensure the default is set.\n          this.setValue(this.defaultValue, {\n            noUpdateEvent: true\n          });\n        }\n      }\n    }\n  }, {\n    key: \"triggerRootChange\",\n    value: function triggerRootChange() {\n      if (this.options.onChange) {\n        var _this$options;\n\n        (_this$options = this.options).onChange.apply(_this$options, arguments);\n      } else if (this.root) {\n        var _this$root4;\n\n        (_this$root4 = this.root).triggerChange.apply(_this$root4, arguments);\n      }\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, fromRoot) {\n      flags = flags || {};\n\n      if (flags.modified) {\n        if (!flags.noPristineChangeOnModified) {\n          this.pristine = false;\n        }\n\n        this.addClass(this.getElement(), 'formio-modified');\n      } // If we are supposed to validate on blur, then don't trigger validation yet.\n\n\n      if (this.component.validateOn === 'blur' && !this.errors.length) {\n        flags.noValidate = true;\n      }\n\n      if (this.component.onChange) {\n        this.evaluate(this.component.onChange, {\n          flags: flags\n        });\n      } // Set the changed variable.\n\n\n      var changed = {\n        instance: this,\n        component: this.component,\n        value: this.dataValue,\n        flags: flags\n      }; // Emit the change.\n\n      this.emit('componentChange', changed); // Do not propogate the modified flag.\n\n      var modified = false;\n\n      if (flags.modified) {\n        modified = true;\n        delete flags.modified;\n      } // Bubble this change up to the top.\n\n\n      if (!fromRoot) {\n        this.triggerRootChange(flags, changed, modified);\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"wysiwygDefault\",\n    get: function get() {\n      return {\n        quill: {\n          theme: 'snow',\n          placeholder: this.t(this.component.placeholder, {\n            _userInput: true\n          }),\n          modules: {\n            toolbar: [[{\n              'size': ['small', false, 'large', 'huge']\n            }], // custom dropdown\n            [{\n              'header': [1, 2, 3, 4, 5, 6, false]\n            }], [{\n              'font': []\n            }], ['bold', 'italic', 'underline', 'strike', {\n              'script': 'sub'\n            }, {\n              'script': 'super'\n            }, 'clean'], [{\n              'color': []\n            }, {\n              'background': []\n            }], [{\n              'list': 'ordered'\n            }, {\n              'list': 'bullet'\n            }, {\n              'indent': '-1'\n            }, {\n              'indent': '+1'\n            }, {\n              'align': []\n            }], ['blockquote', 'code-block'], ['link', 'image', 'video', 'formula', 'source']]\n          }\n        },\n        ace: {\n          theme: 'ace/theme/xcode',\n          maxLines: 12,\n          minLines: 12,\n          tabSize: 2,\n          mode: 'ace/mode/javascript',\n          placeholder: this.t(this.component.placeholder, {\n            _userInput: true\n          })\n        },\n        ckeditor: {\n          image: {\n            toolbar: ['imageTextAlternative', '|', 'imageStyle:full', 'imageStyle:alignLeft', 'imageStyle:alignCenter', 'imageStyle:alignRight'],\n            styles: ['full', 'alignLeft', 'alignCenter', 'alignRight']\n          },\n          extraPlugins: []\n        },\n        default: {}\n      };\n    }\n  }, {\n    key: \"addCKE\",\n    value: function addCKE(element, settings, onChange) {\n      settings = _lodash.default.isEmpty(settings) ? {} : settings;\n      settings.base64Upload = this.component.isUploadEnabled ? false : true;\n      settings.mediaEmbed = {\n        previewsInData: true\n      };\n      settings = _lodash.default.merge(this.wysiwygDefault.ckeditor, _lodash.default.get(this.options, 'editors.ckeditor.settings', {}), settings);\n\n      if (this.component.isUploadEnabled) {\n        settings.extraPlugins.push((0, _uploadAdapter.getFormioUploadAdapterPlugin)(this.fileService, this));\n      }\n\n      return _Formio.GlobalFormio.requireLibrary('ckeditor', isIEBrowser ? 'CKEDITOR' : 'ClassicEditor', _lodash.default.get(this.options, 'editors.ckeditor.src', CKEDITOR_URL), true).then(function () {\n        if (!element.parentNode) {\n          return _nativePromiseOnly.default.reject();\n        }\n\n        if (isIEBrowser) {\n          var editor = CKEDITOR.replace(element);\n          editor.on('change', function () {\n            return onChange(editor.getData());\n          });\n          return _nativePromiseOnly.default.resolve(editor);\n        } else {\n          return ClassicEditor.create(element, settings).then(function (editor) {\n            editor.model.document.on('change', function () {\n              return onChange(editor.data.get());\n            });\n            return editor;\n          });\n        }\n      });\n    }\n  }, {\n    key: \"addQuill\",\n    value: function addQuill(element, settings, onChange) {\n      var _this15 = this;\n\n      settings = _lodash.default.isEmpty(settings) ? this.wysiwygDefault.quill : settings;\n      settings = _lodash.default.merge(this.wysiwygDefault.quill, _lodash.default.get(this.options, 'editors.quill.settings', {}), settings);\n      settings = _objectSpread(_objectSpread({}, settings), {}, {\n        modules: _objectSpread({\n          table: true\n        }, settings.modules)\n      }); // Lazy load the quill css.\n\n      _Formio.GlobalFormio.requireLibrary(\"quill-css-\".concat(settings.theme), 'Quill', [{\n        type: 'styles',\n        src: \"\".concat(QUILL_URL, \"/quill.\").concat(settings.theme, \".css\")\n      }], true); // Lazy load the quill library.\n\n\n      return _Formio.GlobalFormio.requireLibrary('quill', 'Quill', _lodash.default.get(this.options, 'editors.quill.src', \"\".concat(QUILL_URL, \"/quill.min.js\")), true).then(function () {\n        return _Formio.GlobalFormio.requireLibrary('quill-table', 'Quill', QUILL_TABLE_URL, true).then(function () {\n          if (!element.parentNode) {\n            return _nativePromiseOnly.default.reject();\n          }\n\n          _this15.quill = new Quill(element, isIEBrowser ? _objectSpread(_objectSpread({}, settings), {}, {\n            modules: {}\n          }) : settings);\n          /** This block of code adds the [source] capabilities.  See https://codepen.io/anon/pen/ZyEjrQ **/\n\n          var txtArea = document.createElement('textarea');\n          txtArea.setAttribute('class', 'quill-source-code');\n\n          _this15.quill.addContainer('ql-custom').appendChild(txtArea);\n\n          var qlSource = element.parentNode.querySelector('.ql-source');\n\n          if (qlSource) {\n            _this15.addEventListener(qlSource, 'click', function (event) {\n              event.preventDefault();\n\n              if (txtArea.style.display === 'inherit') {\n                _this15.quill.setContents(_this15.quill.clipboard.convert(txtArea.value));\n              }\n\n              txtArea.style.display = txtArea.style.display === 'none' ? 'inherit' : 'none';\n            });\n          }\n          /** END CODEBLOCK **/\n          // Make sure to select cursor when they click on the element.\n\n\n          _this15.addEventListener(element, 'click', function () {\n            return _this15.quill.focus();\n          }); // Allows users to skip toolbar items when tabbing though form\n\n\n          var elm = document.querySelectorAll('.ql-formats > button');\n\n          for (var i = 0; i < elm.length; i++) {\n            elm[i].setAttribute('tabindex', '-1');\n          }\n\n          _this15.quill.on('text-change', function () {\n            txtArea.value = _this15.quill.root.innerHTML;\n            onChange(txtArea);\n          });\n\n          return _this15.quill;\n        });\n      });\n    }\n  }, {\n    key: \"shouldSanitizeValue\",\n    get: function get() {\n      var _this$options2;\n\n      // Sanitize value if sanitizing for thw whole content is turned off\n      return ((_this$options2 = this.options) === null || _this$options2 === void 0 ? void 0 : _this$options2.sanitize) === false ? true : false;\n    }\n  }, {\n    key: \"addAce\",\n    value: function addAce(element, settings, onChange) {\n      if (!settings || settings.theme === 'snow') {\n        var mode = settings ? settings.mode : '';\n        settings = {};\n\n        if (mode) {\n          settings.mode = mode;\n        }\n      }\n\n      settings = _lodash.default.merge(this.wysiwygDefault.ace, _lodash.default.get(this.options, 'editors.ace.settings', {}), settings || {});\n      return _Formio.GlobalFormio.requireLibrary('ace', 'ace', _lodash.default.get(this.options, 'editors.ace.src', ACE_URL), true).then(function (editor) {\n        editor = editor.edit(element);\n        editor.removeAllListeners('change');\n        editor.setOptions(settings);\n        editor.getSession().setMode(settings.mode);\n        editor.on('change', function () {\n          return onChange(editor.getValue());\n        });\n\n        if (settings.isUseWorkerDisabled) {\n          editor.session.setUseWorker(false);\n        }\n\n        return editor;\n      });\n    }\n  }, {\n    key: \"tree\",\n    get: function get() {\n      return this.component.tree || false;\n    }\n    /**\n     * The empty value for this component.\n     *\n     * @return {null}\n     */\n\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return null;\n    }\n    /**\n     * Returns if this component has a value set.\n     *\n     */\n\n  }, {\n    key: \"hasValue\",\n    value: function hasValue(data) {\n      return _lodash.default.has(data || this.data, this.key);\n    }\n    /**\n     * Get the data value at the root level.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"rootValue\",\n    get: function get() {\n      return this.root ? this.root.data : this.data;\n    }\n  }, {\n    key: \"rootPristine\",\n    get: function get() {\n      return _lodash.default.get(this, 'root.pristine', false);\n    }\n    /**\n     * Get the static value of this component.\n     * @return {*}\n     */\n\n  }, {\n    key: \"dataValue\",\n    get: function get() {\n      if (!this.key || !this.visible && this.component.clearOnHide && !this.rootPristine) {\n        return this.emptyValue;\n      }\n\n      if (!this.hasValue() && this.shouldAddDefaultValue) {\n        var empty = this.component.multiple ? [] : this.emptyValue;\n\n        if (!this.rootPristine) {\n          this.dataValue = empty;\n        }\n\n        return empty;\n      }\n\n      return _lodash.default.get(this._data, this.key);\n    }\n    /**\n     * Sets the static value of this component.\n     *\n     * @param value\n     */\n    ,\n    set: function set(value) {\n      if (!this.allowData || !this.key || !this.visible && this.component.clearOnHide && !this.rootPristine) {\n        return;\n      }\n\n      if (value !== null && value !== undefined) {\n        value = this.hook('setDataValue', value, this.key, this._data);\n      }\n\n      if (value === null || value === undefined) {\n        this.unset();\n        return;\n      }\n\n      _lodash.default.set(this._data, this.key, value);\n\n      return;\n    }\n    /**\n     * Splice a value from the dataValue.\n     *\n     * @param index\n     */\n\n  }, {\n    key: \"splice\",\n    value: function splice(index) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (this.hasValue()) {\n        var dataValue = this.dataValue || [];\n\n        if (_lodash.default.isArray(dataValue) && dataValue.hasOwnProperty(index)) {\n          dataValue.splice(index, 1);\n          this.dataValue = dataValue;\n          this.triggerChange(flags);\n        }\n      }\n    }\n  }, {\n    key: \"unset\",\n    value: function unset() {\n      _lodash.default.unset(this._data, this.key);\n    }\n    /**\n     * Deletes the value of the component.\n     */\n\n  }, {\n    key: \"deleteValue\",\n    value: function deleteValue() {\n      this.setValue(null, {\n        noUpdateEvent: true,\n        noDefault: true\n      });\n      this.unset();\n    }\n  }, {\n    key: \"getCustomDefaultValue\",\n    value: function getCustomDefaultValue(defaultValue) {\n      if (this.component.customDefaultValue && !this.options.preview) {\n        defaultValue = this.evaluate(this.component.customDefaultValue, {\n          value: ''\n        }, 'value');\n      }\n\n      return defaultValue;\n    }\n  }, {\n    key: \"shouldAddDefaultValue\",\n    get: function get() {\n      return !this.options.noDefaults || this.component.defaultValue && !this.isEmpty(this.component.defaultValue) || this.component.customDefaultValue;\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var _this16 = this;\n\n      var defaultValue = this.emptyValue;\n\n      if (this.component.defaultValue) {\n        defaultValue = this.component.defaultValue;\n      }\n\n      defaultValue = this.getCustomDefaultValue(defaultValue);\n\n      var checkMask = function checkMask(value) {\n        if (typeof value === 'string') {\n          var placeholderChar = _this16.placeholderChar;\n          value = (0, _vanillaTextMask.conformToMask)(value, _this16.defaultMask, {\n            placeholderChar: placeholderChar\n          }).conformedValue;\n\n          if (!FormioUtils.matchInputMask(value, _this16.defaultMask)) {\n            value = '';\n          }\n        } else {\n          value = '';\n        }\n\n        return value;\n      };\n\n      if (this.defaultMask) {\n        if (Array.isArray(defaultValue)) {\n          defaultValue = defaultValue.map(checkMask);\n        } else {\n          defaultValue = checkMask(defaultValue);\n        }\n      } // Clone so that it creates a new instance.\n\n\n      return _lodash.default.cloneDeep(defaultValue);\n    }\n    /**\n     * Get the input value of this component.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (!this.hasInput || this.viewOnly || !this.refs.input || !this.refs.input.length) {\n        return this.dataValue;\n      }\n\n      var values = [];\n\n      for (var i in this.refs.input) {\n        if (this.refs.input.hasOwnProperty(i)) {\n          if (!this.component.multiple) {\n            return this.getValueAt(i);\n          }\n\n          values.push(this.getValueAt(i));\n        }\n      }\n\n      if (values.length === 0 && !this.component.multiple) {\n        return '';\n      }\n\n      return values;\n    }\n    /**\n     * Get the value at a specific index.\n     *\n     * @param index\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getValueAt\",\n    value: function getValueAt(index) {\n      var input = this.performInputMapping(this.refs.input[index]);\n      return input ? input.value : undefined;\n    }\n    /**\n     * Set the value of this component.\n     *\n     * @param value\n     * @param flags\n     *\n     * @return {boolean} - If the value changed.\n     */\n\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var changed = this.updateValue(value, flags);\n      value = this.dataValue;\n\n      if (!this.hasInput) {\n        return changed;\n      }\n\n      var isArray = Array.isArray(value);\n      var valueInput = this.refs.fileLink || this.refs.input;\n\n      if (isArray && Array.isArray(this.defaultValue) && this.refs.hasOwnProperty('input') && valueInput && valueInput.length !== value.length && this.visible) {\n        this.redraw();\n      }\n\n      if (this.isHtmlRenderMode() && flags && flags.fromSubmission && changed) {\n        this.redraw();\n        return changed;\n      }\n\n      for (var i in this.refs.input) {\n        if (this.refs.input.hasOwnProperty(i)) {\n          this.setValueAt(i, isArray ? value[i] : value, flags);\n        }\n      }\n\n      return changed;\n    }\n    /**\n     * Set the value at a specific index.\n     *\n     * @param index\n     * @param value\n     */\n\n  }, {\n    key: \"setValueAt\",\n    value: function setValueAt(index, value) {\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      if (!flags.noDefault && (value === null || value === undefined) && !this.component.multiple) {\n        value = this.defaultValue;\n      }\n\n      var input = this.performInputMapping(this.refs.input[index]);\n      var valueMaskInput = this.refs.valueMaskInput;\n\n      if (valueMaskInput !== null && valueMaskInput !== void 0 && valueMaskInput.mask) {\n        valueMaskInput.mask.textMaskInputElement.update(value);\n      }\n\n      if (input.mask) {\n        input.mask.textMaskInputElement.update(value);\n      } else if (input.widget && input.widget.setValue) {\n        input.widget.setValue(value);\n      } else {\n        input.value = value;\n      }\n    }\n  }, {\n    key: \"hasSetValue\",\n    get: function get() {\n      return this.hasValue() && !this.isEmpty(this.dataValue);\n    }\n  }, {\n    key: \"setDefaultValue\",\n    value: function setDefaultValue() {\n      if (this.defaultValue && this.shouldAddDefaultValue) {\n        var defaultValue = this.component.multiple && !this.dataValue.length ? [] : this.defaultValue;\n        this.setValue(defaultValue, {\n          noUpdateEvent: true\n        });\n      }\n    }\n    /**\n     * Restore the value of a control.\n     */\n\n  }, {\n    key: \"restoreValue\",\n    value: function restoreValue() {\n      if (this.hasSetValue) {\n        this.setValue(this.dataValue, {\n          noUpdateEvent: true\n        });\n      } else {\n        this.setDefaultValue();\n      }\n    }\n    /**\n     * Normalize values coming into updateValue.\n     *\n     * @param value\n     * @return {*}\n     */\n\n  }, {\n    key: \"normalizeValue\",\n    value: function normalizeValue(value) {\n      if (this.component.multiple && !Array.isArray(value)) {\n        value = value ? [value] : [];\n      }\n\n      return value;\n    }\n    /**\n     * Update a value of this component.\n     *\n     * @param flags\n     */\n\n  }, {\n    key: \"updateComponentValue\",\n    value: function updateComponentValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var newValue = !flags.resetValue && (value === undefined || value === null) ? this.getValue() : value;\n      newValue = this.normalizeValue(newValue, flags);\n      var changed = newValue !== undefined ? this.hasChanged(newValue, this.dataValue) : false;\n\n      if (changed) {\n        this.dataValue = newValue;\n        this.updateOnChange(flags, changed);\n      }\n\n      if (this.componentModal && flags && flags.fromSubmission) {\n        this.componentModal.setValue(value);\n      }\n\n      return changed;\n    }\n    /**\n     * Updates the value of this component plus all sub-components.\n     *\n     * @param args\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"updateValue\",\n    value: function updateValue() {\n      return this.updateComponentValue.apply(this, arguments);\n    }\n  }, {\n    key: \"getIcon\",\n    value: function getIcon(name, content, styles) {\n      var ref = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'icon';\n      return this.renderTemplate('icon', {\n        className: this.iconClass(name),\n        ref: ref,\n        styles: styles,\n        content: content\n      });\n    }\n    /**\n     * Resets the value of this component.\n     */\n\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      this.unset();\n      this.setValue(this.emptyValue, {\n        noUpdateEvent: true,\n        noValidate: true,\n        resetValue: true\n      });\n    }\n    /**\n     * Determine if the value of this component has changed.\n     *\n     * @param newValue\n     * @param oldValue\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"hasChanged\",\n    value: function hasChanged(newValue, oldValue) {\n      if ((newValue === undefined || newValue === null) && (oldValue === undefined || oldValue === null || this.isEmpty(oldValue))) {\n        return false;\n      } // If we do not have a value and are getting set to anything other than undefined or null, then we changed.\n\n\n      if (newValue !== undefined && newValue !== null && this.allowData && !this.hasValue()) {\n        return true;\n      }\n\n      return !_lodash.default.isEqual(newValue, oldValue);\n    }\n    /**\n     * Update the value on change.\n     *\n     * @param flags\n     */\n\n  }, {\n    key: \"updateOnChange\",\n    value: function updateOnChange() {\n      var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var changed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!flags.noUpdateEvent && changed) {\n        this.triggerChange(flags);\n        return true;\n      }\n\n      return false;\n    }\n    /**\n     * Perform a calculated value operation.\n     *\n     * @param data - The global data object.\n     *\n     * @return {boolean} - If the value changed during calculation.\n     */\n\n  }, {\n    key: \"convertNumberOrBoolToString\",\n    value: function convertNumberOrBoolToString(value) {\n      if (typeof value === 'number' || typeof value === 'boolean') {\n        return value.toString();\n      }\n\n      return value;\n    }\n  }, {\n    key: \"doValueCalculation\",\n    value: function doValueCalculation(dataValue, data, row) {\n      return this.evaluate(this.component.calculateValue, {\n        value: dataValue,\n        data: data,\n        row: row || this.data\n      }, 'value');\n    }\n  }, {\n    key: \"calculateComponentValue\",\n    value: function calculateComponentValue(data, flags, row) {\n      // If no calculated value or\n      // hidden and set to clearOnHide (Don't calculate a value for a hidden field set to clear when hidden)\n      var clearOnHide = this.component.clearOnHide;\n      var shouldBeCleared = !this.visible && clearOnHide;\n\n      var allowOverride = _lodash.default.get(this.component, 'allowCalculateOverride', false); // Handle all cases when calculated values should not fire.\n\n\n      if (this.options.readOnly && !this.options.pdf || !(this.component.calculateValue || this.component.calculateValueVariable) || shouldBeCleared || this.options.server && !this.component.calculateServer || flags.dataSourceInitialLoading && allowOverride) {\n        return false;\n      }\n\n      var dataValue = this.dataValue; // Calculate the new value.\n\n      var calculatedValue = this.doValueCalculation(dataValue, data, row, flags);\n\n      if (_lodash.default.isNil(calculatedValue)) {\n        calculatedValue = this.emptyValue;\n      }\n\n      var changed = !_lodash.default.isEqual(dataValue, calculatedValue); // Do not override calculations on server if they have calculateServer set.\n\n      if (allowOverride) {\n        var firstPass = this.calculatedValue === undefined;\n\n        if (firstPass) {\n          this.calculatedValue = null;\n        }\n\n        var newCalculatedValue = this.normalizeValue(this.convertNumberOrBoolToString(calculatedValue));\n        var previousCalculatedValue = this.normalizeValue(this.convertNumberOrBoolToString(this.calculatedValue));\n        var calculationChanged = !_lodash.default.isEqual(previousCalculatedValue, newCalculatedValue);\n        var previousChanged = !_lodash.default.isEqual(dataValue, previousCalculatedValue); // Check to ensure that the calculated value is different than the previously calculated value.\n\n        if (previousCalculatedValue && previousChanged && !calculationChanged) {\n          return false;\n        }\n\n        if (flags.isReordered || !calculationChanged) {\n          return false;\n        }\n\n        if (flags.fromSubmission && this.component.persistent === true) {\n          // If we set value from submission and it differs from calculated one, set the calculated value to prevent overriding dataValue in the next pass\n          this.calculatedValue = calculatedValue;\n          return false;\n        } // If this is the firstPass, and the dataValue is different than to the calculatedValue.\n\n\n        if (firstPass && !this.isEmpty(dataValue) && changed && calculationChanged) {\n          // Return that we have a change so it will perform another pass.\n          return true;\n        }\n      }\n\n      this.calculatedValue = calculatedValue;\n\n      if (changed) {\n        if (!flags.noPristineChangeOnModified) {\n          this.pristine = false;\n        }\n\n        flags.triggeredComponentId = this.id;\n        return this.setValue(calculatedValue, flags);\n      }\n\n      return false;\n    }\n    /**\n     * Performs calculations in this component plus any child components.\n     *\n     * @param args\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      return this.calculateComponentValue(data, flags, row);\n    }\n    /**\n     * Get this component's label text.\n     *\n     */\n\n  }, {\n    key: \"label\",\n    get: function get() {\n      return this.component.label;\n    }\n    /**\n     * Set this component's label text and render it.\n     *\n     * @param value - The new label text.\n     */\n    ,\n    set: function set(value) {\n      this.component.label = value;\n\n      if (this.labelElement) {\n        this.labelElement.innerText = value;\n      }\n    }\n    /**\n     * Get FormioForm element at the root of this component tree.\n     *\n     */\n\n  }, {\n    key: \"getRoot\",\n    value: function getRoot() {\n      return this.root;\n    }\n    /**\n     * Returns the invalid message, or empty string if the component is valid.\n     *\n     * @param data\n     * @param dirty\n     * @return {*}\n     */\n\n  }, {\n    key: \"invalidMessage\",\n    value: function invalidMessage(data, dirty, ignoreCondition, row) {\n      if (!ignoreCondition && !this.checkCondition(row, data)) {\n        return '';\n      } // See if this is forced invalid.\n\n\n      if (this.invalid) {\n        return this.invalid;\n      } // No need to check for errors if there is no input or if it is pristine.\n\n\n      if (!this.hasInput || !dirty && this.pristine) {\n        return '';\n      }\n\n      return _lodash.default.map(_Validator.default.checkComponent(this, data), 'message').join('\\n\\n');\n    }\n    /**\n     * Returns if the component is valid or not.\n     *\n     * @param data\n     * @param dirty\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"isValid\",\n    value: function isValid(data, dirty) {\n      return !this.invalidMessage(data, dirty);\n    }\n  }, {\n    key: \"setComponentValidity\",\n    value: function setComponentValidity(messages, dirty, silentCheck) {\n      var hasErrors = !!messages.filter(function (message) {\n        return message.level === 'error' && !message.fromServer;\n      }).length;\n\n      if (messages.length && (!silentCheck || this.error) && (dirty || !this.pristine)) {\n        this.setCustomValidity(messages, dirty);\n      } else if (!silentCheck) {\n        this.setCustomValidity('');\n      }\n\n      return !hasErrors;\n    }\n    /**\n     * Checks the validity of this component and sets the error message if it is invalid.\n     *\n     * @param data\n     * @param dirty\n     * @param row\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row) {\n      var _this$serverErrors,\n          _this17 = this;\n\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      data = data || this.rootValue;\n      row = row || this.data;\n      var _options$async = options.async,\n          async = _options$async === void 0 ? false : _options$async,\n          _options$silentCheck = options.silentCheck,\n          silentCheck = _options$silentCheck === void 0 ? false : _options$silentCheck;\n\n      if (this.shouldSkipValidation(data, dirty, row)) {\n        this.setCustomValidity('');\n        return async ? _nativePromiseOnly.default.resolve(true) : true;\n      }\n\n      var check = _Validator.default.checkComponent(this, data, row, true, async);\n\n      var validations = check;\n\n      if ((_this$serverErrors = this.serverErrors) !== null && _this$serverErrors !== void 0 && _this$serverErrors.length) {\n        validations = check.concat(this.serverErrors);\n      }\n\n      return async ? validations.then(function (messages) {\n        return _this17.setComponentValidity(messages, dirty, silentCheck);\n      }) : this.setComponentValidity(validations, dirty, silentCheck);\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      data = data || this.rootValue;\n      row = row || this.data;\n      var isValid = this.checkComponentValidity(data, dirty, row, {\n        silentCheck: silentCheck\n      });\n      this.checkModal();\n      return isValid;\n    }\n  }, {\n    key: \"checkAsyncValidity\",\n    value: function checkAsyncValidity(data, dirty, row, silentCheck) {\n      return _nativePromiseOnly.default.resolve(this.checkComponentValidity(data, dirty, row, {\n        async: true,\n        silentCheck: silentCheck\n      }));\n    }\n    /**\n     * Check the conditions, calculations, and validity of a single component and triggers an update if\n     * something changed.\n     *\n     * @param data - The root data of the change event.\n     * @param flags - The flags from this change event.\n     *\n     * @return boolean - If component is valid or not.\n     */\n\n  }, {\n    key: \"checkData\",\n    value: function checkData(data, flags, row) {\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data; // Needs for Nextgen Rules Engine\n\n      this.resetCaches(); // Do not trigger refresh if change was triggered on blur event since components with Refresh on Blur have their own listeners\n\n      if (!flags.fromBlur) {\n        this.checkRefreshOn(flags.changes, flags);\n      }\n\n      if (flags.noCheck) {\n        return true;\n      }\n\n      this.checkComponentConditions(data, flags, row);\n\n      if (this.id !== flags.triggeredComponentId) {\n        this.calculateComponentValue(data, flags, row);\n      }\n\n      if (flags.noValidate && !flags.validateOnInit && !flags.fromIframe) {\n        if (flags.fromSubmission && this.rootPristine && this.pristine && this.error && flags.changed) {\n          this.checkComponentValidity(data, !!this.options.alwaysDirty, row, true);\n        }\n\n        return true;\n      }\n\n      var isDirty = false; // We need to set dirty if they explicitly set noValidate to false.\n\n      if (this.options.alwaysDirty || flags.dirty) {\n        isDirty = true;\n      } // See if they explicitely set the values with setSubmission.\n\n\n      if (flags.fromSubmission && this.hasValue(data)) {\n        isDirty = true;\n      }\n\n      this.setDirty(isDirty);\n\n      if (this.component.validateOn === 'blur' && flags.fromSubmission) {\n        return true;\n      }\n\n      var isValid = this.checkComponentValidity(data, isDirty, row, flags);\n      this.checkModal();\n      return isValid;\n    }\n  }, {\n    key: \"checkModal\",\n    value: function checkModal() {\n      var isValid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var dirty = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!this.component.modalEdit || !this.componentModal) {\n        return;\n      }\n\n      if (dirty && !isValid) {\n        this.setErrorClasses([this.refs.openModal], dirty, !isValid, !!this.errors.length, this.refs.openModalWrapper);\n      } else {\n        this.clearErrorClasses(this.refs.openModalWrapper);\n      }\n    }\n  }, {\n    key: \"validationValue\",\n    get: function get() {\n      return this.dataValue;\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      var isEmptyArray = _lodash.default.isArray(value) && value.length === 1 ? _lodash.default.isEqual(value[0], this.emptyValue) : false;\n      return value == null || value.length === 0 || _lodash.default.isEqual(value, this.emptyValue) || isEmptyArray;\n    }\n  }, {\n    key: \"isEqual\",\n    value: function isEqual(valueA) {\n      var valueB = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.dataValue;\n      return this.isEmpty(valueA) && this.isEmpty(valueB) || _lodash.default.isEqual(valueA, valueB);\n    }\n    /**\n     * Check if a component is eligible for multiple validation\n     *\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"validateMultiple\",\n    value: function validateMultiple() {\n      return true;\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      return this.error ? [this.error] : [];\n    }\n  }, {\n    key: \"clearErrorClasses\",\n    value: function clearErrorClasses() {\n      var element = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.element;\n      this.removeClass(element, this.options.componentErrorClass);\n      this.removeClass(element, 'alert alert-danger');\n      this.removeClass(element, 'has-error');\n      this.removeClass(element, 'has-message');\n    }\n  }, {\n    key: \"setInputWidgetErrorClasses\",\n    value: function setInputWidgetErrorClasses(inputRefs, hasErrors) {\n      if (!this.isInputComponent || !this.component.widget || !(inputRefs !== null && inputRefs !== void 0 && inputRefs.length)) {\n        return;\n      }\n\n      inputRefs.forEach(function (input) {\n        if (input !== null && input !== void 0 && input.widget && input.widget.setErrorClasses) {\n          input.widget.setErrorClasses(hasErrors);\n        }\n      });\n    }\n  }, {\n    key: \"setCustomValidity\",\n    value: function setCustomValidity(messages, dirty, external) {\n      var _this18 = this;\n\n      var inputRefs = this.isInputComponent ? this.refs.input || [] : null;\n\n      if (typeof messages === 'string' && messages) {\n        messages = {\n          level: 'error',\n          message: messages\n        };\n      }\n\n      if (!Array.isArray(messages)) {\n        if (messages) {\n          messages = [messages];\n        } else {\n          messages = [];\n        }\n      }\n\n      var hasErrors = !!messages.filter(function (message) {\n        return message.level === 'error';\n      }).length;\n      var invalidInputRefs = inputRefs;\n\n      if (this.component.multiple) {\n        var inputRefsArray = Array.from(inputRefs);\n        inputRefsArray.forEach(function (input) {\n          _this18.setElementInvalid(_this18.performInputMapping(input), false);\n        });\n        invalidInputRefs = inputRefsArray.filter(function (ref) {\n          var _messages$some, _messages;\n\n          return (_messages$some = (_messages = messages).some) === null || _messages$some === void 0 ? void 0 : _messages$some.call(_messages, function (msg) {\n            var _msg$context;\n\n            return (msg === null || msg === void 0 ? void 0 : (_msg$context = msg.context) === null || _msg$context === void 0 ? void 0 : _msg$context.input) === ref;\n          });\n        });\n      }\n\n      if (messages.length) {\n        if (this.refs.messageContainer) {\n          this.empty(this.refs.messageContainer);\n        }\n\n        this.error = {\n          component: this.component,\n          message: messages[0].message,\n          messages: messages,\n          external: !!external\n        };\n        this.emit('componentError', this.error);\n        this.addMessages(messages, dirty, invalidInputRefs);\n\n        if (invalidInputRefs) {\n          this.setErrorClasses(invalidInputRefs, dirty, hasErrors, !!messages.length);\n        }\n      } else if (this.error && this.error.external === !!external) {\n        if (this.refs.messageContainer) {\n          this.empty(this.refs.messageContainer);\n        }\n\n        if (this.refs.modalMessageContainer) {\n          this.empty(this.refs.modalMessageContainer);\n        }\n\n        this.error = null;\n\n        if (invalidInputRefs) {\n          this.setErrorClasses(invalidInputRefs, dirty, hasErrors, !!messages.length);\n        }\n\n        this.clearErrorClasses();\n      } // if (!this.refs.input) {\n      //   return;\n      // }\n      // this.refs.input.forEach(input => {\n      //   input = this.performInputMapping(input);\n      //   if (typeof input.setCustomValidity === 'function') {\n      //     input.setCustomValidity(message, dirty);\n      //   }\n      // });\n\n    }\n    /**\n     * Determines if the value of this component is hidden from the user as if it is coming from the server, but is\n     * protected.\n     *\n     * @return {boolean|*}\n     */\n\n  }, {\n    key: \"isValueHidden\",\n    value: function isValueHidden() {\n      if (!this.root || !this.root.hasOwnProperty('editing')) {\n        return false;\n      }\n\n      if (!this.root || !this.root.editing) {\n        return false;\n      }\n\n      return this.component.protected || !this.component.persistent || this.component.persistent === 'client-only';\n    }\n  }, {\n    key: \"shouldSkipValidation\",\n    value: function shouldSkipValidation(data, dirty, row) {\n      var _this19 = this;\n\n      var rules = [// Force valid if component is read-only\n      function () {\n        return _this19.options.readOnly;\n      }, // Do not check validations if component is not an input component.\n      function () {\n        return !_this19.hasInput;\n      }, // Check to see if we are editing and if so, check component persistence.\n      function () {\n        return _this19.isValueHidden();\n      }, // Force valid if component is hidden.\n      function () {\n        return !_this19.visible;\n      }, // Force valid if component is conditionally hidden.\n      function () {\n        return !_this19.checkCondition(row, data);\n      }];\n      return rules.some(function (pred) {\n        return pred();\n      });\n    } // Maintain reverse compatibility.\n\n  }, {\n    key: \"whenReady\",\n    value: function whenReady() {\n      console.warn('The whenReady() method has been deprecated. Please use the dataReady property instead.');\n      return this.dataReady;\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return _nativePromiseOnly.default.resolve();\n    }\n    /**\n     * Prints out the value of this component as a string value.\n     */\n\n  }, {\n    key: \"asString\",\n    value: function asString(value) {\n      value = value || this.getValue();\n      return (Array.isArray(value) ? value : [value]).map(_lodash.default.toString).join(', ');\n    }\n    /**\n     * Return if the component is disabled.\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"disabled\",\n    get: function get() {\n      return this._disabled || this.parentDisabled;\n    }\n    /**\n     * Disable this component.\n     *\n     * @param {boolean} disabled\n     */\n    ,\n    set: function set(disabled) {\n      this._disabled = disabled;\n    }\n  }, {\n    key: \"setDisabled\",\n    value: function setDisabled(element, disabled) {\n      if (!element) {\n        return;\n      }\n\n      element.disabled = disabled;\n\n      if (disabled) {\n        element.setAttribute('disabled', 'disabled');\n      } else {\n        element.removeAttribute('disabled');\n      }\n    }\n  }, {\n    key: \"setLoading\",\n    value: function setLoading(element, loading) {\n      if (!element || element.loading === loading) {\n        return;\n      }\n\n      element.loading = loading;\n\n      if (!element.loader && loading) {\n        element.loader = this.ce('i', {\n          class: \"\".concat(this.iconClass('refresh', true), \" button-icon-right\")\n        });\n      }\n\n      if (element.loader) {\n        if (loading) {\n          this.appendTo(element.loader, element);\n        } else {\n          this.removeChildFrom(element.loader, element);\n        }\n      }\n    }\n  }, {\n    key: \"selectOptions\",\n    value: function selectOptions(select, tag, options, defaultValue) {\n      var _this20 = this;\n\n      _lodash.default.each(options, function (option) {\n        var attrs = {\n          value: option.value\n        };\n\n        if (defaultValue !== undefined && option.value === defaultValue) {\n          attrs.selected = 'selected';\n        }\n\n        var optionElement = _this20.ce('option', attrs);\n\n        optionElement.appendChild(_this20.text(option.label));\n        select.appendChild(optionElement);\n      });\n    }\n  }, {\n    key: \"setSelectValue\",\n    value: function setSelectValue(select, value) {\n      var options = select.querySelectorAll('option');\n\n      _lodash.default.each(options, function (option) {\n        if (option.value === value) {\n          option.setAttribute('selected', 'selected');\n        } else {\n          option.removeAttribute('selected');\n        }\n      });\n\n      if (select.onchange) {\n        select.onchange();\n      }\n\n      if (select.onselect) {\n        select.onselect();\n      }\n    }\n  }, {\n    key: \"getRelativePath\",\n    value: function getRelativePath(path) {\n      var keyPart = \".\".concat(this.key);\n      var thisPath = this.isInputComponent ? this.path : this.path.slice(0).replace(keyPart, '');\n      return path.replace(thisPath, '');\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.detach();\n      this.empty(this.getElement());\n    }\n  }, {\n    key: \"append\",\n    value: function append(element) {\n      this.appendTo(element, this.element);\n    }\n  }, {\n    key: \"prepend\",\n    value: function prepend(element) {\n      this.prependTo(element, this.element);\n    }\n  }, {\n    key: \"removeChild\",\n    value: function removeChild(element) {\n      this.removeChildFrom(element, this.element);\n    }\n  }, {\n    key: \"detachLogic\",\n    value: function detachLogic() {\n      var _this21 = this;\n\n      this.logic.forEach(function (logic) {\n        if (logic.trigger.type === 'event') {\n          var event = _this21.interpolate(logic.trigger.event);\n\n          _this21.off(event); // only applies to callbacks on this component\n\n        }\n      });\n    }\n  }, {\n    key: \"attachLogic\",\n    value: function attachLogic() {\n      var _this22 = this;\n\n      // Do not attach logic during builder mode.\n      if (this.builderMode) {\n        return;\n      }\n\n      this.logic.forEach(function (logic) {\n        if (logic.trigger.type === 'event') {\n          var event = _this22.interpolate(logic.trigger.event);\n\n          _this22.on(event, function () {\n            var newComponent = (0, FormioUtils.fastCloneDeep)(_this22.originalComponent);\n\n            for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n              args[_key4] = arguments[_key4];\n            }\n\n            if (_this22.applyActions(newComponent, logic.actions, args)) {\n              // If component definition changed, replace it.\n              if (!_lodash.default.isEqual(_this22.component, newComponent)) {\n                _this22.component = newComponent;\n\n                var visible = _this22.conditionallyVisible(null, null);\n\n                var disabled = _this22.shouldDisabled; // Change states which won't be recalculated during redrawing\n\n                if (_this22.visible !== visible) {\n                  _this22.visible = visible;\n                }\n\n                if (_this22.disabled !== disabled) {\n                  _this22.disabled = disabled;\n                }\n\n                _this22.redraw();\n              }\n            }\n          }, true);\n        }\n      });\n    }\n    /**\n     * Get the element information.\n     */\n\n  }, {\n    key: \"elementInfo\",\n    value: function elementInfo() {\n      var attributes = {\n        name: this.options.name,\n        type: this.component.inputType || 'text',\n        class: 'form-control',\n        lang: this.options.language\n      };\n\n      if (this.component.placeholder) {\n        attributes.placeholder = this.t(this.component.placeholder, {\n          _userInput: true\n        });\n      }\n\n      if (this.component.tabindex) {\n        attributes.tabindex = this.component.tabindex;\n      }\n\n      if (this.disabled) {\n        attributes.disabled = 'disabled';\n      }\n\n      _lodash.default.defaults(attributes, this.component.attributes);\n\n      return {\n        type: 'input',\n        component: this.component,\n        changeEvent: 'change',\n        attr: attributes\n      };\n    }\n  }, {\n    key: \"autofocus\",\n    value: function autofocus() {\n      var _this23 = this;\n\n      var hasAutofocus = this.component.autofocus && !this.builderMode && !this.options.preview;\n\n      if (hasAutofocus) {\n        this.on('render', function () {\n          return _this23.focus();\n        }, true);\n      }\n    }\n  }, {\n    key: \"scrollIntoView\",\n    value: function scrollIntoView() {\n      var element = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.element;\n\n      if (!element) {\n        return;\n      }\n\n      var _element$getBoundingC = element.getBoundingClientRect(),\n          left = _element$getBoundingC.left,\n          top = _element$getBoundingC.top;\n\n      window.scrollTo(left + window.scrollX, top + window.scrollY);\n    }\n  }, {\n    key: \"focus\",\n    value: function focus(index) {\n      var _this$refs$input2;\n\n      if ('beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n\n      if ((_this$refs$input2 = this.refs.input) !== null && _this$refs$input2 !== void 0 && _this$refs$input2.length) {\n        var _this$component$widge;\n\n        var focusingInput = typeof index === 'number' && this.refs.input[index] ? this.refs.input[index] : this.refs.input[this.refs.input.length - 1];\n\n        if (((_this$component$widge = this.component.widget) === null || _this$component$widge === void 0 ? void 0 : _this$component$widge.type) === 'calendar') {\n          var sibling = focusingInput.nextSibling;\n\n          if (sibling) {\n            sibling.focus();\n          }\n        } else {\n          focusingInput.focus();\n        }\n      }\n\n      if (this.refs.openModal) {\n        this.refs.openModal.focus();\n      }\n\n      if (this.parent.refs.openModal) {\n        this.parent.refs.openModal.focus();\n      }\n    }\n    /**\n     * Get `Formio` instance for working with files\n     */\n\n  }, {\n    key: \"fileService\",\n    get: function get() {\n      if (this.options.fileService) {\n        return this.options.fileService;\n      }\n\n      if (this.options.formio) {\n        return this.options.formio;\n      }\n\n      if (this.root && this.root.formio) {\n        return this.root.formio;\n      }\n\n      var formio = new _Formio.GlobalFormio(); // If a form is loaded, then make sure to set the correct formUrl.\n\n      if (this.root && this.root._form && this.root._form._id) {\n        formio.formUrl = \"\".concat(formio.projectUrl, \"/form/\").concat(this.root._form._id);\n      }\n\n      return formio;\n    }\n  }, {\n    key: \"resetCaches\",\n    value: function resetCaches() {}\n  }, {\n    key: \"previewMode\",\n    get: function get() {\n      return false;\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len5 = arguments.length, sources = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n        sources[_key5] = arguments[_key5];\n      }\n\n      return _lodash.default.merge.apply(_lodash.default, [{\n        /**\n         * Determines if this component provides an input.\n         */\n        input: true,\n\n        /**\n         * The data key for this component (how the data is stored in the database).\n         */\n        key: '',\n\n        /**\n         * The input placeholder for this component.\n         */\n        placeholder: '',\n\n        /**\n         * The input prefix\n         */\n        prefix: '',\n\n        /**\n         * The custom CSS class to provide to this component.\n         */\n        customClass: '',\n\n        /**\n         * The input suffix.\n         */\n        suffix: '',\n\n        /**\n         * If this component should allow an array of values to be captured.\n         */\n        multiple: false,\n\n        /**\n         * The default value of this component.\n         */\n        defaultValue: null,\n\n        /**\n         * If the data of this component should be protected (no GET api requests can see the data)\n         */\n        protected: false,\n\n        /**\n         * Validate if the value of this component should be unique within the form.\n         */\n        unique: false,\n\n        /**\n         * If the value of this component should be persisted within the backend api database.\n         */\n        persistent: true,\n\n        /**\n         * Determines if the component should be within the form, but not visible.\n         */\n        hidden: false,\n\n        /**\n         * If the component should be cleared when hidden.\n         */\n        clearOnHide: true,\n\n        /**\n         * This will refresh this component options when this field changes.\n         */\n        refreshOn: '',\n\n        /**\n         * This will redraw the component when this field changes.\n         */\n        redrawOn: '',\n\n        /**\n         * If this component should be included as a column within a submission table.\n         */\n        tableView: false,\n\n        /**\n         * If this component should be rendering in modal.\n         */\n        modalEdit: false,\n\n        /**\n         * The input label provided to this component.\n         */\n        label: '',\n        dataGridLabel: false,\n        labelPosition: 'top',\n        description: '',\n        errorLabel: '',\n        tooltip: '',\n        hideLabel: false,\n        tabindex: '',\n        disabled: false,\n        autofocus: false,\n        dbIndex: false,\n        customDefaultValue: '',\n        calculateValue: '',\n        calculateServer: false,\n        widget: null,\n\n        /**\n         * Attributes that will be assigned to the input elements of this component.\n         */\n        attributes: {},\n\n        /**\n         * This will perform the validation on either \"change\" or \"blur\" of the input element.\n         */\n        validateOn: 'change',\n\n        /**\n         * The validation criteria for this component.\n         */\n        validate: {\n          /**\n           * If this component is required.\n           */\n          required: false,\n\n          /**\n           * Custom JavaScript validation.\n           */\n          custom: '',\n\n          /**\n           * If the custom validation should remain private (only the backend will see it and execute it).\n           */\n          customPrivate: false,\n\n          /**\n           * If this component should implement a strict date validation if the Calendar widget is implemented.\n           */\n          strictDateValidation: false,\n          multiple: false,\n          unique: false\n        },\n\n        /**\n         * The simple conditional settings for a component.\n         */\n        conditional: {\n          show: null,\n          when: null,\n          eq: ''\n        },\n        overlay: {\n          style: '',\n          left: '',\n          top: '',\n          width: '',\n          height: ''\n        },\n        allowCalculateOverride: false,\n        encrypted: false,\n        showCharCount: false,\n        showWordCount: false,\n        properties: {},\n        allowMultipleMasks: false,\n        addons: []\n      }].concat(sources));\n    }\n    /**\n     * Return the validator as part of the component.\n     *\n     * @return {ValidationChecker}\n     * @constructor\n     */\n\n  }, {\n    key: \"Validator\",\n    get: function get() {\n      return _Validator.default;\n    }\n    /**\n     * Provides a table view for this component. Override if you wish to do something different than using getView\n     * method of your instance.\n     *\n     * @param value\n     * @param options\n     */\n\n    /* eslint-disable no-unused-vars */\n\n  }, {\n    key: \"tableView\",\n    value: function tableView(value, options) {}\n  }]);\n\n  return Component;\n}(_Element2.default);\n\nexports.default = Component;\nComponent.externalLibraries = {};\n\nComponent.requireLibrary = function (name, property, src, polling) {\n  if (!Component.externalLibraries.hasOwnProperty(name)) {\n    Component.externalLibraries[name] = {};\n    Component.externalLibraries[name].ready = new _nativePromiseOnly.default(function (resolve, reject) {\n      Component.externalLibraries[name].resolve = resolve;\n      Component.externalLibraries[name].reject = reject;\n    });\n    var callbackName = \"\".concat(name, \"Callback\");\n\n    if (!polling && !window[callbackName]) {\n      window[callbackName] = function () {\n        this.resolve();\n      }.bind(Component.externalLibraries[name]);\n    } // See if the plugin already exists.\n\n\n    var plugin = _lodash.default.get(window, property);\n\n    if (plugin) {\n      Component.externalLibraries[name].resolve(plugin);\n    } else {\n      src = Array.isArray(src) ? src : [src];\n      src.forEach(function (lib) {\n        var attrs = {};\n        var elementType = '';\n\n        if (typeof lib === 'string') {\n          lib = {\n            type: 'script',\n            src: lib\n          };\n        }\n\n        switch (lib.type) {\n          case 'script':\n            elementType = 'script';\n            attrs = {\n              src: lib.src,\n              type: 'text/javascript',\n              defer: true,\n              async: true\n            };\n            break;\n\n          case 'styles':\n            elementType = 'link';\n            attrs = {\n              href: lib.src,\n              rel: 'stylesheet'\n            };\n            break;\n        } // Add the script to the top page.\n\n\n        var script = document.createElement(elementType);\n\n        for (var attr in attrs) {\n          script.setAttribute(attr, attrs[attr]);\n        }\n\n        document.getElementsByTagName('head')[0].appendChild(script);\n      }); // if no callback is provided, then check periodically for the script.\n\n      if (polling) {\n        setTimeout(function checkLibrary() {\n          var plugin = _lodash.default.get(window, property);\n\n          if (plugin) {\n            Component.externalLibraries[name].resolve(plugin);\n          } else {\n            // check again after 200 ms.\n            setTimeout(checkLibrary, 200);\n          }\n        }, 200);\n      }\n    }\n  }\n\n  return Component.externalLibraries[name].ready;\n};\n\nComponent.libraryReady = function (name) {\n  if (Component.externalLibraries.hasOwnProperty(name) && Component.externalLibraries[name].ready) {\n    return Component.externalLibraries[name].ready;\n  }\n\n  return _nativePromiseOnly.default.reject(\"\".concat(name, \" library was not required.\"));\n};"]},"metadata":{},"sourceType":"script"}